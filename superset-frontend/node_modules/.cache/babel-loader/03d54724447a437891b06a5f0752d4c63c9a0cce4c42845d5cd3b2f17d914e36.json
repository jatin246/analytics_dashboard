{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useContext, useMemo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { findPermission } from 'src/utils/findPermission';\nimport DrillDetailPane from './DrillDetailPane';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst ModalFooter = ({ canExplore, closeModal, exploreChart }) => {\n  const theme = useTheme();\n  return _jsxs(_Fragment, { children: [\n    _jsx(Button, { buttonStyle: \"secondary\", buttonSize: \"small\", onClick: exploreChart, disabled: !canExplore, tooltip: !canExplore ?\n      t('You do not have sufficient permissions to edit the chart') :\n      undefined, children:\n      t('Edit chart') }\n    ),\n    _jsx(Button, { buttonStyle: \"primary\", buttonSize: \"small\", onClick: closeModal, \"data-test\": \"close-drilltodetail-modal\", css: css`\n          margin-left: ${theme.gridUnit * 2}px;\n        `, children:\n      t('Close') }\n    )] }\n  );\n};__signature__(ModalFooter, \"useTheme{theme}\", () => [useTheme]);\nexport default function DrillDetailModal({ chartId, formData, initialFilters, showModal, onHideModal }) {\n  const theme = useTheme();\n  const history = useHistory();\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const { slice_name: chartName } = useSelector((state) => state.sliceEntities.slices[chartId]);\n  const canExplore = useSelector((state) => {var _state$user;return findPermission('can_explore', 'Superset', (_state$user = state.user) == null ? void 0 : _state$user.roles);});\n  const exploreUrl = useMemo(() => `/explore/?dashboard_page_id=${dashboardPageId}&slice_id=${chartId}`, [chartId, dashboardPageId]);\n  const exploreChart = useCallback(() => {\n    history.push(exploreUrl);\n  }, [exploreUrl, history]);\n  return _jsx(Modal, { show: showModal, onHide: onHideModal != null ? onHideModal : () => null, css: css`\n        .ant-modal-body {\n          display: flex;\n          flex-direction: column;\n        }\n      `, title: t('Drill to detail: %s', chartName), footer: _jsx(ModalFooter, { exploreChart: exploreChart, canExplore: canExplore }), responsive: true, resizable: true, resizableConfig: {\n      minHeight: theme.gridUnit * 128,\n      minWidth: theme.gridUnit * 128,\n      defaultSize: {\n        width: 'auto',\n        height: '75vh'\n      }\n    }, draggable: true, destroyOnClose: true, maskClosable: false, children:\n    _jsx(DrillDetailPane, { formData: formData, initialFilters: initialFilters }) }\n  );\n}__signature__(DrillDetailModal, \"useTheme{theme}\\nuseHistory{history}\\nuseContext{dashboardPageId}\\nuseSelector{{ slice_name: chartName }}\\nuseSelector{canExplore}\\nuseMemo{exploreUrl}\\nuseCallback{exploreChart}\", () => [useTheme, useHistory, useSelector, useSelector]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(ModalFooter, \"ModalFooter\", \"/app/superset-frontend/src/components/Chart/DrillDetail/DrillDetailModal.tsx\");reactHotLoader.register(DrillDetailModal, \"DrillDetailModal\", \"/app/superset-frontend/src/components/Chart/DrillDetail/DrillDetailModal.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useContext","useMemo","useHistory","css","t","useTheme","Modal","Button","useSelector","DashboardPageIdContext","findPermission","DrillDetailPane","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ModalFooter","canExplore","closeModal","exploreChart","theme","children","buttonStyle","buttonSize","onClick","disabled","tooltip","undefined","gridUnit","__signature__","DrillDetailModal","chartId","formData","initialFilters","showModal","onHideModal","history","dashboardPageId","slice_name","chartName","state","sliceEntities","slices","_state$user","user","roles","exploreUrl","push","show","onHide","title","footer","responsive","resizable","resizableConfig","minHeight","minWidth","defaultSize","width","height","draggable","destroyOnClose","maskClosable","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/app/superset-frontend/src/components/Chart/DrillDetail/DrillDetailModal.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { useCallback, useContext, useMemo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { Slice } from 'src/types/Chart';\nimport { RootState } from 'src/dashboard/types';\nimport { findPermission } from 'src/utils/findPermission';\nimport DrillDetailPane from './DrillDetailPane';\n\ninterface ModalFooterProps {\n  canExplore: boolean;\n  closeModal?: () => void;\n  exploreChart: () => void;\n}\n\nconst ModalFooter = ({\n  canExplore,\n  closeModal,\n  exploreChart,\n}: ModalFooterProps) => {\n  const theme = useTheme();\n\n  return (\n    <>\n      <Button\n        buttonStyle=\"secondary\"\n        buttonSize=\"small\"\n        onClick={exploreChart}\n        disabled={!canExplore}\n        tooltip={\n          !canExplore\n            ? t('You do not have sufficient permissions to edit the chart')\n            : undefined\n        }\n      >\n        {t('Edit chart')}\n      </Button>\n      <Button\n        buttonStyle=\"primary\"\n        buttonSize=\"small\"\n        onClick={closeModal}\n        data-test=\"close-drilltodetail-modal\"\n        css={css`\n          margin-left: ${theme.gridUnit * 2}px;\n        `}\n      >\n        {t('Close')}\n      </Button>\n    </>\n  );\n};\n\ninterface DrillDetailModalProps {\n  chartId: number;\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n  showModal: boolean;\n  onHideModal: () => void;\n}\n\nexport default function DrillDetailModal({\n  chartId,\n  formData,\n  initialFilters,\n  showModal,\n  onHideModal,\n}: DrillDetailModalProps) {\n  const theme = useTheme();\n  const history = useHistory();\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const { slice_name: chartName } = useSelector(\n    (state: { sliceEntities: { slices: Record<number, Slice> } }) =>\n      state.sliceEntities.slices[chartId],\n  );\n  const canExplore = useSelector((state: RootState) =>\n    findPermission('can_explore', 'Superset', state.user?.roles),\n  );\n\n  const exploreUrl = useMemo(\n    () => `/explore/?dashboard_page_id=${dashboardPageId}&slice_id=${chartId}`,\n    [chartId, dashboardPageId],\n  );\n\n  const exploreChart = useCallback(() => {\n    history.push(exploreUrl);\n  }, [exploreUrl, history]);\n\n  return (\n    <Modal\n      show={showModal}\n      onHide={onHideModal ?? (() => null)}\n      css={css`\n        .ant-modal-body {\n          display: flex;\n          flex-direction: column;\n        }\n      `}\n      title={t('Drill to detail: %s', chartName)}\n      footer={\n        <ModalFooter exploreChart={exploreChart} canExplore={canExplore} />\n      }\n      responsive\n      resizable\n      resizableConfig={{\n        minHeight: theme.gridUnit * 128,\n        minWidth: theme.gridUnit * 128,\n        defaultSize: {\n          width: 'auto',\n          height: '75vh',\n        },\n      }}\n      draggable\n      destroyOnClose\n      maskClosable={false}\n    >\n      <DrillDetailPane formData={formData} initialFilters={initialFilters} />\n    </Modal>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}