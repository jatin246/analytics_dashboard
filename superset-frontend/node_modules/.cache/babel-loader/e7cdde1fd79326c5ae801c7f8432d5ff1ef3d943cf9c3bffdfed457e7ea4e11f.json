{"ast":null,"code":"import _omit from \"lodash/omit\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { Input } from 'src/components/Input';\nimport { FormItem } from 'src/components/Form';\nimport jsonStringify from 'json-stringify-pretty-compact';\nimport Button from 'src/components/Button';\nimport { AntdForm, AsyncSelect, Col, Row } from 'src/components';\nimport rison from 'rison';\nimport { ensureIsArray, isFeatureEnabled, FeatureFlag, getCategoricalSchemeRegistry, styled, SupersetClient, t, getClientErrorObject } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport { JsonEditor } from 'src/components/AsyncAceEditor';\nimport ColorSchemeControlWrapper from 'src/dashboard/components/ColorSchemeControlWrapper';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { fetchTags, OBJECT_TYPES } from 'src/features/tags/tags';\nimport { loadTags } from 'src/components/Tags/utils';\nimport { applyColors, getColorNamespace } from 'src/utils/colorScheme';import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nconst StyledFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\nconst StyledJsonEditor = styled(JsonEditor)`\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ theme }) => theme.colors.secondary.light2};\n`;var _ref = process.env.NODE_ENV === \"production\" ? { name: \"1blj7km\", styles: \"margin-top:1em\" } : { name: \"1gtq0eh-PropertiesModal\", styles: \"margin-top:1em;label:PropertiesModal;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL1Byb3BlcnRpZXNNb2RhbC9pbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBb2JrQiIsImZpbGUiOiIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9Qcm9wZXJ0aWVzTW9kYWwvaW5kZXgudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBvbWl0IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvSW5wdXQnO1xuaW1wb3J0IHsgRm9ybUl0ZW0gfSBmcm9tICdzcmMvY29tcG9uZW50cy9Gb3JtJztcbmltcG9ydCBqc29uU3RyaW5naWZ5IGZyb20gJ2pzb24tc3RyaW5naWZ5LXByZXR0eS1jb21wYWN0JztcbmltcG9ydCBCdXR0b24gZnJvbSAnc3JjL2NvbXBvbmVudHMvQnV0dG9uJztcbmltcG9ydCB7IEFudGRGb3JtLCBBc3luY1NlbGVjdCwgQ29sLCBSb3cgfSBmcm9tICdzcmMvY29tcG9uZW50cyc7XG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgZW5zdXJlSXNBcnJheSwgaXNGZWF0dXJlRW5hYmxlZCwgRmVhdHVyZUZsYWcsIGdldENhdGVnb3JpY2FsU2NoZW1lUmVnaXN0cnksIHN0eWxlZCwgU3VwZXJzZXRDbGllbnQsIHQsIGdldENsaWVudEVycm9yT2JqZWN0LCB9IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCBNb2RhbCBmcm9tICdzcmMvY29tcG9uZW50cy9Nb2RhbCc7XG5pbXBvcnQgeyBKc29uRWRpdG9yIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvQXN5bmNBY2VFZGl0b3InO1xuaW1wb3J0IENvbG9yU2NoZW1lQ29udHJvbFdyYXBwZXIgZnJvbSAnc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL0NvbG9yU2NoZW1lQ29udHJvbFdyYXBwZXInO1xuaW1wb3J0IEZpbHRlclNjb3BlTW9kYWwgZnJvbSAnc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL2ZpbHRlcnNjb3BlL0ZpbHRlclNjb3BlTW9kYWwnO1xuaW1wb3J0IHdpdGhUb2FzdHMgZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVzc2FnZVRvYXN0cy93aXRoVG9hc3RzJztcbmltcG9ydCB7IGZldGNoVGFncywgT0JKRUNUX1RZUEVTIH0gZnJvbSAnc3JjL2ZlYXR1cmVzL3RhZ3MvdGFncyc7XG5pbXBvcnQgeyBsb2FkVGFncyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL1RhZ3MvdXRpbHMnO1xuaW1wb3J0IHsgYXBwbHlDb2xvcnMsIGdldENvbG9yTmFtZXNwYWNlIH0gZnJvbSAnc3JjL3V0aWxzL2NvbG9yU2NoZW1lJztcbmNvbnN0IFN0eWxlZEZvcm1JdGVtID0gc3R5bGVkKEZvcm1JdGVtKSBgXG4gIG1hcmdpbi1ib3R0b206IDA7XG5gO1xuY29uc3QgU3R5bGVkSnNvbkVkaXRvciA9IHN0eWxlZChKc29uRWRpdG9yKSBgXG4gIGJvcmRlci1yYWRpdXM6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuYm9yZGVyUmFkaXVzfXB4O1xuICBib3JkZXI6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5zZWNvbmRhcnkubGlnaHQyfTtcbmA7XG5jb25zdCBQcm9wZXJ0aWVzTW9kYWwgPSAoeyBhZGRTdWNjZXNzVG9hc3QsIGFkZERhbmdlclRvYXN0LCBjb2xvclNjaGVtZTogY3VycmVudENvbG9yU2NoZW1lLCBkYXNoYm9hcmRJZCwgZGFzaGJvYXJkSW5mbzogY3VycmVudERhc2hib2FyZEluZm8sIGRhc2hib2FyZFRpdGxlLCBvbkhpZGUgPSAoKSA9PiB7IH0sIG9ubHlBcHBseSA9IGZhbHNlLCBvblN1Ym1pdCA9ICgpID0+IHsgfSwgc2hvdyA9IGZhbHNlLCB9KSA9PiB7XG4gICAgY29uc3QgW2Zvcm1dID0gQW50ZEZvcm0udXNlRm9ybSgpO1xuICAgIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW2lzQWR2YW5jZWRPcGVuLCBzZXRJc0FkdmFuY2VkT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW2NvbG9yU2NoZW1lLCBzZXRDb2xvclNjaGVtZV0gPSB1c2VTdGF0ZShjdXJyZW50Q29sb3JTY2hlbWUpO1xuICAgIGNvbnN0IFtqc29uTWV0YWRhdGEsIHNldEpzb25NZXRhZGF0YV0gPSB1c2VTdGF0ZSgnJyk7XG4gICAgY29uc3QgW2Rhc2hib2FyZEluZm8sIHNldERhc2hib2FyZEluZm9dID0gdXNlU3RhdGUoKTtcbiAgICBjb25zdCBbb3duZXJzLCBzZXRPd25lcnNdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IFtyb2xlcywgc2V0Um9sZXNdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IHNhdmVMYWJlbCA9IG9ubHlBcHBseSA/IHQoJ0FwcGx5JykgOiB0KCdTYXZlJyk7XG4gICAgY29uc3QgW3RhZ3MsIHNldFRhZ3NdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IGNhdGVnb3JpY2FsU2NoZW1lUmVnaXN0cnkgPSBnZXRDYXRlZ29yaWNhbFNjaGVtZVJlZ2lzdHJ5KCk7XG4gICAgY29uc3QgdGFnc0FzU2VsZWN0VmFsdWVzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdFRhZ3MgPSB0YWdzLm1hcCgodGFnKSA9PiAoe1xuICAgICAgICAgICAgdmFsdWU6IHRhZy5pZCxcbiAgICAgICAgICAgIGxhYmVsOiB0YWcubmFtZSxcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gc2VsZWN0VGFncztcbiAgICB9LCBbdGFncy5sZW5ndGhdKTtcbiAgICBjb25zdCBoYW5kbGVFcnJvclJlc3BvbnNlID0gYXN5bmMgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZXJyb3IsIHN0YXR1c1RleHQsIG1lc3NhZ2UgfSA9IGF3YWl0IGdldENsaWVudEVycm9yT2JqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgbGV0IGVycm9yVGV4dCA9IGVycm9yIHx8IHN0YXR1c1RleHQgfHwgdCgnQW4gZXJyb3IgaGFzIG9jY3VycmVkJyk7XG4gICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ29iamVjdCcgJiYgJ2pzb25fbWV0YWRhdGEnIGluIG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGVycm9yVGV4dCA9IG1lc3NhZ2UuanNvbl9tZXRhZGF0YTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGVycm9yVGV4dCA9IG1lc3NhZ2U7XG4gICAgICAgICAgICBpZiAobWVzc2FnZSA9PT0gJ0ZvcmJpZGRlbicpIHtcbiAgICAgICAgICAgICAgICBlcnJvclRleHQgPSB0KCdZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBlZGl0IHRoaXMgZGFzaGJvYXJkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgTW9kYWwuZXJyb3Ioe1xuICAgICAgICAgICAgdGl0bGU6IHQoJ0Vycm9yJyksXG4gICAgICAgICAgICBjb250ZW50OiBlcnJvclRleHQsXG4gICAgICAgICAgICBva0J1dHRvblByb3BzOiB7IGRhbmdlcjogdHJ1ZSwgY2xhc3NOYW1lOiAnYnRuLWRhbmdlcicgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBsb2FkQWNjZXNzT3B0aW9ucyA9IHVzZUNhbGxiYWNrKChhY2Nlc3NUeXBlID0gJ293bmVycycsIGlucHV0ID0gJycsIHBhZ2UsIHBhZ2VTaXplKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gcmlzb24uZW5jb2RlKHtcbiAgICAgICAgICAgIGZpbHRlcjogaW5wdXQsXG4gICAgICAgICAgICBwYWdlLFxuICAgICAgICAgICAgcGFnZV9zaXplOiBwYWdlU2l6ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL2Rhc2hib2FyZC9yZWxhdGVkLyR7YWNjZXNzVHlwZX0/cT0ke3F1ZXJ5fWAsXG4gICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gKHtcbiAgICAgICAgICAgIGRhdGE6IHJlc3BvbnNlLmpzb24ucmVzdWx0XG4gICAgICAgICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5leHRyYS5hY3RpdmUgIT09IHVuZGVmaW5lZCA/IGl0ZW0uZXh0cmEuYWN0aXZlIDogdHJ1ZSlcbiAgICAgICAgICAgICAgICAubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50LFxuICAgICAgICB9KSk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGhhbmRsZURhc2hib2FyZERhdGEgPSB1c2VDYWxsYmFjayhkYXNoYm9hcmREYXRhID0+IHtcbiAgICAgICAgY29uc3QgeyBpZCwgZGFzaGJvYXJkX3RpdGxlLCBzbHVnLCBjZXJ0aWZpZWRfYnksIGNlcnRpZmljYXRpb25fZGV0YWlscywgb3duZXJzLCByb2xlcywgbWV0YWRhdGEsIGlzX21hbmFnZWRfZXh0ZXJuYWxseSwgfSA9IGRhc2hib2FyZERhdGE7XG4gICAgICAgIGNvbnN0IGRhc2hib2FyZEluZm8gPSB7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIHRpdGxlOiBkYXNoYm9hcmRfdGl0bGUsXG4gICAgICAgICAgICBzbHVnOiBzbHVnIHx8ICcnLFxuICAgICAgICAgICAgY2VydGlmaWVkQnk6IGNlcnRpZmllZF9ieSB8fCAnJyxcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb25EZXRhaWxzOiBjZXJ0aWZpY2F0aW9uX2RldGFpbHMgfHwgJycsXG4gICAgICAgICAgICBpc01hbmFnZWRFeHRlcm5hbGx5OiBpc19tYW5hZ2VkX2V4dGVybmFsbHkgfHwgZmFsc2UsXG4gICAgICAgIH07XG4gICAgICAgIGZvcm0uc2V0RmllbGRzVmFsdWUoZGFzaGJvYXJkSW5mbyk7XG4gICAgICAgIHNldERhc2hib2FyZEluZm8oZGFzaGJvYXJkSW5mbyk7XG4gICAgICAgIHNldE93bmVycyhvd25lcnMpO1xuICAgICAgICBzZXRSb2xlcyhyb2xlcyk7XG4gICAgICAgIHNldENvbG9yU2NoZW1lKG1ldGFkYXRhLmNvbG9yX3NjaGVtZSk7XG4gICAgICAgIGNvbnN0IG1ldGFEYXRhQ29weSA9IG9taXQobWV0YWRhdGEsIFtcbiAgICAgICAgICAgICdwb3NpdGlvbnMnLFxuICAgICAgICAgICAgJ3NoYXJlZF9sYWJlbF9jb2xvcnMnLFxuICAgICAgICAgICAgJ2NvbG9yX3NjaGVtZV9kb21haW4nLFxuICAgICAgICBdKTtcbiAgICAgICAgc2V0SnNvbk1ldGFkYXRhKG1ldGFEYXRhQ29weSA/IGpzb25TdHJpbmdpZnkobWV0YURhdGFDb3B5KSA6ICcnKTtcbiAgICB9LCBbZm9ybV0pO1xuICAgIGNvbnN0IGZldGNoRGFzaGJvYXJkRGV0YWlscyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgICAvLyBXZSBmZXRjaCB0aGUgZGFzaGJvYXJkIGRldGFpbHMgYmVjYXVzZSBub3QgYWxsIGNvZGVcbiAgICAgICAgLy8gdGhhdCByZW5kZXJzIHRoaXMgY29tcG9uZW50IGhhdmUgYWxsIHRoZSB2YWx1ZXMgd2UgbmVlZC5cbiAgICAgICAgLy8gQXQgc29tZSBwb2ludCB3aGVuIHdlIGhhdmUgYSBtb3JlIGNvbnNpc3RlbnQgZnJvbnRlbmRcbiAgICAgICAgLy8gZGF0YW1vZGVsLCB0aGUgZGFzaGJvYXJkIGNvdWxkIHByb2JhYmx5IGp1c3QgYmUgcGFzc2VkIGFzIGEgcHJvcC5cbiAgICAgICAgU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXNoYm9hcmQvJHtkYXNoYm9hcmRJZH1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhc2hib2FyZCA9IHJlc3BvbnNlLmpzb24ucmVzdWx0O1xuICAgICAgICAgICAgY29uc3QganNvbk1ldGFkYXRhT2JqID0gZGFzaGJvYXJkLmpzb25fbWV0YWRhdGE/Lmxlbmd0aFxuICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShkYXNoYm9hcmQuanNvbl9tZXRhZGF0YSlcbiAgICAgICAgICAgICAgICA6IHt9O1xuICAgICAgICAgICAgaGFuZGxlRGFzaGJvYXJkRGF0YSh7XG4gICAgICAgICAgICAgICAgLi4uZGFzaGJvYXJkLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBqc29uTWV0YWRhdGFPYmosXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH0sIGhhbmRsZUVycm9yUmVzcG9uc2UpO1xuICAgIH0sIFtkYXNoYm9hcmRJZCwgaGFuZGxlRGFzaGJvYXJkRGF0YV0pO1xuICAgIGNvbnN0IGdldEpzb25NZXRhZGF0YSA9ICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGpzb25NZXRhZGF0YT8ubGVuZ3RoXG4gICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKGpzb25NZXRhZGF0YSlcbiAgICAgICAgICAgICAgICA6IHt9O1xuICAgICAgICAgICAgcmV0dXJuIGpzb25NZXRhZGF0YU9iajtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoXykge1xuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPbkNoYW5nZU93bmVycyA9IChvd25lcnMpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkT3duZXJzID0gZW5zdXJlSXNBcnJheShvd25lcnMpLm1hcChvID0+ICh7XG4gICAgICAgICAgICBpZDogby52YWx1ZSxcbiAgICAgICAgICAgIGZ1bGxfbmFtZTogby5sYWJlbCxcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRPd25lcnMocGFyc2VkT3duZXJzKTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZU9uQ2hhbmdlUm9sZXMgPSAocm9sZXMpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkUm9sZXMgPSBlbnN1cmVJc0FycmF5KHJvbGVzKS5tYXAociA9PiAoe1xuICAgICAgICAgICAgaWQ6IHIudmFsdWUsXG4gICAgICAgICAgICBuYW1lOiByLmxhYmVsLFxuICAgICAgICB9KSk7XG4gICAgICAgIHNldFJvbGVzKHBhcnNlZFJvbGVzKTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZU93bmVyc1NlbGVjdFZhbHVlID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXJzZWRPd25lcnMgPSAob3duZXJzIHx8IFtdKS5tYXAoKG93bmVyKSA9PiAoe1xuICAgICAgICAgICAgdmFsdWU6IG93bmVyLmlkLFxuICAgICAgICAgICAgbGFiZWw6IG93bmVyLmZ1bGxfbmFtZSB8fCBgJHtvd25lci5maXJzdF9uYW1lfSAke293bmVyLmxhc3RfbmFtZX1gLFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBwYXJzZWRPd25lcnM7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVSb2xlc1NlbGVjdFZhbHVlID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXJzZWRSb2xlcyA9IChyb2xlcyB8fCBbXSkubWFwKChyb2xlKSA9PiAoe1xuICAgICAgICAgICAgdmFsdWU6IHJvbGUuaWQsXG4gICAgICAgICAgICBsYWJlbDogYCR7cm9sZS5uYW1lfWAsXG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIHBhcnNlZFJvbGVzO1xuICAgIH07XG4gICAgY29uc3Qgb25Db2xvclNjaGVtZUNoYW5nZSA9IChjb2xvclNjaGVtZSA9ICcnLCB7IHVwZGF0ZU1ldGFkYXRhID0gdHJ1ZSB9ID0ge30pID0+IHtcbiAgICAgICAgLy8gY2hlY2sgdGhhdCBjb2xvcl9zY2hlbWUgaXMgdmFsaWRcbiAgICAgICAgY29uc3QgY29sb3JDaG9pY2VzID0gY2F0ZWdvcmljYWxTY2hlbWVSZWdpc3RyeS5rZXlzKCk7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICAvLyBvbmx5IGZpcmUgaWYgdGhlIGNvbG9yX3NjaGVtZSBpcyBwcmVzZW50IGFuZCBpbnZhbGlkXG4gICAgICAgIGlmIChjb2xvclNjaGVtZSAmJiAhY29sb3JDaG9pY2VzLmluY2x1ZGVzKGNvbG9yU2NoZW1lKSkge1xuICAgICAgICAgICAgTW9kYWwuZXJyb3Ioe1xuICAgICAgICAgICAgICAgIHRpdGxlOiB0KCdFcnJvcicpLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHQoJ0EgdmFsaWQgY29sb3Igc2NoZW1lIGlzIHJlcXVpcmVkJyksXG4gICAgICAgICAgICAgICAgb2tCdXR0b25Qcm9wczogeyBkYW5nZXI6IHRydWUsIGNsYXNzTmFtZTogJ2J0bi1kYW5nZXInIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQSB2YWxpZCBjb2xvciBzY2hlbWUgaXMgcmVxdWlyZWQnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB1cGRhdGUgbWV0YWRhdGEgdG8gbWF0Y2ggc2VsZWN0aW9uXG4gICAgICAgIGlmICh1cGRhdGVNZXRhZGF0YSkge1xuICAgICAgICAgICAganNvbk1ldGFkYXRhT2JqLmNvbG9yX3NjaGVtZSA9IGNvbG9yU2NoZW1lO1xuICAgICAgICAgICAganNvbk1ldGFkYXRhT2JqLmxhYmVsX2NvbG9ycyA9IGpzb25NZXRhZGF0YU9iai5sYWJlbF9jb2xvcnMgfHwge307XG4gICAgICAgICAgICBzZXRKc29uTWV0YWRhdGEoanNvblN0cmluZ2lmeShqc29uTWV0YWRhdGFPYmopKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRDb2xvclNjaGVtZShjb2xvclNjaGVtZSk7XG4gICAgfTtcbiAgICBjb25zdCBvbkZpbmlzaCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgeyB0aXRsZSwgc2x1ZywgY2VydGlmaWVkQnksIGNlcnRpZmljYXRpb25EZXRhaWxzIH0gPSBmb3JtLmdldEZpZWxkc1ZhbHVlKCk7XG4gICAgICAgIGxldCBjdXJyZW50Q29sb3JTY2hlbWUgPSBjb2xvclNjaGVtZTtcbiAgICAgICAgbGV0IGN1cnJlbnRKc29uTWV0YWRhdGEgPSBqc29uTWV0YWRhdGE7XG4gICAgICAgIC8vIHZhbGlkYXRlIGN1cnJlbnRKc29uTWV0YWRhdGFcbiAgICAgICAgbGV0IG1ldGFkYXRhO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFjdXJyZW50SnNvbk1ldGFkYXRhLnN0YXJ0c1dpdGgoJ3snKSB8fFxuICAgICAgICAgICAgICAgICFjdXJyZW50SnNvbk1ldGFkYXRhLmVuZHNXaXRoKCd9JykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1ldGFkYXRhID0gSlNPTi5wYXJzZShjdXJyZW50SnNvbk1ldGFkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGFkZERhbmdlclRvYXN0KHQoJ0pTT04gbWV0YWRhdGEgaXMgaW52YWxpZCEnKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29weU1ldGFkYXRhID0geyAuLi5tZXRhZGF0YSB9O1xuICAgICAgICBjb25zdCBjb2xvck5hbWVzcGFjZSA9IGdldENvbG9yTmFtZXNwYWNlKG1ldGFkYXRhPy5jb2xvcl9uYW1lc3BhY2UpO1xuICAgICAgICAvLyBjb2xvciBzY2hlbWUgaW4ganNvbiBtZXRhZGF0YSBoYXMgcHJlY2VkZW5jZSBvdmVyIHNlbGVjdGlvblxuICAgICAgICBjdXJyZW50Q29sb3JTY2hlbWUgPSBtZXRhZGF0YT8uY29sb3Jfc2NoZW1lIHx8IGNvbG9yU2NoZW1lO1xuICAgICAgICAvLyByZW1vdmUgaW5mb3JtYXRpb24gZnJvbSB1c2VyIGZhY2luZyBpbnB1dFxuICAgICAgICBpZiAobWV0YWRhdGE/LnNoYXJlZF9sYWJlbF9jb2xvcnMpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBtZXRhZGF0YS5zaGFyZWRfbGFiZWxfY29sb3JzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtZXRhZGF0YT8uY29sb3Jfc2NoZW1lX2RvbWFpbikge1xuICAgICAgICAgICAgZGVsZXRlIG1ldGFkYXRhLmNvbG9yX3NjaGVtZV9kb21haW47XG4gICAgICAgIH1cbiAgICAgICAgLy8gb25seSBhcHBseSBjb2xvcnMsIHRoZSB1c2VyIGhhcyBub3Qgc2F2ZWQgeWV0XG4gICAgICAgIGFwcGx5Q29sb3JzKGNvcHlNZXRhZGF0YSwgdHJ1ZSk7XG4gICAgICAgIGN1cnJlbnRKc29uTWV0YWRhdGEgPSBqc29uU3RyaW5naWZ5KG1ldGFkYXRhKTtcbiAgICAgICAgb25Db2xvclNjaGVtZUNoYW5nZShjdXJyZW50Q29sb3JTY2hlbWUsIHtcbiAgICAgICAgICAgIHVwZGF0ZU1ldGFkYXRhOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG1vcmVPblN1Ym1pdFByb3BzID0ge307XG4gICAgICAgIGNvbnN0IG1vcmVQdXRQcm9wcyA9IHt9O1xuICAgICAgICBpZiAoaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5EYXNoYm9hcmRSYmFjKSkge1xuICAgICAgICAgICAgbW9yZU9uU3VibWl0UHJvcHMucm9sZXMgPSByb2xlcztcbiAgICAgICAgICAgIG1vcmVQdXRQcm9wcy5yb2xlcyA9IChyb2xlcyB8fCBbXSkubWFwKHIgPT4gci5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkpIHtcbiAgICAgICAgICAgIG1vcmVQdXRQcm9wcy50YWdzID0gdGFncy5tYXAodGFnID0+IHRhZy5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb25TdWJtaXRQcm9wcyA9IHtcbiAgICAgICAgICAgIGlkOiBkYXNoYm9hcmRJZCxcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgc2x1ZyxcbiAgICAgICAgICAgIGpzb25NZXRhZGF0YTogY3VycmVudEpzb25NZXRhZGF0YSxcbiAgICAgICAgICAgIG93bmVycyxcbiAgICAgICAgICAgIGNvbG9yU2NoZW1lOiBjdXJyZW50Q29sb3JTY2hlbWUsXG4gICAgICAgICAgICBjb2xvck5hbWVzcGFjZSxcbiAgICAgICAgICAgIGNlcnRpZmllZEJ5LFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbkRldGFpbHMsXG4gICAgICAgICAgICAuLi5tb3JlT25TdWJtaXRQcm9wcyxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9ubHlBcHBseSkge1xuICAgICAgICAgICAgb25TdWJtaXQob25TdWJtaXRQcm9wcyk7XG4gICAgICAgICAgICBvbkhpZGUoKTtcbiAgICAgICAgICAgIGFkZFN1Y2Nlc3NUb2FzdCh0KCdEYXNoYm9hcmQgcHJvcGVydGllcyB1cGRhdGVkJykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgU3VwZXJzZXRDbGllbnQucHV0KHtcbiAgICAgICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGFzaGJvYXJkLyR7ZGFzaGJvYXJkSWR9YCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGRhc2hib2FyZF90aXRsZTogdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHNsdWc6IHNsdWcgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAganNvbl9tZXRhZGF0YTogY3VycmVudEpzb25NZXRhZGF0YSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBvd25lcnM6IChvd25lcnMgfHwgW10pLm1hcChvID0+IG8uaWQpLFxuICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5IHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWVkQnkgJiYgY2VydGlmaWNhdGlvbkRldGFpbHMgPyBjZXJ0aWZpY2F0aW9uRGV0YWlscyA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIC4uLm1vcmVQdXRQcm9wcyxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9uU3VibWl0KG9uU3VibWl0UHJvcHMpO1xuICAgICAgICAgICAgICAgIG9uSGlkZSgpO1xuICAgICAgICAgICAgICAgIGFkZFN1Y2Nlc3NUb2FzdCh0KCdUaGUgZGFzaGJvYXJkIGhhcyBiZWVuIHNhdmVkJykpO1xuICAgICAgICAgICAgfSwgaGFuZGxlRXJyb3JSZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGdldFJvd3NXaXRob3V0Um9sZXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICBjb25zdCBoYXNDdXN0b21MYWJlbHNDb2xvciA9ICEhT2JqZWN0LmtleXMoanNvbk1ldGFkYXRhT2JqPy5sYWJlbF9jb2xvcnMgfHwge30pLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuICg8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnQWNjZXNzJyl9PC9oMz5cbiAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ093bmVycycpfT5cbiAgICAgICAgICAgIDxBc3luY1NlbGVjdCBhbGxvd0NsZWFyIGFyaWFMYWJlbD17dCgnT3duZXJzJyl9IGRpc2FibGVkPXtpc0xvYWRpbmd9IG1vZGU9XCJtdWx0aXBsZVwiIG9uQ2hhbmdlPXtoYW5kbGVPbkNoYW5nZU93bmVyc30gb3B0aW9ucz17KGlucHV0LCBwYWdlLCBwYWdlU2l6ZSkgPT4gbG9hZEFjY2Vzc09wdGlvbnMoJ293bmVycycsIGlucHV0LCBwYWdlLCBwYWdlU2l6ZSl9IHZhbHVlPXtoYW5kbGVPd25lcnNTZWxlY3RWYWx1ZSgpfS8+XG4gICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICB7dCgnT3duZXJzIGlzIGEgbGlzdCBvZiB1c2VycyB3aG8gY2FuIGFsdGVyIHRoZSBkYXNoYm9hcmQuIFNlYXJjaGFibGUgYnkgbmFtZSBvciB1c2VybmFtZS4nKX1cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvQ29sPlxuICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnQ29sb3JzJyl9PC9oMz5cbiAgICAgICAgICA8Q29sb3JTY2hlbWVDb250cm9sV3JhcHBlciBoYXNDdXN0b21MYWJlbHNDb2xvcj17aGFzQ3VzdG9tTGFiZWxzQ29sb3J9IG9uQ2hhbmdlPXtvbkNvbG9yU2NoZW1lQ2hhbmdlfSBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9IGxhYmVsTWFyZ2luPXs0fS8+XG4gICAgICAgIDwvQ29sPlxuICAgICAgPC9Sb3c+KTtcbiAgICB9O1xuICAgIGNvbnN0IGdldFJvd3NXaXRoUm9sZXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICBjb25zdCBoYXNDdXN0b21MYWJlbHNDb2xvciA9ICEhT2JqZWN0LmtleXMoanNvbk1ldGFkYXRhT2JqPy5sYWJlbF9jb2xvcnMgfHwge30pLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuICg8PlxuICAgICAgICA8Um93PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MjR9PlxuICAgICAgICAgICAgPGgzIHN0eWxlPXt7IG1hcmdpblRvcDogJzFlbScgfX0+e3QoJ0FjY2VzcycpfTwvaDM+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtIGxhYmVsPXt0KCdPd25lcnMnKX0+XG4gICAgICAgICAgICAgIDxBc3luY1NlbGVjdCBhbGxvd0NsZWFyIGFsbG93TmV3T3B0aW9ucyBhcmlhTGFiZWw9e3QoJ093bmVycycpfSBkaXNhYmxlZD17aXNMb2FkaW5nfSBtb2RlPVwibXVsdGlwbGVcIiBvbkNoYW5nZT17aGFuZGxlT25DaGFuZ2VPd25lcnN9IG9wdGlvbnM9eyhpbnB1dCwgcGFnZSwgcGFnZVNpemUpID0+IGxvYWRBY2Nlc3NPcHRpb25zKCdvd25lcnMnLCBpbnB1dCwgcGFnZSwgcGFnZVNpemUpfSB2YWx1ZT17aGFuZGxlT3duZXJzU2VsZWN0VmFsdWUoKX0vPlxuICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAge3QoJ093bmVycyBpcyBhIGxpc3Qgb2YgdXNlcnMgd2hvIGNhbiBhbHRlciB0aGUgZGFzaGJvYXJkLiBTZWFyY2hhYmxlIGJ5IG5hbWUgb3IgdXNlcm5hbWUuJyl9XG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ1JvbGVzJyl9PlxuICAgICAgICAgICAgICA8QXN5bmNTZWxlY3QgYWxsb3dDbGVhciBhcmlhTGFiZWw9e3QoJ1JvbGVzJyl9IGRpc2FibGVkPXtpc0xvYWRpbmd9IG1vZGU9XCJtdWx0aXBsZVwiIG9uQ2hhbmdlPXtoYW5kbGVPbkNoYW5nZVJvbGVzfSBvcHRpb25zPXsoaW5wdXQsIHBhZ2UsIHBhZ2VTaXplKSA9PiBsb2FkQWNjZXNzT3B0aW9ucygncm9sZXMnLCBpbnB1dCwgcGFnZSwgcGFnZVNpemUpfSB2YWx1ZT17aGFuZGxlUm9sZXNTZWxlY3RWYWx1ZSgpfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnUm9sZXMgaXMgYSBsaXN0IHdoaWNoIGRlZmluZXMgYWNjZXNzIHRvIHRoZSBkYXNoYm9hcmQuIEdyYW50aW5nIGEgcm9sZSBhY2Nlc3MgdG8gYSBkYXNoYm9hcmQgd2lsbCBieXBhc3MgZGF0YXNldCBsZXZlbCBjaGVja3MuIElmIG5vIHJvbGVzIGFyZSBkZWZpbmVkLCByZWd1bGFyIGFjY2VzcyBwZXJtaXNzaW9ucyBhcHBseS4nKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8Q29sb3JTY2hlbWVDb250cm9sV3JhcHBlciBoYXNDdXN0b21MYWJlbHNDb2xvcj17aGFzQ3VzdG9tTGFiZWxzQ29sb3J9IG9uQ2hhbmdlPXtvbkNvbG9yU2NoZW1lQ2hhbmdlfSBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9IGxhYmVsTWFyZ2luPXs0fS8+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgPC8+KTtcbiAgICB9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChzaG93KSB7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnREYXNoYm9hcmRJbmZvKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2hEYXNoYm9hcmREZXRhaWxzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVEYXNoYm9hcmREYXRhKGN1cnJlbnREYXNoYm9hcmRJbmZvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBKc29uRWRpdG9yLnByZWxvYWQoKTtcbiAgICB9LCBbY3VycmVudERhc2hib2FyZEluZm8sIGZldGNoRGFzaGJvYXJkRGV0YWlscywgaGFuZGxlRGFzaGJvYXJkRGF0YSwgc2hvd10pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIHRoZSB0aXRsZSBjYW4gYmUgY2hhbmdlZCBpbmxpbmUgaW4gdGhlIGRhc2hib2FyZCwgdGhpcyBjYXRjaGVzIGl0XG4gICAgICAgIGlmIChkYXNoYm9hcmRUaXRsZSAmJlxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mbyAmJlxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mby50aXRsZSAhPT0gZGFzaGJvYXJkVGl0bGUpIHtcbiAgICAgICAgICAgIGZvcm0uc2V0RmllbGRzVmFsdWUoe1xuICAgICAgICAgICAgICAgIC4uLmRhc2hib2FyZEluZm8sXG4gICAgICAgICAgICAgICAgdGl0bGU6IGRhc2hib2FyZFRpdGxlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCBbZGFzaGJvYXJkSW5mbywgZGFzaGJvYXJkVGl0bGUsIGZvcm1dKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIWlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmZXRjaFRhZ3Moe1xuICAgICAgICAgICAgICAgIG9iamVjdFR5cGU6IE9CSkVDVF9UWVBFUy5EQVNIQk9BUkQsXG4gICAgICAgICAgICAgICAgb2JqZWN0SWQ6IGRhc2hib2FyZElkLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVUeXBlczogZmFsc2UsXG4gICAgICAgICAgICB9LCAodGFncykgPT4gc2V0VGFncyh0YWdzKSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgYWRkRGFuZ2VyVG9hc3QoYEVycm9yIGZldGNoaW5nIHRhZ3M6ICR7ZXJyb3IudGV4dH1gKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaGFuZGxlRXJyb3JSZXNwb25zZShlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LCBbZGFzaGJvYXJkSWRdKTtcbiAgICBjb25zdCBoYW5kbGVDaGFuZ2VUYWdzID0gKHRhZ3MpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkVGFncyA9IGVuc3VyZUlzQXJyYXkodGFncykubWFwKHIgPT4gKHtcbiAgICAgICAgICAgIGlkOiByLnZhbHVlLFxuICAgICAgICAgICAgbmFtZTogci5sYWJlbCxcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRUYWdzKHBhcnNlZFRhZ3MpO1xuICAgIH07XG4gICAgcmV0dXJuICg8TW9kYWwgc2hvdz17c2hvd30gb25IaWRlPXtvbkhpZGV9IHRpdGxlPXt0KCdEYXNoYm9hcmQgcHJvcGVydGllcycpfSBmb290ZXI9ezw+XG4gICAgICAgICAgPEJ1dHRvbiBodG1sVHlwZT1cImJ1dHRvblwiIGJ1dHRvblNpemU9XCJzbWFsbFwiIG9uQ2xpY2s9e29uSGlkZX0gZGF0YS10ZXN0PVwicHJvcGVydGllcy1tb2RhbC1jYW5jZWwtYnV0dG9uXCIgY3RhPlxuICAgICAgICAgICAge3QoJ0NhbmNlbCcpfVxuICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDxCdXR0b24gZGF0YS10ZXN0PVwicHJvcGVydGllcy1tb2RhbC1hcHBseS1idXR0b25cIiBvbkNsaWNrPXtmb3JtLnN1Ym1pdH0gYnV0dG9uU2l6ZT1cInNtYWxsXCIgYnV0dG9uU3R5bGU9XCJwcmltYXJ5XCIgY2xhc3NOYW1lPVwibS1yLTVcIiBjdGEgZGlzYWJsZWQ9e2Rhc2hib2FyZEluZm8/LmlzTWFuYWdlZEV4dGVybmFsbHl9IHRvb2x0aXA9e2Rhc2hib2FyZEluZm8/LmlzTWFuYWdlZEV4dGVybmFsbHlcbiAgICAgICAgICAgICAgICA/IHQoXCJUaGlzIGRhc2hib2FyZCBpcyBtYW5hZ2VkIGV4dGVybmFsbHksIGFuZCBjYW4ndCBiZSBlZGl0ZWQgaW4gU3VwZXJzZXRcIilcbiAgICAgICAgICAgICAgICA6ICcnfT5cbiAgICAgICAgICAgIHtzYXZlTGFiZWx9XG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDwvPn0gcmVzcG9uc2l2ZT5cbiAgICAgIDxBbnRkRm9ybSBmb3JtPXtmb3JtfSBvbkZpbmlzaD17b25GaW5pc2h9IGRhdGEtdGVzdD1cImRhc2hib2FyZC1lZGl0LXByb3BlcnRpZXMtZm9ybVwiIGxheW91dD1cInZlcnRpY2FsXCIgaW5pdGlhbFZhbHVlcz17ZGFzaGJvYXJkSW5mb30+XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsyNH0+XG4gICAgICAgICAgICA8aDM+e3QoJ0Jhc2ljIGluZm9ybWF0aW9uJyl9PC9oMz5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8Rm9ybUl0ZW0gbGFiZWw9e3QoJ05hbWUnKX0gbmFtZT1cInRpdGxlXCI+XG4gICAgICAgICAgICAgIDxJbnB1dCBkYXRhLXRlc3Q9XCJkYXNoYm9hcmQtdGl0bGUtaW5wdXRcIiB0eXBlPVwidGV4dFwiIGRpc2FibGVkPXtpc0xvYWRpbmd9Lz5cbiAgICAgICAgICAgIDwvRm9ybUl0ZW0+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ1VSTCBzbHVnJyl9IG5hbWU9XCJzbHVnXCI+XG4gICAgICAgICAgICAgIDxJbnB1dCB0eXBlPVwidGV4dFwiIGRpc2FibGVkPXtpc0xvYWRpbmd9Lz5cbiAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgIHt0KCdBIHJlYWRhYmxlIFVSTCBmb3IgeW91ciBkYXNoYm9hcmQnKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkRhc2hib2FyZFJiYWMpXG4gICAgICAgICAgICA/IGdldFJvd3NXaXRoUm9sZXMoKVxuICAgICAgICAgICAgOiBnZXRSb3dzV2l0aG91dFJvbGVzKCl9XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsyNH0+XG4gICAgICAgICAgICA8aDM+e3QoJ0NlcnRpZmljYXRpb24nKX08L2gzPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgICAgPFJvdyBndXR0ZXI9ezE2fT5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnQ2VydGlmaWVkIGJ5Jyl9IG5hbWU9XCJjZXJ0aWZpZWRCeVwiPlxuICAgICAgICAgICAgICA8SW5wdXQgdHlwZT1cInRleHRcIiBkaXNhYmxlZD17aXNMb2FkaW5nfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnUGVyc29uIG9yIGdyb3VwIHRoYXQgaGFzIGNlcnRpZmllZCB0aGlzIGRhc2hib2FyZC4nKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9IG5hbWU9XCJjZXJ0aWZpY2F0aW9uRGV0YWlsc1wiPlxuICAgICAgICAgICAgICA8SW5wdXQgdHlwZT1cInRleHRcIiBkaXNhYmxlZD17aXNMb2FkaW5nfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnQW55IGFkZGl0aW9uYWwgZGV0YWlsIHRvIHNob3cgaW4gdGhlIGNlcnRpZmljYXRpb24gdG9vbHRpcC4nKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLlRhZ2dpbmdTeXN0ZW0pID8gKDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgPGgzIGNzcz17eyBtYXJnaW5Ub3A6ICcxZW0nIH19Pnt0KCdUYWdzJyl9PC9oMz5cbiAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgIDwvUm93PikgOiBudWxsfVxuICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5UYWdnaW5nU3lzdGVtKSA/ICg8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgICAgICA8QXN5bmNTZWxlY3QgYXJpYUxhYmVsPVwiVGFnc1wiIG1vZGU9XCJtdWx0aXBsZVwiIHZhbHVlPXt0YWdzQXNTZWxlY3RWYWx1ZXN9IG9wdGlvbnM9e2xvYWRUYWdzfSBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlVGFnc30gYWxsb3dDbGVhci8+XG4gICAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICB7dCgnQSBsaXN0IG9mIHRhZ3MgdGhhdCBoYXZlIGJlZW4gYXBwbGllZCB0byB0aGlzIGNoYXJ0LicpfVxuICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICA8L1Jvdz4pIDogbnVsbH1cbiAgICAgICAgPFJvdz5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezI0fT5cbiAgICAgICAgICAgIDxoMyBzdHlsZT17eyBtYXJnaW5Ub3A6ICcxZW0nIH19PlxuICAgICAgICAgICAgICA8QnV0dG9uIGJ1dHRvblN0eWxlPVwibGlua1wiIG9uQ2xpY2s9eygpID0+IHNldElzQWR2YW5jZWRPcGVuKCFpc0FkdmFuY2VkT3Blbil9PlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT17YGZhIGZhLWFuZ2xlLSR7aXNBZHZhbmNlZE9wZW4gPyAnZG93bicgOiAncmlnaHQnfWB9IHN0eWxlPXt7IG1pbldpZHRoOiAnMWVtJyB9fS8+XG4gICAgICAgICAgICAgICAge3QoJ0FkdmFuY2VkJyl9XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgIHtpc0FkdmFuY2VkT3BlbiAmJiAoPD5cbiAgICAgICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ0pTT04gbWV0YWRhdGEnKX0+XG4gICAgICAgICAgICAgICAgICA8U3R5bGVkSnNvbkVkaXRvciBzaG93TG9hZGluZ0ZvckltcG9ydCBuYW1lPVwianNvbl9tZXRhZGF0YVwiIHZhbHVlPXtqc29uTWV0YWRhdGF9IG9uQ2hhbmdlPXtzZXRKc29uTWV0YWRhdGF9IHRhYlNpemU9ezJ9IHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjIwMHB4XCIgd3JhcEVuYWJsZWQvPlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAge3QoJ1RoaXMgSlNPTiBvYmplY3QgaXMgZ2VuZXJhdGVkIGR5bmFtaWNhbGx5IHdoZW4gY2xpY2tpbmcgdGhlIHNhdmUgb3Igb3ZlcndyaXRlIGJ1dHRvbiBpbiB0aGUgZGFzaGJvYXJkIHZpZXcuIEl0IGlzIGV4cG9zZWQgaGVyZSBmb3IgcmVmZXJlbmNlIGFuZCBmb3IgcG93ZXIgdXNlcnMgd2hvIG1heSB3YW50IHRvIGFsdGVyIHNwZWNpZmljIHBhcmFtZXRlcnMuJyl9XG4gICAgICAgICAgICAgICAgICB7b25seUFwcGx5ICYmICg8PlxuICAgICAgICAgICAgICAgICAgICAgIHsnICd9XG4gICAgICAgICAgICAgICAgICAgICAge3QoJ1BsZWFzZSBETyBOT1Qgb3ZlcndyaXRlIHRoZSBcImZpbHRlcl9zY29wZXNcIiBrZXkuJyl9eycgJ31cbiAgICAgICAgICAgICAgICAgICAgICA8RmlsdGVyU2NvcGVNb2RhbCB0cmlnZ2VyTm9kZT17PHNwYW4gY2xhc3NOYW1lPVwiYWxlcnQtbGlua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0KCdVc2UgXCIlKG1lbnVOYW1lKXNcIiBtZW51IGluc3RlYWQuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudU5hbWU6IHQoJ1NldCBmaWx0ZXIgbWFwcGluZycpLFxuICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPn0vPlxuICAgICAgICAgICAgICAgICAgICA8Lz4pfVxuICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgPC8+KX1cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICA8L0FudGRGb3JtPlxuICAgIDwvTW9kYWw+KTtcbn07XG5leHBvcnQgZGVmYXVsdCB3aXRoVG9hc3RzKFByb3BlcnRpZXNNb2RhbCk7XG4iXX0= */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst PropertiesModal = ({ addSuccessToast, addDangerToast, colorScheme: currentColorScheme, dashboardId, dashboardInfo: currentDashboardInfo, dashboardTitle, onHide = () => {}, onlyApply = false, onSubmit = () => {}, show = false }) => {\n  const [form] = AntdForm.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false);\n  const [colorScheme, setColorScheme] = useState(currentColorScheme);\n  const [jsonMetadata, setJsonMetadata] = useState('');\n  const [dashboardInfo, setDashboardInfo] = useState();\n  const [owners, setOwners] = useState([]);\n  const [roles, setRoles] = useState([]);\n  const saveLabel = onlyApply ? t('Apply') : t('Save');\n  const [tags, setTags] = useState([]);\n  const categoricalSchemeRegistry = getCategoricalSchemeRegistry();\n  const tagsAsSelectValues = useMemo(() => {\n    const selectTags = tags.map((tag) => ({\n      value: tag.id,\n      label: tag.name\n    }));\n    return selectTags;\n  }, [tags.length]);\n  const handleErrorResponse = async (response) => {\n    const { error, statusText, message } = await getClientErrorObject(response);\n    let errorText = error || statusText || t('An error has occurred');\n    if (typeof message === 'object' && 'json_metadata' in message) {\n      errorText = message.json_metadata;\n    } else\n    if (typeof message === 'string') {\n      errorText = message;\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n    }\n    Modal.error({\n      title: t('Error'),\n      content: errorText,\n      okButtonProps: { danger: true, className: 'btn-danger' }\n    });\n  };\n  const loadAccessOptions = useCallback((accessType = 'owners', input = '', page, pageSize) => {\n    const query = rison.encode({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dashboard/related/${accessType}?q=${query}`\n    }).then((response) => ({\n      data: response.json.result.\n      filter((item) => item.extra.active !== undefined ? item.extra.active : true).\n      map((item) => ({\n        value: item.value,\n        label: item.text\n      })),\n      totalCount: response.json.count\n    }));\n  }, []);\n  const handleDashboardData = useCallback((dashboardData) => {\n    const { id, dashboard_title, slug, certified_by, certification_details, owners, roles, metadata, is_managed_externally } = dashboardData;\n    const dashboardInfo = {\n      id,\n      title: dashboard_title,\n      slug: slug || '',\n      certifiedBy: certified_by || '',\n      certificationDetails: certification_details || '',\n      isManagedExternally: is_managed_externally || false\n    };\n    form.setFieldsValue(dashboardInfo);\n    setDashboardInfo(dashboardInfo);\n    setOwners(owners);\n    setRoles(roles);\n    setColorScheme(metadata.color_scheme);\n    const metaDataCopy = _omit(metadata, [\n    'positions',\n    'shared_label_colors',\n    'color_scheme_domain']\n    );\n    setJsonMetadata(metaDataCopy ? jsonStringify(metaDataCopy) : '');\n  }, [form]);\n  const fetchDashboardDetails = useCallback(() => {\n    setIsLoading(true);\n    // We fetch the dashboard details because not all code\n    // that renders this component have all the values we need.\n    // At some point when we have a more consistent frontend\n    // datamodel, the dashboard could probably just be passed as a prop.\n    SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${dashboardId}`\n    }).then((response) => {var _dashboard$json_metad;\n      const dashboard = response.json.result;\n      const jsonMetadataObj = (_dashboard$json_metad = dashboard.json_metadata) != null && _dashboard$json_metad.length ?\n      JSON.parse(dashboard.json_metadata) :\n      {};\n      handleDashboardData({\n        ...dashboard,\n        metadata: jsonMetadataObj\n      });\n      setIsLoading(false);\n    }, handleErrorResponse);\n  }, [dashboardId, handleDashboardData]);\n  const getJsonMetadata = () => {\n    try {\n      const jsonMetadataObj = jsonMetadata != null && jsonMetadata.length ?\n      JSON.parse(jsonMetadata) :\n      {};\n      return jsonMetadataObj;\n    }\n    catch (_) {\n      return {};\n    }\n  };\n  const handleOnChangeOwners = (owners) => {\n    const parsedOwners = ensureIsArray(owners).map((o) => ({\n      id: o.value,\n      full_name: o.label\n    }));\n    setOwners(parsedOwners);\n  };\n  const handleOnChangeRoles = (roles) => {\n    const parsedRoles = ensureIsArray(roles).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setRoles(parsedRoles);\n  };\n  const handleOwnersSelectValue = () => {\n    const parsedOwners = (owners || []).map((owner) => ({\n      value: owner.id,\n      label: owner.full_name || `${owner.first_name} ${owner.last_name}`\n    }));\n    return parsedOwners;\n  };\n  const handleRolesSelectValue = () => {\n    const parsedRoles = (roles || []).map((role) => ({\n      value: role.id,\n      label: `${role.name}`\n    }));\n    return parsedRoles;\n  };\n  const onColorSchemeChange = (colorScheme = '', { updateMetadata = true } = {}) => {\n    // check that color_scheme is valid\n    const colorChoices = categoricalSchemeRegistry.keys();\n    const jsonMetadataObj = getJsonMetadata();\n    // only fire if the color_scheme is present and invalid\n    if (colorScheme && !colorChoices.includes(colorScheme)) {\n      Modal.error({\n        title: t('Error'),\n        content: t('A valid color scheme is required'),\n        okButtonProps: { danger: true, className: 'btn-danger' }\n      });\n      throw new Error('A valid color scheme is required');\n    }\n    // update metadata to match selection\n    if (updateMetadata) {\n      jsonMetadataObj.color_scheme = colorScheme;\n      jsonMetadataObj.label_colors = jsonMetadataObj.label_colors || {};\n      setJsonMetadata(jsonStringify(jsonMetadataObj));\n    }\n    setColorScheme(colorScheme);\n  };\n  const onFinish = () => {var _metadata, _metadata2, _metadata3, _metadata4;\n    const { title, slug, certifiedBy, certificationDetails } = form.getFieldsValue();\n    let currentColorScheme = colorScheme;\n    let currentJsonMetadata = jsonMetadata;\n    // validate currentJsonMetadata\n    let metadata;\n    try {\n      if (!currentJsonMetadata.startsWith('{') ||\n      !currentJsonMetadata.endsWith('}')) {\n        throw new Error();\n      }\n      metadata = JSON.parse(currentJsonMetadata);\n    }\n    catch (error) {\n      addDangerToast(t('JSON metadata is invalid!'));\n      return;\n    }\n    const copyMetadata = { ...metadata };\n    const colorNamespace = getColorNamespace((_metadata = metadata) == null ? void 0 : _metadata.color_namespace);\n    // color scheme in json metadata has precedence over selection\n    currentColorScheme = ((_metadata2 = metadata) == null ? void 0 : _metadata2.color_scheme) || colorScheme;\n    // remove information from user facing input\n    if ((_metadata3 = metadata) != null && _metadata3.shared_label_colors) {\n      delete metadata.shared_label_colors;\n    }\n    if ((_metadata4 = metadata) != null && _metadata4.color_scheme_domain) {\n      delete metadata.color_scheme_domain;\n    }\n    // only apply colors, the user has not saved yet\n    applyColors(copyMetadata, true);\n    currentJsonMetadata = jsonStringify(metadata);\n    onColorSchemeChange(currentColorScheme, {\n      updateMetadata: false\n    });\n    const moreOnSubmitProps = {};\n    const morePutProps = {};\n    if (isFeatureEnabled(FeatureFlag.DashboardRbac)) {\n      moreOnSubmitProps.roles = roles;\n      morePutProps.roles = (roles || []).map((r) => r.id);\n    }\n    if (isFeatureEnabled(FeatureFlag.TaggingSystem)) {\n      morePutProps.tags = tags.map((tag) => tag.id);\n    }\n    const onSubmitProps = {\n      id: dashboardId,\n      title,\n      slug,\n      jsonMetadata: currentJsonMetadata,\n      owners,\n      colorScheme: currentColorScheme,\n      colorNamespace,\n      certifiedBy,\n      certificationDetails,\n      ...moreOnSubmitProps\n    };\n    if (onlyApply) {\n      onSubmit(onSubmitProps);\n      onHide();\n      addSuccessToast(t('Dashboard properties updated'));\n    } else\n    {\n      SupersetClient.put({\n        endpoint: `/api/v1/dashboard/${dashboardId}`,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dashboard_title: title,\n          slug: slug || null,\n          json_metadata: currentJsonMetadata || null,\n          owners: (owners || []).map((o) => o.id),\n          certified_by: certifiedBy || null,\n          certification_details: certifiedBy && certificationDetails ? certificationDetails : null,\n          ...morePutProps\n        })\n      }).then(() => {\n        onSubmit(onSubmitProps);\n        onHide();\n        addSuccessToast(t('The dashboard has been saved'));\n      }, handleErrorResponse);\n    }\n  };\n  const getRowsWithoutRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return _jsxs(Row, { gutter: 16, children: [\n      _jsxs(Col, { xs: 24, md: 12, children: [\n        _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Access') }),\n        _jsx(StyledFormItem, { label: t('Owners'), children:\n          _jsx(AsyncSelect, { allowClear: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() }) }\n        ),\n        _jsx(\"p\", { className: \"help-block\", children:\n          t('Owners is a list of users who can alter the dashboard. Searchable by name or username.') }\n        )] }\n      ),\n      _jsxs(Col, { xs: 24, md: 12, children: [\n        _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Colors') }),\n        _jsx(ColorSchemeControlWrapper, { hasCustomLabelsColor: hasCustomLabelsColor, onChange: onColorSchemeChange, colorScheme: colorScheme, labelMargin: 4 })] }\n      )] }\n    );\n  };\n  const getRowsWithRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return _jsxs(_Fragment, { children: [\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Access') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Owners'), children:\n            _jsx(AsyncSelect, { allowClear: true, allowNewOptions: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Owners is a list of users who can alter the dashboard. Searchable by name or username.') }\n          )] }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Roles'), children:\n            _jsx(AsyncSelect, { allowClear: true, ariaLabel: t('Roles'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeRoles, options: (input, page, pageSize) => loadAccessOptions('roles', input, page, pageSize), value: handleRolesSelectValue() }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, regular access permissions apply.') }\n          )] }\n        )] }\n      ),\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(ColorSchemeControlWrapper, { hasCustomLabelsColor: hasCustomLabelsColor, onChange: onColorSchemeChange, colorScheme: colorScheme, labelMargin: 4 }) }\n        ) }\n      )] }\n    );\n  };\n  useEffect(() => {\n    if (show) {\n      if (!currentDashboardInfo) {\n        fetchDashboardDetails();\n      } else\n      {\n        handleDashboardData(currentDashboardInfo);\n      }\n    }\n    JsonEditor.preload();\n  }, [currentDashboardInfo, fetchDashboardDetails, handleDashboardData, show]);\n  useEffect(() => {\n    // the title can be changed inline in the dashboard, this catches it\n    if (dashboardTitle &&\n    dashboardInfo &&\n    dashboardInfo.title !== dashboardTitle) {\n      form.setFieldsValue({\n        ...dashboardInfo,\n        title: dashboardTitle\n      });\n    }\n  }, [dashboardInfo, dashboardTitle, form]);\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.TaggingSystem))\n    return;\n    try {\n      fetchTags({\n        objectType: OBJECT_TYPES.DASHBOARD,\n        objectId: dashboardId,\n        includeTypes: false\n      }, (tags) => setTags(tags), (error) => {\n        addDangerToast(`Error fetching tags: ${error.text}`);\n      });\n    }\n    catch (error) {\n      handleErrorResponse(error);\n    }\n  }, [dashboardId]);\n  const handleChangeTags = (tags) => {\n    const parsedTags = ensureIsArray(tags).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setTags(parsedTags);\n  };\n  return _jsx(Modal, { show: show, onHide: onHide, title: t('Dashboard properties'), footer: _jsxs(_Fragment, { children: [\n      _jsx(Button, { htmlType: \"button\", buttonSize: \"small\", onClick: onHide, \"data-test\": \"properties-modal-cancel-button\", cta: true, children:\n        t('Cancel') }\n      ),\n      _jsx(Button, { \"data-test\": \"properties-modal-apply-button\", onClick: form.submit, buttonSize: \"small\", buttonStyle: \"primary\", className: \"m-r-5\", cta: true, disabled: dashboardInfo == null ? void 0 : dashboardInfo.isManagedExternally, tooltip: dashboardInfo != null && dashboardInfo.isManagedExternally ?\n        t(\"This dashboard is managed externally, and can't be edited in Superset\") :\n        '', children:\n        saveLabel }\n      )] }\n    ), responsive: true, children:\n    _jsxs(AntdForm, { form: form, onFinish: onFinish, \"data-test\": \"dashboard-edit-properties-form\", layout: \"vertical\", initialValues: dashboardInfo, children: [\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { children: t('Basic information') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(FormItem, { label: t('Name'), name: \"title\", children:\n            _jsx(Input, { \"data-test\": \"dashboard-title-input\", type: \"text\", disabled: isLoading }) }\n          ) }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('URL slug'), name: \"slug\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('A readable URL for your dashboard') }\n          )] }\n        )] }\n      ),\n      isFeatureEnabled(FeatureFlag.DashboardRbac) ?\n      getRowsWithRoles() :\n      getRowsWithoutRoles(),\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { children: t('Certification') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Certified by'), name: \"certifiedBy\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Person or group that has certified this dashboard.') }\n          )] }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Certification details'), name: \"certificationDetails\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Any additional detail to show in the certification tooltip.') }\n          )] }\n        )] }\n      ),\n      isFeatureEnabled(FeatureFlag.TaggingSystem) ? _jsx(Row, { gutter: 16, children:\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(\"h3\", { css: _ref, children: t('Tags') }) }\n        ) }\n      ) : null,\n      isFeatureEnabled(FeatureFlag.TaggingSystem) ? _jsx(Row, { gutter: 16, children:\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { children:\n            _jsx(AsyncSelect, { ariaLabel: \"Tags\", mode: \"multiple\", value: tagsAsSelectValues, options: loadTags, onChange: handleChangeTags, allowClear: true }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('A list of tags that have been applied to this chart.') }\n          )] }\n        ) }\n      ) : null,\n      _jsx(Row, { children:\n        _jsxs(Col, { xs: 24, md: 24, children: [\n          _jsx(\"h3\", { style: { marginTop: '1em' }, children:\n            _jsxs(Button, { buttonStyle: \"link\", onClick: () => setIsAdvancedOpen(!isAdvancedOpen), children: [\n              _jsx(\"i\", { className: `fa fa-angle-${isAdvancedOpen ? 'down' : 'right'}`, style: { minWidth: '1em' } }),\n              t('Advanced')] }\n            ) }\n          ),\n          isAdvancedOpen && _jsxs(_Fragment, { children: [\n            _jsx(StyledFormItem, { label: t('JSON metadata'), children:\n              _jsx(StyledJsonEditor, { showLoadingForImport: true, name: \"json_metadata\", value: jsonMetadata, onChange: setJsonMetadata, tabSize: 2, width: \"100%\", height: \"200px\", wrapEnabled: true }) }\n            ),\n            _jsxs(\"p\", { className: \"help-block\", children: [\n              t('This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.'),\n              onlyApply && _jsxs(_Fragment, { children: [\n                ' ',\n                t('Please DO NOT overwrite the \"filter_scopes\" key.'), ' ',\n                _jsx(FilterScopeModal, { triggerNode: _jsx(\"span\", { className: \"alert-link\", children:\n                    t('Use \"%(menuName)s\" menu instead.', {\n                      menuName: t('Set filter mapping')\n                    }) }\n                  ) })] }\n              )] }\n            )] }\n          )] }\n        ) }\n      )] }\n    ) }\n  );\n};__signature__(PropertiesModal, \"useForm{[form]}\\nuseState{[isLoading, setIsLoading](false)}\\nuseState{[isAdvancedOpen, setIsAdvancedOpen](false)}\\nuseState{[colorScheme, setColorScheme](currentColorScheme)}\\nuseState{[jsonMetadata, setJsonMetadata]('')}\\nuseState{[dashboardInfo, setDashboardInfo]}\\nuseState{[owners, setOwners]([])}\\nuseState{[roles, setRoles]([])}\\nuseState{[tags, setTags]([])}\\nuseMemo{tagsAsSelectValues}\\nuseCallback{loadAccessOptions}\\nuseCallback{handleDashboardData}\\nuseCallback{fetchDashboardDetails}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\");const _default =\nwithToasts(PropertiesModal);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledFormItem, \"StyledFormItem\", \"/app/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(StyledJsonEditor, \"StyledJsonEditor\", \"/app/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(PropertiesModal, \"PropertiesModal\", \"/app/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useEffect","useMemo","useState","Input","FormItem","jsonStringify","Button","AntdForm","AsyncSelect","Col","Row","rison","ensureIsArray","isFeatureEnabled","FeatureFlag","getCategoricalSchemeRegistry","styled","SupersetClient","t","getClientErrorObject","Modal","JsonEditor","ColorSchemeControlWrapper","FilterScopeModal","withToasts","fetchTags","OBJECT_TYPES","loadTags","applyColors","getColorNamespace","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","StyledFormItem","StyledJsonEditor","theme","borderRadius","colors","secondary","light2","_ref","process","env","NODE_ENV","name","styles","map","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","PropertiesModal","addSuccessToast","addDangerToast","colorScheme","currentColorScheme","dashboardId","dashboardInfo","currentDashboardInfo","dashboardTitle","onHide","onlyApply","onSubmit","show","form","useForm","isLoading","setIsLoading","isAdvancedOpen","setIsAdvancedOpen","setColorScheme","jsonMetadata","setJsonMetadata","setDashboardInfo","owners","setOwners","roles","setRoles","saveLabel","tags","setTags","categoricalSchemeRegistry","tagsAsSelectValues","selectTags","tag","value","id","label","length","handleErrorResponse","response","error","statusText","message","errorText","json_metadata","title","content","okButtonProps","danger","className","loadAccessOptions","accessType","input","page","pageSize","query","encode","filter","page_size","get","endpoint","then","data","json","result","item","extra","active","undefined","text","totalCount","count","handleDashboardData","dashboardData","dashboard_title","slug","certified_by","certification_details","metadata","is_managed_externally","certifiedBy","certificationDetails","isManagedExternally","setFieldsValue","color_scheme","metaDataCopy","_omit","fetchDashboardDetails","_dashboard$json_metad","dashboard","jsonMetadataObj","JSON","parse","getJsonMetadata","_","handleOnChangeOwners","parsedOwners","o","full_name","handleOnChangeRoles","parsedRoles","r","handleOwnersSelectValue","owner","first_name","last_name","handleRolesSelectValue","role","onColorSchemeChange","updateMetadata","colorChoices","keys","includes","Error","label_colors","onFinish","_metadata","_metadata2","_metadata3","_metadata4","getFieldsValue","currentJsonMetadata","startsWith","endsWith","copyMetadata","colorNamespace","color_namespace","shared_label_colors","color_scheme_domain","moreOnSubmitProps","morePutProps","DashboardRbac","TaggingSystem","onSubmitProps","put","headers","body","stringify","getRowsWithoutRoles","hasCustomLabelsColor","Object","gutter","children","xs","md","style","marginTop","allowClear","ariaLabel","disabled","mode","onChange","options","labelMargin","getRowsWithRoles","allowNewOptions","preload","objectType","DASHBOARD","objectId","includeTypes","handleChangeTags","parsedTags","footer","htmlType","buttonSize","onClick","cta","submit","buttonStyle","tooltip","responsive","layout","initialValues","type","css","minWidth","showLoadingForImport","tabSize","width","height","wrapEnabled","triggerNode","menuName","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/app/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { omit } from 'lodash';\nimport { Input } from 'src/components/Input';\nimport { FormItem } from 'src/components/Form';\nimport jsonStringify from 'json-stringify-pretty-compact';\nimport Button from 'src/components/Button';\nimport { AntdForm, AsyncSelect, Col, Row } from 'src/components';\nimport rison from 'rison';\nimport {\n  ensureIsArray,\n  isFeatureEnabled,\n  FeatureFlag,\n  getCategoricalSchemeRegistry,\n  styled,\n  SupersetClient,\n  t,\n  getClientErrorObject,\n} from '@superset-ui/core';\n\nimport Modal from 'src/components/Modal';\nimport { JsonEditor } from 'src/components/AsyncAceEditor';\n\nimport ColorSchemeControlWrapper from 'src/dashboard/components/ColorSchemeControlWrapper';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport TagType from 'src/types/TagType';\nimport { fetchTags, OBJECT_TYPES } from 'src/features/tags/tags';\nimport { loadTags } from 'src/components/Tags/utils';\nimport { applyColors, getColorNamespace } from 'src/utils/colorScheme';\n\nconst StyledFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\n\nconst StyledJsonEditor = styled(JsonEditor)`\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ theme }) => theme.colors.secondary.light2};\n`;\n\ntype PropertiesModalProps = {\n  dashboardId: number;\n  dashboardTitle?: string;\n  dashboardInfo?: Record<string, any>;\n  show?: boolean;\n  onHide?: () => void;\n  colorScheme?: string;\n  onSubmit?: (params: Record<string, any>) => void;\n  addSuccessToast: (message: string) => void;\n  addDangerToast: (message: string) => void;\n  onlyApply?: boolean;\n};\n\ntype Roles = { id: number; name: string }[];\ntype Owners = {\n  id: number;\n  full_name?: string;\n  first_name?: string;\n  last_name?: string;\n}[];\ntype DashboardInfo = {\n  id: number;\n  title: string;\n  slug: string;\n  certifiedBy: string;\n  certificationDetails: string;\n  isManagedExternally: boolean;\n};\n\nconst PropertiesModal = ({\n  addSuccessToast,\n  addDangerToast,\n  colorScheme: currentColorScheme,\n  dashboardId,\n  dashboardInfo: currentDashboardInfo,\n  dashboardTitle,\n  onHide = () => {},\n  onlyApply = false,\n  onSubmit = () => {},\n  show = false,\n}: PropertiesModalProps) => {\n  const [form] = AntdForm.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false);\n  const [colorScheme, setColorScheme] = useState(currentColorScheme);\n  const [jsonMetadata, setJsonMetadata] = useState('');\n  const [dashboardInfo, setDashboardInfo] = useState<DashboardInfo>();\n  const [owners, setOwners] = useState<Owners>([]);\n  const [roles, setRoles] = useState<Roles>([]);\n  const saveLabel = onlyApply ? t('Apply') : t('Save');\n  const [tags, setTags] = useState<TagType[]>([]);\n  const categoricalSchemeRegistry = getCategoricalSchemeRegistry();\n\n  const tagsAsSelectValues = useMemo(() => {\n    const selectTags = tags.map((tag: { id: number; name: string }) => ({\n      value: tag.id,\n      label: tag.name,\n    }));\n    return selectTags;\n  }, [tags.length]);\n\n  const handleErrorResponse = async (response: Response) => {\n    const { error, statusText, message } = await getClientErrorObject(response);\n    let errorText = error || statusText || t('An error has occurred');\n    if (typeof message === 'object' && 'json_metadata' in message) {\n      errorText = (message as { json_metadata: string }).json_metadata;\n    } else if (typeof message === 'string') {\n      errorText = message;\n\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n    }\n\n    Modal.error({\n      title: t('Error'),\n      content: errorText,\n      okButtonProps: { danger: true, className: 'btn-danger' },\n    });\n  };\n\n  const loadAccessOptions = useCallback(\n    (accessType = 'owners', input = '', page: number, pageSize: number) => {\n      const query = rison.encode({\n        filter: input,\n        page,\n        page_size: pageSize,\n      });\n      return SupersetClient.get({\n        endpoint: `/api/v1/dashboard/related/${accessType}?q=${query}`,\n      }).then(response => ({\n        data: response.json.result\n          .filter((item: { extra: { active: boolean } }) =>\n            item.extra.active !== undefined ? item.extra.active : true,\n          )\n          .map((item: { value: number; text: string }) => ({\n            value: item.value,\n            label: item.text,\n          })),\n        totalCount: response.json.count,\n      }));\n    },\n    [],\n  );\n\n  const handleDashboardData = useCallback(\n    dashboardData => {\n      const {\n        id,\n        dashboard_title,\n        slug,\n        certified_by,\n        certification_details,\n        owners,\n        roles,\n        metadata,\n        is_managed_externally,\n      } = dashboardData;\n      const dashboardInfo = {\n        id,\n        title: dashboard_title,\n        slug: slug || '',\n        certifiedBy: certified_by || '',\n        certificationDetails: certification_details || '',\n        isManagedExternally: is_managed_externally || false,\n      };\n\n      form.setFieldsValue(dashboardInfo);\n      setDashboardInfo(dashboardInfo);\n      setOwners(owners);\n      setRoles(roles);\n      setColorScheme(metadata.color_scheme);\n\n      const metaDataCopy = omit(metadata, [\n        'positions',\n        'shared_label_colors',\n        'color_scheme_domain',\n      ]);\n\n      setJsonMetadata(metaDataCopy ? jsonStringify(metaDataCopy) : '');\n    },\n    [form],\n  );\n\n  const fetchDashboardDetails = useCallback(() => {\n    setIsLoading(true);\n    // We fetch the dashboard details because not all code\n    // that renders this component have all the values we need.\n    // At some point when we have a more consistent frontend\n    // datamodel, the dashboard could probably just be passed as a prop.\n    SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${dashboardId}`,\n    }).then(response => {\n      const dashboard = response.json.result;\n      const jsonMetadataObj = dashboard.json_metadata?.length\n        ? JSON.parse(dashboard.json_metadata)\n        : {};\n\n      handleDashboardData({\n        ...dashboard,\n        metadata: jsonMetadataObj,\n      });\n\n      setIsLoading(false);\n    }, handleErrorResponse);\n  }, [dashboardId, handleDashboardData]);\n\n  const getJsonMetadata = () => {\n    try {\n      const jsonMetadataObj = jsonMetadata?.length\n        ? JSON.parse(jsonMetadata)\n        : {};\n      return jsonMetadataObj;\n    } catch (_) {\n      return {};\n    }\n  };\n\n  const handleOnChangeOwners = (owners: { value: number; label: string }[]) => {\n    const parsedOwners: Owners = ensureIsArray(owners).map(o => ({\n      id: o.value,\n      full_name: o.label,\n    }));\n    setOwners(parsedOwners);\n  };\n\n  const handleOnChangeRoles = (roles: { value: number; label: string }[]) => {\n    const parsedRoles: Roles = ensureIsArray(roles).map(r => ({\n      id: r.value,\n      name: r.label,\n    }));\n    setRoles(parsedRoles);\n  };\n\n  const handleOwnersSelectValue = () => {\n    const parsedOwners = (owners || []).map(\n      (owner: {\n        id: number;\n        first_name?: string;\n        last_name?: string;\n        full_name?: string;\n      }) => ({\n        value: owner.id,\n        label: owner.full_name || `${owner.first_name} ${owner.last_name}`,\n      }),\n    );\n    return parsedOwners;\n  };\n\n  const handleRolesSelectValue = () => {\n    const parsedRoles = (roles || []).map(\n      (role: { id: number; name: string }) => ({\n        value: role.id,\n        label: `${role.name}`,\n      }),\n    );\n    return parsedRoles;\n  };\n\n  const onColorSchemeChange = (\n    colorScheme = '',\n    { updateMetadata = true } = {},\n  ) => {\n    // check that color_scheme is valid\n    const colorChoices = categoricalSchemeRegistry.keys();\n    const jsonMetadataObj = getJsonMetadata();\n\n    // only fire if the color_scheme is present and invalid\n    if (colorScheme && !colorChoices.includes(colorScheme)) {\n      Modal.error({\n        title: t('Error'),\n        content: t('A valid color scheme is required'),\n        okButtonProps: { danger: true, className: 'btn-danger' },\n      });\n      throw new Error('A valid color scheme is required');\n    }\n\n    // update metadata to match selection\n    if (updateMetadata) {\n      jsonMetadataObj.color_scheme = colorScheme;\n      jsonMetadataObj.label_colors = jsonMetadataObj.label_colors || {};\n\n      setJsonMetadata(jsonStringify(jsonMetadataObj));\n    }\n    setColorScheme(colorScheme);\n  };\n\n  const onFinish = () => {\n    const { title, slug, certifiedBy, certificationDetails } =\n      form.getFieldsValue();\n    let currentColorScheme = colorScheme;\n    let currentJsonMetadata = jsonMetadata;\n\n    // validate currentJsonMetadata\n    let metadata;\n    try {\n      if (\n        !currentJsonMetadata.startsWith('{') ||\n        !currentJsonMetadata.endsWith('}')\n      ) {\n        throw new Error();\n      }\n      metadata = JSON.parse(currentJsonMetadata);\n    } catch (error) {\n      addDangerToast(t('JSON metadata is invalid!'));\n      return;\n    }\n\n    const copyMetadata = { ...metadata };\n    const colorNamespace = getColorNamespace(metadata?.color_namespace);\n\n    // color scheme in json metadata has precedence over selection\n    currentColorScheme = metadata?.color_scheme || colorScheme;\n\n    // remove information from user facing input\n    if (metadata?.shared_label_colors) {\n      delete metadata.shared_label_colors;\n    }\n    if (metadata?.color_scheme_domain) {\n      delete metadata.color_scheme_domain;\n    }\n\n    // only apply colors, the user has not saved yet\n    applyColors(copyMetadata, true);\n\n    currentJsonMetadata = jsonStringify(metadata);\n\n    onColorSchemeChange(currentColorScheme, {\n      updateMetadata: false,\n    });\n\n    const moreOnSubmitProps: { roles?: Roles } = {};\n    const morePutProps: { roles?: number[]; tags?: (number | undefined)[] } =\n      {};\n    if (isFeatureEnabled(FeatureFlag.DashboardRbac)) {\n      moreOnSubmitProps.roles = roles;\n      morePutProps.roles = (roles || []).map(r => r.id);\n    }\n    if (isFeatureEnabled(FeatureFlag.TaggingSystem)) {\n      morePutProps.tags = tags.map(tag => tag.id);\n    }\n    const onSubmitProps = {\n      id: dashboardId,\n      title,\n      slug,\n      jsonMetadata: currentJsonMetadata,\n      owners,\n      colorScheme: currentColorScheme,\n      colorNamespace,\n      certifiedBy,\n      certificationDetails,\n      ...moreOnSubmitProps,\n    };\n    if (onlyApply) {\n      onSubmit(onSubmitProps);\n      onHide();\n      addSuccessToast(t('Dashboard properties updated'));\n    } else {\n      SupersetClient.put({\n        endpoint: `/api/v1/dashboard/${dashboardId}`,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dashboard_title: title,\n          slug: slug || null,\n          json_metadata: currentJsonMetadata || null,\n          owners: (owners || []).map(o => o.id),\n          certified_by: certifiedBy || null,\n          certification_details:\n            certifiedBy && certificationDetails ? certificationDetails : null,\n          ...morePutProps,\n        }),\n      }).then(() => {\n        onSubmit(onSubmitProps);\n        onHide();\n        addSuccessToast(t('The dashboard has been saved'));\n      }, handleErrorResponse);\n    }\n  };\n\n  const getRowsWithoutRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys(\n      jsonMetadataObj?.label_colors || {},\n    ).length;\n\n    return (\n      <Row gutter={16}>\n        <Col xs={24} md={12}>\n          <h3 style={{ marginTop: '1em' }}>{t('Access')}</h3>\n          <StyledFormItem label={t('Owners')}>\n            <AsyncSelect\n              allowClear\n              ariaLabel={t('Owners')}\n              disabled={isLoading}\n              mode=\"multiple\"\n              onChange={handleOnChangeOwners}\n              options={(input, page, pageSize) =>\n                loadAccessOptions('owners', input, page, pageSize)\n              }\n              value={handleOwnersSelectValue()}\n            />\n          </StyledFormItem>\n          <p className=\"help-block\">\n            {t(\n              'Owners is a list of users who can alter the dashboard. Searchable by name or username.',\n            )}\n          </p>\n        </Col>\n        <Col xs={24} md={12}>\n          <h3 style={{ marginTop: '1em' }}>{t('Colors')}</h3>\n          <ColorSchemeControlWrapper\n            hasCustomLabelsColor={hasCustomLabelsColor}\n            onChange={onColorSchemeChange}\n            colorScheme={colorScheme}\n            labelMargin={4}\n          />\n        </Col>\n      </Row>\n    );\n  };\n\n  const getRowsWithRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys(\n      jsonMetadataObj?.label_colors || {},\n    ).length;\n\n    return (\n      <>\n        <Row>\n          <Col xs={24} md={24}>\n            <h3 style={{ marginTop: '1em' }}>{t('Access')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Owners')}>\n              <AsyncSelect\n                allowClear\n                allowNewOptions\n                ariaLabel={t('Owners')}\n                disabled={isLoading}\n                mode=\"multiple\"\n                onChange={handleOnChangeOwners}\n                options={(input, page, pageSize) =>\n                  loadAccessOptions('owners', input, page, pageSize)\n                }\n                value={handleOwnersSelectValue()}\n              />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t(\n                'Owners is a list of users who can alter the dashboard. Searchable by name or username.',\n              )}\n            </p>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Roles')}>\n              <AsyncSelect\n                allowClear\n                ariaLabel={t('Roles')}\n                disabled={isLoading}\n                mode=\"multiple\"\n                onChange={handleOnChangeRoles}\n                options={(input, page, pageSize) =>\n                  loadAccessOptions('roles', input, page, pageSize)\n                }\n                value={handleRolesSelectValue()}\n              />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t(\n                'Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, regular access permissions apply.',\n              )}\n            </p>\n          </Col>\n        </Row>\n        <Row>\n          <Col xs={24} md={12}>\n            <ColorSchemeControlWrapper\n              hasCustomLabelsColor={hasCustomLabelsColor}\n              onChange={onColorSchemeChange}\n              colorScheme={colorScheme}\n              labelMargin={4}\n            />\n          </Col>\n        </Row>\n      </>\n    );\n  };\n\n  useEffect(() => {\n    if (show) {\n      if (!currentDashboardInfo) {\n        fetchDashboardDetails();\n      } else {\n        handleDashboardData(currentDashboardInfo);\n      }\n    }\n\n    JsonEditor.preload();\n  }, [currentDashboardInfo, fetchDashboardDetails, handleDashboardData, show]);\n\n  useEffect(() => {\n    // the title can be changed inline in the dashboard, this catches it\n    if (\n      dashboardTitle &&\n      dashboardInfo &&\n      dashboardInfo.title !== dashboardTitle\n    ) {\n      form.setFieldsValue({\n        ...dashboardInfo,\n        title: dashboardTitle,\n      });\n    }\n  }, [dashboardInfo, dashboardTitle, form]);\n\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.TaggingSystem)) return;\n    try {\n      fetchTags(\n        {\n          objectType: OBJECT_TYPES.DASHBOARD,\n          objectId: dashboardId,\n          includeTypes: false,\n        },\n        (tags: TagType[]) => setTags(tags),\n        (error: Response) => {\n          addDangerToast(`Error fetching tags: ${error.text}`);\n        },\n      );\n    } catch (error) {\n      handleErrorResponse(error);\n    }\n  }, [dashboardId]);\n\n  const handleChangeTags = (tags: { label: string; value: number }[]) => {\n    const parsedTags: TagType[] = ensureIsArray(tags).map(r => ({\n      id: r.value,\n      name: r.label,\n    }));\n    setTags(parsedTags);\n  };\n\n  return (\n    <Modal\n      show={show}\n      onHide={onHide}\n      title={t('Dashboard properties')}\n      footer={\n        <>\n          <Button\n            htmlType=\"button\"\n            buttonSize=\"small\"\n            onClick={onHide}\n            data-test=\"properties-modal-cancel-button\"\n            cta\n          >\n            {t('Cancel')}\n          </Button>\n          <Button\n            data-test=\"properties-modal-apply-button\"\n            onClick={form.submit}\n            buttonSize=\"small\"\n            buttonStyle=\"primary\"\n            className=\"m-r-5\"\n            cta\n            disabled={dashboardInfo?.isManagedExternally}\n            tooltip={\n              dashboardInfo?.isManagedExternally\n                ? t(\n                    \"This dashboard is managed externally, and can't be edited in Superset\",\n                  )\n                : ''\n            }\n          >\n            {saveLabel}\n          </Button>\n        </>\n      }\n      responsive\n    >\n      <AntdForm\n        form={form}\n        onFinish={onFinish}\n        data-test=\"dashboard-edit-properties-form\"\n        layout=\"vertical\"\n        initialValues={dashboardInfo}\n      >\n        <Row>\n          <Col xs={24} md={24}>\n            <h3>{t('Basic information')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <FormItem label={t('Name')} name=\"title\">\n              <Input\n                data-test=\"dashboard-title-input\"\n                type=\"text\"\n                disabled={isLoading}\n              />\n            </FormItem>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('URL slug')} name=\"slug\">\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('A readable URL for your dashboard')}\n            </p>\n          </Col>\n        </Row>\n        {isFeatureEnabled(FeatureFlag.DashboardRbac)\n          ? getRowsWithRoles()\n          : getRowsWithoutRoles()}\n        <Row>\n          <Col xs={24} md={24}>\n            <h3>{t('Certification')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Certified by')} name=\"certifiedBy\">\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('Person or group that has certified this dashboard.')}\n            </p>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem\n              label={t('Certification details')}\n              name=\"certificationDetails\"\n            >\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('Any additional detail to show in the certification tooltip.')}\n            </p>\n          </Col>\n        </Row>\n        {isFeatureEnabled(FeatureFlag.TaggingSystem) ? (\n          <Row gutter={16}>\n            <Col xs={24} md={12}>\n              <h3 css={{ marginTop: '1em' }}>{t('Tags')}</h3>\n            </Col>\n          </Row>\n        ) : null}\n        {isFeatureEnabled(FeatureFlag.TaggingSystem) ? (\n          <Row gutter={16}>\n            <Col xs={24} md={12}>\n              <StyledFormItem>\n                <AsyncSelect\n                  ariaLabel=\"Tags\"\n                  mode=\"multiple\"\n                  value={tagsAsSelectValues}\n                  options={loadTags}\n                  onChange={handleChangeTags}\n                  allowClear\n                />\n              </StyledFormItem>\n              <p className=\"help-block\">\n                {t('A list of tags that have been applied to this chart.')}\n              </p>\n            </Col>\n          </Row>\n        ) : null}\n        <Row>\n          <Col xs={24} md={24}>\n            <h3 style={{ marginTop: '1em' }}>\n              <Button\n                buttonStyle=\"link\"\n                onClick={() => setIsAdvancedOpen(!isAdvancedOpen)}\n              >\n                <i\n                  className={`fa fa-angle-${isAdvancedOpen ? 'down' : 'right'}`}\n                  style={{ minWidth: '1em' }}\n                />\n                {t('Advanced')}\n              </Button>\n            </h3>\n            {isAdvancedOpen && (\n              <>\n                <StyledFormItem label={t('JSON metadata')}>\n                  <StyledJsonEditor\n                    showLoadingForImport\n                    name=\"json_metadata\"\n                    value={jsonMetadata}\n                    onChange={setJsonMetadata}\n                    tabSize={2}\n                    width=\"100%\"\n                    height=\"200px\"\n                    wrapEnabled\n                  />\n                </StyledFormItem>\n                <p className=\"help-block\">\n                  {t(\n                    'This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.',\n                  )}\n                  {onlyApply && (\n                    <>\n                      {' '}\n                      {t(\n                        'Please DO NOT overwrite the \"filter_scopes\" key.',\n                      )}{' '}\n                      <FilterScopeModal\n                        triggerNode={\n                          <span className=\"alert-link\">\n                            {t('Use \"%(menuName)s\" menu instead.', {\n                              menuName: t('Set filter mapping'),\n                            })}\n                          </span>\n                        }\n                      />\n                    </>\n                  )}\n                </p>\n              </>\n            )}\n          </Col>\n        </Row>\n      </AntdForm>\n    </Modal>\n  );\n};\n\nexport default withToasts(PropertiesModal);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}