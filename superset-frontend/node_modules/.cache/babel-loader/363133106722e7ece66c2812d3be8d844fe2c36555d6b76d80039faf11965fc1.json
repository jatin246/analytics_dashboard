{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useMemo, useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport Alert from 'src/components/Alert';\nimport MetadataBar from 'src/components/MetadataBar';\nimport { MetadataType } from 'src/components/MetadataBar/ContentType';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { cachedSupersetGet } from 'src/utils/cachedSupersetGet';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nexport const useDatasetMetadataBar = ({ dataset: datasetProps, datasetId }) => {\n  const theme = useTheme();\n  const [result, setResult] = useState();\n  const [status, setStatus] = useState(datasetProps ? ResourceStatus.Complete : ResourceStatus.Loading);\n  useEffect(() => {\n    if (!datasetProps && datasetId) {\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`\n      }).\n      then(({ json: { result } }) => {\n        setResult(result);\n        setStatus(ResourceStatus.Complete);\n      }).\n      catch(() => {\n        setStatus(ResourceStatus.Error);\n      });\n    }\n  }, [datasetId, datasetProps]);\n  const metadataBar = useMemo(() => {\n    const items = [];\n    const dataset = datasetProps || result;\n    if (dataset) {var _created_by$first_nam, _created_by$last_name;\n      const { changed_on_humanized, created_on_humanized, description, table_name, changed_by, created_by, owners } = dataset;\n      const notAvailable = t('Not available');\n      const createdBy = `${(_created_by$first_nam = created_by == null ? void 0 : created_by.first_name) != null ? _created_by$first_nam : ''} ${(_created_by$last_name = created_by == null ? void 0 : created_by.last_name) != null ? _created_by$last_name : ''}`.trim() || notAvailable;\n      const modifiedBy = changed_by ?\n      `${changed_by.first_name} ${changed_by.last_name}` :\n      notAvailable;\n      const formattedOwners = (owners == null ? void 0 : owners.length) > 0 ?\n      owners.map((owner) => `${owner.first_name} ${owner.last_name}`) :\n      [notAvailable];\n      items.push({\n        type: MetadataType.Table,\n        title: table_name\n      });\n      items.push({\n        type: MetadataType.LastModified,\n        value: changed_on_humanized,\n        modifiedBy\n      });\n      items.push({\n        type: MetadataType.Owner,\n        createdBy,\n        owners: formattedOwners,\n        createdOn: created_on_humanized\n      });\n      if (description) {\n        items.push({\n          type: MetadataType.Description,\n          value: description\n        });\n      }\n    }\n    return _jsxs(\"div\", { css: css`\n          display: flex;\n          margin-bottom: ${theme.gridUnit * 4}px;\n        `, children: [\n      status === ResourceStatus.Complete && _jsx(MetadataBar, { items: items, tooltipPlacement: \"bottom\" }),\n      status === ResourceStatus.Error && _jsx(Alert, { type: \"error\", message: t('There was an error loading the dataset metadata') })] }\n    );\n  }, [datasetProps, result, status, theme.gridUnit]);\n  return {\n    metadataBar,\n    status\n  };\n};__signature__(useDatasetMetadataBar, \"useTheme{theme}\\nuseState{[result, setResult]}\\nuseState{[status, setStatus](datasetProps ? ResourceStatus.Complete : ResourceStatus.Loading)}\\nuseEffect{}\\nuseMemo{metadataBar}\", () => [useTheme]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(useDatasetMetadataBar, \"useDatasetMetadataBar\", \"/app/superset-frontend/src/features/datasets/metadataBar/useDatasetMetadataBar.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useEffect","useMemo","useState","css","t","useTheme","Alert","MetadataBar","MetadataType","ResourceStatus","cachedSupersetGet","jsx","_jsx","jsxs","_jsxs","useDatasetMetadataBar","dataset","datasetProps","datasetId","theme","result","setResult","status","setStatus","Complete","Loading","endpoint","then","json","catch","Error","metadataBar","items","_created_by$first_nam","_created_by$last_name","changed_on_humanized","created_on_humanized","description","table_name","changed_by","created_by","owners","notAvailable","createdBy","first_name","last_name","trim","modifiedBy","formattedOwners","length","map","owner","push","type","Table","title","LastModified","value","Owner","createdOn","Description","gridUnit","children","tooltipPlacement","message","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/features/datasets/metadataBar/useDatasetMetadataBar.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useMemo, useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport Alert from 'src/components/Alert';\nimport { Dataset } from 'src/components/Chart/types';\nimport MetadataBar from 'src/components/MetadataBar';\nimport {\n  ContentType,\n  MetadataType,\n} from 'src/components/MetadataBar/ContentType';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { cachedSupersetGet } from 'src/utils/cachedSupersetGet';\n\nexport type UseDatasetMetadataBarProps =\n  | { datasetId?: undefined; dataset: Dataset }\n  | { datasetId: number | string; dataset?: undefined };\nexport const useDatasetMetadataBar = ({\n  dataset: datasetProps,\n  datasetId,\n}: UseDatasetMetadataBarProps) => {\n  const theme = useTheme();\n  const [result, setResult] = useState<Dataset>();\n  const [status, setStatus] = useState<ResourceStatus>(\n    datasetProps ? ResourceStatus.Complete : ResourceStatus.Loading,\n  );\n\n  useEffect(() => {\n    if (!datasetProps && datasetId) {\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`,\n      })\n        .then(({ json: { result } }) => {\n          setResult(result);\n          setStatus(ResourceStatus.Complete);\n        })\n        .catch(() => {\n          setStatus(ResourceStatus.Error);\n        });\n    }\n  }, [datasetId, datasetProps]);\n\n  const metadataBar = useMemo(() => {\n    const items: ContentType[] = [];\n    const dataset = datasetProps || result;\n    if (dataset) {\n      const {\n        changed_on_humanized,\n        created_on_humanized,\n        description,\n        table_name,\n        changed_by,\n        created_by,\n        owners,\n      } = dataset;\n      const notAvailable = t('Not available');\n      const createdBy =\n        `${created_by?.first_name ?? ''} ${\n          created_by?.last_name ?? ''\n        }`.trim() || notAvailable;\n      const modifiedBy = changed_by\n        ? `${changed_by.first_name} ${changed_by.last_name}`\n        : notAvailable;\n      const formattedOwners =\n        owners?.length > 0\n          ? owners.map(owner => `${owner.first_name} ${owner.last_name}`)\n          : [notAvailable];\n      items.push({\n        type: MetadataType.Table,\n        title: table_name,\n      });\n      items.push({\n        type: MetadataType.LastModified,\n        value: changed_on_humanized,\n        modifiedBy,\n      });\n      items.push({\n        type: MetadataType.Owner,\n        createdBy,\n        owners: formattedOwners,\n        createdOn: created_on_humanized,\n      });\n      if (description) {\n        items.push({\n          type: MetadataType.Description,\n          value: description,\n        });\n      }\n    }\n    return (\n      <div\n        css={css`\n          display: flex;\n          margin-bottom: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {status === ResourceStatus.Complete && (\n          <MetadataBar items={items} tooltipPlacement=\"bottom\" />\n        )}\n        {status === ResourceStatus.Error && (\n          <Alert\n            type=\"error\"\n            message={t('There was an error loading the dataset metadata')}\n          />\n        )}\n      </div>\n    );\n  }, [datasetProps, result, status, theme.gridUnit]);\n\n  return {\n    metadataBar,\n    status,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}