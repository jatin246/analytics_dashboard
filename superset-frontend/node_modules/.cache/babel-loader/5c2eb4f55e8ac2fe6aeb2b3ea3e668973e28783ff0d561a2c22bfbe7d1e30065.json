{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport moment from 'moment';\nimport { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  styled,\n  css,\n  isFeatureEnabled,\n  FeatureFlag,\n  t,\n  getExtensionsRegistry } from\n'@superset-ui/core';\nimport { Global } from '@emotion/react';\nimport {\n  LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD,\n  LOG_ACTIONS_FORCE_REFRESH_DASHBOARD,\n  LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD } from\n'src/logger/LogUtils';\nimport Icons from 'src/components/Icons';\nimport Button from 'src/components/Button';\nimport { AntdButton } from 'src/components/';\nimport { findPermission } from 'src/utils/findPermission';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { safeStringify } from 'src/utils/safeStringify';\nimport ConnectedHeaderActionsDropdown from 'src/dashboard/components/Header/HeaderActionsDropdown';\nimport PublishedStatus from 'src/dashboard/components/PublishedStatus';\nimport UndoRedoKeyListeners from 'src/dashboard/components/UndoRedoKeyListeners';\nimport PropertiesModal from 'src/dashboard/components/PropertiesModal';\nimport { chartPropShape } from 'src/dashboard/util/propShapes';\nimport getOwnerName from 'src/utils/getOwnerName';\nimport {\n  UNDO_LIMIT,\n  SAVE_TYPE_OVERWRITE,\n  DASHBOARD_POSITION_DATA_LIMIT } from\n'src/dashboard/util/constants';\nimport setPeriodicRunner, {\n  stopPeriodicRender } from\n'src/dashboard/util/setPeriodicRunner';\nimport { PageHeaderWithActions } from 'src/components/PageHeaderWithActions';\nimport MetadataBar, { MetadataType } from 'src/components/MetadataBar';\nimport DashboardEmbedModal from '../EmbeddedModal';\nimport OverwriteConfirm from '../OverwriteConfirm';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\n\nconst extensionsRegistry = getExtensionsRegistry();\n\nconst propTypes = {\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  addWarningToast: PropTypes.func.isRequired,\n  user: PropTypes.object, // UserWithPermissionsAndRoles,\n  dashboardInfo: PropTypes.object.isRequired,\n  dashboardTitle: PropTypes.string,\n  dataMask: PropTypes.object.isRequired,\n  charts: PropTypes.objectOf(chartPropShape).isRequired,\n  layout: PropTypes.object.isRequired,\n  expandedSlices: PropTypes.object,\n  customCss: PropTypes.string,\n  colorNamespace: PropTypes.string,\n  colorScheme: PropTypes.string,\n  setColorScheme: PropTypes.func.isRequired,\n  setUnsavedChanges: PropTypes.func.isRequired,\n  isStarred: PropTypes.bool.isRequired,\n  isPublished: PropTypes.bool.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  onSave: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  fetchFaveStar: PropTypes.func.isRequired,\n  fetchCharts: PropTypes.func.isRequired,\n  saveFaveStar: PropTypes.func.isRequired,\n  savePublished: PropTypes.func.isRequired,\n  updateDashboardTitle: PropTypes.func.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  setEditMode: PropTypes.func.isRequired,\n  showBuilderPane: PropTypes.func.isRequired,\n  updateCss: PropTypes.func.isRequired,\n  logEvent: PropTypes.func.isRequired,\n  hasUnsavedChanges: PropTypes.bool.isRequired,\n  maxUndoHistoryExceeded: PropTypes.bool.isRequired,\n  lastModifiedTime: PropTypes.number.isRequired,\n\n  // redux\n  onRefresh: PropTypes.func.isRequired,\n  onUndo: PropTypes.func.isRequired,\n  onRedo: PropTypes.func.isRequired,\n  undoLength: PropTypes.number.isRequired,\n  redoLength: PropTypes.number.isRequired,\n  setMaxUndoHistoryExceeded: PropTypes.func.isRequired,\n  maxUndoHistoryToast: PropTypes.func.isRequired,\n  refreshFrequency: PropTypes.number,\n  shouldPersistRefreshFrequency: PropTypes.bool.isRequired,\n  setRefreshFrequency: PropTypes.func.isRequired,\n  dashboardInfoChanged: PropTypes.func.isRequired,\n  dashboardTitleChanged: PropTypes.func.isRequired\n};\n\nconst defaultProps = {\n  colorNamespace: undefined,\n  colorScheme: undefined\n};\n\nconst headerContainerStyle = (theme) => css`\n  border-bottom: 1px solid ${theme.colors.grayscale.light2};\n`;\n\nconst editButtonStyle = (theme) => css`\n  color: ${theme.colors.primary.dark2};\n`;\n\nconst actionButtonsStyle = (theme) => css`\n  display: flex;\n  align-items: center;\n\n  .action-schedule-report {\n    margin-left: ${theme.gridUnit * 2}px;\n  }\n\n  .undoRedo {\n    display: flex;\n    margin-right: ${theme.gridUnit * 2}px;\n  }\n`;\n\nconst StyledUndoRedoButton = styled(AntdButton)`\n  padding: 0;\n  &:hover {\n    background: transparent;\n  }\n`;\n\nconst undoRedoStyle = (theme) => css`\n  color: ${theme.colors.grayscale.light1};\n  &:hover {\n    color: ${theme.colors.grayscale.base};\n  }\n`;\n\nconst undoRedoEmphasized = (theme) => css`\n  color: ${theme.colors.grayscale.base};\n`;\n\nconst undoRedoDisabled = (theme) => css`\n  color: ${theme.colors.grayscale.light2};\n`;\n\nconst saveBtnStyle = (theme) => css`\n  min-width: ${theme.gridUnit * 17}px;\n  height: ${theme.gridUnit * 8}px;\n`;\n\nconst discardBtnStyle = (theme) => css`\n  min-width: ${theme.gridUnit * 22}px;\n  height: ${theme.gridUnit * 8}px;\n`;\n\nclass Header extends PureComponent {\n  static discardChanges() {\n    const url = new URL(window.location.href);\n\n    url.searchParams.delete('edit');\n    window.location.assign(url);\n  }\n\n  constructor(props) {\n    super(props);this.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    showEmbedModal = () => {\n      this.setState({ showingEmbedModal: true });\n    };this.\n\n    hideEmbedModal = () => {\n      this.setState({ showingEmbedModal: false });\n    };this.\n\n    getMetadataItems = () => {\n      const { dashboardInfo } = this.props;\n      return [\n      {\n        type: MetadataType.LastModified,\n        value: dashboardInfo.changed_on_delta_humanized,\n        modifiedBy:\n        getOwnerName(dashboardInfo.changed_by) || t('Not available')\n      },\n      {\n        type: MetadataType.Owner,\n        createdBy: getOwnerName(dashboardInfo.created_by) || t('Not available'),\n        owners:\n        dashboardInfo.owners.length > 0 ?\n        dashboardInfo.owners.map(getOwnerName) :\n        t('None'),\n        createdOn: dashboardInfo.created_on_delta_humanized\n      }];\n\n    };this.state = { didNotifyMaxUndoHistoryToast: false, emphasizeUndo: false, emphasizeRedo: false, showingPropertiesModal: false, isDropdownVisible: false };this.handleChangeText = this.handleChangeText.bind(this);this.handleCtrlZ = this.handleCtrlZ.bind(this);this.handleCtrlY = this.handleCtrlY.bind(this);this.toggleEditMode = this.toggleEditMode.bind(this);this.forceRefresh = this.forceRefresh.bind(this);this.startPeriodicRender = this.startPeriodicRender.bind(this);this.overwriteDashboard = this.overwriteDashboard.bind(this);this.showPropertiesModal = this.showPropertiesModal.bind(this);this.hidePropertiesModal = this.hidePropertiesModal.bind(this);this.setIsDropdownVisible = this.setIsDropdownVisible.bind(this);}componentDidMount() {const { refreshFrequency } = this.props;this.startPeriodicRender(refreshFrequency * 1000);}componentDidUpdate(prevProps) {if (this.props.refreshFrequency !== prevProps.refreshFrequency) {const { refreshFrequency } = this.props;this.startPeriodicRender(refreshFrequency * 1000);}}UNSAFE_componentWillReceiveProps(nextProps) {if (UNDO_LIMIT - nextProps.undoLength <= 0 && !this.state.didNotifyMaxUndoHistoryToast) {this.setState(() => ({ didNotifyMaxUndoHistoryToast: true }));this.props.maxUndoHistoryToast();}if (nextProps.undoLength > UNDO_LIMIT && !this.props.maxUndoHistoryExceeded) {this.props.setMaxUndoHistoryExceeded();}}componentWillUnmount() {stopPeriodicRender(this.refreshTimer);this.props.setRefreshFrequency(0);clearTimeout(this.ctrlYTimeout);clearTimeout(this.ctrlZTimeout);}handleChangeText(nextText) {const { updateDashboardTitle, onChange } = this.props;if (nextText && this.props.dashboardTitle !== nextText) {updateDashboardTitle(nextText);onChange();}}setIsDropdownVisible(visible) {this.setState({ isDropdownVisible: visible });}handleCtrlY() {this.props.onRedo();this.setState({ emphasizeRedo: true }, () => {if (this.ctrlYTimeout) clearTimeout(this.ctrlYTimeout);this.ctrlYTimeout = setTimeout(() => {this.setState({ emphasizeRedo: false });}, 100);});}handleCtrlZ() {this.props.onUndo();this.setState({ emphasizeUndo: true }, () => {if (this.ctrlZTimeout) clearTimeout(this.ctrlZTimeout);this.ctrlZTimeout = setTimeout(() => {this.setState({ emphasizeUndo: false });}, 100);});}forceRefresh() {if (!this.props.isLoading) {const chartList = Object.keys(this.props.charts);this.props.logEvent(LOG_ACTIONS_FORCE_REFRESH_DASHBOARD, { force: true, interval: 0, chartCount: chartList.length });return this.props.onRefresh(chartList, true, 0, this.props.dashboardInfo.id);}return false;}startPeriodicRender(interval) {let intervalMessage;if (interval) {var _dashboardInfo$common, _dashboardInfo$common2;const { dashboardInfo } = this.props;const periodicRefreshOptions = (_dashboardInfo$common = dashboardInfo.common) == null ? void 0 : (_dashboardInfo$common2 = _dashboardInfo$common.conf) == null ? void 0 : _dashboardInfo$common2.DASHBOARD_AUTO_REFRESH_INTERVALS;const predefinedValue = periodicRefreshOptions.find((option) => Number(option[0]) === interval / 1000);if (predefinedValue) {intervalMessage = t(predefinedValue[1]);} else {intervalMessage = moment.duration(interval, 'millisecond').humanize();}}const periodicRender = () => {const { fetchCharts, logEvent, charts, dashboardInfo } = this.props;const { metadata } = dashboardInfo;const immune = metadata.timed_refresh_immune_slices || [];const affectedCharts = Object.values(charts).filter((chart) => immune.indexOf(chart.id) === -1).map((chart) => chart.id);logEvent(LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD, { interval, chartCount: affectedCharts.length });this.props.addWarningToast(t(`This dashboard is currently auto refreshing; the next auto refresh will be in %s.`, intervalMessage));if (dashboardInfo.common.conf.DASHBOARD_AUTO_REFRESH_MODE === 'fetch') {// force-refresh while auto-refresh in dashboard\n        return fetchCharts(affectedCharts, false, interval * 0.2, dashboardInfo.id);}return fetchCharts(affectedCharts, true, interval * 0.2, dashboardInfo.id);};this.refreshTimer = setPeriodicRunner({ interval, periodicRender, refreshTimer: this.refreshTimer });}toggleEditMode() {this.props.logEvent(LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD, { edit_mode: !this.props.editMode });this.props.setEditMode(!this.props.editMode);}overwriteDashboard() {var _dashboardInfo$metada, _dashboardInfo$metada2, _dashboardInfo$metada3;const { dashboardTitle, layout: positions, colorScheme, colorNamespace, customCss, dashboardInfo, refreshFrequency: currentRefreshFrequency, shouldPersistRefreshFrequency, lastModifiedTime, slug } = this.props; // check refresh frequency is for current session or persist\n    const refreshFrequency = shouldPersistRefreshFrequency ? currentRefreshFrequency : (_dashboardInfo$metada = dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada.refresh_frequency;const currentColorNamespace = (dashboardInfo == null ? void 0 : (_dashboardInfo$metada2 = dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada2.color_namespace) || colorNamespace;const currentColorScheme = (dashboardInfo == null ? void 0 : (_dashboardInfo$metada3 = dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada3.color_scheme) || colorScheme;const data = { certified_by: dashboardInfo.certified_by, certification_details: dashboardInfo.certification_details, css: customCss, dashboard_title: dashboardTitle, last_modified_time: lastModifiedTime, owners: dashboardInfo.owners, roles: dashboardInfo.roles, slug, metadata: { ...(dashboardInfo == null ? void 0 : dashboardInfo.metadata), color_namespace: currentColorNamespace, color_scheme: currentColorScheme, positions, refresh_frequency: refreshFrequency } }; // make sure positions data less than DB storage limitation:\n    const positionJSONLength = safeStringify(positions).length;const limit = dashboardInfo.common.conf.SUPERSET_DASHBOARD_POSITION_DATA_LIMIT || DASHBOARD_POSITION_DATA_LIMIT;if (positionJSONLength >= limit) {this.props.addDangerToast(t('Your dashboard is too large. Please reduce its size before saving it.'));} else {if (positionJSONLength >= limit * 0.9) {this.props.addWarningToast('Your dashboard is near the size limit.');}this.props.onSave(data, dashboardInfo.id, SAVE_TYPE_OVERWRITE);}}showPropertiesModal() {this.setState({ showingPropertiesModal: true });}hidePropertiesModal() {this.setState({ showingPropertiesModal: false });}render() {var _dashboardInfo$common3, _dashboardInfo$common4, _dashboardInfo$common5, _dashboardInfo$common6;const {\n      dashboardTitle,\n      layout,\n      expandedSlices,\n      customCss,\n      colorNamespace,\n      dataMask,\n      setColorScheme,\n      setUnsavedChanges,\n      colorScheme,\n      onUndo,\n      onRedo,\n      undoLength,\n      redoLength,\n      onChange,\n      onSave,\n      updateCss,\n      editMode,\n      isPublished,\n      user,\n      dashboardInfo,\n      hasUnsavedChanges,\n      isLoading,\n      refreshFrequency,\n      shouldPersistRefreshFrequency,\n      setRefreshFrequency,\n      lastModifiedTime,\n      logEvent\n    } = this.props;\n\n    const userCanEdit =\n    dashboardInfo.dash_edit_perm && !dashboardInfo.is_managed_externally;\n    const userCanShare = dashboardInfo.dash_share_perm;\n    const userCanSaveAs = dashboardInfo.dash_save_perm;\n    const userCanCurate =\n    isFeatureEnabled(FeatureFlag.EmbeddedSuperset) &&\n    findPermission('can_set_embedded', 'Dashboard', user.roles);\n    const refreshLimit = (_dashboardInfo$common3 =\n    dashboardInfo.common) == null ? void 0 : (_dashboardInfo$common4 = _dashboardInfo$common3.conf) == null ? void 0 : _dashboardInfo$common4.SUPERSET_DASHBOARD_PERIODICAL_REFRESH_LIMIT;\n    const refreshWarning = (_dashboardInfo$common5 =\n    dashboardInfo.common) == null ? void 0 : (_dashboardInfo$common6 = _dashboardInfo$common5.conf) == null ? void 0 : _dashboardInfo$common6.\n    SUPERSET_DASHBOARD_PERIODICAL_REFRESH_WARNING_MESSAGE;\n\n    const handleOnPropertiesChange = (updates) => {\n      const { dashboardInfoChanged, dashboardTitleChanged } = this.props;\n\n      setColorScheme(updates.colorScheme);\n      dashboardInfoChanged({\n        slug: updates.slug,\n        metadata: JSON.parse(updates.jsonMetadata || '{}'),\n        certified_by: updates.certifiedBy,\n        certification_details: updates.certificationDetails,\n        owners: updates.owners,\n        roles: updates.roles\n      });\n      setUnsavedChanges(true);\n      dashboardTitleChanged(updates.title);\n    };\n\n    const NavExtension = extensionsRegistry.get('dashboard.nav.right');\n\n    return (\n      _jsxs(\"div\", {\n        css: headerContainerStyle,\n        \"data-test\": \"dashboard-header-container\",\n        \"data-test-id\": dashboardInfo.id,\n        className: \"dashboard-header-container\", children: [\n\n        _jsx(PageHeaderWithActions, {\n          editableTitleProps: {\n            title: dashboardTitle,\n            canEdit: userCanEdit && editMode,\n            onSave: this.handleChangeText,\n            placeholder: t('Add the name of the dashboard'),\n            label: t('Dashboard title'),\n            showTooltip: false\n          },\n          certificatiedBadgeProps: {\n            certifiedBy: dashboardInfo.certified_by,\n            details: dashboardInfo.certification_details\n          },\n          faveStarProps: {\n            itemId: dashboardInfo.id,\n            fetchFaveStar: this.props.fetchFaveStar,\n            saveFaveStar: this.props.saveFaveStar,\n            isStarred: this.props.isStarred,\n            showTooltip: true\n          },\n          titlePanelAdditionalItems: [\n          !editMode &&\n          _jsx(PublishedStatus, {\n            dashboardId: dashboardInfo.id,\n            isPublished: isPublished,\n            savePublished: this.props.savePublished,\n            canEdit: userCanEdit,\n            canSave: userCanSaveAs,\n            visible: !editMode }\n          ),\n\n          !editMode &&\n          _jsx(MetadataBar, {\n            items: this.getMetadataItems(),\n            tooltipPlacement: \"bottom\" }\n          )],\n\n\n          rightPanelAdditionalItems:\n          _jsxs(\"div\", { className: \"button-container\", children: [\n            userCanSaveAs &&\n            _jsx(\"div\", {\n              className: \"button-container\",\n              \"data-test\": \"dashboard-edit-actions\", children:\n\n              editMode &&\n              _jsxs(\"div\", { css: actionButtonsStyle, children: [\n                _jsxs(\"div\", { className: \"undoRedo\", children: [\n                  _jsx(Tooltip, {\n                    id: \"dashboard-undo-tooltip\",\n                    title: t('Undo the action'), children:\n\n                    _jsx(StyledUndoRedoButton, {\n                      type: \"text\",\n                      disabled: undoLength < 1,\n                      onClick: undoLength && onUndo, children:\n\n                      _jsx(Icons.Undo, {\n                        css: [\n                        undoRedoStyle,\n                        this.state.emphasizeUndo && undoRedoEmphasized,\n                        undoLength < 1 && undoRedoDisabled, process.env.NODE_ENV === \"production\" ? \"\" : \";label:Header;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL0hlYWRlci9pbmRleC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBc2tCOEIiLCJmaWxlIjoiL2FwcC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvSGVhZGVyL2luZGV4LmpzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qIGVzbGludC1lbnYgYnJvd3NlciAqL1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQge1xuICBzdHlsZWQsXG4gIGNzcyxcbiAgaXNGZWF0dXJlRW5hYmxlZCxcbiAgRmVhdHVyZUZsYWcsXG4gIHQsXG4gIGdldEV4dGVuc2lvbnNSZWdpc3RyeSxcbn0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHsgR2xvYmFsIH0gZnJvbSAnQGVtb3Rpb24vcmVhY3QnO1xuaW1wb3J0IHtcbiAgTE9HX0FDVElPTlNfUEVSSU9ESUNfUkVOREVSX0RBU0hCT0FSRCxcbiAgTE9HX0FDVElPTlNfRk9SQ0VfUkVGUkVTSF9EQVNIQk9BUkQsXG4gIExPR19BQ1RJT05TX1RPR0dMRV9FRElUX0RBU0hCT0FSRCxcbn0gZnJvbSAnc3JjL2xvZ2dlci9Mb2dVdGlscyc7XG5pbXBvcnQgSWNvbnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvSWNvbnMnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IHsgQW50ZEJ1dHRvbiB9IGZyb20gJ3NyYy9jb21wb25lbnRzLyc7XG5pbXBvcnQgeyBmaW5kUGVybWlzc2lvbiB9IGZyb20gJ3NyYy91dGlscy9maW5kUGVybWlzc2lvbic7XG5pbXBvcnQgeyBUb29sdGlwIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvVG9vbHRpcCc7XG5pbXBvcnQgeyBzYWZlU3RyaW5naWZ5IH0gZnJvbSAnc3JjL3V0aWxzL3NhZmVTdHJpbmdpZnknO1xuaW1wb3J0IENvbm5lY3RlZEhlYWRlckFjdGlvbnNEcm9wZG93biBmcm9tICdzcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvSGVhZGVyL0hlYWRlckFjdGlvbnNEcm9wZG93bic7XG5pbXBvcnQgUHVibGlzaGVkU3RhdHVzIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9QdWJsaXNoZWRTdGF0dXMnO1xuaW1wb3J0IFVuZG9SZWRvS2V5TGlzdGVuZXJzIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9VbmRvUmVkb0tleUxpc3RlbmVycyc7XG5pbXBvcnQgUHJvcGVydGllc01vZGFsIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9Qcm9wZXJ0aWVzTW9kYWwnO1xuaW1wb3J0IHsgY2hhcnRQcm9wU2hhcGUgfSBmcm9tICdzcmMvZGFzaGJvYXJkL3V0aWwvcHJvcFNoYXBlcyc7XG5pbXBvcnQgZ2V0T3duZXJOYW1lIGZyb20gJ3NyYy91dGlscy9nZXRPd25lck5hbWUnO1xuaW1wb3J0IHtcbiAgVU5ET19MSU1JVCxcbiAgU0FWRV9UWVBFX09WRVJXUklURSxcbiAgREFTSEJPQVJEX1BPU0lUSU9OX0RBVEFfTElNSVQsXG59IGZyb20gJ3NyYy9kYXNoYm9hcmQvdXRpbC9jb25zdGFudHMnO1xuaW1wb3J0IHNldFBlcmlvZGljUnVubmVyLCB7XG4gIHN0b3BQZXJpb2RpY1JlbmRlcixcbn0gZnJvbSAnc3JjL2Rhc2hib2FyZC91dGlsL3NldFBlcmlvZGljUnVubmVyJztcbmltcG9ydCB7IFBhZ2VIZWFkZXJXaXRoQWN0aW9ucyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL1BhZ2VIZWFkZXJXaXRoQWN0aW9ucyc7XG5pbXBvcnQgTWV0YWRhdGFCYXIsIHsgTWV0YWRhdGFUeXBlIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvTWV0YWRhdGFCYXInO1xuaW1wb3J0IERhc2hib2FyZEVtYmVkTW9kYWwgZnJvbSAnLi4vRW1iZWRkZWRNb2RhbCc7XG5pbXBvcnQgT3ZlcndyaXRlQ29uZmlybSBmcm9tICcuLi9PdmVyd3JpdGVDb25maXJtJztcblxuY29uc3QgZXh0ZW5zaW9uc1JlZ2lzdHJ5ID0gZ2V0RXh0ZW5zaW9uc1JlZ2lzdHJ5KCk7XG5cbmNvbnN0IHByb3BUeXBlcyA9IHtcbiAgYWRkU3VjY2Vzc1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBhZGREYW5nZXJUb2FzdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgYWRkV2FybmluZ1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB1c2VyOiBQcm9wVHlwZXMub2JqZWN0LCAvLyBVc2VyV2l0aFBlcm1pc3Npb25zQW5kUm9sZXMsXG4gIGRhc2hib2FyZEluZm86IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgZGFzaGJvYXJkVGl0bGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGRhdGFNYXNrOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIGNoYXJ0czogUHJvcFR5cGVzLm9iamVjdE9mKGNoYXJ0UHJvcFNoYXBlKS5pc1JlcXVpcmVkLFxuICBsYXlvdXQ6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgZXhwYW5kZWRTbGljZXM6IFByb3BUeXBlcy5vYmplY3QsXG4gIGN1c3RvbUNzczogUHJvcFR5cGVzLnN0cmluZyxcbiAgY29sb3JOYW1lc3BhY2U6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGNvbG9yU2NoZW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBzZXRDb2xvclNjaGVtZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2V0VW5zYXZlZENoYW5nZXM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGlzU3RhcnJlZDogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgaXNQdWJsaXNoZWQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gIGlzTG9hZGluZzogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgb25TYXZlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZmV0Y2hGYXZlU3RhcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZmV0Y2hDaGFydHM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIHNhdmVGYXZlU3RhcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2F2ZVB1Ymxpc2hlZDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgdXBkYXRlRGFzaGJvYXJkVGl0bGU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGVkaXRNb2RlOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICBzZXRFZGl0TW9kZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2hvd0J1aWxkZXJQYW5lOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB1cGRhdGVDc3M6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGxvZ0V2ZW50OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBoYXNVbnNhdmVkQ2hhbmdlczogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgbWF4VW5kb0hpc3RvcnlFeGNlZWRlZDogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgbGFzdE1vZGlmaWVkVGltZTogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuXG4gIC8vIHJlZHV4XG4gIG9uUmVmcmVzaDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25VbmRvOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvblJlZG86IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIHVuZG9MZW5ndGg6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgcmVkb0xlbmd0aDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICBzZXRNYXhVbmRvSGlzdG9yeUV4Y2VlZGVkOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBtYXhVbmRvSGlzdG9yeVRvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICByZWZyZXNoRnJlcXVlbmN5OiBQcm9wVHlwZXMubnVtYmVyLFxuICBzaG91bGRQZXJzaXN0UmVmcmVzaEZyZXF1ZW5jeTogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgc2V0UmVmcmVzaEZyZXF1ZW5jeTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZGFzaGJvYXJkSW5mb0NoYW5nZWQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGRhc2hib2FyZFRpdGxlQ2hhbmdlZDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgY29sb3JOYW1lc3BhY2U6IHVuZGVmaW5lZCxcbiAgY29sb3JTY2hlbWU6IHVuZGVmaW5lZCxcbn07XG5cbmNvbnN0IGhlYWRlckNvbnRhaW5lclN0eWxlID0gdGhlbWUgPT4gY3NzYFxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG5gO1xuXG5jb25zdCBlZGl0QnV0dG9uU3R5bGUgPSB0aGVtZSA9PiBjc3NgXG4gIGNvbG9yOiAke3RoZW1lLmNvbG9ycy5wcmltYXJ5LmRhcmsyfTtcbmA7XG5cbmNvbnN0IGFjdGlvbkJ1dHRvbnNTdHlsZSA9IHRoZW1lID0+IGNzc2BcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcblxuICAuYWN0aW9uLXNjaGVkdWxlLXJlcG9ydCB7XG4gICAgbWFyZ2luLWxlZnQ6ICR7dGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICB9XG5cbiAgLnVuZG9SZWRvIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIG1hcmdpbi1yaWdodDogJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZFVuZG9SZWRvQnV0dG9uID0gc3R5bGVkKEFudGRCdXR0b24pYFxuICBwYWRkaW5nOiAwO1xuICAmOmhvdmVyIHtcbiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgfVxuYDtcblxuY29uc3QgdW5kb1JlZG9TdHlsZSA9IHRoZW1lID0+IGNzc2BcbiAgY29sb3I6ICR7dGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDF9O1xuICAmOmhvdmVyIHtcbiAgICBjb2xvcjogJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9O1xuICB9XG5gO1xuXG5jb25zdCB1bmRvUmVkb0VtcGhhc2l6ZWQgPSB0aGVtZSA9PiBjc3NgXG4gIGNvbG9yOiAke3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG5gO1xuXG5jb25zdCB1bmRvUmVkb0Rpc2FibGVkID0gdGhlbWUgPT4gY3NzYFxuICBjb2xvcjogJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG5gO1xuXG5jb25zdCBzYXZlQnRuU3R5bGUgPSB0aGVtZSA9PiBjc3NgXG4gIG1pbi13aWR0aDogJHt0aGVtZS5ncmlkVW5pdCAqIDE3fXB4O1xuICBoZWlnaHQ6ICR7dGhlbWUuZ3JpZFVuaXQgKiA4fXB4O1xuYDtcblxuY29uc3QgZGlzY2FyZEJ0blN0eWxlID0gdGhlbWUgPT4gY3NzYFxuICBtaW4td2lkdGg6ICR7dGhlbWUuZ3JpZFVuaXQgKiAyMn1weDtcbiAgaGVpZ2h0OiAke3RoZW1lLmdyaWRVbml0ICogOH1weDtcbmA7XG5cbmNsYXNzIEhlYWRlciBleHRlbmRzIFB1cmVDb21wb25lbnQge1xuICBzdGF0aWMgZGlzY2FyZENoYW5nZXMoKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cbiAgICB1cmwuc2VhcmNoUGFyYW1zLmRlbGV0ZSgnZWRpdCcpO1xuICAgIHdpbmRvdy5sb2NhdGlvbi5hc3NpZ24odXJsKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBkaWROb3RpZnlNYXhVbmRvSGlzdG9yeVRvYXN0OiBmYWxzZSxcbiAgICAgIGVtcGhhc2l6ZVVuZG86IGZhbHNlLFxuICAgICAgZW1waGFzaXplUmVkbzogZmFsc2UsXG4gICAgICBzaG93aW5nUHJvcGVydGllc01vZGFsOiBmYWxzZSxcbiAgICAgIGlzRHJvcGRvd25WaXNpYmxlOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgdGhpcy5oYW5kbGVDaGFuZ2VUZXh0ID0gdGhpcy5oYW5kbGVDaGFuZ2VUZXh0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5oYW5kbGVDdHJsWiA9IHRoaXMuaGFuZGxlQ3RybFouYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZUN0cmxZID0gdGhpcy5oYW5kbGVDdHJsWS5iaW5kKHRoaXMpO1xuICAgIHRoaXMudG9nZ2xlRWRpdE1vZGUgPSB0aGlzLnRvZ2dsZUVkaXRNb2RlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5mb3JjZVJlZnJlc2ggPSB0aGlzLmZvcmNlUmVmcmVzaC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlciA9IHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlci5iaW5kKHRoaXMpO1xuICAgIHRoaXMub3ZlcndyaXRlRGFzaGJvYXJkID0gdGhpcy5vdmVyd3JpdGVEYXNoYm9hcmQuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNob3dQcm9wZXJ0aWVzTW9kYWwgPSB0aGlzLnNob3dQcm9wZXJ0aWVzTW9kYWwuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhpZGVQcm9wZXJ0aWVzTW9kYWwgPSB0aGlzLmhpZGVQcm9wZXJ0aWVzTW9kYWwuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldElzRHJvcGRvd25WaXNpYmxlID0gdGhpcy5zZXRJc0Ryb3Bkb3duVmlzaWJsZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgY29uc3QgeyByZWZyZXNoRnJlcXVlbmN5IH0gPSB0aGlzLnByb3BzO1xuICAgIHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlcihyZWZyZXNoRnJlcXVlbmN5ICogMTAwMCk7XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XG4gICAgaWYgKHRoaXMucHJvcHMucmVmcmVzaEZyZXF1ZW5jeSAhPT0gcHJldlByb3BzLnJlZnJlc2hGcmVxdWVuY3kpIHtcbiAgICAgIGNvbnN0IHsgcmVmcmVzaEZyZXF1ZW5jeSB9ID0gdGhpcy5wcm9wcztcbiAgICAgIHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlcihyZWZyZXNoRnJlcXVlbmN5ICogMTAwMCk7XG4gICAgfVxuICB9XG5cbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgaWYgKFxuICAgICAgVU5ET19MSU1JVCAtIG5leHRQcm9wcy51bmRvTGVuZ3RoIDw9IDAgJiZcbiAgICAgICF0aGlzLnN0YXRlLmRpZE5vdGlmeU1heFVuZG9IaXN0b3J5VG9hc3RcbiAgICApIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoKCkgPT4gKHsgZGlkTm90aWZ5TWF4VW5kb0hpc3RvcnlUb2FzdDogdHJ1ZSB9KSk7XG4gICAgICB0aGlzLnByb3BzLm1heFVuZG9IaXN0b3J5VG9hc3QoKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgbmV4dFByb3BzLnVuZG9MZW5ndGggPiBVTkRPX0xJTUlUICYmXG4gICAgICAhdGhpcy5wcm9wcy5tYXhVbmRvSGlzdG9yeUV4Y2VlZGVkXG4gICAgKSB7XG4gICAgICB0aGlzLnByb3BzLnNldE1heFVuZG9IaXN0b3J5RXhjZWVkZWQoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBzdG9wUGVyaW9kaWNSZW5kZXIodGhpcy5yZWZyZXNoVGltZXIpO1xuICAgIHRoaXMucHJvcHMuc2V0UmVmcmVzaEZyZXF1ZW5jeSgwKTtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5jdHJsWVRpbWVvdXQpO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLmN0cmxaVGltZW91dCk7XG4gIH1cblxuICBoYW5kbGVDaGFuZ2VUZXh0KG5leHRUZXh0KSB7XG4gICAgY29uc3QgeyB1cGRhdGVEYXNoYm9hcmRUaXRsZSwgb25DaGFuZ2UgfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKG5leHRUZXh0ICYmIHRoaXMucHJvcHMuZGFzaGJvYXJkVGl0bGUgIT09IG5leHRUZXh0KSB7XG4gICAgICB1cGRhdGVEYXNoYm9hcmRUaXRsZShuZXh0VGV4dCk7XG4gICAgICBvbkNoYW5nZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldElzRHJvcGRvd25WaXNpYmxlKHZpc2libGUpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGlzRHJvcGRvd25WaXNpYmxlOiB2aXNpYmxlLFxuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlQ3RybFkoKSB7XG4gICAgdGhpcy5wcm9wcy5vblJlZG8oKTtcbiAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplUmVkbzogdHJ1ZSB9LCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5jdHJsWVRpbWVvdXQpIGNsZWFyVGltZW91dCh0aGlzLmN0cmxZVGltZW91dCk7XG4gICAgICB0aGlzLmN0cmxZVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplUmVkbzogZmFsc2UgfSk7XG4gICAgICB9LCAxMDApO1xuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlQ3RybFooKSB7XG4gICAgdGhpcy5wcm9wcy5vblVuZG8oKTtcbiAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplVW5kbzogdHJ1ZSB9LCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5jdHJsWlRpbWVvdXQpIGNsZWFyVGltZW91dCh0aGlzLmN0cmxaVGltZW91dCk7XG4gICAgICB0aGlzLmN0cmxaVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplVW5kbzogZmFsc2UgfSk7XG4gICAgICB9LCAxMDApO1xuICAgIH0pO1xuICB9XG5cbiAgZm9yY2VSZWZyZXNoKCkge1xuICAgIGlmICghdGhpcy5wcm9wcy5pc0xvYWRpbmcpIHtcbiAgICAgIGNvbnN0IGNoYXJ0TGlzdCA9IE9iamVjdC5rZXlzKHRoaXMucHJvcHMuY2hhcnRzKTtcbiAgICAgIHRoaXMucHJvcHMubG9nRXZlbnQoTE9HX0FDVElPTlNfRk9SQ0VfUkVGUkVTSF9EQVNIQk9BUkQsIHtcbiAgICAgICAgZm9yY2U6IHRydWUsXG4gICAgICAgIGludGVydmFsOiAwLFxuICAgICAgICBjaGFydENvdW50OiBjaGFydExpc3QubGVuZ3RoLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcy5wcm9wcy5vblJlZnJlc2goXG4gICAgICAgIGNoYXJ0TGlzdCxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICAgMCxcbiAgICAgICAgdGhpcy5wcm9wcy5kYXNoYm9hcmRJbmZvLmlkLFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgc3RhcnRQZXJpb2RpY1JlbmRlcihpbnRlcnZhbCkge1xuICAgIGxldCBpbnRlcnZhbE1lc3NhZ2U7XG5cbiAgICBpZiAoaW50ZXJ2YWwpIHtcbiAgICAgIGNvbnN0IHsgZGFzaGJvYXJkSW5mbyB9ID0gdGhpcy5wcm9wcztcbiAgICAgIGNvbnN0IHBlcmlvZGljUmVmcmVzaE9wdGlvbnMgPVxuICAgICAgICBkYXNoYm9hcmRJbmZvLmNvbW1vbj8uY29uZj8uREFTSEJPQVJEX0FVVE9fUkVGUkVTSF9JTlRFUlZBTFM7XG4gICAgICBjb25zdCBwcmVkZWZpbmVkVmFsdWUgPSBwZXJpb2RpY1JlZnJlc2hPcHRpb25zLmZpbmQoXG4gICAgICAgIG9wdGlvbiA9PiBOdW1iZXIob3B0aW9uWzBdKSA9PT0gaW50ZXJ2YWwgLyAxMDAwLFxuICAgICAgKTtcblxuICAgICAgaWYgKHByZWRlZmluZWRWYWx1ZSkge1xuICAgICAgICBpbnRlcnZhbE1lc3NhZ2UgPSB0KHByZWRlZmluZWRWYWx1ZVsxXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnRlcnZhbE1lc3NhZ2UgPSBtb21lbnQuZHVyYXRpb24oaW50ZXJ2YWwsICdtaWxsaXNlY29uZCcpLmh1bWFuaXplKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcGVyaW9kaWNSZW5kZXIgPSAoKSA9PiB7XG4gICAgICBjb25zdCB7IGZldGNoQ2hhcnRzLCBsb2dFdmVudCwgY2hhcnRzLCBkYXNoYm9hcmRJbmZvIH0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3QgeyBtZXRhZGF0YSB9ID0gZGFzaGJvYXJkSW5mbztcbiAgICAgIGNvbnN0IGltbXVuZSA9IG1ldGFkYXRhLnRpbWVkX3JlZnJlc2hfaW1tdW5lX3NsaWNlcyB8fCBbXTtcbiAgICAgIGNvbnN0IGFmZmVjdGVkQ2hhcnRzID0gT2JqZWN0LnZhbHVlcyhjaGFydHMpXG4gICAgICAgIC5maWx0ZXIoY2hhcnQgPT4gaW1tdW5lLmluZGV4T2YoY2hhcnQuaWQpID09PSAtMSlcbiAgICAgICAgLm1hcChjaGFydCA9PiBjaGFydC5pZCk7XG5cbiAgICAgIGxvZ0V2ZW50KExPR19BQ1RJT05TX1BFUklPRElDX1JFTkRFUl9EQVNIQk9BUkQsIHtcbiAgICAgICAgaW50ZXJ2YWwsXG4gICAgICAgIGNoYXJ0Q291bnQ6IGFmZmVjdGVkQ2hhcnRzLmxlbmd0aCxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5wcm9wcy5hZGRXYXJuaW5nVG9hc3QoXG4gICAgICAgIHQoXG4gICAgICAgICAgYFRoaXMgZGFzaGJvYXJkIGlzIGN1cnJlbnRseSBhdXRvIHJlZnJlc2hpbmc7IHRoZSBuZXh0IGF1dG8gcmVmcmVzaCB3aWxsIGJlIGluICVzLmAsXG4gICAgICAgICAgaW50ZXJ2YWxNZXNzYWdlLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICAgIGlmIChkYXNoYm9hcmRJbmZvLmNvbW1vbi5jb25mLkRBU0hCT0FSRF9BVVRPX1JFRlJFU0hfTU9ERSA9PT0gJ2ZldGNoJykge1xuICAgICAgICAvLyBmb3JjZS1yZWZyZXNoIHdoaWxlIGF1dG8tcmVmcmVzaCBpbiBkYXNoYm9hcmRcbiAgICAgICAgcmV0dXJuIGZldGNoQ2hhcnRzKFxuICAgICAgICAgIGFmZmVjdGVkQ2hhcnRzLFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgIGludGVydmFsICogMC4yLFxuICAgICAgICAgIGRhc2hib2FyZEluZm8uaWQsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmV0Y2hDaGFydHMoXG4gICAgICAgIGFmZmVjdGVkQ2hhcnRzLFxuICAgICAgICB0cnVlLFxuICAgICAgICBpbnRlcnZhbCAqIDAuMixcbiAgICAgICAgZGFzaGJvYXJkSW5mby5pZCxcbiAgICAgICk7XG4gICAgfTtcblxuICAgIHRoaXMucmVmcmVzaFRpbWVyID0gc2V0UGVyaW9kaWNSdW5uZXIoe1xuICAgICAgaW50ZXJ2YWwsXG4gICAgICBwZXJpb2RpY1JlbmRlcixcbiAgICAgIHJlZnJlc2hUaW1lcjogdGhpcy5yZWZyZXNoVGltZXIsXG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVFZGl0TW9kZSgpIHtcbiAgICB0aGlzLnByb3BzLmxvZ0V2ZW50KExPR19BQ1RJT05TX1RPR0dMRV9FRElUX0RBU0hCT0FSRCwge1xuICAgICAgZWRpdF9tb2RlOiAhdGhpcy5wcm9wcy5lZGl0TW9kZSxcbiAgICB9KTtcbiAgICB0aGlzLnByb3BzLnNldEVkaXRNb2RlKCF0aGlzLnByb3BzLmVkaXRNb2RlKTtcbiAgfVxuXG4gIG92ZXJ3cml0ZURhc2hib2FyZCgpIHtcbiAgICBjb25zdCB7XG4gICAgICBkYXNoYm9hcmRUaXRsZSxcbiAgICAgIGxheW91dDogcG9zaXRpb25zLFxuICAgICAgY29sb3JTY2hlbWUsXG4gICAgICBjb2xvck5hbWVzcGFjZSxcbiAgICAgIGN1c3RvbUNzcyxcbiAgICAgIGRhc2hib2FyZEluZm8sXG4gICAgICByZWZyZXNoRnJlcXVlbmN5OiBjdXJyZW50UmVmcmVzaEZyZXF1ZW5jeSxcbiAgICAgIHNob3VsZFBlcnNpc3RSZWZyZXNoRnJlcXVlbmN5LFxuICAgICAgbGFzdE1vZGlmaWVkVGltZSxcbiAgICAgIHNsdWcsXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAvLyBjaGVjayByZWZyZXNoIGZyZXF1ZW5jeSBpcyBmb3IgY3VycmVudCBzZXNzaW9uIG9yIHBlcnNpc3RcbiAgICBjb25zdCByZWZyZXNoRnJlcXVlbmN5ID0gc2hvdWxkUGVyc2lzdFJlZnJlc2hGcmVxdWVuY3lcbiAgICAgID8gY3VycmVudFJlZnJlc2hGcmVxdWVuY3lcbiAgICAgIDogZGFzaGJvYXJkSW5mby5tZXRhZGF0YT8ucmVmcmVzaF9mcmVxdWVuY3k7XG5cbiAgICBjb25zdCBjdXJyZW50Q29sb3JOYW1lc3BhY2UgPVxuICAgICAgZGFzaGJvYXJkSW5mbz8ubWV0YWRhdGE/LmNvbG9yX25hbWVzcGFjZSB8fCBjb2xvck5hbWVzcGFjZTtcbiAgICBjb25zdCBjdXJyZW50Q29sb3JTY2hlbWUgPVxuICAgICAgZGFzaGJvYXJkSW5mbz8ubWV0YWRhdGE/LmNvbG9yX3NjaGVtZSB8fCBjb2xvclNjaGVtZTtcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBjZXJ0aWZpZWRfYnk6IGRhc2hib2FyZEluZm8uY2VydGlmaWVkX2J5LFxuICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBkYXNoYm9hcmRJbmZvLmNlcnRpZmljYXRpb25fZGV0YWlscyxcbiAgICAgIGNzczogY3VzdG9tQ3NzLFxuICAgICAgZGFzaGJvYXJkX3RpdGxlOiBkYXNoYm9hcmRUaXRsZSxcbiAgICAgIGxhc3RfbW9kaWZpZWRfdGltZTogbGFzdE1vZGlmaWVkVGltZSxcbiAgICAgIG93bmVyczogZGFzaGJvYXJkSW5mby5vd25lcnMsXG4gICAgICByb2xlczogZGFzaGJvYXJkSW5mby5yb2xlcyxcbiAgICAgIHNsdWcsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICAuLi5kYXNoYm9hcmRJbmZvPy5tZXRhZGF0YSxcbiAgICAgICAgY29sb3JfbmFtZXNwYWNlOiBjdXJyZW50Q29sb3JOYW1lc3BhY2UsXG4gICAgICAgIGNvbG9yX3NjaGVtZTogY3VycmVudENvbG9yU2NoZW1lLFxuICAgICAgICBwb3NpdGlvbnMsXG4gICAgICAgIHJlZnJlc2hfZnJlcXVlbmN5OiByZWZyZXNoRnJlcXVlbmN5LFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgLy8gbWFrZSBzdXJlIHBvc2l0aW9ucyBkYXRhIGxlc3MgdGhhbiBEQiBzdG9yYWdlIGxpbWl0YXRpb246XG4gICAgY29uc3QgcG9zaXRpb25KU09OTGVuZ3RoID0gc2FmZVN0cmluZ2lmeShwb3NpdGlvbnMpLmxlbmd0aDtcbiAgICBjb25zdCBsaW1pdCA9XG4gICAgICBkYXNoYm9hcmRJbmZvLmNvbW1vbi5jb25mLlNVUEVSU0VUX0RBU0hCT0FSRF9QT1NJVElPTl9EQVRBX0xJTUlUIHx8XG4gICAgICBEQVNIQk9BUkRfUE9TSVRJT05fREFUQV9MSU1JVDtcbiAgICBpZiAocG9zaXRpb25KU09OTGVuZ3RoID49IGxpbWl0KSB7XG4gICAgICB0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0KFxuICAgICAgICB0KFxuICAgICAgICAgICdZb3VyIGRhc2hib2FyZCBpcyB0b28gbGFyZ2UuIFBsZWFzZSByZWR1Y2UgaXRzIHNpemUgYmVmb3JlIHNhdmluZyBpdC4nLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHBvc2l0aW9uSlNPTkxlbmd0aCA+PSBsaW1pdCAqIDAuOSkge1xuICAgICAgICB0aGlzLnByb3BzLmFkZFdhcm5pbmdUb2FzdCgnWW91ciBkYXNoYm9hcmQgaXMgbmVhciB0aGUgc2l6ZSBsaW1pdC4nKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5wcm9wcy5vblNhdmUoZGF0YSwgZGFzaGJvYXJkSW5mby5pZCwgU0FWRV9UWVBFX09WRVJXUklURSk7XG4gICAgfVxuICB9XG5cbiAgc2hvd1Byb3BlcnRpZXNNb2RhbCgpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgc2hvd2luZ1Byb3BlcnRpZXNNb2RhbDogdHJ1ZSB9KTtcbiAgfVxuXG4gIGhpZGVQcm9wZXJ0aWVzTW9kYWwoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dpbmdQcm9wZXJ0aWVzTW9kYWw6IGZhbHNlIH0pO1xuICB9XG5cbiAgc2hvd0VtYmVkTW9kYWwgPSAoKSA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dpbmdFbWJlZE1vZGFsOiB0cnVlIH0pO1xuICB9O1xuXG4gIGhpZGVFbWJlZE1vZGFsID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBzaG93aW5nRW1iZWRNb2RhbDogZmFsc2UgfSk7XG4gIH07XG5cbiAgZ2V0TWV0YWRhdGFJdGVtcyA9ICgpID0+IHtcbiAgICBjb25zdCB7IGRhc2hib2FyZEluZm8gfSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogTWV0YWRhdGFUeXBlLkxhc3RNb2RpZmllZCxcbiAgICAgICAgdmFsdWU6IGRhc2hib2FyZEluZm8uY2hhbmdlZF9vbl9kZWx0YV9odW1hbml6ZWQsXG4gICAgICAgIG1vZGlmaWVkQnk6XG4gICAgICAgICAgZ2V0T3duZXJOYW1lKGRhc2hib2FyZEluZm8uY2hhbmdlZF9ieSkgfHwgdCgnTm90IGF2YWlsYWJsZScpLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogTWV0YWRhdGFUeXBlLk93bmVyLFxuICAgICAgICBjcmVhdGVkQnk6IGdldE93bmVyTmFtZShkYXNoYm9hcmRJbmZvLmNyZWF0ZWRfYnkpIHx8IHQoJ05vdCBhdmFpbGFibGUnKSxcbiAgICAgICAgb3duZXJzOlxuICAgICAgICAgIGRhc2hib2FyZEluZm8ub3duZXJzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgID8gZGFzaGJvYXJkSW5mby5vd25lcnMubWFwKGdldE93bmVyTmFtZSlcbiAgICAgICAgICAgIDogdCgnTm9uZScpLFxuICAgICAgICBjcmVhdGVkT246IGRhc2hib2FyZEluZm8uY3JlYXRlZF9vbl9kZWx0YV9odW1hbml6ZWQsXG4gICAgICB9LFxuICAgIF07XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGRhc2hib2FyZFRpdGxlLFxuICAgICAgbGF5b3V0LFxuICAgICAgZXhwYW5kZWRTbGljZXMsXG4gICAgICBjdXN0b21Dc3MsXG4gICAgICBjb2xvck5hbWVzcGFjZSxcbiAgICAgIGRhdGFNYXNrLFxuICAgICAgc2V0Q29sb3JTY2hlbWUsXG4gICAgICBzZXRVbnNhdmVkQ2hhbmdlcyxcbiAgICAgIGNvbG9yU2NoZW1lLFxuICAgICAgb25VbmRvLFxuICAgICAgb25SZWRvLFxuICAgICAgdW5kb0xlbmd0aCxcbiAgICAgIHJlZG9MZW5ndGgsXG4gICAgICBvbkNoYW5nZSxcbiAgICAgIG9uU2F2ZSxcbiAgICAgIHVwZGF0ZUNzcyxcbiAgICAgIGVkaXRNb2RlLFxuICAgICAgaXNQdWJsaXNoZWQsXG4gICAgICB1c2VyLFxuICAgICAgZGFzaGJvYXJkSW5mbyxcbiAgICAgIGhhc1Vuc2F2ZWRDaGFuZ2VzLFxuICAgICAgaXNMb2FkaW5nLFxuICAgICAgcmVmcmVzaEZyZXF1ZW5jeSxcbiAgICAgIHNob3VsZFBlcnNpc3RSZWZyZXNoRnJlcXVlbmN5LFxuICAgICAgc2V0UmVmcmVzaEZyZXF1ZW5jeSxcbiAgICAgIGxhc3RNb2RpZmllZFRpbWUsXG4gICAgICBsb2dFdmVudCxcbiAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IHVzZXJDYW5FZGl0ID1cbiAgICAgIGRhc2hib2FyZEluZm8uZGFzaF9lZGl0X3Blcm0gJiYgIWRhc2hib2FyZEluZm8uaXNfbWFuYWdlZF9leHRlcm5hbGx5O1xuICAgIGNvbnN0IHVzZXJDYW5TaGFyZSA9IGRhc2hib2FyZEluZm8uZGFzaF9zaGFyZV9wZXJtO1xuICAgIGNvbnN0IHVzZXJDYW5TYXZlQXMgPSBkYXNoYm9hcmRJbmZvLmRhc2hfc2F2ZV9wZXJtO1xuICAgIGNvbnN0IHVzZXJDYW5DdXJhdGUgPVxuICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbWJlZGRlZFN1cGVyc2V0KSAmJlxuICAgICAgZmluZFBlcm1pc3Npb24oJ2Nhbl9zZXRfZW1iZWRkZWQnLCAnRGFzaGJvYXJkJywgdXNlci5yb2xlcyk7XG4gICAgY29uc3QgcmVmcmVzaExpbWl0ID1cbiAgICAgIGRhc2hib2FyZEluZm8uY29tbW9uPy5jb25mPy5TVVBFUlNFVF9EQVNIQk9BUkRfUEVSSU9ESUNBTF9SRUZSRVNIX0xJTUlUO1xuICAgIGNvbnN0IHJlZnJlc2hXYXJuaW5nID1cbiAgICAgIGRhc2hib2FyZEluZm8uY29tbW9uPy5jb25mXG4gICAgICAgID8uU1VQRVJTRVRfREFTSEJPQVJEX1BFUklPRElDQUxfUkVGUkVTSF9XQVJOSU5HX01FU1NBR0U7XG5cbiAgICBjb25zdCBoYW5kbGVPblByb3BlcnRpZXNDaGFuZ2UgPSB1cGRhdGVzID0+IHtcbiAgICAgIGNvbnN0IHsgZGFzaGJvYXJkSW5mb0NoYW5nZWQsIGRhc2hib2FyZFRpdGxlQ2hhbmdlZCB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgc2V0Q29sb3JTY2hlbWUodXBkYXRlcy5jb2xvclNjaGVtZSk7XG4gICAgICBkYXNoYm9hcmRJbmZvQ2hhbmdlZCh7XG4gICAgICAgIHNsdWc6IHVwZGF0ZXMuc2x1ZyxcbiAgICAgICAgbWV0YWRhdGE6IEpTT04ucGFyc2UodXBkYXRlcy5qc29uTWV0YWRhdGEgfHwgJ3t9JyksXG4gICAgICAgIGNlcnRpZmllZF9ieTogdXBkYXRlcy5jZXJ0aWZpZWRCeSxcbiAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiB1cGRhdGVzLmNlcnRpZmljYXRpb25EZXRhaWxzLFxuICAgICAgICBvd25lcnM6IHVwZGF0ZXMub3duZXJzLFxuICAgICAgICByb2xlczogdXBkYXRlcy5yb2xlcyxcbiAgICAgIH0pO1xuICAgICAgc2V0VW5zYXZlZENoYW5nZXModHJ1ZSk7XG4gICAgICBkYXNoYm9hcmRUaXRsZUNoYW5nZWQodXBkYXRlcy50aXRsZSk7XG4gICAgfTtcblxuICAgIGNvbnN0IE5hdkV4dGVuc2lvbiA9IGV4dGVuc2lvbnNSZWdpc3RyeS5nZXQoJ2Rhc2hib2FyZC5uYXYucmlnaHQnKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIGNzcz17aGVhZGVyQ29udGFpbmVyU3R5bGV9XG4gICAgICAgIGRhdGEtdGVzdD1cImRhc2hib2FyZC1oZWFkZXItY29udGFpbmVyXCJcbiAgICAgICAgZGF0YS10ZXN0LWlkPXtkYXNoYm9hcmRJbmZvLmlkfVxuICAgICAgICBjbGFzc05hbWU9XCJkYXNoYm9hcmQtaGVhZGVyLWNvbnRhaW5lclwiXG4gICAgICA+XG4gICAgICAgIDxQYWdlSGVhZGVyV2l0aEFjdGlvbnNcbiAgICAgICAgICBlZGl0YWJsZVRpdGxlUHJvcHM9e3tcbiAgICAgICAgICAgIHRpdGxlOiBkYXNoYm9hcmRUaXRsZSxcbiAgICAgICAgICAgIGNhbkVkaXQ6IHVzZXJDYW5FZGl0ICYmIGVkaXRNb2RlLFxuICAgICAgICAgICAgb25TYXZlOiB0aGlzLmhhbmRsZUNoYW5nZVRleHQsXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogdCgnQWRkIHRoZSBuYW1lIG9mIHRoZSBkYXNoYm9hcmQnKSxcbiAgICAgICAgICAgIGxhYmVsOiB0KCdEYXNoYm9hcmQgdGl0bGUnKSxcbiAgICAgICAgICAgIHNob3dUb29sdGlwOiBmYWxzZSxcbiAgICAgICAgICB9fVxuICAgICAgICAgIGNlcnRpZmljYXRpZWRCYWRnZVByb3BzPXt7XG4gICAgICAgICAgICBjZXJ0aWZpZWRCeTogZGFzaGJvYXJkSW5mby5jZXJ0aWZpZWRfYnksXG4gICAgICAgICAgICBkZXRhaWxzOiBkYXNoYm9hcmRJbmZvLmNlcnRpZmljYXRpb25fZGV0YWlscyxcbiAgICAgICAgICB9fVxuICAgICAgICAgIGZhdmVTdGFyUHJvcHM9e3tcbiAgICAgICAgICAgIGl0ZW1JZDogZGFzaGJvYXJkSW5mby5pZCxcbiAgICAgICAgICAgIGZldGNoRmF2ZVN0YXI6IHRoaXMucHJvcHMuZmV0Y2hGYXZlU3RhcixcbiAgICAgICAgICAgIHNhdmVGYXZlU3RhcjogdGhpcy5wcm9wcy5zYXZlRmF2ZVN0YXIsXG4gICAgICAgICAgICBpc1N0YXJyZWQ6IHRoaXMucHJvcHMuaXNTdGFycmVkLFxuICAgICAgICAgICAgc2hvd1Rvb2x0aXA6IHRydWUsXG4gICAgICAgICAgfX1cbiAgICAgICAgICB0aXRsZVBhbmVsQWRkaXRpb25hbEl0ZW1zPXtbXG4gICAgICAgICAgICAhZWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgICA8UHVibGlzaGVkU3RhdHVzXG4gICAgICAgICAgICAgICAgZGFzaGJvYXJkSWQ9e2Rhc2hib2FyZEluZm8uaWR9XG4gICAgICAgICAgICAgICAgaXNQdWJsaXNoZWQ9e2lzUHVibGlzaGVkfVxuICAgICAgICAgICAgICAgIHNhdmVQdWJsaXNoZWQ9e3RoaXMucHJvcHMuc2F2ZVB1Ymxpc2hlZH1cbiAgICAgICAgICAgICAgICBjYW5FZGl0PXt1c2VyQ2FuRWRpdH1cbiAgICAgICAgICAgICAgICBjYW5TYXZlPXt1c2VyQ2FuU2F2ZUFzfVxuICAgICAgICAgICAgICAgIHZpc2libGU9eyFlZGl0TW9kZX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICksXG4gICAgICAgICAgICAhZWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgICA8TWV0YWRhdGFCYXJcbiAgICAgICAgICAgICAgICBpdGVtcz17dGhpcy5nZXRNZXRhZGF0YUl0ZW1zKCl9XG4gICAgICAgICAgICAgICAgdG9vbHRpcFBsYWNlbWVudD1cImJvdHRvbVwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIF19XG4gICAgICAgICAgcmlnaHRQYW5lbEFkZGl0aW9uYWxJdGVtcz17XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbi1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAge3VzZXJDYW5TYXZlQXMgJiYgKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ1dHRvbi1jb250YWluZXJcIlxuICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PVwiZGFzaGJvYXJkLWVkaXQtYWN0aW9uc1wiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAge2VkaXRNb2RlICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjc3M9e2FjdGlvbkJ1dHRvbnNTdHlsZX0+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1bmRvUmVkb1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJkYXNoYm9hcmQtdW5kby10b29sdGlwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e3QoJ1VuZG8gdGhlIGFjdGlvbicpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8U3R5bGVkVW5kb1JlZG9CdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3VuZG9MZW5ndGggPCAxfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3VuZG9MZW5ndGggJiYgb25VbmRvfVxuICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25zLlVuZG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzcz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRvUmVkb1N0eWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmVtcGhhc2l6ZVVuZG8gJiYgdW5kb1JlZG9FbXBoYXNpemVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRvTGVuZ3RoIDwgMSAmJiB1bmRvUmVkb0Rpc2FibGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD1cInVuZG8tYWN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25TaXplPVwieGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvU3R5bGVkVW5kb1JlZG9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImRhc2hib2FyZC1yZWRvLXRvb2x0aXBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17dCgnUmVkbyB0aGUgYWN0aW9uJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxTdHlsZWRVbmRvUmVkb0J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17cmVkb0xlbmd0aCA8IDF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17cmVkb0xlbmd0aCAmJiBvblJlZG99XG4gICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvbnMuUmVkb1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3NzPXtbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZG9SZWRvU3R5bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZW1waGFzaXplUmVkbyAmJiB1bmRvUmVkb0VtcGhhc2l6ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZG9MZW5ndGggPCAxICYmIHVuZG9SZWRvRGlzYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PVwicmVkby1hY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvblNpemU9XCJ4bFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TdHlsZWRVbmRvUmVkb0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3M9e2Rpc2NhcmRCdG5TdHlsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmNvbnN0cnVjdG9yLmRpc2NhcmRDaGFuZ2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uU3R5bGU9XCJkZWZhdWx0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD1cImRpc2NhcmQtY2hhbmdlcy1idXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD17dCgnRGlzY2FyZCcpfVxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0KCdEaXNjYXJkJyl9XG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzPXtzYXZlQnRuU3R5bGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b25TaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFoYXNVbnNhdmVkQ2hhbmdlc31cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm92ZXJ3cml0ZURhc2hib2FyZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD1cImhlYWRlci1zYXZlLWJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPXt0KCdTYXZlJyl9XG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge3QoJ1NhdmUnKX1cbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7ZWRpdE1vZGUgPyAoXG4gICAgICAgICAgICAgICAgPFVuZG9SZWRvS2V5TGlzdGVuZXJzXG4gICAgICAgICAgICAgICAgICBvblVuZG89e3RoaXMuaGFuZGxlQ3RybFp9XG4gICAgICAgICAgICAgICAgICBvblJlZG89e3RoaXMuaGFuZGxlQ3RybFl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNzcz17YWN0aW9uQnV0dG9uc1N0eWxlfT5cbiAgICAgICAgICAgICAgICAgIHtOYXZFeHRlbnNpb24gJiYgPE5hdkV4dGVuc2lvbiAvPn1cbiAgICAgICAgICAgICAgICAgIHt1c2VyQ2FuRWRpdCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBidXR0b25TdHlsZT1cInNlY29uZGFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy50b2dnbGVFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3Q9XCJlZGl0LWRhc2hib2FyZC1idXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFjdGlvbi1idXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgIGNzcz17ZWRpdEJ1dHRvblN0eWxlfVxuICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e3QoJ0VkaXQgZGFzaGJvYXJkJyl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICB7dCgnRWRpdCBkYXNoYm9hcmQnKX1cbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lbnVEcm9wZG93blByb3BzPXt7XG4gICAgICAgICAgICBnZXRQb3B1cENvbnRhaW5lcjogdHJpZ2dlck5vZGUgPT5cbiAgICAgICAgICAgICAgdHJpZ2dlck5vZGUuY2xvc2VzdCgnLmhlYWRlci13aXRoLWFjdGlvbnMnKSxcbiAgICAgICAgICAgIHZpc2libGU6IHRoaXMuc3RhdGUuaXNEcm9wZG93blZpc2libGUsXG4gICAgICAgICAgICBvblZpc2libGVDaGFuZ2U6IHRoaXMuc2V0SXNEcm9wZG93blZpc2libGUsXG4gICAgICAgICAgfX1cbiAgICAgICAgICBhZGRpdGlvbmFsQWN0aW9uc01lbnU9e1xuICAgICAgICAgICAgPENvbm5lY3RlZEhlYWRlckFjdGlvbnNEcm9wZG93blxuICAgICAgICAgICAgICBhZGRTdWNjZXNzVG9hc3Q9e3RoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0fVxuICAgICAgICAgICAgICBhZGREYW5nZXJUb2FzdD17dGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdH1cbiAgICAgICAgICAgICAgZGFzaGJvYXJkSWQ9e2Rhc2hib2FyZEluZm8uaWR9XG4gICAgICAgICAgICAgIGRhc2hib2FyZFRpdGxlPXtkYXNoYm9hcmRUaXRsZX1cbiAgICAgICAgICAgICAgZGFzaGJvYXJkSW5mbz17ZGFzaGJvYXJkSW5mb31cbiAgICAgICAgICAgICAgZGF0YU1hc2s9e2RhdGFNYXNrfVxuICAgICAgICAgICAgICBsYXlvdXQ9e2xheW91dH1cbiAgICAgICAgICAgICAgZXhwYW5kZWRTbGljZXM9e2V4cGFuZGVkU2xpY2VzfVxuICAgICAgICAgICAgICBjdXN0b21Dc3M9e2N1c3RvbUNzc31cbiAgICAgICAgICAgICAgY29sb3JOYW1lc3BhY2U9e2NvbG9yTmFtZXNwYWNlfVxuICAgICAgICAgICAgICBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9XG4gICAgICAgICAgICAgIG9uU2F2ZT17b25TYXZlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgIGZvcmNlUmVmcmVzaEFsbENoYXJ0cz17dGhpcy5mb3JjZVJlZnJlc2h9XG4gICAgICAgICAgICAgIHN0YXJ0UGVyaW9kaWNSZW5kZXI9e3RoaXMuc3RhcnRQZXJpb2RpY1JlbmRlcn1cbiAgICAgICAgICAgICAgcmVmcmVzaEZyZXF1ZW5jeT17cmVmcmVzaEZyZXF1ZW5jeX1cbiAgICAgICAgICAgICAgc2hvdWxkUGVyc2lzdFJlZnJlc2hGcmVxdWVuY3k9e3Nob3VsZFBlcnNpc3RSZWZyZXNoRnJlcXVlbmN5fVxuICAgICAgICAgICAgICBzZXRSZWZyZXNoRnJlcXVlbmN5PXtzZXRSZWZyZXNoRnJlcXVlbmN5fVxuICAgICAgICAgICAgICB1cGRhdGVDc3M9e3VwZGF0ZUNzc31cbiAgICAgICAgICAgICAgZWRpdE1vZGU9e2VkaXRNb2RlfVxuICAgICAgICAgICAgICBoYXNVbnNhdmVkQ2hhbmdlcz17aGFzVW5zYXZlZENoYW5nZXN9XG4gICAgICAgICAgICAgIHVzZXJDYW5FZGl0PXt1c2VyQ2FuRWRpdH1cbiAgICAgICAgICAgICAgdXNlckNhblNoYXJlPXt1c2VyQ2FuU2hhcmV9XG4gICAgICAgICAgICAgIHVzZXJDYW5TYXZlPXt1c2VyQ2FuU2F2ZUFzfVxuICAgICAgICAgICAgICB1c2VyQ2FuQ3VyYXRlPXt1c2VyQ2FuQ3VyYXRlfVxuICAgICAgICAgICAgICBpc0xvYWRpbmc9e2lzTG9hZGluZ31cbiAgICAgICAgICAgICAgc2hvd1Byb3BlcnRpZXNNb2RhbD17dGhpcy5zaG93UHJvcGVydGllc01vZGFsfVxuICAgICAgICAgICAgICBtYW5hZ2VFbWJlZGRlZD17dGhpcy5zaG93RW1iZWRNb2RhbH1cbiAgICAgICAgICAgICAgcmVmcmVzaExpbWl0PXtyZWZyZXNoTGltaXR9XG4gICAgICAgICAgICAgIHJlZnJlc2hXYXJuaW5nPXtyZWZyZXNoV2FybmluZ31cbiAgICAgICAgICAgICAgbGFzdE1vZGlmaWVkVGltZT17bGFzdE1vZGlmaWVkVGltZX1cbiAgICAgICAgICAgICAgaXNEcm9wZG93blZpc2libGU9e3RoaXMuc3RhdGUuaXNEcm9wZG93blZpc2libGV9XG4gICAgICAgICAgICAgIHNldElzRHJvcGRvd25WaXNpYmxlPXt0aGlzLnNldElzRHJvcGRvd25WaXNpYmxlfVxuICAgICAgICAgICAgICBsb2dFdmVudD17bG9nRXZlbnR9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIH1cbiAgICAgICAgICBzaG93RmF2ZVN0YXI9e3VzZXI/LnVzZXJJZCAmJiBkYXNoYm9hcmRJbmZvPy5pZH1cbiAgICAgICAgICBzaG93VGl0bGVQYW5lbEl0ZW1zXG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLnNob3dpbmdQcm9wZXJ0aWVzTW9kYWwgJiYgKFxuICAgICAgICAgIDxQcm9wZXJ0aWVzTW9kYWxcbiAgICAgICAgICAgIGRhc2hib2FyZElkPXtkYXNoYm9hcmRJbmZvLmlkfVxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mbz17ZGFzaGJvYXJkSW5mb31cbiAgICAgICAgICAgIGRhc2hib2FyZFRpdGxlPXtkYXNoYm9hcmRUaXRsZX1cbiAgICAgICAgICAgIHNob3c9e3RoaXMuc3RhdGUuc2hvd2luZ1Byb3BlcnRpZXNNb2RhbH1cbiAgICAgICAgICAgIG9uSGlkZT17dGhpcy5oaWRlUHJvcGVydGllc01vZGFsfVxuICAgICAgICAgICAgY29sb3JTY2hlbWU9e3RoaXMucHJvcHMuY29sb3JTY2hlbWV9XG4gICAgICAgICAgICBvblN1Ym1pdD17aGFuZGxlT25Qcm9wZXJ0aWVzQ2hhbmdlfVxuICAgICAgICAgICAgb25seUFwcGx5XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cblxuICAgICAgICA8T3ZlcndyaXRlQ29uZmlybSAvPlxuXG4gICAgICAgIHt1c2VyQ2FuQ3VyYXRlICYmIChcbiAgICAgICAgICA8RGFzaGJvYXJkRW1iZWRNb2RhbFxuICAgICAgICAgICAgc2hvdz17dGhpcy5zdGF0ZS5zaG93aW5nRW1iZWRNb2RhbH1cbiAgICAgICAgICAgIG9uSGlkZT17dGhpcy5oaWRlRW1iZWRNb2RhbH1cbiAgICAgICAgICAgIGRhc2hib2FyZElkPXtkYXNoYm9hcmRJbmZvLmlkfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxHbG9iYWxcbiAgICAgICAgICBzdHlsZXM9e2Nzc2BcbiAgICAgICAgICAgIC5hbnQtbWVudS12ZXJ0aWNhbCB7XG4gICAgICAgICAgICAgIGJvcmRlci1yaWdodDogbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBgfVxuICAgICAgICAvPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuXG5IZWFkZXIucHJvcFR5cGVzID0gcHJvcFR5cGVzO1xuSGVhZGVyLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcblxuZXhwb3J0IGRlZmF1bHQgSGVhZGVyO1xuIl19 */\"],\n\n                        \"data-test\": \"undo-action\",\n                        iconSize: \"xl\" }\n                      ) }\n                    ) }\n                  ),\n                  _jsx(Tooltip, {\n                    id: \"dashboard-redo-tooltip\",\n                    title: t('Redo the action'), children:\n\n                    _jsx(StyledUndoRedoButton, {\n                      type: \"text\",\n                      disabled: redoLength < 1,\n                      onClick: redoLength && onRedo, children:\n\n                      _jsx(Icons.Redo, {\n                        css: [\n                        undoRedoStyle,\n                        this.state.emphasizeRedo && undoRedoEmphasized,\n                        redoLength < 1 && undoRedoDisabled, process.env.NODE_ENV === \"production\" ? \"\" : \";label:Header;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL0hlYWRlci9pbmRleC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMGxCOEIiLCJmaWxlIjoiL2FwcC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvSGVhZGVyL2luZGV4LmpzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qIGVzbGludC1lbnYgYnJvd3NlciAqL1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQge1xuICBzdHlsZWQsXG4gIGNzcyxcbiAgaXNGZWF0dXJlRW5hYmxlZCxcbiAgRmVhdHVyZUZsYWcsXG4gIHQsXG4gIGdldEV4dGVuc2lvbnNSZWdpc3RyeSxcbn0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHsgR2xvYmFsIH0gZnJvbSAnQGVtb3Rpb24vcmVhY3QnO1xuaW1wb3J0IHtcbiAgTE9HX0FDVElPTlNfUEVSSU9ESUNfUkVOREVSX0RBU0hCT0FSRCxcbiAgTE9HX0FDVElPTlNfRk9SQ0VfUkVGUkVTSF9EQVNIQk9BUkQsXG4gIExPR19BQ1RJT05TX1RPR0dMRV9FRElUX0RBU0hCT0FSRCxcbn0gZnJvbSAnc3JjL2xvZ2dlci9Mb2dVdGlscyc7XG5pbXBvcnQgSWNvbnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvSWNvbnMnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IHsgQW50ZEJ1dHRvbiB9IGZyb20gJ3NyYy9jb21wb25lbnRzLyc7XG5pbXBvcnQgeyBmaW5kUGVybWlzc2lvbiB9IGZyb20gJ3NyYy91dGlscy9maW5kUGVybWlzc2lvbic7XG5pbXBvcnQgeyBUb29sdGlwIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvVG9vbHRpcCc7XG5pbXBvcnQgeyBzYWZlU3RyaW5naWZ5IH0gZnJvbSAnc3JjL3V0aWxzL3NhZmVTdHJpbmdpZnknO1xuaW1wb3J0IENvbm5lY3RlZEhlYWRlckFjdGlvbnNEcm9wZG93biBmcm9tICdzcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvSGVhZGVyL0hlYWRlckFjdGlvbnNEcm9wZG93bic7XG5pbXBvcnQgUHVibGlzaGVkU3RhdHVzIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9QdWJsaXNoZWRTdGF0dXMnO1xuaW1wb3J0IFVuZG9SZWRvS2V5TGlzdGVuZXJzIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9VbmRvUmVkb0tleUxpc3RlbmVycyc7XG5pbXBvcnQgUHJvcGVydGllc01vZGFsIGZyb20gJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9Qcm9wZXJ0aWVzTW9kYWwnO1xuaW1wb3J0IHsgY2hhcnRQcm9wU2hhcGUgfSBmcm9tICdzcmMvZGFzaGJvYXJkL3V0aWwvcHJvcFNoYXBlcyc7XG5pbXBvcnQgZ2V0T3duZXJOYW1lIGZyb20gJ3NyYy91dGlscy9nZXRPd25lck5hbWUnO1xuaW1wb3J0IHtcbiAgVU5ET19MSU1JVCxcbiAgU0FWRV9UWVBFX09WRVJXUklURSxcbiAgREFTSEJPQVJEX1BPU0lUSU9OX0RBVEFfTElNSVQsXG59IGZyb20gJ3NyYy9kYXNoYm9hcmQvdXRpbC9jb25zdGFudHMnO1xuaW1wb3J0IHNldFBlcmlvZGljUnVubmVyLCB7XG4gIHN0b3BQZXJpb2RpY1JlbmRlcixcbn0gZnJvbSAnc3JjL2Rhc2hib2FyZC91dGlsL3NldFBlcmlvZGljUnVubmVyJztcbmltcG9ydCB7IFBhZ2VIZWFkZXJXaXRoQWN0aW9ucyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL1BhZ2VIZWFkZXJXaXRoQWN0aW9ucyc7XG5pbXBvcnQgTWV0YWRhdGFCYXIsIHsgTWV0YWRhdGFUeXBlIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvTWV0YWRhdGFCYXInO1xuaW1wb3J0IERhc2hib2FyZEVtYmVkTW9kYWwgZnJvbSAnLi4vRW1iZWRkZWRNb2RhbCc7XG5pbXBvcnQgT3ZlcndyaXRlQ29uZmlybSBmcm9tICcuLi9PdmVyd3JpdGVDb25maXJtJztcblxuY29uc3QgZXh0ZW5zaW9uc1JlZ2lzdHJ5ID0gZ2V0RXh0ZW5zaW9uc1JlZ2lzdHJ5KCk7XG5cbmNvbnN0IHByb3BUeXBlcyA9IHtcbiAgYWRkU3VjY2Vzc1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBhZGREYW5nZXJUb2FzdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgYWRkV2FybmluZ1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB1c2VyOiBQcm9wVHlwZXMub2JqZWN0LCAvLyBVc2VyV2l0aFBlcm1pc3Npb25zQW5kUm9sZXMsXG4gIGRhc2hib2FyZEluZm86IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgZGFzaGJvYXJkVGl0bGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGRhdGFNYXNrOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIGNoYXJ0czogUHJvcFR5cGVzLm9iamVjdE9mKGNoYXJ0UHJvcFNoYXBlKS5pc1JlcXVpcmVkLFxuICBsYXlvdXQ6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgZXhwYW5kZWRTbGljZXM6IFByb3BUeXBlcy5vYmplY3QsXG4gIGN1c3RvbUNzczogUHJvcFR5cGVzLnN0cmluZyxcbiAgY29sb3JOYW1lc3BhY2U6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGNvbG9yU2NoZW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBzZXRDb2xvclNjaGVtZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2V0VW5zYXZlZENoYW5nZXM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGlzU3RhcnJlZDogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgaXNQdWJsaXNoZWQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gIGlzTG9hZGluZzogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgb25TYXZlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZmV0Y2hGYXZlU3RhcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZmV0Y2hDaGFydHM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIHNhdmVGYXZlU3RhcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2F2ZVB1Ymxpc2hlZDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgdXBkYXRlRGFzaGJvYXJkVGl0bGU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGVkaXRNb2RlOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICBzZXRFZGl0TW9kZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2hvd0J1aWxkZXJQYW5lOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB1cGRhdGVDc3M6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGxvZ0V2ZW50OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBoYXNVbnNhdmVkQ2hhbmdlczogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgbWF4VW5kb0hpc3RvcnlFeGNlZWRlZDogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgbGFzdE1vZGlmaWVkVGltZTogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuXG4gIC8vIHJlZHV4XG4gIG9uUmVmcmVzaDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25VbmRvOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvblJlZG86IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIHVuZG9MZW5ndGg6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgcmVkb0xlbmd0aDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICBzZXRNYXhVbmRvSGlzdG9yeUV4Y2VlZGVkOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBtYXhVbmRvSGlzdG9yeVRvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICByZWZyZXNoRnJlcXVlbmN5OiBQcm9wVHlwZXMubnVtYmVyLFxuICBzaG91bGRQZXJzaXN0UmVmcmVzaEZyZXF1ZW5jeTogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgc2V0UmVmcmVzaEZyZXF1ZW5jeTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZGFzaGJvYXJkSW5mb0NoYW5nZWQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGRhc2hib2FyZFRpdGxlQ2hhbmdlZDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgY29sb3JOYW1lc3BhY2U6IHVuZGVmaW5lZCxcbiAgY29sb3JTY2hlbWU6IHVuZGVmaW5lZCxcbn07XG5cbmNvbnN0IGhlYWRlckNvbnRhaW5lclN0eWxlID0gdGhlbWUgPT4gY3NzYFxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG5gO1xuXG5jb25zdCBlZGl0QnV0dG9uU3R5bGUgPSB0aGVtZSA9PiBjc3NgXG4gIGNvbG9yOiAke3RoZW1lLmNvbG9ycy5wcmltYXJ5LmRhcmsyfTtcbmA7XG5cbmNvbnN0IGFjdGlvbkJ1dHRvbnNTdHlsZSA9IHRoZW1lID0+IGNzc2BcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcblxuICAuYWN0aW9uLXNjaGVkdWxlLXJlcG9ydCB7XG4gICAgbWFyZ2luLWxlZnQ6ICR7dGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICB9XG5cbiAgLnVuZG9SZWRvIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIG1hcmdpbi1yaWdodDogJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZFVuZG9SZWRvQnV0dG9uID0gc3R5bGVkKEFudGRCdXR0b24pYFxuICBwYWRkaW5nOiAwO1xuICAmOmhvdmVyIHtcbiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgfVxuYDtcblxuY29uc3QgdW5kb1JlZG9TdHlsZSA9IHRoZW1lID0+IGNzc2BcbiAgY29sb3I6ICR7dGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDF9O1xuICAmOmhvdmVyIHtcbiAgICBjb2xvcjogJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9O1xuICB9XG5gO1xuXG5jb25zdCB1bmRvUmVkb0VtcGhhc2l6ZWQgPSB0aGVtZSA9PiBjc3NgXG4gIGNvbG9yOiAke3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG5gO1xuXG5jb25zdCB1bmRvUmVkb0Rpc2FibGVkID0gdGhlbWUgPT4gY3NzYFxuICBjb2xvcjogJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG5gO1xuXG5jb25zdCBzYXZlQnRuU3R5bGUgPSB0aGVtZSA9PiBjc3NgXG4gIG1pbi13aWR0aDogJHt0aGVtZS5ncmlkVW5pdCAqIDE3fXB4O1xuICBoZWlnaHQ6ICR7dGhlbWUuZ3JpZFVuaXQgKiA4fXB4O1xuYDtcblxuY29uc3QgZGlzY2FyZEJ0blN0eWxlID0gdGhlbWUgPT4gY3NzYFxuICBtaW4td2lkdGg6ICR7dGhlbWUuZ3JpZFVuaXQgKiAyMn1weDtcbiAgaGVpZ2h0OiAke3RoZW1lLmdyaWRVbml0ICogOH1weDtcbmA7XG5cbmNsYXNzIEhlYWRlciBleHRlbmRzIFB1cmVDb21wb25lbnQge1xuICBzdGF0aWMgZGlzY2FyZENoYW5nZXMoKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cbiAgICB1cmwuc2VhcmNoUGFyYW1zLmRlbGV0ZSgnZWRpdCcpO1xuICAgIHdpbmRvdy5sb2NhdGlvbi5hc3NpZ24odXJsKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBkaWROb3RpZnlNYXhVbmRvSGlzdG9yeVRvYXN0OiBmYWxzZSxcbiAgICAgIGVtcGhhc2l6ZVVuZG86IGZhbHNlLFxuICAgICAgZW1waGFzaXplUmVkbzogZmFsc2UsXG4gICAgICBzaG93aW5nUHJvcGVydGllc01vZGFsOiBmYWxzZSxcbiAgICAgIGlzRHJvcGRvd25WaXNpYmxlOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgdGhpcy5oYW5kbGVDaGFuZ2VUZXh0ID0gdGhpcy5oYW5kbGVDaGFuZ2VUZXh0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5oYW5kbGVDdHJsWiA9IHRoaXMuaGFuZGxlQ3RybFouYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZUN0cmxZID0gdGhpcy5oYW5kbGVDdHJsWS5iaW5kKHRoaXMpO1xuICAgIHRoaXMudG9nZ2xlRWRpdE1vZGUgPSB0aGlzLnRvZ2dsZUVkaXRNb2RlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5mb3JjZVJlZnJlc2ggPSB0aGlzLmZvcmNlUmVmcmVzaC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlciA9IHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlci5iaW5kKHRoaXMpO1xuICAgIHRoaXMub3ZlcndyaXRlRGFzaGJvYXJkID0gdGhpcy5vdmVyd3JpdGVEYXNoYm9hcmQuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNob3dQcm9wZXJ0aWVzTW9kYWwgPSB0aGlzLnNob3dQcm9wZXJ0aWVzTW9kYWwuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhpZGVQcm9wZXJ0aWVzTW9kYWwgPSB0aGlzLmhpZGVQcm9wZXJ0aWVzTW9kYWwuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldElzRHJvcGRvd25WaXNpYmxlID0gdGhpcy5zZXRJc0Ryb3Bkb3duVmlzaWJsZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgY29uc3QgeyByZWZyZXNoRnJlcXVlbmN5IH0gPSB0aGlzLnByb3BzO1xuICAgIHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlcihyZWZyZXNoRnJlcXVlbmN5ICogMTAwMCk7XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XG4gICAgaWYgKHRoaXMucHJvcHMucmVmcmVzaEZyZXF1ZW5jeSAhPT0gcHJldlByb3BzLnJlZnJlc2hGcmVxdWVuY3kpIHtcbiAgICAgIGNvbnN0IHsgcmVmcmVzaEZyZXF1ZW5jeSB9ID0gdGhpcy5wcm9wcztcbiAgICAgIHRoaXMuc3RhcnRQZXJpb2RpY1JlbmRlcihyZWZyZXNoRnJlcXVlbmN5ICogMTAwMCk7XG4gICAgfVxuICB9XG5cbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgaWYgKFxuICAgICAgVU5ET19MSU1JVCAtIG5leHRQcm9wcy51bmRvTGVuZ3RoIDw9IDAgJiZcbiAgICAgICF0aGlzLnN0YXRlLmRpZE5vdGlmeU1heFVuZG9IaXN0b3J5VG9hc3RcbiAgICApIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoKCkgPT4gKHsgZGlkTm90aWZ5TWF4VW5kb0hpc3RvcnlUb2FzdDogdHJ1ZSB9KSk7XG4gICAgICB0aGlzLnByb3BzLm1heFVuZG9IaXN0b3J5VG9hc3QoKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgbmV4dFByb3BzLnVuZG9MZW5ndGggPiBVTkRPX0xJTUlUICYmXG4gICAgICAhdGhpcy5wcm9wcy5tYXhVbmRvSGlzdG9yeUV4Y2VlZGVkXG4gICAgKSB7XG4gICAgICB0aGlzLnByb3BzLnNldE1heFVuZG9IaXN0b3J5RXhjZWVkZWQoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBzdG9wUGVyaW9kaWNSZW5kZXIodGhpcy5yZWZyZXNoVGltZXIpO1xuICAgIHRoaXMucHJvcHMuc2V0UmVmcmVzaEZyZXF1ZW5jeSgwKTtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5jdHJsWVRpbWVvdXQpO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLmN0cmxaVGltZW91dCk7XG4gIH1cblxuICBoYW5kbGVDaGFuZ2VUZXh0KG5leHRUZXh0KSB7XG4gICAgY29uc3QgeyB1cGRhdGVEYXNoYm9hcmRUaXRsZSwgb25DaGFuZ2UgfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKG5leHRUZXh0ICYmIHRoaXMucHJvcHMuZGFzaGJvYXJkVGl0bGUgIT09IG5leHRUZXh0KSB7XG4gICAgICB1cGRhdGVEYXNoYm9hcmRUaXRsZShuZXh0VGV4dCk7XG4gICAgICBvbkNoYW5nZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldElzRHJvcGRvd25WaXNpYmxlKHZpc2libGUpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGlzRHJvcGRvd25WaXNpYmxlOiB2aXNpYmxlLFxuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlQ3RybFkoKSB7XG4gICAgdGhpcy5wcm9wcy5vblJlZG8oKTtcbiAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplUmVkbzogdHJ1ZSB9LCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5jdHJsWVRpbWVvdXQpIGNsZWFyVGltZW91dCh0aGlzLmN0cmxZVGltZW91dCk7XG4gICAgICB0aGlzLmN0cmxZVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplUmVkbzogZmFsc2UgfSk7XG4gICAgICB9LCAxMDApO1xuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlQ3RybFooKSB7XG4gICAgdGhpcy5wcm9wcy5vblVuZG8oKTtcbiAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplVW5kbzogdHJ1ZSB9LCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5jdHJsWlRpbWVvdXQpIGNsZWFyVGltZW91dCh0aGlzLmN0cmxaVGltZW91dCk7XG4gICAgICB0aGlzLmN0cmxaVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZW1waGFzaXplVW5kbzogZmFsc2UgfSk7XG4gICAgICB9LCAxMDApO1xuICAgIH0pO1xuICB9XG5cbiAgZm9yY2VSZWZyZXNoKCkge1xuICAgIGlmICghdGhpcy5wcm9wcy5pc0xvYWRpbmcpIHtcbiAgICAgIGNvbnN0IGNoYXJ0TGlzdCA9IE9iamVjdC5rZXlzKHRoaXMucHJvcHMuY2hhcnRzKTtcbiAgICAgIHRoaXMucHJvcHMubG9nRXZlbnQoTE9HX0FDVElPTlNfRk9SQ0VfUkVGUkVTSF9EQVNIQk9BUkQsIHtcbiAgICAgICAgZm9yY2U6IHRydWUsXG4gICAgICAgIGludGVydmFsOiAwLFxuICAgICAgICBjaGFydENvdW50OiBjaGFydExpc3QubGVuZ3RoLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcy5wcm9wcy5vblJlZnJlc2goXG4gICAgICAgIGNoYXJ0TGlzdCxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICAgMCxcbiAgICAgICAgdGhpcy5wcm9wcy5kYXNoYm9hcmRJbmZvLmlkLFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgc3RhcnRQZXJpb2RpY1JlbmRlcihpbnRlcnZhbCkge1xuICAgIGxldCBpbnRlcnZhbE1lc3NhZ2U7XG5cbiAgICBpZiAoaW50ZXJ2YWwpIHtcbiAgICAgIGNvbnN0IHsgZGFzaGJvYXJkSW5mbyB9ID0gdGhpcy5wcm9wcztcbiAgICAgIGNvbnN0IHBlcmlvZGljUmVmcmVzaE9wdGlvbnMgPVxuICAgICAgICBkYXNoYm9hcmRJbmZvLmNvbW1vbj8uY29uZj8uREFTSEJPQVJEX0FVVE9fUkVGUkVTSF9JTlRFUlZBTFM7XG4gICAgICBjb25zdCBwcmVkZWZpbmVkVmFsdWUgPSBwZXJpb2RpY1JlZnJlc2hPcHRpb25zLmZpbmQoXG4gICAgICAgIG9wdGlvbiA9PiBOdW1iZXIob3B0aW9uWzBdKSA9PT0gaW50ZXJ2YWwgLyAxMDAwLFxuICAgICAgKTtcblxuICAgICAgaWYgKHByZWRlZmluZWRWYWx1ZSkge1xuICAgICAgICBpbnRlcnZhbE1lc3NhZ2UgPSB0KHByZWRlZmluZWRWYWx1ZVsxXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnRlcnZhbE1lc3NhZ2UgPSBtb21lbnQuZHVyYXRpb24oaW50ZXJ2YWwsICdtaWxsaXNlY29uZCcpLmh1bWFuaXplKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcGVyaW9kaWNSZW5kZXIgPSAoKSA9PiB7XG4gICAgICBjb25zdCB7IGZldGNoQ2hhcnRzLCBsb2dFdmVudCwgY2hhcnRzLCBkYXNoYm9hcmRJbmZvIH0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3QgeyBtZXRhZGF0YSB9ID0gZGFzaGJvYXJkSW5mbztcbiAgICAgIGNvbnN0IGltbXVuZSA9IG1ldGFkYXRhLnRpbWVkX3JlZnJlc2hfaW1tdW5lX3NsaWNlcyB8fCBbXTtcbiAgICAgIGNvbnN0IGFmZmVjdGVkQ2hhcnRzID0gT2JqZWN0LnZhbHVlcyhjaGFydHMpXG4gICAgICAgIC5maWx0ZXIoY2hhcnQgPT4gaW1tdW5lLmluZGV4T2YoY2hhcnQuaWQpID09PSAtMSlcbiAgICAgICAgLm1hcChjaGFydCA9PiBjaGFydC5pZCk7XG5cbiAgICAgIGxvZ0V2ZW50KExPR19BQ1RJT05TX1BFUklPRElDX1JFTkRFUl9EQVNIQk9BUkQsIHtcbiAgICAgICAgaW50ZXJ2YWwsXG4gICAgICAgIGNoYXJ0Q291bnQ6IGFmZmVjdGVkQ2hhcnRzLmxlbmd0aCxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5wcm9wcy5hZGRXYXJuaW5nVG9hc3QoXG4gICAgICAgIHQoXG4gICAgICAgICAgYFRoaXMgZGFzaGJvYXJkIGlzIGN1cnJlbnRseSBhdXRvIHJlZnJlc2hpbmc7IHRoZSBuZXh0IGF1dG8gcmVmcmVzaCB3aWxsIGJlIGluICVzLmAsXG4gICAgICAgICAgaW50ZXJ2YWxNZXNzYWdlLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICAgIGlmIChkYXNoYm9hcmRJbmZvLmNvbW1vbi5jb25mLkRBU0hCT0FSRF9BVVRPX1JFRlJFU0hfTU9ERSA9PT0gJ2ZldGNoJykge1xuICAgICAgICAvLyBmb3JjZS1yZWZyZXNoIHdoaWxlIGF1dG8tcmVmcmVzaCBpbiBkYXNoYm9hcmRcbiAgICAgICAgcmV0dXJuIGZldGNoQ2hhcnRzKFxuICAgICAgICAgIGFmZmVjdGVkQ2hhcnRzLFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgIGludGVydmFsICogMC4yLFxuICAgICAgICAgIGRhc2hib2FyZEluZm8uaWQsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmV0Y2hDaGFydHMoXG4gICAgICAgIGFmZmVjdGVkQ2hhcnRzLFxuICAgICAgICB0cnVlLFxuICAgICAgICBpbnRlcnZhbCAqIDAuMixcbiAgICAgICAgZGFzaGJvYXJkSW5mby5pZCxcbiAgICAgICk7XG4gICAgfTtcblxuICAgIHRoaXMucmVmcmVzaFRpbWVyID0gc2V0UGVyaW9kaWNSdW5uZXIoe1xuICAgICAgaW50ZXJ2YWwsXG4gICAgICBwZXJpb2RpY1JlbmRlcixcbiAgICAgIHJlZnJlc2hUaW1lcjogdGhpcy5yZWZyZXNoVGltZXIsXG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVFZGl0TW9kZSgpIHtcbiAgICB0aGlzLnByb3BzLmxvZ0V2ZW50KExPR19BQ1RJT05TX1RPR0dMRV9FRElUX0RBU0hCT0FSRCwge1xuICAgICAgZWRpdF9tb2RlOiAhdGhpcy5wcm9wcy5lZGl0TW9kZSxcbiAgICB9KTtcbiAgICB0aGlzLnByb3BzLnNldEVkaXRNb2RlKCF0aGlzLnByb3BzLmVkaXRNb2RlKTtcbiAgfVxuXG4gIG92ZXJ3cml0ZURhc2hib2FyZCgpIHtcbiAgICBjb25zdCB7XG4gICAgICBkYXNoYm9hcmRUaXRsZSxcbiAgICAgIGxheW91dDogcG9zaXRpb25zLFxuICAgICAgY29sb3JTY2hlbWUsXG4gICAgICBjb2xvck5hbWVzcGFjZSxcbiAgICAgIGN1c3RvbUNzcyxcbiAgICAgIGRhc2hib2FyZEluZm8sXG4gICAgICByZWZyZXNoRnJlcXVlbmN5OiBjdXJyZW50UmVmcmVzaEZyZXF1ZW5jeSxcbiAgICAgIHNob3VsZFBlcnNpc3RSZWZyZXNoRnJlcXVlbmN5LFxuICAgICAgbGFzdE1vZGlmaWVkVGltZSxcbiAgICAgIHNsdWcsXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAvLyBjaGVjayByZWZyZXNoIGZyZXF1ZW5jeSBpcyBmb3IgY3VycmVudCBzZXNzaW9uIG9yIHBlcnNpc3RcbiAgICBjb25zdCByZWZyZXNoRnJlcXVlbmN5ID0gc2hvdWxkUGVyc2lzdFJlZnJlc2hGcmVxdWVuY3lcbiAgICAgID8gY3VycmVudFJlZnJlc2hGcmVxdWVuY3lcbiAgICAgIDogZGFzaGJvYXJkSW5mby5tZXRhZGF0YT8ucmVmcmVzaF9mcmVxdWVuY3k7XG5cbiAgICBjb25zdCBjdXJyZW50Q29sb3JOYW1lc3BhY2UgPVxuICAgICAgZGFzaGJvYXJkSW5mbz8ubWV0YWRhdGE/LmNvbG9yX25hbWVzcGFjZSB8fCBjb2xvck5hbWVzcGFjZTtcbiAgICBjb25zdCBjdXJyZW50Q29sb3JTY2hlbWUgPVxuICAgICAgZGFzaGJvYXJkSW5mbz8ubWV0YWRhdGE/LmNvbG9yX3NjaGVtZSB8fCBjb2xvclNjaGVtZTtcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBjZXJ0aWZpZWRfYnk6IGRhc2hib2FyZEluZm8uY2VydGlmaWVkX2J5LFxuICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBkYXNoYm9hcmRJbmZvLmNlcnRpZmljYXRpb25fZGV0YWlscyxcbiAgICAgIGNzczogY3VzdG9tQ3NzLFxuICAgICAgZGFzaGJvYXJkX3RpdGxlOiBkYXNoYm9hcmRUaXRsZSxcbiAgICAgIGxhc3RfbW9kaWZpZWRfdGltZTogbGFzdE1vZGlmaWVkVGltZSxcbiAgICAgIG93bmVyczogZGFzaGJvYXJkSW5mby5vd25lcnMsXG4gICAgICByb2xlczogZGFzaGJvYXJkSW5mby5yb2xlcyxcbiAgICAgIHNsdWcsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICAuLi5kYXNoYm9hcmRJbmZvPy5tZXRhZGF0YSxcbiAgICAgICAgY29sb3JfbmFtZXNwYWNlOiBjdXJyZW50Q29sb3JOYW1lc3BhY2UsXG4gICAgICAgIGNvbG9yX3NjaGVtZTogY3VycmVudENvbG9yU2NoZW1lLFxuICAgICAgICBwb3NpdGlvbnMsXG4gICAgICAgIHJlZnJlc2hfZnJlcXVlbmN5OiByZWZyZXNoRnJlcXVlbmN5LFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgLy8gbWFrZSBzdXJlIHBvc2l0aW9ucyBkYXRhIGxlc3MgdGhhbiBEQiBzdG9yYWdlIGxpbWl0YXRpb246XG4gICAgY29uc3QgcG9zaXRpb25KU09OTGVuZ3RoID0gc2FmZVN0cmluZ2lmeShwb3NpdGlvbnMpLmxlbmd0aDtcbiAgICBjb25zdCBsaW1pdCA9XG4gICAgICBkYXNoYm9hcmRJbmZvLmNvbW1vbi5jb25mLlNVUEVSU0VUX0RBU0hCT0FSRF9QT1NJVElPTl9EQVRBX0xJTUlUIHx8XG4gICAgICBEQVNIQk9BUkRfUE9TSVRJT05fREFUQV9MSU1JVDtcbiAgICBpZiAocG9zaXRpb25KU09OTGVuZ3RoID49IGxpbWl0KSB7XG4gICAgICB0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0KFxuICAgICAgICB0KFxuICAgICAgICAgICdZb3VyIGRhc2hib2FyZCBpcyB0b28gbGFyZ2UuIFBsZWFzZSByZWR1Y2UgaXRzIHNpemUgYmVmb3JlIHNhdmluZyBpdC4nLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHBvc2l0aW9uSlNPTkxlbmd0aCA+PSBsaW1pdCAqIDAuOSkge1xuICAgICAgICB0aGlzLnByb3BzLmFkZFdhcm5pbmdUb2FzdCgnWW91ciBkYXNoYm9hcmQgaXMgbmVhciB0aGUgc2l6ZSBsaW1pdC4nKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5wcm9wcy5vblNhdmUoZGF0YSwgZGFzaGJvYXJkSW5mby5pZCwgU0FWRV9UWVBFX09WRVJXUklURSk7XG4gICAgfVxuICB9XG5cbiAgc2hvd1Byb3BlcnRpZXNNb2RhbCgpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgc2hvd2luZ1Byb3BlcnRpZXNNb2RhbDogdHJ1ZSB9KTtcbiAgfVxuXG4gIGhpZGVQcm9wZXJ0aWVzTW9kYWwoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dpbmdQcm9wZXJ0aWVzTW9kYWw6IGZhbHNlIH0pO1xuICB9XG5cbiAgc2hvd0VtYmVkTW9kYWwgPSAoKSA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dpbmdFbWJlZE1vZGFsOiB0cnVlIH0pO1xuICB9O1xuXG4gIGhpZGVFbWJlZE1vZGFsID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBzaG93aW5nRW1iZWRNb2RhbDogZmFsc2UgfSk7XG4gIH07XG5cbiAgZ2V0TWV0YWRhdGFJdGVtcyA9ICgpID0+IHtcbiAgICBjb25zdCB7IGRhc2hib2FyZEluZm8gfSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogTWV0YWRhdGFUeXBlLkxhc3RNb2RpZmllZCxcbiAgICAgICAgdmFsdWU6IGRhc2hib2FyZEluZm8uY2hhbmdlZF9vbl9kZWx0YV9odW1hbml6ZWQsXG4gICAgICAgIG1vZGlmaWVkQnk6XG4gICAgICAgICAgZ2V0T3duZXJOYW1lKGRhc2hib2FyZEluZm8uY2hhbmdlZF9ieSkgfHwgdCgnTm90IGF2YWlsYWJsZScpLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogTWV0YWRhdGFUeXBlLk93bmVyLFxuICAgICAgICBjcmVhdGVkQnk6IGdldE93bmVyTmFtZShkYXNoYm9hcmRJbmZvLmNyZWF0ZWRfYnkpIHx8IHQoJ05vdCBhdmFpbGFibGUnKSxcbiAgICAgICAgb3duZXJzOlxuICAgICAgICAgIGRhc2hib2FyZEluZm8ub3duZXJzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgID8gZGFzaGJvYXJkSW5mby5vd25lcnMubWFwKGdldE93bmVyTmFtZSlcbiAgICAgICAgICAgIDogdCgnTm9uZScpLFxuICAgICAgICBjcmVhdGVkT246IGRhc2hib2FyZEluZm8uY3JlYXRlZF9vbl9kZWx0YV9odW1hbml6ZWQsXG4gICAgICB9LFxuICAgIF07XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGRhc2hib2FyZFRpdGxlLFxuICAgICAgbGF5b3V0LFxuICAgICAgZXhwYW5kZWRTbGljZXMsXG4gICAgICBjdXN0b21Dc3MsXG4gICAgICBjb2xvck5hbWVzcGFjZSxcbiAgICAgIGRhdGFNYXNrLFxuICAgICAgc2V0Q29sb3JTY2hlbWUsXG4gICAgICBzZXRVbnNhdmVkQ2hhbmdlcyxcbiAgICAgIGNvbG9yU2NoZW1lLFxuICAgICAgb25VbmRvLFxuICAgICAgb25SZWRvLFxuICAgICAgdW5kb0xlbmd0aCxcbiAgICAgIHJlZG9MZW5ndGgsXG4gICAgICBvbkNoYW5nZSxcbiAgICAgIG9uU2F2ZSxcbiAgICAgIHVwZGF0ZUNzcyxcbiAgICAgIGVkaXRNb2RlLFxuICAgICAgaXNQdWJsaXNoZWQsXG4gICAgICB1c2VyLFxuICAgICAgZGFzaGJvYXJkSW5mbyxcbiAgICAgIGhhc1Vuc2F2ZWRDaGFuZ2VzLFxuICAgICAgaXNMb2FkaW5nLFxuICAgICAgcmVmcmVzaEZyZXF1ZW5jeSxcbiAgICAgIHNob3VsZFBlcnNpc3RSZWZyZXNoRnJlcXVlbmN5LFxuICAgICAgc2V0UmVmcmVzaEZyZXF1ZW5jeSxcbiAgICAgIGxhc3RNb2RpZmllZFRpbWUsXG4gICAgICBsb2dFdmVudCxcbiAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IHVzZXJDYW5FZGl0ID1cbiAgICAgIGRhc2hib2FyZEluZm8uZGFzaF9lZGl0X3Blcm0gJiYgIWRhc2hib2FyZEluZm8uaXNfbWFuYWdlZF9leHRlcm5hbGx5O1xuICAgIGNvbnN0IHVzZXJDYW5TaGFyZSA9IGRhc2hib2FyZEluZm8uZGFzaF9zaGFyZV9wZXJtO1xuICAgIGNvbnN0IHVzZXJDYW5TYXZlQXMgPSBkYXNoYm9hcmRJbmZvLmRhc2hfc2F2ZV9wZXJtO1xuICAgIGNvbnN0IHVzZXJDYW5DdXJhdGUgPVxuICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbWJlZGRlZFN1cGVyc2V0KSAmJlxuICAgICAgZmluZFBlcm1pc3Npb24oJ2Nhbl9zZXRfZW1iZWRkZWQnLCAnRGFzaGJvYXJkJywgdXNlci5yb2xlcyk7XG4gICAgY29uc3QgcmVmcmVzaExpbWl0ID1cbiAgICAgIGRhc2hib2FyZEluZm8uY29tbW9uPy5jb25mPy5TVVBFUlNFVF9EQVNIQk9BUkRfUEVSSU9ESUNBTF9SRUZSRVNIX0xJTUlUO1xuICAgIGNvbnN0IHJlZnJlc2hXYXJuaW5nID1cbiAgICAgIGRhc2hib2FyZEluZm8uY29tbW9uPy5jb25mXG4gICAgICAgID8uU1VQRVJTRVRfREFTSEJPQVJEX1BFUklPRElDQUxfUkVGUkVTSF9XQVJOSU5HX01FU1NBR0U7XG5cbiAgICBjb25zdCBoYW5kbGVPblByb3BlcnRpZXNDaGFuZ2UgPSB1cGRhdGVzID0+IHtcbiAgICAgIGNvbnN0IHsgZGFzaGJvYXJkSW5mb0NoYW5nZWQsIGRhc2hib2FyZFRpdGxlQ2hhbmdlZCB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgc2V0Q29sb3JTY2hlbWUodXBkYXRlcy5jb2xvclNjaGVtZSk7XG4gICAgICBkYXNoYm9hcmRJbmZvQ2hhbmdlZCh7XG4gICAgICAgIHNsdWc6IHVwZGF0ZXMuc2x1ZyxcbiAgICAgICAgbWV0YWRhdGE6IEpTT04ucGFyc2UodXBkYXRlcy5qc29uTWV0YWRhdGEgfHwgJ3t9JyksXG4gICAgICAgIGNlcnRpZmllZF9ieTogdXBkYXRlcy5jZXJ0aWZpZWRCeSxcbiAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiB1cGRhdGVzLmNlcnRpZmljYXRpb25EZXRhaWxzLFxuICAgICAgICBvd25lcnM6IHVwZGF0ZXMub3duZXJzLFxuICAgICAgICByb2xlczogdXBkYXRlcy5yb2xlcyxcbiAgICAgIH0pO1xuICAgICAgc2V0VW5zYXZlZENoYW5nZXModHJ1ZSk7XG4gICAgICBkYXNoYm9hcmRUaXRsZUNoYW5nZWQodXBkYXRlcy50aXRsZSk7XG4gICAgfTtcblxuICAgIGNvbnN0IE5hdkV4dGVuc2lvbiA9IGV4dGVuc2lvbnNSZWdpc3RyeS5nZXQoJ2Rhc2hib2FyZC5uYXYucmlnaHQnKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIGNzcz17aGVhZGVyQ29udGFpbmVyU3R5bGV9XG4gICAgICAgIGRhdGEtdGVzdD1cImRhc2hib2FyZC1oZWFkZXItY29udGFpbmVyXCJcbiAgICAgICAgZGF0YS10ZXN0LWlkPXtkYXNoYm9hcmRJbmZvLmlkfVxuICAgICAgICBjbGFzc05hbWU9XCJkYXNoYm9hcmQtaGVhZGVyLWNvbnRhaW5lclwiXG4gICAgICA+XG4gICAgICAgIDxQYWdlSGVhZGVyV2l0aEFjdGlvbnNcbiAgICAgICAgICBlZGl0YWJsZVRpdGxlUHJvcHM9e3tcbiAgICAgICAgICAgIHRpdGxlOiBkYXNoYm9hcmRUaXRsZSxcbiAgICAgICAgICAgIGNhbkVkaXQ6IHVzZXJDYW5FZGl0ICYmIGVkaXRNb2RlLFxuICAgICAgICAgICAgb25TYXZlOiB0aGlzLmhhbmRsZUNoYW5nZVRleHQsXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogdCgnQWRkIHRoZSBuYW1lIG9mIHRoZSBkYXNoYm9hcmQnKSxcbiAgICAgICAgICAgIGxhYmVsOiB0KCdEYXNoYm9hcmQgdGl0bGUnKSxcbiAgICAgICAgICAgIHNob3dUb29sdGlwOiBmYWxzZSxcbiAgICAgICAgICB9fVxuICAgICAgICAgIGNlcnRpZmljYXRpZWRCYWRnZVByb3BzPXt7XG4gICAgICAgICAgICBjZXJ0aWZpZWRCeTogZGFzaGJvYXJkSW5mby5jZXJ0aWZpZWRfYnksXG4gICAgICAgICAgICBkZXRhaWxzOiBkYXNoYm9hcmRJbmZvLmNlcnRpZmljYXRpb25fZGV0YWlscyxcbiAgICAgICAgICB9fVxuICAgICAgICAgIGZhdmVTdGFyUHJvcHM9e3tcbiAgICAgICAgICAgIGl0ZW1JZDogZGFzaGJvYXJkSW5mby5pZCxcbiAgICAgICAgICAgIGZldGNoRmF2ZVN0YXI6IHRoaXMucHJvcHMuZmV0Y2hGYXZlU3RhcixcbiAgICAgICAgICAgIHNhdmVGYXZlU3RhcjogdGhpcy5wcm9wcy5zYXZlRmF2ZVN0YXIsXG4gICAgICAgICAgICBpc1N0YXJyZWQ6IHRoaXMucHJvcHMuaXNTdGFycmVkLFxuICAgICAgICAgICAgc2hvd1Rvb2x0aXA6IHRydWUsXG4gICAgICAgICAgfX1cbiAgICAgICAgICB0aXRsZVBhbmVsQWRkaXRpb25hbEl0ZW1zPXtbXG4gICAgICAgICAgICAhZWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgICA8UHVibGlzaGVkU3RhdHVzXG4gICAgICAgICAgICAgICAgZGFzaGJvYXJkSWQ9e2Rhc2hib2FyZEluZm8uaWR9XG4gICAgICAgICAgICAgICAgaXNQdWJsaXNoZWQ9e2lzUHVibGlzaGVkfVxuICAgICAgICAgICAgICAgIHNhdmVQdWJsaXNoZWQ9e3RoaXMucHJvcHMuc2F2ZVB1Ymxpc2hlZH1cbiAgICAgICAgICAgICAgICBjYW5FZGl0PXt1c2VyQ2FuRWRpdH1cbiAgICAgICAgICAgICAgICBjYW5TYXZlPXt1c2VyQ2FuU2F2ZUFzfVxuICAgICAgICAgICAgICAgIHZpc2libGU9eyFlZGl0TW9kZX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICksXG4gICAgICAgICAgICAhZWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgICA8TWV0YWRhdGFCYXJcbiAgICAgICAgICAgICAgICBpdGVtcz17dGhpcy5nZXRNZXRhZGF0YUl0ZW1zKCl9XG4gICAgICAgICAgICAgICAgdG9vbHRpcFBsYWNlbWVudD1cImJvdHRvbVwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIF19XG4gICAgICAgICAgcmlnaHRQYW5lbEFkZGl0aW9uYWxJdGVtcz17XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbi1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAge3VzZXJDYW5TYXZlQXMgJiYgKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ1dHRvbi1jb250YWluZXJcIlxuICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PVwiZGFzaGJvYXJkLWVkaXQtYWN0aW9uc1wiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAge2VkaXRNb2RlICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjc3M9e2FjdGlvbkJ1dHRvbnNTdHlsZX0+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1bmRvUmVkb1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJkYXNoYm9hcmQtdW5kby10b29sdGlwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e3QoJ1VuZG8gdGhlIGFjdGlvbicpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8U3R5bGVkVW5kb1JlZG9CdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3VuZG9MZW5ndGggPCAxfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3VuZG9MZW5ndGggJiYgb25VbmRvfVxuICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb25zLlVuZG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzcz17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRvUmVkb1N0eWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmVtcGhhc2l6ZVVuZG8gJiYgdW5kb1JlZG9FbXBoYXNpemVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRvTGVuZ3RoIDwgMSAmJiB1bmRvUmVkb0Rpc2FibGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD1cInVuZG8tYWN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25TaXplPVwieGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvU3R5bGVkVW5kb1JlZG9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImRhc2hib2FyZC1yZWRvLXRvb2x0aXBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17dCgnUmVkbyB0aGUgYWN0aW9uJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxTdHlsZWRVbmRvUmVkb0J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17cmVkb0xlbmd0aCA8IDF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17cmVkb0xlbmd0aCAmJiBvblJlZG99XG4gICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWNvbnMuUmVkb1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3NzPXtbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZG9SZWRvU3R5bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZW1waGFzaXplUmVkbyAmJiB1bmRvUmVkb0VtcGhhc2l6ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZG9MZW5ndGggPCAxICYmIHVuZG9SZWRvRGlzYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PVwicmVkby1hY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvblNpemU9XCJ4bFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TdHlsZWRVbmRvUmVkb0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3M9e2Rpc2NhcmRCdG5TdHlsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmNvbnN0cnVjdG9yLmRpc2NhcmRDaGFuZ2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uU3R5bGU9XCJkZWZhdWx0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD1cImRpc2NhcmQtY2hhbmdlcy1idXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD17dCgnRGlzY2FyZCcpfVxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt0KCdEaXNjYXJkJyl9XG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzPXtzYXZlQnRuU3R5bGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b25TaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFoYXNVbnNhdmVkQ2hhbmdlc31cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm92ZXJ3cml0ZURhc2hib2FyZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD1cImhlYWRlci1zYXZlLWJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPXt0KCdTYXZlJyl9XG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAge3QoJ1NhdmUnKX1cbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7ZWRpdE1vZGUgPyAoXG4gICAgICAgICAgICAgICAgPFVuZG9SZWRvS2V5TGlzdGVuZXJzXG4gICAgICAgICAgICAgICAgICBvblVuZG89e3RoaXMuaGFuZGxlQ3RybFp9XG4gICAgICAgICAgICAgICAgICBvblJlZG89e3RoaXMuaGFuZGxlQ3RybFl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNzcz17YWN0aW9uQnV0dG9uc1N0eWxlfT5cbiAgICAgICAgICAgICAgICAgIHtOYXZFeHRlbnNpb24gJiYgPE5hdkV4dGVuc2lvbiAvPn1cbiAgICAgICAgICAgICAgICAgIHt1c2VyQ2FuRWRpdCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBidXR0b25TdHlsZT1cInNlY29uZGFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy50b2dnbGVFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3Q9XCJlZGl0LWRhc2hib2FyZC1idXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFjdGlvbi1idXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgIGNzcz17ZWRpdEJ1dHRvblN0eWxlfVxuICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e3QoJ0VkaXQgZGFzaGJvYXJkJyl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICB7dCgnRWRpdCBkYXNoYm9hcmQnKX1cbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lbnVEcm9wZG93blByb3BzPXt7XG4gICAgICAgICAgICBnZXRQb3B1cENvbnRhaW5lcjogdHJpZ2dlck5vZGUgPT5cbiAgICAgICAgICAgICAgdHJpZ2dlck5vZGUuY2xvc2VzdCgnLmhlYWRlci13aXRoLWFjdGlvbnMnKSxcbiAgICAgICAgICAgIHZpc2libGU6IHRoaXMuc3RhdGUuaXNEcm9wZG93blZpc2libGUsXG4gICAgICAgICAgICBvblZpc2libGVDaGFuZ2U6IHRoaXMuc2V0SXNEcm9wZG93blZpc2libGUsXG4gICAgICAgICAgfX1cbiAgICAgICAgICBhZGRpdGlvbmFsQWN0aW9uc01lbnU9e1xuICAgICAgICAgICAgPENvbm5lY3RlZEhlYWRlckFjdGlvbnNEcm9wZG93blxuICAgICAgICAgICAgICBhZGRTdWNjZXNzVG9hc3Q9e3RoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0fVxuICAgICAgICAgICAgICBhZGREYW5nZXJUb2FzdD17dGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdH1cbiAgICAgICAgICAgICAgZGFzaGJvYXJkSWQ9e2Rhc2hib2FyZEluZm8uaWR9XG4gICAgICAgICAgICAgIGRhc2hib2FyZFRpdGxlPXtkYXNoYm9hcmRUaXRsZX1cbiAgICAgICAgICAgICAgZGFzaGJvYXJkSW5mbz17ZGFzaGJvYXJkSW5mb31cbiAgICAgICAgICAgICAgZGF0YU1hc2s9e2RhdGFNYXNrfVxuICAgICAgICAgICAgICBsYXlvdXQ9e2xheW91dH1cbiAgICAgICAgICAgICAgZXhwYW5kZWRTbGljZXM9e2V4cGFuZGVkU2xpY2VzfVxuICAgICAgICAgICAgICBjdXN0b21Dc3M9e2N1c3RvbUNzc31cbiAgICAgICAgICAgICAgY29sb3JOYW1lc3BhY2U9e2NvbG9yTmFtZXNwYWNlfVxuICAgICAgICAgICAgICBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9XG4gICAgICAgICAgICAgIG9uU2F2ZT17b25TYXZlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgIGZvcmNlUmVmcmVzaEFsbENoYXJ0cz17dGhpcy5mb3JjZVJlZnJlc2h9XG4gICAgICAgICAgICAgIHN0YXJ0UGVyaW9kaWNSZW5kZXI9e3RoaXMuc3RhcnRQZXJpb2RpY1JlbmRlcn1cbiAgICAgICAgICAgICAgcmVmcmVzaEZyZXF1ZW5jeT17cmVmcmVzaEZyZXF1ZW5jeX1cbiAgICAgICAgICAgICAgc2hvdWxkUGVyc2lzdFJlZnJlc2hGcmVxdWVuY3k9e3Nob3VsZFBlcnNpc3RSZWZyZXNoRnJlcXVlbmN5fVxuICAgICAgICAgICAgICBzZXRSZWZyZXNoRnJlcXVlbmN5PXtzZXRSZWZyZXNoRnJlcXVlbmN5fVxuICAgICAgICAgICAgICB1cGRhdGVDc3M9e3VwZGF0ZUNzc31cbiAgICAgICAgICAgICAgZWRpdE1vZGU9e2VkaXRNb2RlfVxuICAgICAgICAgICAgICBoYXNVbnNhdmVkQ2hhbmdlcz17aGFzVW5zYXZlZENoYW5nZXN9XG4gICAgICAgICAgICAgIHVzZXJDYW5FZGl0PXt1c2VyQ2FuRWRpdH1cbiAgICAgICAgICAgICAgdXNlckNhblNoYXJlPXt1c2VyQ2FuU2hhcmV9XG4gICAgICAgICAgICAgIHVzZXJDYW5TYXZlPXt1c2VyQ2FuU2F2ZUFzfVxuICAgICAgICAgICAgICB1c2VyQ2FuQ3VyYXRlPXt1c2VyQ2FuQ3VyYXRlfVxuICAgICAgICAgICAgICBpc0xvYWRpbmc9e2lzTG9hZGluZ31cbiAgICAgICAgICAgICAgc2hvd1Byb3BlcnRpZXNNb2RhbD17dGhpcy5zaG93UHJvcGVydGllc01vZGFsfVxuICAgICAgICAgICAgICBtYW5hZ2VFbWJlZGRlZD17dGhpcy5zaG93RW1iZWRNb2RhbH1cbiAgICAgICAgICAgICAgcmVmcmVzaExpbWl0PXtyZWZyZXNoTGltaXR9XG4gICAgICAgICAgICAgIHJlZnJlc2hXYXJuaW5nPXtyZWZyZXNoV2FybmluZ31cbiAgICAgICAgICAgICAgbGFzdE1vZGlmaWVkVGltZT17bGFzdE1vZGlmaWVkVGltZX1cbiAgICAgICAgICAgICAgaXNEcm9wZG93blZpc2libGU9e3RoaXMuc3RhdGUuaXNEcm9wZG93blZpc2libGV9XG4gICAgICAgICAgICAgIHNldElzRHJvcGRvd25WaXNpYmxlPXt0aGlzLnNldElzRHJvcGRvd25WaXNpYmxlfVxuICAgICAgICAgICAgICBsb2dFdmVudD17bG9nRXZlbnR9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIH1cbiAgICAgICAgICBzaG93RmF2ZVN0YXI9e3VzZXI/LnVzZXJJZCAmJiBkYXNoYm9hcmRJbmZvPy5pZH1cbiAgICAgICAgICBzaG93VGl0bGVQYW5lbEl0ZW1zXG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLnNob3dpbmdQcm9wZXJ0aWVzTW9kYWwgJiYgKFxuICAgICAgICAgIDxQcm9wZXJ0aWVzTW9kYWxcbiAgICAgICAgICAgIGRhc2hib2FyZElkPXtkYXNoYm9hcmRJbmZvLmlkfVxuICAgICAgICAgICAgZGFzaGJvYXJkSW5mbz17ZGFzaGJvYXJkSW5mb31cbiAgICAgICAgICAgIGRhc2hib2FyZFRpdGxlPXtkYXNoYm9hcmRUaXRsZX1cbiAgICAgICAgICAgIHNob3c9e3RoaXMuc3RhdGUuc2hvd2luZ1Byb3BlcnRpZXNNb2RhbH1cbiAgICAgICAgICAgIG9uSGlkZT17dGhpcy5oaWRlUHJvcGVydGllc01vZGFsfVxuICAgICAgICAgICAgY29sb3JTY2hlbWU9e3RoaXMucHJvcHMuY29sb3JTY2hlbWV9XG4gICAgICAgICAgICBvblN1Ym1pdD17aGFuZGxlT25Qcm9wZXJ0aWVzQ2hhbmdlfVxuICAgICAgICAgICAgb25seUFwcGx5XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cblxuICAgICAgICA8T3ZlcndyaXRlQ29uZmlybSAvPlxuXG4gICAgICAgIHt1c2VyQ2FuQ3VyYXRlICYmIChcbiAgICAgICAgICA8RGFzaGJvYXJkRW1iZWRNb2RhbFxuICAgICAgICAgICAgc2hvdz17dGhpcy5zdGF0ZS5zaG93aW5nRW1iZWRNb2RhbH1cbiAgICAgICAgICAgIG9uSGlkZT17dGhpcy5oaWRlRW1iZWRNb2RhbH1cbiAgICAgICAgICAgIGRhc2hib2FyZElkPXtkYXNoYm9hcmRJbmZvLmlkfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxHbG9iYWxcbiAgICAgICAgICBzdHlsZXM9e2Nzc2BcbiAgICAgICAgICAgIC5hbnQtbWVudS12ZXJ0aWNhbCB7XG4gICAgICAgICAgICAgIGJvcmRlci1yaWdodDogbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBgfVxuICAgICAgICAvPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuXG5IZWFkZXIucHJvcFR5cGVzID0gcHJvcFR5cGVzO1xuSGVhZGVyLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcblxuZXhwb3J0IGRlZmF1bHQgSGVhZGVyO1xuIl19 */\"],\n\n                        \"data-test\": \"redo-action\",\n                        iconSize: \"xl\" }\n                      ) }\n                    ) }\n                  )] }\n                ),\n                _jsx(Button, {\n                  css: discardBtnStyle,\n                  buttonSize: \"small\",\n                  onClick: this.constructor.discardChanges,\n                  buttonStyle: \"default\",\n                  \"data-test\": \"discard-changes-button\",\n                  \"aria-label\": t('Discard'), children:\n\n                  t('Discard') }\n                ),\n                _jsx(Button, {\n                  css: saveBtnStyle,\n                  buttonSize: \"small\",\n                  disabled: !hasUnsavedChanges,\n                  buttonStyle: \"primary\",\n                  onClick: this.overwriteDashboard,\n                  \"data-test\": \"header-save-button\",\n                  \"aria-label\": t('Save'), children:\n\n                  t('Save') }\n                )] }\n              ) }\n\n            ),\n\n            editMode ?\n            _jsx(UndoRedoKeyListeners, {\n              onUndo: this.handleCtrlZ,\n              onRedo: this.handleCtrlY }\n            ) :\n\n            _jsxs(\"div\", { css: actionButtonsStyle, children: [\n              NavExtension && _jsx(NavExtension, {}),\n              userCanEdit &&\n              _jsx(Button, {\n                buttonStyle: \"secondary\",\n                onClick: this.toggleEditMode,\n                \"data-test\": \"edit-dashboard-button\",\n                className: \"action-button\",\n                css: editButtonStyle,\n                \"aria-label\": t('Edit dashboard'), children:\n\n                t('Edit dashboard') }\n              )] }\n\n            )] }\n\n          ),\n\n          menuDropdownProps: {\n            getPopupContainer: (triggerNode) =>\n            triggerNode.closest('.header-with-actions'),\n            visible: this.state.isDropdownVisible,\n            onVisibleChange: this.setIsDropdownVisible\n          },\n          additionalActionsMenu:\n          _jsx(ConnectedHeaderActionsDropdown, {\n            addSuccessToast: this.props.addSuccessToast,\n            addDangerToast: this.props.addDangerToast,\n            dashboardId: dashboardInfo.id,\n            dashboardTitle: dashboardTitle,\n            dashboardInfo: dashboardInfo,\n            dataMask: dataMask,\n            layout: layout,\n            expandedSlices: expandedSlices,\n            customCss: customCss,\n            colorNamespace: colorNamespace,\n            colorScheme: colorScheme,\n            onSave: onSave,\n            onChange: onChange,\n            forceRefreshAllCharts: this.forceRefresh,\n            startPeriodicRender: this.startPeriodicRender,\n            refreshFrequency: refreshFrequency,\n            shouldPersistRefreshFrequency: shouldPersistRefreshFrequency,\n            setRefreshFrequency: setRefreshFrequency,\n            updateCss: updateCss,\n            editMode: editMode,\n            hasUnsavedChanges: hasUnsavedChanges,\n            userCanEdit: userCanEdit,\n            userCanShare: userCanShare,\n            userCanSave: userCanSaveAs,\n            userCanCurate: userCanCurate,\n            isLoading: isLoading,\n            showPropertiesModal: this.showPropertiesModal,\n            manageEmbedded: this.showEmbedModal,\n            refreshLimit: refreshLimit,\n            refreshWarning: refreshWarning,\n            lastModifiedTime: lastModifiedTime,\n            isDropdownVisible: this.state.isDropdownVisible,\n            setIsDropdownVisible: this.setIsDropdownVisible,\n            logEvent: logEvent }\n          ),\n\n          showFaveStar: (user == null ? void 0 : user.userId) && (dashboardInfo == null ? void 0 : dashboardInfo.id),\n          showTitlePanelItems: true }\n        ),\n        this.state.showingPropertiesModal &&\n        _jsx(PropertiesModal, {\n          dashboardId: dashboardInfo.id,\n          dashboardInfo: dashboardInfo,\n          dashboardTitle: dashboardTitle,\n          show: this.state.showingPropertiesModal,\n          onHide: this.hidePropertiesModal,\n          colorScheme: this.props.colorScheme,\n          onSubmit: handleOnPropertiesChange,\n          onlyApply: true }\n        ),\n\n\n        _jsx(OverwriteConfirm, {}),\n\n        userCanCurate &&\n        _jsx(DashboardEmbedModal, {\n          show: this.state.showingEmbedModal,\n          onHide: this.hideEmbedModal,\n          dashboardId: dashboardInfo.id }\n        ),\n\n        _jsx(Global, {\n          styles: css`\n            .ant-menu-vertical {\n              border-right: none;\n            }\n          ` }\n        )] }\n      ));\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nHeader.propTypes = propTypes;\nHeader.defaultProps = defaultProps;const _default =\n\nHeader;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(extensionsRegistry, \"extensionsRegistry\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(propTypes, \"propTypes\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(headerContainerStyle, \"headerContainerStyle\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(editButtonStyle, \"editButtonStyle\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(actionButtonsStyle, \"actionButtonsStyle\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(StyledUndoRedoButton, \"StyledUndoRedoButton\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(undoRedoStyle, \"undoRedoStyle\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(undoRedoEmphasized, \"undoRedoEmphasized\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(undoRedoDisabled, \"undoRedoDisabled\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(saveBtnStyle, \"saveBtnStyle\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(discardBtnStyle, \"discardBtnStyle\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(Header, \"Header\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/dashboard/components/Header/index.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["moment","PureComponent","PropTypes","styled","css","isFeatureEnabled","FeatureFlag","t","getExtensionsRegistry","Global","LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD","LOG_ACTIONS_FORCE_REFRESH_DASHBOARD","LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD","Icons","Button","AntdButton","findPermission","Tooltip","safeStringify","ConnectedHeaderActionsDropdown","PublishedStatus","UndoRedoKeyListeners","PropertiesModal","chartPropShape","getOwnerName","UNDO_LIMIT","SAVE_TYPE_OVERWRITE","DASHBOARD_POSITION_DATA_LIMIT","setPeriodicRunner","stopPeriodicRender","PageHeaderWithActions","MetadataBar","MetadataType","DashboardEmbedModal","OverwriteConfirm","jsx","_jsx","jsxs","_jsxs","extensionsRegistry","propTypes","addSuccessToast","func","isRequired","addDangerToast","addWarningToast","user","object","dashboardInfo","dashboardTitle","string","dataMask","charts","objectOf","layout","expandedSlices","customCss","colorNamespace","colorScheme","setColorScheme","setUnsavedChanges","isStarred","bool","isPublished","isLoading","onSave","onChange","fetchFaveStar","fetchCharts","saveFaveStar","savePublished","updateDashboardTitle","editMode","setEditMode","showBuilderPane","updateCss","logEvent","hasUnsavedChanges","maxUndoHistoryExceeded","lastModifiedTime","number","onRefresh","onUndo","onRedo","undoLength","redoLength","setMaxUndoHistoryExceeded","maxUndoHistoryToast","refreshFrequency","shouldPersistRefreshFrequency","setRefreshFrequency","dashboardInfoChanged","dashboardTitleChanged","defaultProps","undefined","headerContainerStyle","theme","colors","grayscale","light2","editButtonStyle","primary","dark2","actionButtonsStyle","gridUnit","StyledUndoRedoButton","undoRedoStyle","light1","base","undoRedoEmphasized","undoRedoDisabled","saveBtnStyle","discardBtnStyle","Header","discardChanges","url","URL","window","location","href","searchParams","delete","assign","constructor","props","showEmbedModal","setState","showingEmbedModal","hideEmbedModal","getMetadataItems","type","LastModified","value","changed_on_delta_humanized","modifiedBy","changed_by","Owner","createdBy","created_by","owners","length","map","createdOn","created_on_delta_humanized","state","didNotifyMaxUndoHistoryToast","emphasizeUndo","emphasizeRedo","showingPropertiesModal","isDropdownVisible","handleChangeText","bind","handleCtrlZ","handleCtrlY","toggleEditMode","forceRefresh","startPeriodicRender","overwriteDashboard","showPropertiesModal","hidePropertiesModal","setIsDropdownVisible","componentDidMount","componentDidUpdate","prevProps","UNSAFE_componentWillReceiveProps","nextProps","componentWillUnmount","refreshTimer","clearTimeout","ctrlYTimeout","ctrlZTimeout","nextText","visible","setTimeout","chartList","Object","keys","force","interval","chartCount","id","intervalMessage","_dashboardInfo$common","_dashboardInfo$common2","periodicRefreshOptions","common","conf","DASHBOARD_AUTO_REFRESH_INTERVALS","predefinedValue","find","option","Number","duration","humanize","periodicRender","metadata","immune","timed_refresh_immune_slices","affectedCharts","values","filter","chart","indexOf","DASHBOARD_AUTO_REFRESH_MODE","edit_mode","_dashboardInfo$metada","_dashboardInfo$metada2","_dashboardInfo$metada3","positions","currentRefreshFrequency","slug","refresh_frequency","currentColorNamespace","color_namespace","currentColorScheme","color_scheme","data","certified_by","certification_details","dashboard_title","last_modified_time","roles","positionJSONLength","limit","SUPERSET_DASHBOARD_POSITION_DATA_LIMIT","render","_dashboardInfo$common3","_dashboardInfo$common4","_dashboardInfo$common5","_dashboardInfo$common6","userCanEdit","dash_edit_perm","is_managed_externally","userCanShare","dash_share_perm","userCanSaveAs","dash_save_perm","userCanCurate","EmbeddedSuperset","refreshLimit","SUPERSET_DASHBOARD_PERIODICAL_REFRESH_LIMIT","refreshWarning","SUPERSET_DASHBOARD_PERIODICAL_REFRESH_WARNING_MESSAGE","handleOnPropertiesChange","updates","JSON","parse","jsonMetadata","certifiedBy","certificationDetails","title","NavExtension","get","className","children","editableTitleProps","canEdit","placeholder","label","showTooltip","certificatiedBadgeProps","details","faveStarProps","itemId","titlePanelAdditionalItems","dashboardId","canSave","items","tooltipPlacement","rightPanelAdditionalItems","disabled","onClick","Undo","process","env","NODE_ENV","iconSize","Redo","buttonSize","buttonStyle","menuDropdownProps","getPopupContainer","triggerNode","closest","onVisibleChange","additionalActionsMenu","forceRefreshAllCharts","userCanSave","manageEmbedded","showFaveStar","userId","showTitlePanelItems","show","onHide","onSubmit","onlyApply","styles","__reactstandin__regenerateByEval","key","code","eval","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/app/superset-frontend/src/dashboard/components/Header/index.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport moment from 'moment';\nimport { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  styled,\n  css,\n  isFeatureEnabled,\n  FeatureFlag,\n  t,\n  getExtensionsRegistry,\n} from '@superset-ui/core';\nimport { Global } from '@emotion/react';\nimport {\n  LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD,\n  LOG_ACTIONS_FORCE_REFRESH_DASHBOARD,\n  LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD,\n} from 'src/logger/LogUtils';\nimport Icons from 'src/components/Icons';\nimport Button from 'src/components/Button';\nimport { AntdButton } from 'src/components/';\nimport { findPermission } from 'src/utils/findPermission';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { safeStringify } from 'src/utils/safeStringify';\nimport ConnectedHeaderActionsDropdown from 'src/dashboard/components/Header/HeaderActionsDropdown';\nimport PublishedStatus from 'src/dashboard/components/PublishedStatus';\nimport UndoRedoKeyListeners from 'src/dashboard/components/UndoRedoKeyListeners';\nimport PropertiesModal from 'src/dashboard/components/PropertiesModal';\nimport { chartPropShape } from 'src/dashboard/util/propShapes';\nimport getOwnerName from 'src/utils/getOwnerName';\nimport {\n  UNDO_LIMIT,\n  SAVE_TYPE_OVERWRITE,\n  DASHBOARD_POSITION_DATA_LIMIT,\n} from 'src/dashboard/util/constants';\nimport setPeriodicRunner, {\n  stopPeriodicRender,\n} from 'src/dashboard/util/setPeriodicRunner';\nimport { PageHeaderWithActions } from 'src/components/PageHeaderWithActions';\nimport MetadataBar, { MetadataType } from 'src/components/MetadataBar';\nimport DashboardEmbedModal from '../EmbeddedModal';\nimport OverwriteConfirm from '../OverwriteConfirm';\n\nconst extensionsRegistry = getExtensionsRegistry();\n\nconst propTypes = {\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  addWarningToast: PropTypes.func.isRequired,\n  user: PropTypes.object, // UserWithPermissionsAndRoles,\n  dashboardInfo: PropTypes.object.isRequired,\n  dashboardTitle: PropTypes.string,\n  dataMask: PropTypes.object.isRequired,\n  charts: PropTypes.objectOf(chartPropShape).isRequired,\n  layout: PropTypes.object.isRequired,\n  expandedSlices: PropTypes.object,\n  customCss: PropTypes.string,\n  colorNamespace: PropTypes.string,\n  colorScheme: PropTypes.string,\n  setColorScheme: PropTypes.func.isRequired,\n  setUnsavedChanges: PropTypes.func.isRequired,\n  isStarred: PropTypes.bool.isRequired,\n  isPublished: PropTypes.bool.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  onSave: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  fetchFaveStar: PropTypes.func.isRequired,\n  fetchCharts: PropTypes.func.isRequired,\n  saveFaveStar: PropTypes.func.isRequired,\n  savePublished: PropTypes.func.isRequired,\n  updateDashboardTitle: PropTypes.func.isRequired,\n  editMode: PropTypes.bool.isRequired,\n  setEditMode: PropTypes.func.isRequired,\n  showBuilderPane: PropTypes.func.isRequired,\n  updateCss: PropTypes.func.isRequired,\n  logEvent: PropTypes.func.isRequired,\n  hasUnsavedChanges: PropTypes.bool.isRequired,\n  maxUndoHistoryExceeded: PropTypes.bool.isRequired,\n  lastModifiedTime: PropTypes.number.isRequired,\n\n  // redux\n  onRefresh: PropTypes.func.isRequired,\n  onUndo: PropTypes.func.isRequired,\n  onRedo: PropTypes.func.isRequired,\n  undoLength: PropTypes.number.isRequired,\n  redoLength: PropTypes.number.isRequired,\n  setMaxUndoHistoryExceeded: PropTypes.func.isRequired,\n  maxUndoHistoryToast: PropTypes.func.isRequired,\n  refreshFrequency: PropTypes.number,\n  shouldPersistRefreshFrequency: PropTypes.bool.isRequired,\n  setRefreshFrequency: PropTypes.func.isRequired,\n  dashboardInfoChanged: PropTypes.func.isRequired,\n  dashboardTitleChanged: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  colorNamespace: undefined,\n  colorScheme: undefined,\n};\n\nconst headerContainerStyle = theme => css`\n  border-bottom: 1px solid ${theme.colors.grayscale.light2};\n`;\n\nconst editButtonStyle = theme => css`\n  color: ${theme.colors.primary.dark2};\n`;\n\nconst actionButtonsStyle = theme => css`\n  display: flex;\n  align-items: center;\n\n  .action-schedule-report {\n    margin-left: ${theme.gridUnit * 2}px;\n  }\n\n  .undoRedo {\n    display: flex;\n    margin-right: ${theme.gridUnit * 2}px;\n  }\n`;\n\nconst StyledUndoRedoButton = styled(AntdButton)`\n  padding: 0;\n  &:hover {\n    background: transparent;\n  }\n`;\n\nconst undoRedoStyle = theme => css`\n  color: ${theme.colors.grayscale.light1};\n  &:hover {\n    color: ${theme.colors.grayscale.base};\n  }\n`;\n\nconst undoRedoEmphasized = theme => css`\n  color: ${theme.colors.grayscale.base};\n`;\n\nconst undoRedoDisabled = theme => css`\n  color: ${theme.colors.grayscale.light2};\n`;\n\nconst saveBtnStyle = theme => css`\n  min-width: ${theme.gridUnit * 17}px;\n  height: ${theme.gridUnit * 8}px;\n`;\n\nconst discardBtnStyle = theme => css`\n  min-width: ${theme.gridUnit * 22}px;\n  height: ${theme.gridUnit * 8}px;\n`;\n\nclass Header extends PureComponent {\n  static discardChanges() {\n    const url = new URL(window.location.href);\n\n    url.searchParams.delete('edit');\n    window.location.assign(url);\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      didNotifyMaxUndoHistoryToast: false,\n      emphasizeUndo: false,\n      emphasizeRedo: false,\n      showingPropertiesModal: false,\n      isDropdownVisible: false,\n    };\n\n    this.handleChangeText = this.handleChangeText.bind(this);\n    this.handleCtrlZ = this.handleCtrlZ.bind(this);\n    this.handleCtrlY = this.handleCtrlY.bind(this);\n    this.toggleEditMode = this.toggleEditMode.bind(this);\n    this.forceRefresh = this.forceRefresh.bind(this);\n    this.startPeriodicRender = this.startPeriodicRender.bind(this);\n    this.overwriteDashboard = this.overwriteDashboard.bind(this);\n    this.showPropertiesModal = this.showPropertiesModal.bind(this);\n    this.hidePropertiesModal = this.hidePropertiesModal.bind(this);\n    this.setIsDropdownVisible = this.setIsDropdownVisible.bind(this);\n  }\n\n  componentDidMount() {\n    const { refreshFrequency } = this.props;\n    this.startPeriodicRender(refreshFrequency * 1000);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.refreshFrequency !== prevProps.refreshFrequency) {\n      const { refreshFrequency } = this.props;\n      this.startPeriodicRender(refreshFrequency * 1000);\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (\n      UNDO_LIMIT - nextProps.undoLength <= 0 &&\n      !this.state.didNotifyMaxUndoHistoryToast\n    ) {\n      this.setState(() => ({ didNotifyMaxUndoHistoryToast: true }));\n      this.props.maxUndoHistoryToast();\n    }\n    if (\n      nextProps.undoLength > UNDO_LIMIT &&\n      !this.props.maxUndoHistoryExceeded\n    ) {\n      this.props.setMaxUndoHistoryExceeded();\n    }\n  }\n\n  componentWillUnmount() {\n    stopPeriodicRender(this.refreshTimer);\n    this.props.setRefreshFrequency(0);\n    clearTimeout(this.ctrlYTimeout);\n    clearTimeout(this.ctrlZTimeout);\n  }\n\n  handleChangeText(nextText) {\n    const { updateDashboardTitle, onChange } = this.props;\n    if (nextText && this.props.dashboardTitle !== nextText) {\n      updateDashboardTitle(nextText);\n      onChange();\n    }\n  }\n\n  setIsDropdownVisible(visible) {\n    this.setState({\n      isDropdownVisible: visible,\n    });\n  }\n\n  handleCtrlY() {\n    this.props.onRedo();\n    this.setState({ emphasizeRedo: true }, () => {\n      if (this.ctrlYTimeout) clearTimeout(this.ctrlYTimeout);\n      this.ctrlYTimeout = setTimeout(() => {\n        this.setState({ emphasizeRedo: false });\n      }, 100);\n    });\n  }\n\n  handleCtrlZ() {\n    this.props.onUndo();\n    this.setState({ emphasizeUndo: true }, () => {\n      if (this.ctrlZTimeout) clearTimeout(this.ctrlZTimeout);\n      this.ctrlZTimeout = setTimeout(() => {\n        this.setState({ emphasizeUndo: false });\n      }, 100);\n    });\n  }\n\n  forceRefresh() {\n    if (!this.props.isLoading) {\n      const chartList = Object.keys(this.props.charts);\n      this.props.logEvent(LOG_ACTIONS_FORCE_REFRESH_DASHBOARD, {\n        force: true,\n        interval: 0,\n        chartCount: chartList.length,\n      });\n      return this.props.onRefresh(\n        chartList,\n        true,\n        0,\n        this.props.dashboardInfo.id,\n      );\n    }\n    return false;\n  }\n\n  startPeriodicRender(interval) {\n    let intervalMessage;\n\n    if (interval) {\n      const { dashboardInfo } = this.props;\n      const periodicRefreshOptions =\n        dashboardInfo.common?.conf?.DASHBOARD_AUTO_REFRESH_INTERVALS;\n      const predefinedValue = periodicRefreshOptions.find(\n        option => Number(option[0]) === interval / 1000,\n      );\n\n      if (predefinedValue) {\n        intervalMessage = t(predefinedValue[1]);\n      } else {\n        intervalMessage = moment.duration(interval, 'millisecond').humanize();\n      }\n    }\n\n    const periodicRender = () => {\n      const { fetchCharts, logEvent, charts, dashboardInfo } = this.props;\n      const { metadata } = dashboardInfo;\n      const immune = metadata.timed_refresh_immune_slices || [];\n      const affectedCharts = Object.values(charts)\n        .filter(chart => immune.indexOf(chart.id) === -1)\n        .map(chart => chart.id);\n\n      logEvent(LOG_ACTIONS_PERIODIC_RENDER_DASHBOARD, {\n        interval,\n        chartCount: affectedCharts.length,\n      });\n      this.props.addWarningToast(\n        t(\n          `This dashboard is currently auto refreshing; the next auto refresh will be in %s.`,\n          intervalMessage,\n        ),\n      );\n      if (dashboardInfo.common.conf.DASHBOARD_AUTO_REFRESH_MODE === 'fetch') {\n        // force-refresh while auto-refresh in dashboard\n        return fetchCharts(\n          affectedCharts,\n          false,\n          interval * 0.2,\n          dashboardInfo.id,\n        );\n      }\n      return fetchCharts(\n        affectedCharts,\n        true,\n        interval * 0.2,\n        dashboardInfo.id,\n      );\n    };\n\n    this.refreshTimer = setPeriodicRunner({\n      interval,\n      periodicRender,\n      refreshTimer: this.refreshTimer,\n    });\n  }\n\n  toggleEditMode() {\n    this.props.logEvent(LOG_ACTIONS_TOGGLE_EDIT_DASHBOARD, {\n      edit_mode: !this.props.editMode,\n    });\n    this.props.setEditMode(!this.props.editMode);\n  }\n\n  overwriteDashboard() {\n    const {\n      dashboardTitle,\n      layout: positions,\n      colorScheme,\n      colorNamespace,\n      customCss,\n      dashboardInfo,\n      refreshFrequency: currentRefreshFrequency,\n      shouldPersistRefreshFrequency,\n      lastModifiedTime,\n      slug,\n    } = this.props;\n\n    // check refresh frequency is for current session or persist\n    const refreshFrequency = shouldPersistRefreshFrequency\n      ? currentRefreshFrequency\n      : dashboardInfo.metadata?.refresh_frequency;\n\n    const currentColorNamespace =\n      dashboardInfo?.metadata?.color_namespace || colorNamespace;\n    const currentColorScheme =\n      dashboardInfo?.metadata?.color_scheme || colorScheme;\n\n    const data = {\n      certified_by: dashboardInfo.certified_by,\n      certification_details: dashboardInfo.certification_details,\n      css: customCss,\n      dashboard_title: dashboardTitle,\n      last_modified_time: lastModifiedTime,\n      owners: dashboardInfo.owners,\n      roles: dashboardInfo.roles,\n      slug,\n      metadata: {\n        ...dashboardInfo?.metadata,\n        color_namespace: currentColorNamespace,\n        color_scheme: currentColorScheme,\n        positions,\n        refresh_frequency: refreshFrequency,\n      },\n    };\n\n    // make sure positions data less than DB storage limitation:\n    const positionJSONLength = safeStringify(positions).length;\n    const limit =\n      dashboardInfo.common.conf.SUPERSET_DASHBOARD_POSITION_DATA_LIMIT ||\n      DASHBOARD_POSITION_DATA_LIMIT;\n    if (positionJSONLength >= limit) {\n      this.props.addDangerToast(\n        t(\n          'Your dashboard is too large. Please reduce its size before saving it.',\n        ),\n      );\n    } else {\n      if (positionJSONLength >= limit * 0.9) {\n        this.props.addWarningToast('Your dashboard is near the size limit.');\n      }\n\n      this.props.onSave(data, dashboardInfo.id, SAVE_TYPE_OVERWRITE);\n    }\n  }\n\n  showPropertiesModal() {\n    this.setState({ showingPropertiesModal: true });\n  }\n\n  hidePropertiesModal() {\n    this.setState({ showingPropertiesModal: false });\n  }\n\n  showEmbedModal = () => {\n    this.setState({ showingEmbedModal: true });\n  };\n\n  hideEmbedModal = () => {\n    this.setState({ showingEmbedModal: false });\n  };\n\n  getMetadataItems = () => {\n    const { dashboardInfo } = this.props;\n    return [\n      {\n        type: MetadataType.LastModified,\n        value: dashboardInfo.changed_on_delta_humanized,\n        modifiedBy:\n          getOwnerName(dashboardInfo.changed_by) || t('Not available'),\n      },\n      {\n        type: MetadataType.Owner,\n        createdBy: getOwnerName(dashboardInfo.created_by) || t('Not available'),\n        owners:\n          dashboardInfo.owners.length > 0\n            ? dashboardInfo.owners.map(getOwnerName)\n            : t('None'),\n        createdOn: dashboardInfo.created_on_delta_humanized,\n      },\n    ];\n  };\n\n  render() {\n    const {\n      dashboardTitle,\n      layout,\n      expandedSlices,\n      customCss,\n      colorNamespace,\n      dataMask,\n      setColorScheme,\n      setUnsavedChanges,\n      colorScheme,\n      onUndo,\n      onRedo,\n      undoLength,\n      redoLength,\n      onChange,\n      onSave,\n      updateCss,\n      editMode,\n      isPublished,\n      user,\n      dashboardInfo,\n      hasUnsavedChanges,\n      isLoading,\n      refreshFrequency,\n      shouldPersistRefreshFrequency,\n      setRefreshFrequency,\n      lastModifiedTime,\n      logEvent,\n    } = this.props;\n\n    const userCanEdit =\n      dashboardInfo.dash_edit_perm && !dashboardInfo.is_managed_externally;\n    const userCanShare = dashboardInfo.dash_share_perm;\n    const userCanSaveAs = dashboardInfo.dash_save_perm;\n    const userCanCurate =\n      isFeatureEnabled(FeatureFlag.EmbeddedSuperset) &&\n      findPermission('can_set_embedded', 'Dashboard', user.roles);\n    const refreshLimit =\n      dashboardInfo.common?.conf?.SUPERSET_DASHBOARD_PERIODICAL_REFRESH_LIMIT;\n    const refreshWarning =\n      dashboardInfo.common?.conf\n        ?.SUPERSET_DASHBOARD_PERIODICAL_REFRESH_WARNING_MESSAGE;\n\n    const handleOnPropertiesChange = updates => {\n      const { dashboardInfoChanged, dashboardTitleChanged } = this.props;\n\n      setColorScheme(updates.colorScheme);\n      dashboardInfoChanged({\n        slug: updates.slug,\n        metadata: JSON.parse(updates.jsonMetadata || '{}'),\n        certified_by: updates.certifiedBy,\n        certification_details: updates.certificationDetails,\n        owners: updates.owners,\n        roles: updates.roles,\n      });\n      setUnsavedChanges(true);\n      dashboardTitleChanged(updates.title);\n    };\n\n    const NavExtension = extensionsRegistry.get('dashboard.nav.right');\n\n    return (\n      <div\n        css={headerContainerStyle}\n        data-test=\"dashboard-header-container\"\n        data-test-id={dashboardInfo.id}\n        className=\"dashboard-header-container\"\n      >\n        <PageHeaderWithActions\n          editableTitleProps={{\n            title: dashboardTitle,\n            canEdit: userCanEdit && editMode,\n            onSave: this.handleChangeText,\n            placeholder: t('Add the name of the dashboard'),\n            label: t('Dashboard title'),\n            showTooltip: false,\n          }}\n          certificatiedBadgeProps={{\n            certifiedBy: dashboardInfo.certified_by,\n            details: dashboardInfo.certification_details,\n          }}\n          faveStarProps={{\n            itemId: dashboardInfo.id,\n            fetchFaveStar: this.props.fetchFaveStar,\n            saveFaveStar: this.props.saveFaveStar,\n            isStarred: this.props.isStarred,\n            showTooltip: true,\n          }}\n          titlePanelAdditionalItems={[\n            !editMode && (\n              <PublishedStatus\n                dashboardId={dashboardInfo.id}\n                isPublished={isPublished}\n                savePublished={this.props.savePublished}\n                canEdit={userCanEdit}\n                canSave={userCanSaveAs}\n                visible={!editMode}\n              />\n            ),\n            !editMode && (\n              <MetadataBar\n                items={this.getMetadataItems()}\n                tooltipPlacement=\"bottom\"\n              />\n            ),\n          ]}\n          rightPanelAdditionalItems={\n            <div className=\"button-container\">\n              {userCanSaveAs && (\n                <div\n                  className=\"button-container\"\n                  data-test=\"dashboard-edit-actions\"\n                >\n                  {editMode && (\n                    <div css={actionButtonsStyle}>\n                      <div className=\"undoRedo\">\n                        <Tooltip\n                          id=\"dashboard-undo-tooltip\"\n                          title={t('Undo the action')}\n                        >\n                          <StyledUndoRedoButton\n                            type=\"text\"\n                            disabled={undoLength < 1}\n                            onClick={undoLength && onUndo}\n                          >\n                            <Icons.Undo\n                              css={[\n                                undoRedoStyle,\n                                this.state.emphasizeUndo && undoRedoEmphasized,\n                                undoLength < 1 && undoRedoDisabled,\n                              ]}\n                              data-test=\"undo-action\"\n                              iconSize=\"xl\"\n                            />\n                          </StyledUndoRedoButton>\n                        </Tooltip>\n                        <Tooltip\n                          id=\"dashboard-redo-tooltip\"\n                          title={t('Redo the action')}\n                        >\n                          <StyledUndoRedoButton\n                            type=\"text\"\n                            disabled={redoLength < 1}\n                            onClick={redoLength && onRedo}\n                          >\n                            <Icons.Redo\n                              css={[\n                                undoRedoStyle,\n                                this.state.emphasizeRedo && undoRedoEmphasized,\n                                redoLength < 1 && undoRedoDisabled,\n                              ]}\n                              data-test=\"redo-action\"\n                              iconSize=\"xl\"\n                            />\n                          </StyledUndoRedoButton>\n                        </Tooltip>\n                      </div>\n                      <Button\n                        css={discardBtnStyle}\n                        buttonSize=\"small\"\n                        onClick={this.constructor.discardChanges}\n                        buttonStyle=\"default\"\n                        data-test=\"discard-changes-button\"\n                        aria-label={t('Discard')}\n                      >\n                        {t('Discard')}\n                      </Button>\n                      <Button\n                        css={saveBtnStyle}\n                        buttonSize=\"small\"\n                        disabled={!hasUnsavedChanges}\n                        buttonStyle=\"primary\"\n                        onClick={this.overwriteDashboard}\n                        data-test=\"header-save-button\"\n                        aria-label={t('Save')}\n                      >\n                        {t('Save')}\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              )}\n              {editMode ? (\n                <UndoRedoKeyListeners\n                  onUndo={this.handleCtrlZ}\n                  onRedo={this.handleCtrlY}\n                />\n              ) : (\n                <div css={actionButtonsStyle}>\n                  {NavExtension && <NavExtension />}\n                  {userCanEdit && (\n                    <Button\n                      buttonStyle=\"secondary\"\n                      onClick={this.toggleEditMode}\n                      data-test=\"edit-dashboard-button\"\n                      className=\"action-button\"\n                      css={editButtonStyle}\n                      aria-label={t('Edit dashboard')}\n                    >\n                      {t('Edit dashboard')}\n                    </Button>\n                  )}\n                </div>\n              )}\n            </div>\n          }\n          menuDropdownProps={{\n            getPopupContainer: triggerNode =>\n              triggerNode.closest('.header-with-actions'),\n            visible: this.state.isDropdownVisible,\n            onVisibleChange: this.setIsDropdownVisible,\n          }}\n          additionalActionsMenu={\n            <ConnectedHeaderActionsDropdown\n              addSuccessToast={this.props.addSuccessToast}\n              addDangerToast={this.props.addDangerToast}\n              dashboardId={dashboardInfo.id}\n              dashboardTitle={dashboardTitle}\n              dashboardInfo={dashboardInfo}\n              dataMask={dataMask}\n              layout={layout}\n              expandedSlices={expandedSlices}\n              customCss={customCss}\n              colorNamespace={colorNamespace}\n              colorScheme={colorScheme}\n              onSave={onSave}\n              onChange={onChange}\n              forceRefreshAllCharts={this.forceRefresh}\n              startPeriodicRender={this.startPeriodicRender}\n              refreshFrequency={refreshFrequency}\n              shouldPersistRefreshFrequency={shouldPersistRefreshFrequency}\n              setRefreshFrequency={setRefreshFrequency}\n              updateCss={updateCss}\n              editMode={editMode}\n              hasUnsavedChanges={hasUnsavedChanges}\n              userCanEdit={userCanEdit}\n              userCanShare={userCanShare}\n              userCanSave={userCanSaveAs}\n              userCanCurate={userCanCurate}\n              isLoading={isLoading}\n              showPropertiesModal={this.showPropertiesModal}\n              manageEmbedded={this.showEmbedModal}\n              refreshLimit={refreshLimit}\n              refreshWarning={refreshWarning}\n              lastModifiedTime={lastModifiedTime}\n              isDropdownVisible={this.state.isDropdownVisible}\n              setIsDropdownVisible={this.setIsDropdownVisible}\n              logEvent={logEvent}\n            />\n          }\n          showFaveStar={user?.userId && dashboardInfo?.id}\n          showTitlePanelItems\n        />\n        {this.state.showingPropertiesModal && (\n          <PropertiesModal\n            dashboardId={dashboardInfo.id}\n            dashboardInfo={dashboardInfo}\n            dashboardTitle={dashboardTitle}\n            show={this.state.showingPropertiesModal}\n            onHide={this.hidePropertiesModal}\n            colorScheme={this.props.colorScheme}\n            onSubmit={handleOnPropertiesChange}\n            onlyApply\n          />\n        )}\n\n        <OverwriteConfirm />\n\n        {userCanCurate && (\n          <DashboardEmbedModal\n            show={this.state.showingEmbedModal}\n            onHide={this.hideEmbedModal}\n            dashboardId={dashboardInfo.id}\n          />\n        )}\n        <Global\n          styles={css`\n            .ant-menu-vertical {\n              border-right: none;\n            }\n          `}\n        />\n      </div>\n    );\n  }\n}\n\nHeader.propTypes = propTypes;\nHeader.defaultProps = defaultProps;\n\nexport default Header;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}