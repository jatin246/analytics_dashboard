{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { createContext, lazy, useEffect, useMemo, useRef } from 'react';\nimport { Global } from '@emotion/react';\nimport { useHistory } from 'react-router-dom';\nimport { t, useTheme } from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Loading from 'src/components/Loading';\nimport { useDashboard, useDashboardCharts, useDashboardDatasets } from 'src/hooks/apiResources';\nimport { hydrateDashboard } from 'src/dashboard/actions/hydrate';\nimport { setDatasources } from 'src/dashboard/actions/datasources';\nimport injectCustomCss from 'src/dashboard/util/injectCustomCss';\nimport { LocalStorageKeys, setItem } from 'src/utils/localStorageHelpers';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { setDatasetsStatus } from 'src/dashboard/actions/dashboardState';\nimport { getFilterValue, getPermalinkValue } from 'src/dashboard/components/nativeFilters/FilterBar/keyValue';\nimport DashboardContainer from 'src/dashboard/containers/Dashboard';\nimport { nanoid } from 'nanoid';\nimport { chartContextMenuStyles, filterCardPopoverStyle, focusStyle, headerStyles, chartHeaderStyles } from '../styles';\nimport SyncDashboardState, { getDashboardContextLocalStorage } from '../components/SyncDashboardState';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nexport const DashboardPageIdContext = /*#__PURE__*/createContext('');\nconst DashboardBuilder = /*#__PURE__*/lazy(() => import(\n  /* webpackChunkName: \"DashboardContainer\" */\n  /* webpackPreload: true */\n  'src/dashboard/components/DashboardBuilder/DashboardBuilder'));\nconst originalDocumentTitle = document.title;\nexport const DashboardPage = ({ idOrSlug }) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const dashboardPageId = useMemo(() => nanoid(), []);\n  const hasDashboardInfoInitiated = useSelector(({ dashboardInfo }) => dashboardInfo && Object.keys(dashboardInfo).length > 0);\n  const { addDangerToast } = useToasts();\n  const { result: dashboard, error: dashboardApiError } = useDashboard(idOrSlug);\n  const { result: charts, error: chartsApiError } = useDashboardCharts(idOrSlug);\n  const { result: datasets, error: datasetsApiError, status } = useDashboardDatasets(idOrSlug);\n  const isDashboardHydrated = useRef(false);\n  const error = dashboardApiError || chartsApiError;\n  const readyToRender = Boolean(dashboard && charts);\n  const { dashboard_title, css, id = 0 } = dashboard || {};\n  useEffect(() => {\n    // mark tab id as redundant when user closes browser tab - a new id will be\n    // generated next time user opens a dashboard and the old one won't be reused\n    const handleTabClose = () => {\n      const dashboardsContexts = getDashboardContextLocalStorage();\n      setItem(LocalStorageKeys.DashboardExploreContext, {\n        ...dashboardsContexts,\n        [dashboardPageId]: {\n          ...dashboardsContexts[dashboardPageId],\n          isRedundant: true\n        }\n      });\n    };\n    window.addEventListener('beforeunload', handleTabClose);\n    return () => {\n      window.removeEventListener('beforeunload', handleTabClose);\n    };\n  }, [dashboardPageId]);\n  useEffect(() => {\n    dispatch(setDatasetsStatus(status));\n  }, [dispatch, status]);\n  useEffect(() => {\n    // eslint-disable-next-line consistent-return\n    async function getDataMaskApplied() {\n      const permalinkKey = getUrlParam(URL_PARAMS.permalinkKey);\n      const nativeFilterKeyValue = getUrlParam(URL_PARAMS.nativeFiltersKey);\n      const isOldRison = getUrlParam(URL_PARAMS.nativeFilters);\n      let dataMask = nativeFilterKeyValue || {};\n      // activeTabs is initialized with undefined so that it doesn't override\n      // the currently stored value when hydrating\n      let activeTabs;\n      if (permalinkKey) {\n        const permalinkValue = await getPermalinkValue(permalinkKey);\n        if (permalinkValue) {\n          ({ dataMask, activeTabs } = permalinkValue.state);\n        }\n      } else\n      if (nativeFilterKeyValue) {\n        dataMask = await getFilterValue(id, nativeFilterKeyValue);\n      }\n      if (isOldRison) {\n        dataMask = isOldRison;\n      }\n      if (readyToRender) {\n        if (!isDashboardHydrated.current) {\n          isDashboardHydrated.current = true;\n        }\n        dispatch(hydrateDashboard({\n          history,\n          dashboard,\n          charts,\n          activeTabs,\n          dataMask\n        }));\n      }\n      return null;\n    }\n    if (id)\n    getDataMaskApplied();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [readyToRender]);\n  useEffect(() => {\n    if (dashboard_title) {\n      document.title = dashboard_title;\n    }\n    return () => {\n      document.title = originalDocumentTitle;\n    };\n  }, [dashboard_title]);\n  useEffect(() => {\n    if (typeof css === 'string') {\n      // returning will clean up custom css\n      // when dashboard unmounts or changes\n      return injectCustomCss(css);\n    }\n    return () => {};\n  }, [css]);\n  useEffect(() => {\n    if (datasetsApiError) {\n      addDangerToast(t('Error loading chart datasources. Filters may not work correctly.'));\n    } else\n    {\n      dispatch(setDatasources(datasets));\n    }\n  }, [addDangerToast, datasets, datasetsApiError, dispatch]);\n  if (error)\n  throw error; // caught in error boundary\n  if (!readyToRender || !hasDashboardInfoInitiated)\n  return _jsx(Loading, {});\n  return _jsxs(_Fragment, { children: [\n    _jsx(Global, { styles: [\n      filterCardPopoverStyle(theme),\n      headerStyles(theme),\n      chartContextMenuStyles(theme),\n      focusStyle(theme),\n      chartHeaderStyles(theme), process.env.NODE_ENV === \"production\" ? \"\" : \";label:DashboardPage;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2Rhc2hib2FyZC9jb250YWluZXJzL0Rhc2hib2FyZFBhZ2UudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQW9KYyIsImZpbGUiOiIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9kYXNoYm9hcmQvY29udGFpbmVycy9EYXNoYm9hcmRQYWdlLnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIGxhenksIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgR2xvYmFsIH0gZnJvbSAnQGVtb3Rpb24vcmVhY3QnO1xuaW1wb3J0IHsgdXNlSGlzdG9yeSB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgdCwgdXNlVGhlbWUgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyB1c2VEaXNwYXRjaCwgdXNlU2VsZWN0b3IgfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgeyB1c2VUb2FzdHMgfSBmcm9tICdzcmMvY29tcG9uZW50cy9NZXNzYWdlVG9hc3RzL3dpdGhUb2FzdHMnO1xuaW1wb3J0IExvYWRpbmcgZnJvbSAnc3JjL2NvbXBvbmVudHMvTG9hZGluZyc7XG5pbXBvcnQgeyB1c2VEYXNoYm9hcmQsIHVzZURhc2hib2FyZENoYXJ0cywgdXNlRGFzaGJvYXJkRGF0YXNldHMsIH0gZnJvbSAnc3JjL2hvb2tzL2FwaVJlc291cmNlcyc7XG5pbXBvcnQgeyBoeWRyYXRlRGFzaGJvYXJkIH0gZnJvbSAnc3JjL2Rhc2hib2FyZC9hY3Rpb25zL2h5ZHJhdGUnO1xuaW1wb3J0IHsgc2V0RGF0YXNvdXJjZXMgfSBmcm9tICdzcmMvZGFzaGJvYXJkL2FjdGlvbnMvZGF0YXNvdXJjZXMnO1xuaW1wb3J0IGluamVjdEN1c3RvbUNzcyBmcm9tICdzcmMvZGFzaGJvYXJkL3V0aWwvaW5qZWN0Q3VzdG9tQ3NzJztcbmltcG9ydCB7IExvY2FsU3RvcmFnZUtleXMsIHNldEl0ZW0gfSBmcm9tICdzcmMvdXRpbHMvbG9jYWxTdG9yYWdlSGVscGVycyc7XG5pbXBvcnQgeyBVUkxfUEFSQU1TIH0gZnJvbSAnc3JjL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBnZXRVcmxQYXJhbSB9IGZyb20gJ3NyYy91dGlscy91cmxVdGlscyc7XG5pbXBvcnQgeyBzZXREYXRhc2V0c1N0YXR1cyB9IGZyb20gJ3NyYy9kYXNoYm9hcmQvYWN0aW9ucy9kYXNoYm9hcmRTdGF0ZSc7XG5pbXBvcnQgeyBnZXRGaWx0ZXJWYWx1ZSwgZ2V0UGVybWFsaW5rVmFsdWUsIH0gZnJvbSAnc3JjL2Rhc2hib2FyZC9jb21wb25lbnRzL25hdGl2ZUZpbHRlcnMvRmlsdGVyQmFyL2tleVZhbHVlJztcbmltcG9ydCBEYXNoYm9hcmRDb250YWluZXIgZnJvbSAnc3JjL2Rhc2hib2FyZC9jb250YWluZXJzL0Rhc2hib2FyZCc7XG5pbXBvcnQgeyBuYW5vaWQgfSBmcm9tICduYW5vaWQnO1xuaW1wb3J0IHsgY2hhcnRDb250ZXh0TWVudVN0eWxlcywgZmlsdGVyQ2FyZFBvcG92ZXJTdHlsZSwgZm9jdXNTdHlsZSwgaGVhZGVyU3R5bGVzLCBjaGFydEhlYWRlclN0eWxlcywgfSBmcm9tICcuLi9zdHlsZXMnO1xuaW1wb3J0IFN5bmNEYXNoYm9hcmRTdGF0ZSwgeyBnZXREYXNoYm9hcmRDb250ZXh0TG9jYWxTdG9yYWdlLCB9IGZyb20gJy4uL2NvbXBvbmVudHMvU3luY0Rhc2hib2FyZFN0YXRlJztcbmV4cG9ydCBjb25zdCBEYXNoYm9hcmRQYWdlSWRDb250ZXh0ID0gY3JlYXRlQ29udGV4dCgnJyk7XG5jb25zdCBEYXNoYm9hcmRCdWlsZGVyID0gbGF6eSgoKSA9PiBpbXBvcnQoXG4vKiB3ZWJwYWNrQ2h1bmtOYW1lOiBcIkRhc2hib2FyZENvbnRhaW5lclwiICovXG4vKiB3ZWJwYWNrUHJlbG9hZDogdHJ1ZSAqL1xuJ3NyYy9kYXNoYm9hcmQvY29tcG9uZW50cy9EYXNoYm9hcmRCdWlsZGVyL0Rhc2hib2FyZEJ1aWxkZXInKSk7XG5jb25zdCBvcmlnaW5hbERvY3VtZW50VGl0bGUgPSBkb2N1bWVudC50aXRsZTtcbmV4cG9ydCBjb25zdCBEYXNoYm9hcmRQYWdlID0gKHsgaWRPclNsdWcgfSkgPT4ge1xuICAgIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKTtcbiAgICBjb25zdCBkaXNwYXRjaCA9IHVzZURpc3BhdGNoKCk7XG4gICAgY29uc3QgaGlzdG9yeSA9IHVzZUhpc3RvcnkoKTtcbiAgICBjb25zdCBkYXNoYm9hcmRQYWdlSWQgPSB1c2VNZW1vKCgpID0+IG5hbm9pZCgpLCBbXSk7XG4gICAgY29uc3QgaGFzRGFzaGJvYXJkSW5mb0luaXRpYXRlZCA9IHVzZVNlbGVjdG9yKCh7IGRhc2hib2FyZEluZm8gfSkgPT4gZGFzaGJvYXJkSW5mbyAmJiBPYmplY3Qua2V5cyhkYXNoYm9hcmRJbmZvKS5sZW5ndGggPiAwKTtcbiAgICBjb25zdCB7IGFkZERhbmdlclRvYXN0IH0gPSB1c2VUb2FzdHMoKTtcbiAgICBjb25zdCB7IHJlc3VsdDogZGFzaGJvYXJkLCBlcnJvcjogZGFzaGJvYXJkQXBpRXJyb3IgfSA9IHVzZURhc2hib2FyZChpZE9yU2x1Zyk7XG4gICAgY29uc3QgeyByZXN1bHQ6IGNoYXJ0cywgZXJyb3I6IGNoYXJ0c0FwaUVycm9yIH0gPSB1c2VEYXNoYm9hcmRDaGFydHMoaWRPclNsdWcpO1xuICAgIGNvbnN0IHsgcmVzdWx0OiBkYXRhc2V0cywgZXJyb3I6IGRhdGFzZXRzQXBpRXJyb3IsIHN0YXR1cywgfSA9IHVzZURhc2hib2FyZERhdGFzZXRzKGlkT3JTbHVnKTtcbiAgICBjb25zdCBpc0Rhc2hib2FyZEh5ZHJhdGVkID0gdXNlUmVmKGZhbHNlKTtcbiAgICBjb25zdCBlcnJvciA9IGRhc2hib2FyZEFwaUVycm9yIHx8IGNoYXJ0c0FwaUVycm9yO1xuICAgIGNvbnN0IHJlYWR5VG9SZW5kZXIgPSBCb29sZWFuKGRhc2hib2FyZCAmJiBjaGFydHMpO1xuICAgIGNvbnN0IHsgZGFzaGJvYXJkX3RpdGxlLCBjc3MsIGlkID0gMCB9ID0gZGFzaGJvYXJkIHx8IHt9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIG1hcmsgdGFiIGlkIGFzIHJlZHVuZGFudCB3aGVuIHVzZXIgY2xvc2VzIGJyb3dzZXIgdGFiIC0gYSBuZXcgaWQgd2lsbCBiZVxuICAgICAgICAvLyBnZW5lcmF0ZWQgbmV4dCB0aW1lIHVzZXIgb3BlbnMgYSBkYXNoYm9hcmQgYW5kIHRoZSBvbGQgb25lIHdvbid0IGJlIHJldXNlZFxuICAgICAgICBjb25zdCBoYW5kbGVUYWJDbG9zZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhc2hib2FyZHNDb250ZXh0cyA9IGdldERhc2hib2FyZENvbnRleHRMb2NhbFN0b3JhZ2UoKTtcbiAgICAgICAgICAgIHNldEl0ZW0oTG9jYWxTdG9yYWdlS2V5cy5EYXNoYm9hcmRFeHBsb3JlQ29udGV4dCwge1xuICAgICAgICAgICAgICAgIC4uLmRhc2hib2FyZHNDb250ZXh0cyxcbiAgICAgICAgICAgICAgICBbZGFzaGJvYXJkUGFnZUlkXToge1xuICAgICAgICAgICAgICAgICAgICAuLi5kYXNoYm9hcmRzQ29udGV4dHNbZGFzaGJvYXJkUGFnZUlkXSxcbiAgICAgICAgICAgICAgICAgICAgaXNSZWR1bmRhbnQ6IHRydWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgaGFuZGxlVGFiQ2xvc2UpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGhhbmRsZVRhYkNsb3NlKTtcbiAgICAgICAgfTtcbiAgICB9LCBbZGFzaGJvYXJkUGFnZUlkXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgZGlzcGF0Y2goc2V0RGF0YXNldHNTdGF0dXMoc3RhdHVzKSk7XG4gICAgfSwgW2Rpc3BhdGNoLCBzdGF0dXNdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29uc2lzdGVudC1yZXR1cm5cbiAgICAgICAgYXN5bmMgZnVuY3Rpb24gZ2V0RGF0YU1hc2tBcHBsaWVkKCkge1xuICAgICAgICAgICAgY29uc3QgcGVybWFsaW5rS2V5ID0gZ2V0VXJsUGFyYW0oVVJMX1BBUkFNUy5wZXJtYWxpbmtLZXkpO1xuICAgICAgICAgICAgY29uc3QgbmF0aXZlRmlsdGVyS2V5VmFsdWUgPSBnZXRVcmxQYXJhbShVUkxfUEFSQU1TLm5hdGl2ZUZpbHRlcnNLZXkpO1xuICAgICAgICAgICAgY29uc3QgaXNPbGRSaXNvbiA9IGdldFVybFBhcmFtKFVSTF9QQVJBTVMubmF0aXZlRmlsdGVycyk7XG4gICAgICAgICAgICBsZXQgZGF0YU1hc2sgPSBuYXRpdmVGaWx0ZXJLZXlWYWx1ZSB8fCB7fTtcbiAgICAgICAgICAgIC8vIGFjdGl2ZVRhYnMgaXMgaW5pdGlhbGl6ZWQgd2l0aCB1bmRlZmluZWQgc28gdGhhdCBpdCBkb2Vzbid0IG92ZXJyaWRlXG4gICAgICAgICAgICAvLyB0aGUgY3VycmVudGx5IHN0b3JlZCB2YWx1ZSB3aGVuIGh5ZHJhdGluZ1xuICAgICAgICAgICAgbGV0IGFjdGl2ZVRhYnM7XG4gICAgICAgICAgICBpZiAocGVybWFsaW5rS2V5KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGVybWFsaW5rVmFsdWUgPSBhd2FpdCBnZXRQZXJtYWxpbmtWYWx1ZShwZXJtYWxpbmtLZXkpO1xuICAgICAgICAgICAgICAgIGlmIChwZXJtYWxpbmtWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAoeyBkYXRhTWFzaywgYWN0aXZlVGFicyB9ID0gcGVybWFsaW5rVmFsdWUuc3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5hdGl2ZUZpbHRlcktleVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGF0YU1hc2sgPSBhd2FpdCBnZXRGaWx0ZXJWYWx1ZShpZCwgbmF0aXZlRmlsdGVyS2V5VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzT2xkUmlzb24pIHtcbiAgICAgICAgICAgICAgICBkYXRhTWFzayA9IGlzT2xkUmlzb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVhZHlUb1JlbmRlcikge1xuICAgICAgICAgICAgICAgIGlmICghaXNEYXNoYm9hcmRIeWRyYXRlZC5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlzRGFzaGJvYXJkSHlkcmF0ZWQuY3VycmVudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRpc3BhdGNoKGh5ZHJhdGVEYXNoYm9hcmQoe1xuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LFxuICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmQsXG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0cyxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGFicyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YU1hc2ssXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkKVxuICAgICAgICAgICAgZ2V0RGF0YU1hc2tBcHBsaWVkKCk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgICB9LCBbcmVhZHlUb1JlbmRlcl0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChkYXNoYm9hcmRfdGl0bGUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZGFzaGJvYXJkX3RpdGxlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IG9yaWdpbmFsRG9jdW1lbnRUaXRsZTtcbiAgICAgICAgfTtcbiAgICB9LCBbZGFzaGJvYXJkX3RpdGxlXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjc3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAvLyByZXR1cm5pbmcgd2lsbCBjbGVhbiB1cCBjdXN0b20gY3NzXG4gICAgICAgICAgICAvLyB3aGVuIGRhc2hib2FyZCB1bm1vdW50cyBvciBjaGFuZ2VzXG4gICAgICAgICAgICByZXR1cm4gaW5qZWN0Q3VzdG9tQ3NzKGNzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICgpID0+IHsgfTtcbiAgICB9LCBbY3NzXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKGRhdGFzZXRzQXBpRXJyb3IpIHtcbiAgICAgICAgICAgIGFkZERhbmdlclRvYXN0KHQoJ0Vycm9yIGxvYWRpbmcgY2hhcnQgZGF0YXNvdXJjZXMuIEZpbHRlcnMgbWF5IG5vdCB3b3JrIGNvcnJlY3RseS4nKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkaXNwYXRjaChzZXREYXRhc291cmNlcyhkYXRhc2V0cykpO1xuICAgICAgICB9XG4gICAgfSwgW2FkZERhbmdlclRvYXN0LCBkYXRhc2V0cywgZGF0YXNldHNBcGlFcnJvciwgZGlzcGF0Y2hdKTtcbiAgICBpZiAoZXJyb3IpXG4gICAgICAgIHRocm93IGVycm9yOyAvLyBjYXVnaHQgaW4gZXJyb3IgYm91bmRhcnlcbiAgICBpZiAoIXJlYWR5VG9SZW5kZXIgfHwgIWhhc0Rhc2hib2FyZEluZm9Jbml0aWF0ZWQpXG4gICAgICAgIHJldHVybiA8TG9hZGluZyAvPjtcbiAgICByZXR1cm4gKDw+XG4gICAgICA8R2xvYmFsIHN0eWxlcz17W1xuICAgICAgICAgICAgZmlsdGVyQ2FyZFBvcG92ZXJTdHlsZSh0aGVtZSksXG4gICAgICAgICAgICBoZWFkZXJTdHlsZXModGhlbWUpLFxuICAgICAgICAgICAgY2hhcnRDb250ZXh0TWVudVN0eWxlcyh0aGVtZSksXG4gICAgICAgICAgICBmb2N1c1N0eWxlKHRoZW1lKSxcbiAgICAgICAgICAgIGNoYXJ0SGVhZGVyU3R5bGVzKHRoZW1lKSxcbiAgICAgICAgXX0vPlxuICAgICAgPFN5bmNEYXNoYm9hcmRTdGF0ZSBkYXNoYm9hcmRQYWdlSWQ9e2Rhc2hib2FyZFBhZ2VJZH0vPlxuICAgICAgPERhc2hib2FyZFBhZ2VJZENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2Rhc2hib2FyZFBhZ2VJZH0+XG4gICAgICAgIDxEYXNoYm9hcmRDb250YWluZXI+XG4gICAgICAgICAgPERhc2hib2FyZEJ1aWxkZXIgLz5cbiAgICAgICAgPC9EYXNoYm9hcmRDb250YWluZXI+XG4gICAgICA8L0Rhc2hib2FyZFBhZ2VJZENvbnRleHQuUHJvdmlkZXI+XG4gICAgPC8+KTtcbn07XG5leHBvcnQgZGVmYXVsdCBEYXNoYm9hcmRQYWdlO1xuIl19 */\"] }\n    ),\n    _jsx(SyncDashboardState, { dashboardPageId: dashboardPageId }),\n    _jsx(DashboardPageIdContext.Provider, { value: dashboardPageId, children:\n      _jsx(DashboardContainer, { children:\n        _jsx(DashboardBuilder, {}) }\n      ) }\n    )] }\n  );\n};__signature__(DashboardPage, \"useTheme{theme}\\nuseDispatch{dispatch}\\nuseHistory{history}\\nuseMemo{dashboardPageId}\\nuseSelector{hasDashboardInfoInitiated}\\nuseToasts{{ addDangerToast }}\\nuseDashboard{{ result: dashboard, error: dashboardApiError }}\\nuseDashboardCharts{{ result: charts, error: chartsApiError }}\\nuseDashboardDatasets{{ result: datasets, error: datasetsApiError, status, }}\\nuseRef{isDashboardHydrated}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\", () => [useTheme, useDispatch, useHistory, useSelector, useToasts, useDashboard, useDashboardCharts, useDashboardDatasets]);const _default =\nDashboardPage;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DashboardPageIdContext, \"DashboardPageIdContext\", \"/app/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(DashboardBuilder, \"DashboardBuilder\", \"/app/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(originalDocumentTitle, \"originalDocumentTitle\", \"/app/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(DashboardPage, \"DashboardPage\", \"/app/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/dashboard/containers/DashboardPage.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["createContext","lazy","useEffect","useMemo","useRef","Global","useHistory","t","useTheme","useDispatch","useSelector","useToasts","Loading","useDashboard","useDashboardCharts","useDashboardDatasets","hydrateDashboard","setDatasources","injectCustomCss","LocalStorageKeys","setItem","URL_PARAMS","getUrlParam","setDatasetsStatus","getFilterValue","getPermalinkValue","DashboardContainer","nanoid","chartContextMenuStyles","filterCardPopoverStyle","focusStyle","headerStyles","chartHeaderStyles","SyncDashboardState","getDashboardContextLocalStorage","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","DashboardPageIdContext","DashboardBuilder","originalDocumentTitle","document","title","DashboardPage","idOrSlug","theme","dispatch","history","dashboardPageId","hasDashboardInfoInitiated","dashboardInfo","Object","keys","length","addDangerToast","result","dashboard","error","dashboardApiError","charts","chartsApiError","datasets","datasetsApiError","status","isDashboardHydrated","readyToRender","Boolean","dashboard_title","css","id","handleTabClose","dashboardsContexts","DashboardExploreContext","isRedundant","window","addEventListener","removeEventListener","getDataMaskApplied","permalinkKey","nativeFilterKeyValue","nativeFiltersKey","isOldRison","nativeFilters","dataMask","activeTabs","permalinkValue","state","current","children","styles","process","env","NODE_ENV","Provider","value","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/dashboard/containers/DashboardPage.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { createContext, lazy, FC, useEffect, useMemo, useRef } from 'react';\nimport { Global } from '@emotion/react';\nimport { useHistory } from 'react-router-dom';\nimport { t, useTheme } from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Loading from 'src/components/Loading';\nimport {\n  useDashboard,\n  useDashboardCharts,\n  useDashboardDatasets,\n} from 'src/hooks/apiResources';\nimport { hydrateDashboard } from 'src/dashboard/actions/hydrate';\nimport { setDatasources } from 'src/dashboard/actions/datasources';\nimport injectCustomCss from 'src/dashboard/util/injectCustomCss';\n\nimport { LocalStorageKeys, setItem } from 'src/utils/localStorageHelpers';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { setDatasetsStatus } from 'src/dashboard/actions/dashboardState';\nimport {\n  getFilterValue,\n  getPermalinkValue,\n} from 'src/dashboard/components/nativeFilters/FilterBar/keyValue';\nimport DashboardContainer from 'src/dashboard/containers/Dashboard';\n\nimport { nanoid } from 'nanoid';\nimport { RootState } from '../types';\nimport {\n  chartContextMenuStyles,\n  filterCardPopoverStyle,\n  focusStyle,\n  headerStyles,\n  chartHeaderStyles,\n} from '../styles';\nimport SyncDashboardState, {\n  getDashboardContextLocalStorage,\n} from '../components/SyncDashboardState';\n\nexport const DashboardPageIdContext = createContext('');\n\nconst DashboardBuilder = lazy(\n  () =>\n    import(\n      /* webpackChunkName: \"DashboardContainer\" */\n      /* webpackPreload: true */\n      'src/dashboard/components/DashboardBuilder/DashboardBuilder'\n    ),\n);\n\nconst originalDocumentTitle = document.title;\n\ntype PageProps = {\n  idOrSlug: string;\n};\n\nexport const DashboardPage: FC<PageProps> = ({ idOrSlug }: PageProps) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const dashboardPageId = useMemo(() => nanoid(), []);\n  const hasDashboardInfoInitiated = useSelector<RootState, Boolean>(\n    ({ dashboardInfo }) =>\n      dashboardInfo && Object.keys(dashboardInfo).length > 0,\n  );\n  const { addDangerToast } = useToasts();\n  const { result: dashboard, error: dashboardApiError } =\n    useDashboard(idOrSlug);\n  const { result: charts, error: chartsApiError } =\n    useDashboardCharts(idOrSlug);\n  const {\n    result: datasets,\n    error: datasetsApiError,\n    status,\n  } = useDashboardDatasets(idOrSlug);\n  const isDashboardHydrated = useRef(false);\n\n  const error = dashboardApiError || chartsApiError;\n  const readyToRender = Boolean(dashboard && charts);\n  const { dashboard_title, css, id = 0 } = dashboard || {};\n\n  useEffect(() => {\n    // mark tab id as redundant when user closes browser tab - a new id will be\n    // generated next time user opens a dashboard and the old one won't be reused\n    const handleTabClose = () => {\n      const dashboardsContexts = getDashboardContextLocalStorage();\n      setItem(LocalStorageKeys.DashboardExploreContext, {\n        ...dashboardsContexts,\n        [dashboardPageId]: {\n          ...dashboardsContexts[dashboardPageId],\n          isRedundant: true,\n        },\n      });\n    };\n    window.addEventListener('beforeunload', handleTabClose);\n    return () => {\n      window.removeEventListener('beforeunload', handleTabClose);\n    };\n  }, [dashboardPageId]);\n\n  useEffect(() => {\n    dispatch(setDatasetsStatus(status));\n  }, [dispatch, status]);\n\n  useEffect(() => {\n    // eslint-disable-next-line consistent-return\n    async function getDataMaskApplied() {\n      const permalinkKey = getUrlParam(URL_PARAMS.permalinkKey);\n      const nativeFilterKeyValue = getUrlParam(URL_PARAMS.nativeFiltersKey);\n      const isOldRison = getUrlParam(URL_PARAMS.nativeFilters);\n\n      let dataMask = nativeFilterKeyValue || {};\n      // activeTabs is initialized with undefined so that it doesn't override\n      // the currently stored value when hydrating\n      let activeTabs: string[] | undefined;\n      if (permalinkKey) {\n        const permalinkValue = await getPermalinkValue(permalinkKey);\n        if (permalinkValue) {\n          ({ dataMask, activeTabs } = permalinkValue.state);\n        }\n      } else if (nativeFilterKeyValue) {\n        dataMask = await getFilterValue(id, nativeFilterKeyValue);\n      }\n      if (isOldRison) {\n        dataMask = isOldRison;\n      }\n\n      if (readyToRender) {\n        if (!isDashboardHydrated.current) {\n          isDashboardHydrated.current = true;\n        }\n        dispatch(\n          hydrateDashboard({\n            history,\n            dashboard,\n            charts,\n            activeTabs,\n            dataMask,\n          }),\n        );\n      }\n      return null;\n    }\n    if (id) getDataMaskApplied();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [readyToRender]);\n\n  useEffect(() => {\n    if (dashboard_title) {\n      document.title = dashboard_title;\n    }\n    return () => {\n      document.title = originalDocumentTitle;\n    };\n  }, [dashboard_title]);\n\n  useEffect(() => {\n    if (typeof css === 'string') {\n      // returning will clean up custom css\n      // when dashboard unmounts or changes\n      return injectCustomCss(css);\n    }\n    return () => {};\n  }, [css]);\n\n  useEffect(() => {\n    if (datasetsApiError) {\n      addDangerToast(\n        t('Error loading chart datasources. Filters may not work correctly.'),\n      );\n    } else {\n      dispatch(setDatasources(datasets));\n    }\n  }, [addDangerToast, datasets, datasetsApiError, dispatch]);\n\n  if (error) throw error; // caught in error boundary\n  if (!readyToRender || !hasDashboardInfoInitiated) return <Loading />;\n\n  return (\n    <>\n      <Global\n        styles={[\n          filterCardPopoverStyle(theme),\n          headerStyles(theme),\n          chartContextMenuStyles(theme),\n          focusStyle(theme),\n          chartHeaderStyles(theme),\n        ]}\n      />\n      <SyncDashboardState dashboardPageId={dashboardPageId} />\n      <DashboardPageIdContext.Provider value={dashboardPageId}>\n        <DashboardContainer>\n          <DashboardBuilder />\n        </DashboardContainer>\n      </DashboardPageIdContext.Provider>\n    </>\n  );\n};\n\nexport default DashboardPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}