{"ast":null,"code":"import { css as _css } from \"@emotion/react\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport rison from 'rison';\nimport { PureComponent, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { Radio } from 'src/components/Radio';\nimport Card from 'src/components/Card';\nimport Alert from 'src/components/Alert';\nimport Badge from 'src/components/Badge';\nimport { nanoid } from 'nanoid';\nimport {\n  css,\n  isFeatureEnabled,\n  getCurrencySymbol,\n  ensureIsArray,\n  FeatureFlag,\n  styled,\n  SupersetClient,\n  t,\n  withTheme,\n  getClientErrorObject } from\n'@superset-ui/core';\nimport { Select, AsyncSelect, Row, Col } from 'src/components';\nimport { FormLabel } from 'src/components/Form';\nimport Button from 'src/components/Button';\nimport Tabs from 'src/components/Tabs';\nimport CertifiedBadge from 'src/components/CertifiedBadge';\nimport WarningIconWithTooltip from 'src/components/WarningIconWithTooltip';\nimport DatabaseSelector from 'src/components/DatabaseSelector';\nimport Label from 'src/components/Label';\nimport Loading from 'src/components/Loading';\nimport TableSelector from 'src/components/TableSelector';\nimport EditableTitle from 'src/components/EditableTitle';\nimport CheckboxControl from 'src/explore/components/controls/CheckboxControl';\nimport TextControl from 'src/explore/components/controls/TextControl';\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\nimport SpatialControl from 'src/explore/components/controls/SpatialControl';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport Icons from 'src/components/Icons';\nimport CurrencyControl from 'src/explore/components/controls/CurrencyControl';\nimport CollectionTable from './CollectionTable';\nimport Fieldset from './Fieldset';\nimport Field from './Field';import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\n\nconst DatasourceContainer = styled.div`\n  .change-warning {\n    margin: 16px 10px 0;\n    color: ${({ theme }) => theme.colors.warning.base};\n  }\n\n  .change-warning .bold {\n    font-weight: ${({ theme }) => theme.typography.weights.bold};\n  }\n\n  .form-group.has-feedback > .help-block {\n    margin-top: 8px;\n  }\n\n  .form-group.form-group-md {\n    margin-bottom: 8px;\n  }\n`;\n\nconst FlexRowContainer = styled.div`\n  align-items: center;\n  display: flex;\n\n  svg {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledTableTabs = styled(Tabs)`\n  overflow: visible;\n  .ant-tabs-content-holder {\n    overflow: visible;\n  }\n`;\n\nconst StyledBadge = styled(Badge)`\n  .antd5-badge-count {\n    line-height: ${({ theme }) => theme.gridUnit * 4}px;\n    height: ${({ theme }) => theme.gridUnit * 4}px;\n    margin-left: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EditLockContainer = styled.div`\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  display: flex;\n  align-items: center;\n  a {\n    padding: 0 10px;\n  }\n`;\n\nconst ColumnButtonWrapper = styled.div`\n  text-align: right;\n  ${({ theme }) => `margin-bottom: ${theme.gridUnit * 2}px`}\n`;\n\nconst StyledLabelWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  span {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledColumnsTabWrapper = styled.div`\n  .table > tbody > tr > td {\n    vertical-align: middle;\n  }\n\n  .ant-tag {\n    margin-top: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledButtonWrapper = styled.span`\n  ${({ theme }) => `\n    margin-top: ${theme.gridUnit * 3}px;\n    margin-left: ${theme.gridUnit * 3}px;\n  `}\n`;\n\nconst checkboxGenerator = (d, onChange) =>\n_jsx(CheckboxControl, { value: d, onChange: onChange });\n\nconst DATA_TYPES = [\n{ value: 'STRING', label: t('STRING') },\n{ value: 'NUMERIC', label: t('NUMERIC') },\n{ value: 'DATETIME', label: t('DATETIME') },\n{ value: 'BOOLEAN', label: t('BOOLEAN') }];\n\n\nconst DATASOURCE_TYPES_ARR = [\n{ key: 'physical', label: t('Physical (table or view)') },\n{ key: 'virtual', label: t('Virtual (SQL)') }];\n\nconst DATASOURCE_TYPES = {};\nDATASOURCE_TYPES_ARR.forEach((o) => {\n  DATASOURCE_TYPES[o.key] = o;\n});var _ref = process.env.NODE_ENV === \"production\" ? { name: \"s5xdrg\", styles: \"display:flex;align-items:center\" } : { name: \"l0hchv-CollectionTabTitle\", styles: \"display:flex;align-items:center;label:CollectionTabTitle;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFvS00iLCJmaWxlIjoiL2FwcC9zdXBlcnNldC1mcm9udGVuZC9zcmMvY29tcG9uZW50cy9EYXRhc291cmNlL0RhdGFzb3VyY2VFZGl0b3IuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHJpc29uIGZyb20gJ3Jpc29uJztcbmltcG9ydCB7IFB1cmVDb21wb25lbnQsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7IFJhZGlvIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvUmFkaW8nO1xuaW1wb3J0IENhcmQgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ2FyZCc7XG5pbXBvcnQgQWxlcnQgZnJvbSAnc3JjL2NvbXBvbmVudHMvQWxlcnQnO1xuaW1wb3J0IEJhZGdlIGZyb20gJ3NyYy9jb21wb25lbnRzL0JhZGdlJztcbmltcG9ydCB7IG5hbm9pZCB9IGZyb20gJ25hbm9pZCc7XG5pbXBvcnQge1xuICBjc3MsXG4gIGlzRmVhdHVyZUVuYWJsZWQsXG4gIGdldEN1cnJlbmN5U3ltYm9sLFxuICBlbnN1cmVJc0FycmF5LFxuICBGZWF0dXJlRmxhZyxcbiAgc3R5bGVkLFxuICBTdXBlcnNldENsaWVudCxcbiAgdCxcbiAgd2l0aFRoZW1lLFxuICBnZXRDbGllbnRFcnJvck9iamVjdCxcbn0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHsgU2VsZWN0LCBBc3luY1NlbGVjdCwgUm93LCBDb2wgfSBmcm9tICdzcmMvY29tcG9uZW50cyc7XG5pbXBvcnQgeyBGb3JtTGFiZWwgfSBmcm9tICdzcmMvY29tcG9uZW50cy9Gb3JtJztcbmltcG9ydCBCdXR0b24gZnJvbSAnc3JjL2NvbXBvbmVudHMvQnV0dG9uJztcbmltcG9ydCBUYWJzIGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYnMnO1xuaW1wb3J0IENlcnRpZmllZEJhZGdlIGZyb20gJ3NyYy9jb21wb25lbnRzL0NlcnRpZmllZEJhZGdlJztcbmltcG9ydCBXYXJuaW5nSWNvbldpdGhUb29sdGlwIGZyb20gJ3NyYy9jb21wb25lbnRzL1dhcm5pbmdJY29uV2l0aFRvb2x0aXAnO1xuaW1wb3J0IERhdGFiYXNlU2VsZWN0b3IgZnJvbSAnc3JjL2NvbXBvbmVudHMvRGF0YWJhc2VTZWxlY3Rvcic7XG5pbXBvcnQgTGFiZWwgZnJvbSAnc3JjL2NvbXBvbmVudHMvTGFiZWwnO1xuaW1wb3J0IExvYWRpbmcgZnJvbSAnc3JjL2NvbXBvbmVudHMvTG9hZGluZyc7XG5pbXBvcnQgVGFibGVTZWxlY3RvciBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJsZVNlbGVjdG9yJztcbmltcG9ydCBFZGl0YWJsZVRpdGxlIGZyb20gJ3NyYy9jb21wb25lbnRzL0VkaXRhYmxlVGl0bGUnO1xuaW1wb3J0IENoZWNrYm94Q29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL0NoZWNrYm94Q29udHJvbCc7XG5pbXBvcnQgVGV4dENvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9UZXh0Q29udHJvbCc7XG5pbXBvcnQgVGV4dEFyZWFDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvVGV4dEFyZWFDb250cm9sJztcbmltcG9ydCBTcGF0aWFsQ29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1NwYXRpYWxDb250cm9sJztcbmltcG9ydCB3aXRoVG9hc3RzIGZyb20gJ3NyYy9jb21wb25lbnRzL01lc3NhZ2VUb2FzdHMvd2l0aFRvYXN0cyc7XG5pbXBvcnQgSWNvbnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvSWNvbnMnO1xuaW1wb3J0IEN1cnJlbmN5Q29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL0N1cnJlbmN5Q29udHJvbCc7XG5pbXBvcnQgQ29sbGVjdGlvblRhYmxlIGZyb20gJy4vQ29sbGVjdGlvblRhYmxlJztcbmltcG9ydCBGaWVsZHNldCBmcm9tICcuL0ZpZWxkc2V0JztcbmltcG9ydCBGaWVsZCBmcm9tICcuL0ZpZWxkJztcblxuY29uc3QgRGF0YXNvdXJjZUNvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIC5jaGFuZ2Utd2FybmluZyB7XG4gICAgbWFyZ2luOiAxNnB4IDEwcHggMDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMud2FybmluZy5iYXNlfTtcbiAgfVxuXG4gIC5jaGFuZ2Utd2FybmluZyAuYm9sZCB7XG4gICAgZm9udC13ZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS53ZWlnaHRzLmJvbGR9O1xuICB9XG5cbiAgLmZvcm0tZ3JvdXAuaGFzLWZlZWRiYWNrID4gLmhlbHAtYmxvY2sge1xuICAgIG1hcmdpbi10b3A6IDhweDtcbiAgfVxuXG4gIC5mb3JtLWdyb3VwLmZvcm0tZ3JvdXAtbWQge1xuICAgIG1hcmdpbi1ib3R0b206IDhweDtcbiAgfVxuYDtcblxuY29uc3QgRmxleFJvd0NvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGRpc3BsYXk6IGZsZXg7XG5cbiAgc3ZnIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZFRhYmxlVGFicyA9IHN0eWxlZChUYWJzKWBcbiAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIC5hbnQtdGFicy1jb250ZW50LWhvbGRlciB7XG4gICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZEJhZGdlID0gc3R5bGVkKEJhZGdlKWBcbiAgLmFudGQ1LWJhZGdlLWNvdW50IHtcbiAgICBsaW5lLWhlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgaGVpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgRWRpdExvY2tDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBmb250LXNpemU6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS5zaXplcy5zfXB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBhIHtcbiAgICBwYWRkaW5nOiAwIDEwcHg7XG4gIH1cbmA7XG5cbmNvbnN0IENvbHVtbkJ1dHRvbldyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICB0ZXh0LWFsaWduOiByaWdodDtcbiAgJHsoeyB0aGVtZSB9KSA9PiBgbWFyZ2luLWJvdHRvbTogJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHhgfVxuYDtcblxuY29uc3QgU3R5bGVkTGFiZWxXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgc3BhbiB7XG4gICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRDb2x1bW5zVGFiV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIC50YWJsZSA+IHRib2R5ID4gdHIgPiB0ZCB7XG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgfVxuXG4gIC5hbnQtdGFnIHtcbiAgICBtYXJnaW4tdG9wOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRCdXR0b25XcmFwcGVyID0gc3R5bGVkLnNwYW5gXG4gICR7KHsgdGhlbWUgfSkgPT4gYFxuICAgIG1hcmdpbi10b3A6ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4O1xuICAgIG1hcmdpbi1sZWZ0OiAke3RoZW1lLmdyaWRVbml0ICogM31weDtcbiAgYH1cbmA7XG5cbmNvbnN0IGNoZWNrYm94R2VuZXJhdG9yID0gKGQsIG9uQ2hhbmdlKSA9PiAoXG4gIDxDaGVja2JveENvbnRyb2wgdmFsdWU9e2R9IG9uQ2hhbmdlPXtvbkNoYW5nZX0gLz5cbik7XG5jb25zdCBEQVRBX1RZUEVTID0gW1xuICB7IHZhbHVlOiAnU1RSSU5HJywgbGFiZWw6IHQoJ1NUUklORycpIH0sXG4gIHsgdmFsdWU6ICdOVU1FUklDJywgbGFiZWw6IHQoJ05VTUVSSUMnKSB9LFxuICB7IHZhbHVlOiAnREFURVRJTUUnLCBsYWJlbDogdCgnREFURVRJTUUnKSB9LFxuICB7IHZhbHVlOiAnQk9PTEVBTicsIGxhYmVsOiB0KCdCT09MRUFOJykgfSxcbl07XG5cbmNvbnN0IERBVEFTT1VSQ0VfVFlQRVNfQVJSID0gW1xuICB7IGtleTogJ3BoeXNpY2FsJywgbGFiZWw6IHQoJ1BoeXNpY2FsICh0YWJsZSBvciB2aWV3KScpIH0sXG4gIHsga2V5OiAndmlydHVhbCcsIGxhYmVsOiB0KCdWaXJ0dWFsIChTUUwpJykgfSxcbl07XG5jb25zdCBEQVRBU09VUkNFX1RZUEVTID0ge307XG5EQVRBU09VUkNFX1RZUEVTX0FSUi5mb3JFYWNoKG8gPT4ge1xuICBEQVRBU09VUkNFX1RZUEVTW28ua2V5XSA9IG87XG59KTtcblxuZnVuY3Rpb24gQ29sbGVjdGlvblRhYlRpdGxlKHsgdGl0bGUsIGNvbGxlY3Rpb24gfSkge1xuICByZXR1cm4gKFxuICAgIDxkaXZcbiAgICAgIGNzcz17eyBkaXNwbGF5OiAnZmxleCcsIGFsaWduSXRlbXM6ICdjZW50ZXInIH19XG4gICAgICBkYXRhLXRlc3Q9e2Bjb2xsZWN0aW9uLXRhYi0ke3RpdGxlfWB9XG4gICAgPlxuICAgICAge3RpdGxlfXsnICd9XG4gICAgICA8U3R5bGVkQmFkZ2UgY291bnQ9e2NvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDB9IHNob3daZXJvIC8+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbkNvbGxlY3Rpb25UYWJUaXRsZS5wcm9wVHlwZXMgPSB7XG4gIHRpdGxlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBjb2xsZWN0aW9uOiBQcm9wVHlwZXMuYXJyYXksXG59O1xuXG5mdW5jdGlvbiBDb2x1bW5Db2xsZWN0aW9uVGFibGUoe1xuICBjb2x1bW5zLFxuICBkYXRhc291cmNlLFxuICBvbkNvbHVtbnNDaGFuZ2UsXG4gIG9uRGF0YXNvdXJjZUNoYW5nZSxcbiAgZWRpdGFibGVDb2x1bW5OYW1lLFxuICBzaG93RXhwcmVzc2lvbixcbiAgYWxsb3dBZGRJdGVtLFxuICBhbGxvd0VkaXREYXRhVHlwZSxcbiAgaXRlbUdlbmVyYXRvcixcbiAgY29sdW1uTGFiZWxUb29sdGlwcyxcbn0pIHtcbiAgcmV0dXJuIChcbiAgICA8Q29sbGVjdGlvblRhYmxlXG4gICAgICB0YWJsZUNvbHVtbnM9e1xuICAgICAgICBpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKVxuICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAnYWR2YW5jZWRfZGF0YV90eXBlJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICAgICAgOiBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgfVxuICAgICAgc29ydENvbHVtbnM9e1xuICAgICAgICBpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKVxuICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAnY29sdW1uX25hbWUnLFxuICAgICAgICAgICAgICAnYWR2YW5jZWRfZGF0YV90eXBlJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICAgICAgOiBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICAgJ2lzX2R0dG0nLFxuICAgICAgICAgICAgICAnbWFpbl9kdHRtX2NvbCcsXG4gICAgICAgICAgICAgICdmaWx0ZXJhYmxlJyxcbiAgICAgICAgICAgICAgJ2dyb3VwYnknLFxuICAgICAgICAgICAgXVxuICAgICAgfVxuICAgICAgYWxsb3dEZWxldGVzXG4gICAgICBhbGxvd0FkZEl0ZW09e2FsbG93QWRkSXRlbX1cbiAgICAgIGl0ZW1HZW5lcmF0b3I9e2l0ZW1HZW5lcmF0b3J9XG4gICAgICBjb2xsZWN0aW9uPXtjb2x1bW5zfVxuICAgICAgY29sdW1uTGFiZWxUb29sdGlwcz17Y29sdW1uTGFiZWxUb29sdGlwc31cbiAgICAgIHN0aWNreUhlYWRlclxuICAgICAgZXhwYW5kRmllbGRzZXQ9e1xuICAgICAgICA8Rm9ybUNvbnRhaW5lcj5cbiAgICAgICAgICA8RmllbGRzZXQgY29tcGFjdD5cbiAgICAgICAgICAgIHtzaG93RXhwcmVzc2lvbiAmJiAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZXhwcmVzc2lvblwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ1NRTCBleHByZXNzaW9uJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwibWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwidmVyYm9zZV9uYW1lXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0xhYmVsJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwidmVyYm9zZV9uYW1lXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdMYWJlbCcpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB7YWxsb3dFZGl0RGF0YVR5cGUgJiYgKFxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cInR5cGVcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdEYXRhIHR5cGUnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgYXJpYUxhYmVsPXt0KCdEYXRhIHR5cGUnKX1cbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucz17REFUQV9UWVBFU31cbiAgICAgICAgICAgICAgICAgICAgbmFtZT1cInR5cGVcIlxuICAgICAgICAgICAgICAgICAgICBhbGxvd05ld09wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dDbGVhclxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAge2lzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpID8gKFxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImFkdmFuY2VkX2RhdGFfdHlwZVwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0FkdmFuY2VkIGRhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImFkdmFuY2VkX2RhdGFfdHlwZVwiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdBZHZhbmNlZCBEYXRhIHR5cGUnKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPD48Lz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJweXRob25fZGF0ZV9mb3JtYXRcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnRGF0ZXRpbWUgZm9ybWF0Jyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXtcbiAgICAgICAgICAgICAgICAvKiBOb3RlIHRoZSBmcmFnbWVudGVkIHRyYW5zbGF0aW9ucyBtYXkgbm90IHdvcmsuICovXG4gICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgIHt0KCdUaGUgcGF0dGVybiBvZiB0aW1lc3RhbXAgZm9ybWF0LiBGb3Igc3RyaW5ncyB1c2UgJyl9XG4gICAgICAgICAgICAgICAgICA8YSBocmVmPVwiaHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMi9saWJyYXJ5L2RhdGV0aW1lLmh0bWwjc3RyZnRpbWUtc3RycHRpbWUtYmVoYXZpb3JcIj5cbiAgICAgICAgICAgICAgICAgICAge3QoJ1B5dGhvbiBkYXRldGltZSBzdHJpbmcgcGF0dGVybicpfVxuICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAge3QoJyBleHByZXNzaW9uIHdoaWNoIG5lZWRzIHRvIGFkaGVyZSB0byB0aGUgJyl9XG4gICAgICAgICAgICAgICAgICA8YSBocmVmPVwiaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSVNPXzg2MDFcIj5cbiAgICAgICAgICAgICAgICAgICAge3QoJ0lTTyA4NjAxJyl9XG4gICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICB7dChgIHN0YW5kYXJkIHRvIGVuc3VyZSB0aGF0IHRoZSBsZXhpY29ncmFwaGljYWwgb3JkZXJpbmdcbiAgICAgICAgICAgICAgICAgICAgICBjb2luY2lkZXMgd2l0aCB0aGUgY2hyb25vbG9naWNhbCBvcmRlcmluZy4gSWYgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wIGZvcm1hdCBkb2VzIG5vdCBhZGhlcmUgdG8gdGhlIElTTyA4NjAxIHN0YW5kYXJkXG4gICAgICAgICAgICAgICAgICAgICAgeW91IHdpbGwgbmVlZCB0byBkZWZpbmUgYW4gZXhwcmVzc2lvbiBhbmQgdHlwZSBmb3JcbiAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1pbmcgdGhlIHN0cmluZyBpbnRvIGEgZGF0ZSBvciB0aW1lc3RhbXAuIE5vdGVcbiAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50bHkgdGltZSB6b25lcyBhcmUgbm90IHN1cHBvcnRlZC4gSWYgdGltZSBpcyBzdG9yZWRcbiAgICAgICAgICAgICAgICAgICAgICBpbiBlcG9jaCBmb3JtYXQsIHB1dCBcXGBlcG9jaF9zXFxgIG9yIFxcYGVwb2NoX21zXFxgLiBJZiBubyBwYXR0ZXJuXG4gICAgICAgICAgICAgICAgICAgICAgaXMgc3BlY2lmaWVkIHdlIGZhbGwgYmFjayB0byB1c2luZyB0aGUgb3B0aW9uYWwgZGVmYXVsdHMgb24gYSBwZXJcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZS9jb2x1bW4gbmFtZSBsZXZlbCB2aWEgdGhlIGV4dHJhIHBhcmFtZXRlci5gKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cInB5dGhvbl9kYXRlX2Zvcm1hdFwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIiVZLSVtLSVkXCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWVkX2J5XCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmllZCBCeScpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnUGVyc29uIG9yIGdyb3VwIHRoYXQgaGFzIGNlcnRpZmllZCB0aGlzIG1ldHJpYycpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmllZFwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQ2VydGlmaWVkIGJ5Jyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmljYXRpb25fZGV0YWlsc1wiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ0RldGFpbHMgb2YgdGhlIGNlcnRpZmljYXRpb24nKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpY2F0aW9uRGV0YWlsc1wiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L0ZpZWxkc2V0PlxuICAgICAgICA8L0Zvcm1Db250YWluZXI+XG4gICAgICB9XG4gICAgICBjb2x1bW5MYWJlbHM9e1xuICAgICAgICBpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKVxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnQ29sdW1uJyksXG4gICAgICAgICAgICAgIGFkdmFuY2VkX2RhdGFfdHlwZTogdCgnQWR2YW5jZWQgZGF0YSB0eXBlJyksXG4gICAgICAgICAgICAgIHR5cGU6IHQoJ0RhdGEgdHlwZScpLFxuICAgICAgICAgICAgICBncm91cGJ5OiB0KCdJcyBkaW1lbnNpb24nKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogdCgnSXMgdGVtcG9yYWwnKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogdCgnRGVmYXVsdCBkYXRldGltZScpLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0KCdJcyBmaWx0ZXJhYmxlJyksXG4gICAgICAgICAgICB9XG4gICAgICAgICAgOiB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCdDb2x1bW4nKSxcbiAgICAgICAgICAgICAgdHlwZTogdCgnRGF0YSB0eXBlJyksXG4gICAgICAgICAgICAgIGdyb3VwYnk6IHQoJ0lzIGRpbWVuc2lvbicpLFxuICAgICAgICAgICAgICBpc19kdHRtOiB0KCdJcyB0ZW1wb3JhbCcpLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiB0KCdEZWZhdWx0IGRhdGV0aW1lJyksXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IHQoJ0lzIGZpbHRlcmFibGUnKSxcbiAgICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG9uQ2hhbmdlPXtvbkNvbHVtbnNDaGFuZ2V9XG4gICAgICBpdGVtUmVuZGVyZXJzPXtcbiAgICAgICAgaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcylcbiAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6ICh2LCBvbkl0ZW1DaGFuZ2UsIF8sIHJlY29yZCkgPT5cbiAgICAgICAgICAgICAgICBlZGl0YWJsZUNvbHVtbk5hbWUgPyAoXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgICB7cmVjb3JkLmlzX2NlcnRpZmllZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPENlcnRpZmllZEJhZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRCeT17cmVjb3JkLmNlcnRpZmllZF9ieX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM9e3JlY29yZC5jZXJ0aWZpY2F0aW9uX2RldGFpbHN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPEVkaXRhYmxlVGl0bGVcbiAgICAgICAgICAgICAgICAgICAgICBjYW5FZGl0XG4gICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e3Z9XG4gICAgICAgICAgICAgICAgICAgICAgb25TYXZlVGl0bGU9e29uSXRlbUNoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgICB7cmVjb3JkLmlzX2NlcnRpZmllZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPENlcnRpZmllZEJhZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRCeT17cmVjb3JkLmNlcnRpZmllZF9ieX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM9e3JlY29yZC5jZXJ0aWZpY2F0aW9uX2RldGFpbHN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAge3Z9XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiAodmFsdWUsIF9vbkl0ZW1DaGFuZ2UsIF9sYWJlbCwgcmVjb3JkKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hlY2tlZCA9IGRhdGFzb3VyY2UubWFpbl9kdHRtX2NvbCA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpc2FibGVkID0gIWNvbHVtbnMuZmluZChcbiAgICAgICAgICAgICAgICAgIGNvbHVtbiA9PiBjb2x1bW4uY29sdW1uX25hbWUgPT09IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICApLmlzX2R0dG07XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgIDxSYWRpb1xuICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3Q9e2ByYWRpby1kZWZhdWx0LWR0dG0tJHtyZWNvcmQuY29sdW1uX25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Y2hlY2tlZH1cbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGF0YXNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHJlY29yZC5jb2x1bW5fbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHR5cGU6IGQgPT4gKGQgPyA8TGFiZWw+e2R9PC9MYWJlbD4gOiBudWxsKSxcbiAgICAgICAgICAgICAgYWR2YW5jZWRfZGF0YV90eXBlOiBkID0+IChcbiAgICAgICAgICAgICAgICA8TGFiZWwgb25DaGFuZ2U9e29uQ29sdW1uc0NoYW5nZX0+e2R9PC9MYWJlbD5cbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgaXNfZHR0bTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBncm91cGJ5OiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6ICh2LCBvbkl0ZW1DaGFuZ2UsIF8sIHJlY29yZCkgPT5cbiAgICAgICAgICAgICAgICBlZGl0YWJsZUNvbHVtbk5hbWUgPyAoXG4gICAgICAgICAgICAgICAgICA8U3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgICB7cmVjb3JkLmlzX2NlcnRpZmllZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPENlcnRpZmllZEJhZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRCeT17cmVjb3JkLmNlcnRpZmllZF9ieX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM9e3JlY29yZC5jZXJ0aWZpY2F0aW9uX2RldGFpbHN9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25JdGVtQ2hhbmdlfSAvPlxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dn1cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6ICh2YWx1ZSwgX29uSXRlbUNoYW5nZSwgX2xhYmVsLCByZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGVja2VkID0gZGF0YXNvdXJjZS5tYWluX2R0dG1fY29sID09PSByZWNvcmQuY29sdW1uX25hbWU7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlzYWJsZWQgPSAhY29sdW1ucy5maW5kKFxuICAgICAgICAgICAgICAgICAgY29sdW1uID0+IGNvbHVtbi5jb2x1bW5fbmFtZSA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICkuaXNfZHR0bTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD17YHJhZGlvLWRlZmF1bHQtZHR0bS0ke3JlY29yZC5jb2x1bW5fbmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtjaGVja2VkfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdHlwZTogZCA9PiAoZCA/IDxMYWJlbD57ZH08L0xhYmVsPiA6IG51bGwpLFxuICAgICAgICAgICAgICBpc19kdHRtOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGdyb3VwYnk6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgfVxuICAgICAgfVxuICAgIC8+XG4gICk7XG59XG5Db2x1bW5Db2xsZWN0aW9uVGFibGUucHJvcFR5cGVzID0ge1xuICBjb2x1bW5zOiBQcm9wVHlwZXMuYXJyYXkuaXNSZXF1aXJlZCxcbiAgZGF0YXNvdXJjZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICBvbkNvbHVtbnNDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIG9uRGF0YXNvdXJjZUNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZWRpdGFibGVDb2x1bW5OYW1lOiBQcm9wVHlwZXMuYm9vbCxcbiAgc2hvd0V4cHJlc3Npb246IFByb3BUeXBlcy5ib29sLFxuICBhbGxvd0FkZEl0ZW06IFByb3BUeXBlcy5ib29sLFxuICBhbGxvd0VkaXREYXRhVHlwZTogUHJvcFR5cGVzLmJvb2wsXG4gIGl0ZW1HZW5lcmF0b3I6IFByb3BUeXBlcy5mdW5jLFxufTtcbkNvbHVtbkNvbGxlY3Rpb25UYWJsZS5kZWZhdWx0UHJvcHMgPSB7XG4gIGVkaXRhYmxlQ29sdW1uTmFtZTogZmFsc2UsXG4gIHNob3dFeHByZXNzaW9uOiBmYWxzZSxcbiAgYWxsb3dBZGRJdGVtOiBmYWxzZSxcbiAgYWxsb3dFZGl0RGF0YVR5cGU6IGZhbHNlLFxuICBpdGVtR2VuZXJhdG9yOiAoKSA9PiAoe1xuICAgIGNvbHVtbl9uYW1lOiB0KCc8bmV3IGNvbHVtbj4nKSxcbiAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgIGdyb3VwYnk6IHRydWUsXG4gIH0pLFxufTtcblxuZnVuY3Rpb24gU3RhY2tlZEZpZWxkKHsgbGFiZWwsIGZvcm1FbGVtZW50IH0pIHtcbiAgcmV0dXJuIChcbiAgICA8ZGl2PlxuICAgICAgPGRpdj5cbiAgICAgICAgPHN0cm9uZz57bGFiZWx9PC9zdHJvbmc+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXY+e2Zvcm1FbGVtZW50fTwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5TdGFja2VkRmllbGQucHJvcFR5cGVzID0ge1xuICBsYWJlbDogUHJvcFR5cGVzLnN0cmluZyxcbiAgZm9ybUVsZW1lbnQ6IFByb3BUeXBlcy5ub2RlLFxufTtcblxuZnVuY3Rpb24gRm9ybUNvbnRhaW5lcih7IGNoaWxkcmVuIH0pIHtcbiAgcmV0dXJuIDxDYXJkIHBhZGRlZD57Y2hpbGRyZW59PC9DYXJkPjtcbn1cblxuRm9ybUNvbnRhaW5lci5wcm9wVHlwZXMgPSB7XG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMubm9kZSxcbn07XG5cbmNvbnN0IHByb3BUeXBlcyA9IHtcbiAgZGF0YXNvdXJjZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gIGFkZFN1Y2Nlc3NUb2FzdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgYWRkRGFuZ2VyVG9hc3Q6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIHNldElzRWRpdGluZzogUHJvcFR5cGVzLmZ1bmMsXG59O1xuXG5jb25zdCBkZWZhdWx0UHJvcHMgPSB7XG4gIG9uQ2hhbmdlOiAoKSA9PiB7fSxcbiAgc2V0SXNFZGl0aW5nOiAoKSA9PiB7fSxcbn07XG5cbmZ1bmN0aW9uIE93bmVyc1NlbGVjdG9yKHsgZGF0YXNvdXJjZSwgb25DaGFuZ2UgfSkge1xuICBjb25zdCBsb2FkT3B0aW9ucyA9IHVzZUNhbGxiYWNrKChzZWFyY2ggPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogc2VhcmNoLCBwYWdlLCBwYWdlX3NpemU6IHBhZ2VTaXplIH0pO1xuICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL2RhdGFzZXQvcmVsYXRlZC9vd25lcnM/cT0ke3F1ZXJ5fWAsXG4gICAgfSkudGhlbihyZXNwb25zZSA9PiAoe1xuICAgICAgZGF0YTogcmVzcG9uc2UuanNvbi5yZXN1bHRcbiAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0uZXh0cmEuYWN0aXZlKVxuICAgICAgICAubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgICBsYWJlbDogaXRlbS50ZXh0LFxuICAgICAgICB9KSksXG4gICAgICB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50LFxuICAgIH0pKTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiAoXG4gICAgPEFzeW5jU2VsZWN0XG4gICAgICBhcmlhTGFiZWw9e3QoJ1NlbGVjdCBvd25lcnMnKX1cbiAgICAgIG1vZGU9XCJtdWx0aXBsZVwiXG4gICAgICBuYW1lPVwib3duZXJzXCJcbiAgICAgIHZhbHVlPXtkYXRhc291cmNlLm93bmVyc31cbiAgICAgIG9wdGlvbnM9e2xvYWRPcHRpb25zfVxuICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgaGVhZGVyPXs8Rm9ybUxhYmVsPnt0KCdPd25lcnMnKX08L0Zvcm1MYWJlbD59XG4gICAgICBhbGxvd0NsZWFyXG4gICAgLz5cbiAgKTtcbn1cblxuY2xhc3MgRGF0YXNvdXJjZUVkaXRvciBleHRlbmRzIFB1cmVDb21wb25lbnQge1xuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgZGF0YXNvdXJjZToge1xuICAgICAgICAuLi5wcm9wcy5kYXRhc291cmNlLFxuICAgICAgICBvd25lcnM6IHByb3BzLmRhdGFzb3VyY2Uub3duZXJzLm1hcChvd25lciA9PiAoe1xuICAgICAgICAgIHZhbHVlOiBvd25lci52YWx1ZSB8fCBvd25lci5pZCxcbiAgICAgICAgICBsYWJlbDogb3duZXIubGFiZWwgfHwgYCR7b3duZXIuZmlyc3RfbmFtZX0gJHtvd25lci5sYXN0X25hbWV9YCxcbiAgICAgICAgfSkpLFxuICAgICAgICBtZXRyaWNzOiBwcm9wcy5kYXRhc291cmNlLm1ldHJpY3M/Lm1hcChtZXRyaWMgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNlcnRpZmllZF9ieTogY2VydGlmaWVkQnlNZXRyaWMsXG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uX2RldGFpbHM6IGNlcnRpZmljYXRpb25EZXRhaWxzLFxuICAgICAgICAgIH0gPSBtZXRyaWM7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY2VydGlmaWNhdGlvbjogeyBkZXRhaWxzLCBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5IH0gPSB7fSxcbiAgICAgICAgICAgIHdhcm5pbmdfbWFya2Rvd246IHdhcm5pbmdNYXJrZG93bixcbiAgICAgICAgICB9ID0gSlNPTi5wYXJzZShtZXRyaWMuZXh0cmEgfHwgJ3t9JykgfHwge307XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLm1ldHJpYyxcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWNhdGlvbkRldGFpbHMgfHwgZGV0YWlscyxcbiAgICAgICAgICAgIHdhcm5pbmdfbWFya2Rvd246IHdhcm5pbmdNYXJrZG93biB8fCAnJyxcbiAgICAgICAgICAgIGNlcnRpZmllZF9ieTogY2VydGlmaWVkQnkgfHwgY2VydGlmaWVkQnlNZXRyaWMsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9LFxuICAgICAgZXJyb3JzOiBbXSxcbiAgICAgIGlzU3FsYTpcbiAgICAgICAgcHJvcHMuZGF0YXNvdXJjZS5kYXRhc291cmNlX3R5cGUgPT09ICd0YWJsZScgfHxcbiAgICAgICAgcHJvcHMuZGF0YXNvdXJjZS50eXBlID09PSAndGFibGUnLFxuICAgICAgaXNFZGl0TW9kZTogZmFsc2UsXG4gICAgICBkYXRhYmFzZUNvbHVtbnM6IHByb3BzLmRhdGFzb3VyY2UuY29sdW1ucy5maWx0ZXIoY29sID0+ICFjb2wuZXhwcmVzc2lvbiksXG4gICAgICBjYWxjdWxhdGVkQ29sdW1uczogcHJvcHMuZGF0YXNvdXJjZS5jb2x1bW5zLmZpbHRlcihcbiAgICAgICAgY29sID0+ICEhY29sLmV4cHJlc3Npb24sXG4gICAgICApLFxuICAgICAgbWV0YWRhdGFMb2FkaW5nOiBmYWxzZSxcbiAgICAgIGFjdGl2ZVRhYktleTogMCxcbiAgICAgIGRhdGFzb3VyY2VUeXBlOiBwcm9wcy5kYXRhc291cmNlLnNxbFxuICAgICAgICA/IERBVEFTT1VSQ0VfVFlQRVMudmlydHVhbC5rZXlcbiAgICAgICAgOiBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSxcbiAgICB9O1xuXG4gICAgdGhpcy5vbkNoYW5nZSA9IHRoaXMub25DaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uQ2hhbmdlRWRpdE1vZGUgPSB0aGlzLm9uQ2hhbmdlRWRpdE1vZGUuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UgPSB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZSA9IHRoaXMub25EYXRhc291cmNlQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSA9XG4gICAgICB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zeW5jTWV0YWRhdGEgPSB0aGlzLnN5bmNNZXRhZGF0YS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0Q29sdW1ucyA9IHRoaXMuc2V0Q29sdW1ucy5iaW5kKHRoaXMpO1xuICAgIHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UgPSB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5oYW5kbGVUYWJTZWxlY3QgPSB0aGlzLmhhbmRsZVRhYlNlbGVjdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuY3VycmVuY2llcyA9IGVuc3VyZUlzQXJyYXkocHJvcHMuY3VycmVuY2llcykubWFwKGN1cnJlbmN5Q29kZSA9PiAoe1xuICAgICAgdmFsdWU6IGN1cnJlbmN5Q29kZSxcbiAgICAgIGxhYmVsOiBgJHtnZXRDdXJyZW5jeVN5bWJvbCh7XG4gICAgICAgIHN5bWJvbDogY3VycmVuY3lDb2RlLFxuICAgICAgfSl9ICgke2N1cnJlbmN5Q29kZX0pYCxcbiAgICB9KSk7XG4gIH1cblxuICBvbkNoYW5nZSgpIHtcbiAgICAvLyBFbXB0eWluZyBTUUwgaWYgXCJQaHlzaWNhbFwiIHJhZGlvIGJ1dHRvbiBpcyBzZWxlY3RlZFxuICAgIC8vIEN1cnJlbnRseSB0aGUgbG9naWMgdG8ga25vdyB3aGV0aGVyIHRoZSBzb3VyY2UgaXNcbiAgICAvLyBwaHlzaWNhbCBvciB2aXJ0dWFsIGlzIGJhc2VkIG9uIHdoZXRoZXIgU1FMIGlzIGVtcHR5IG9yIG5vdC5cbiAgICBjb25zdCB7IGRhdGFzb3VyY2VUeXBlLCBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHNxbCA9XG4gICAgICBkYXRhc291cmNlVHlwZSA9PT0gREFUQVNPVVJDRV9UWVBFUy5waHlzaWNhbC5rZXkgPyAnJyA6IGRhdGFzb3VyY2Uuc3FsO1xuICAgIGNvbnN0IG5ld0RhdGFzb3VyY2UgPSB7XG4gICAgICAuLi50aGlzLnN0YXRlLmRhdGFzb3VyY2UsXG4gICAgICBzcWwsXG4gICAgICBjb2x1bW5zOiBbLi4udGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnMsIC4uLnRoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnNdLFxuICAgIH07XG4gICAgdGhpcy5wcm9wcy5vbkNoYW5nZShuZXdEYXRhc291cmNlLCB0aGlzLnN0YXRlLmVycm9ycyk7XG4gIH1cblxuICBvbkNoYW5nZUVkaXRNb2RlKCkge1xuICAgIHRoaXMucHJvcHMuc2V0SXNFZGl0aW5nKCF0aGlzLnN0YXRlLmlzRWRpdE1vZGUpO1xuICAgIHRoaXMuc2V0U3RhdGUocHJldlN0YXRlID0+ICh7IGlzRWRpdE1vZGU6ICFwcmV2U3RhdGUuaXNFZGl0TW9kZSB9KSk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VDaGFuZ2UoZGF0YXNvdXJjZSwgY2FsbGJhY2sgPSB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRhdGFzb3VyY2UgfSwgY2FsbGJhY2spO1xuICB9XG5cbiAgb25EYXRhc291cmNlUHJvcENoYW5nZShhdHRyLCB2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm47IC8vIGlmIHZhbHVlIGlzIHVuZGVmaW5lZCBkbyBub3QgdXBkYXRlIHN0YXRlXG4gICAgY29uc3QgZGF0YXNvdXJjZSA9IHsgLi4udGhpcy5zdGF0ZS5kYXRhc291cmNlLCBbYXR0cl06IHZhbHVlIH07XG4gICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgIHByZXZTdGF0ZSA9PiAoe1xuICAgICAgICBkYXRhc291cmNlOiB7IC4uLnByZXZTdGF0ZS5kYXRhc291cmNlLCBbYXR0cl06IHZhbHVlIH0sXG4gICAgICB9KSxcbiAgICAgIGF0dHIgPT09ICd0YWJsZV9uYW1lJ1xuICAgICAgICA/IHRoaXMub25EYXRhc291cmNlQ2hhbmdlKGRhdGFzb3VyY2UsIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEpXG4gICAgICAgIDogdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UoZGF0YXNvdXJjZSwgdGhpcy52YWxpZGF0ZUFuZENoYW5nZSksXG4gICAgKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZVR5cGVDaGFuZ2UoZGF0YXNvdXJjZVR5cGUpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGF0YXNvdXJjZVR5cGUgfSk7XG4gIH1cblxuICBzZXRDb2x1bW5zKG9iaikge1xuICAgIC8vIHVwZGF0ZSBjYWxjdWxhdGVkQ29sdW1ucyBvciBkYXRhYmFzZUNvbHVtbnNcbiAgICB0aGlzLnNldFN0YXRlKG9iaiwgdGhpcy52YWxpZGF0ZUFuZENoYW5nZSk7XG4gIH1cblxuICB2YWxpZGF0ZUFuZENoYW5nZSgpIHtcbiAgICB0aGlzLnZhbGlkYXRlKHRoaXMub25DaGFuZ2UpO1xuICB9XG5cbiAgdGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEoKSB7XG4gICAgdGhpcy52YWxpZGF0ZSgoKSA9PiB7XG4gICAgICB0aGlzLnN5bmNNZXRhZGF0YSgpO1xuICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlQ29sdW1ucyhjb2xzKSB7XG4gICAgLy8gY29sczogQXJyYXk8e2NvbHVtbl9uYW1lOiBzdHJpbmc7IGlzX2R0dG06IGJvb2xlYW47IHR5cGU6IHN0cmluZzt9PlxuICAgIGNvbnN0IHsgZGF0YWJhc2VDb2x1bW5zIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IGRhdGFiYXNlQ29sdW1uTmFtZXMgPSBjb2xzLm1hcChjb2wgPT4gY29sLmNvbHVtbl9uYW1lKTtcbiAgICBjb25zdCBjdXJyZW50Q29scyA9IGRhdGFiYXNlQ29sdW1ucy5yZWR1Y2UoXG4gICAgICAoYWdnLCBjb2wpID0+ICh7XG4gICAgICAgIC4uLmFnZyxcbiAgICAgICAgW2NvbC5jb2x1bW5fbmFtZV06IGNvbCxcbiAgICAgIH0pLFxuICAgICAge30sXG4gICAgKTtcbiAgICBjb25zdCBmaW5hbENvbHVtbnMgPSBbXTtcbiAgICBjb25zdCByZXN1bHRzID0ge1xuICAgICAgYWRkZWQ6IFtdLFxuICAgICAgbW9kaWZpZWQ6IFtdLFxuICAgICAgcmVtb3ZlZDogZGF0YWJhc2VDb2x1bW5zXG4gICAgICAgIC5tYXAoY29sID0+IGNvbC5jb2x1bW5fbmFtZSlcbiAgICAgICAgLmZpbHRlcihjb2wgPT4gIWRhdGFiYXNlQ29sdW1uTmFtZXMuaW5jbHVkZXMoY29sKSksXG4gICAgfTtcbiAgICBjb2xzLmZvckVhY2goY29sID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRDb2wgPSBjdXJyZW50Q29sc1tjb2wuY29sdW1uX25hbWVdO1xuICAgICAgaWYgKCFjdXJyZW50Q29sKSB7XG4gICAgICAgIC8vIG5ldyBjb2x1bW5cbiAgICAgICAgZmluYWxDb2x1bW5zLnB1c2goe1xuICAgICAgICAgIGlkOiBuYW5vaWQoKSxcbiAgICAgICAgICBjb2x1bW5fbmFtZTogY29sLmNvbHVtbl9uYW1lLFxuICAgICAgICAgIHR5cGU6IGNvbC50eXBlLFxuICAgICAgICAgIGdyb3VwYnk6IHRydWUsXG4gICAgICAgICAgZmlsdGVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICBpc19kdHRtOiBjb2wuaXNfZHR0bSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlc3VsdHMuYWRkZWQucHVzaChjb2wuY29sdW1uX25hbWUpO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgY3VycmVudENvbC50eXBlICE9PSBjb2wudHlwZSB8fFxuICAgICAgICAoIWN1cnJlbnRDb2wuaXNfZHR0bSAmJiBjb2wuaXNfZHR0bSlcbiAgICAgICkge1xuICAgICAgICAvLyBtb2RpZmllZCBjb2x1bW5cbiAgICAgICAgZmluYWxDb2x1bW5zLnB1c2goe1xuICAgICAgICAgIC4uLmN1cnJlbnRDb2wsXG4gICAgICAgICAgdHlwZTogY29sLnR5cGUsXG4gICAgICAgICAgaXNfZHR0bTogY3VycmVudENvbC5pc19kdHRtIHx8IGNvbC5pc19kdHRtLFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0cy5tb2RpZmllZC5wdXNoKGNvbC5jb2x1bW5fbmFtZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyB1bmNoYW5nZWRcbiAgICAgICAgZmluYWxDb2x1bW5zLnB1c2goY3VycmVudENvbCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKFxuICAgICAgcmVzdWx0cy5hZGRlZC5sZW5ndGggfHxcbiAgICAgIHJlc3VsdHMubW9kaWZpZWQubGVuZ3RoIHx8XG4gICAgICByZXN1bHRzLnJlbW92ZWQubGVuZ3RoXG4gICAgKSB7XG4gICAgICB0aGlzLnNldENvbHVtbnMoeyBkYXRhYmFzZUNvbHVtbnM6IGZpbmFsQ29sdW1ucyB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBzeW5jTWV0YWRhdGEoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgIGRhdGFzb3VyY2VfdHlwZTogZGF0YXNvdXJjZS50eXBlIHx8IGRhdGFzb3VyY2UuZGF0YXNvdXJjZV90eXBlLFxuICAgICAgZGF0YWJhc2VfbmFtZTpcbiAgICAgICAgZGF0YXNvdXJjZS5kYXRhYmFzZS5kYXRhYmFzZV9uYW1lIHx8IGRhdGFzb3VyY2UuZGF0YWJhc2UubmFtZSxcbiAgICAgIGNhdGFsb2dfbmFtZTogZGF0YXNvdXJjZS5jYXRhbG9nLFxuICAgICAgc2NoZW1hX25hbWU6IGRhdGFzb3VyY2Uuc2NoZW1hLFxuICAgICAgdGFibGVfbmFtZTogZGF0YXNvdXJjZS50YWJsZV9uYW1lLFxuICAgICAgbm9ybWFsaXplX2NvbHVtbnM6IGRhdGFzb3VyY2Uubm9ybWFsaXplX2NvbHVtbnMsXG4gICAgICBhbHdheXNfZmlsdGVyX21haW5fZHR0bTogZGF0YXNvdXJjZS5hbHdheXNfZmlsdGVyX21haW5fZHR0bSxcbiAgICB9O1xuICAgIE9iamVjdC5lbnRyaWVzKHBhcmFtcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAvLyByaXNvbiBjYW4ndCBlbmNvZGUgdGhlIHVuZGVmaW5lZCB2YWx1ZVxuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcGFyYW1zW2tleV0gPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IGVuZHBvaW50ID0gYC9kYXRhc291cmNlL2V4dGVybmFsX21ldGFkYXRhX2J5X25hbWUvP3E9JHtyaXNvbi5lbmNvZGVfdXJpKFxuICAgICAgcGFyYW1zLFxuICAgICl9YDtcbiAgICB0aGlzLnNldFN0YXRlKHsgbWV0YWRhdGFMb2FkaW5nOiB0cnVlIH0pO1xuXG4gICAgU3VwZXJzZXRDbGllbnQuZ2V0KHsgZW5kcG9pbnQgfSlcbiAgICAgIC50aGVuKCh7IGpzb24gfSkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHRzID0gdGhpcy51cGRhdGVDb2x1bW5zKGpzb24pO1xuICAgICAgICBpZiAocmVzdWx0cy5tb2RpZmllZC5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdChcbiAgICAgICAgICAgIHQoJ01vZGlmaWVkIGNvbHVtbnM6ICVzJywgcmVzdWx0cy5tb2RpZmllZC5qb2luKCcsICcpKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHRzLnJlbW92ZWQubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5hZGRTdWNjZXNzVG9hc3QoXG4gICAgICAgICAgICB0KCdSZW1vdmVkIGNvbHVtbnM6ICVzJywgcmVzdWx0cy5yZW1vdmVkLmpvaW4oJywgJykpLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdHMuYWRkZWQubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5hZGRTdWNjZXNzVG9hc3QoXG4gICAgICAgICAgICB0KCdOZXcgY29sdW1ucyBhZGRlZDogJXMnLCByZXN1bHRzLmFkZGVkLmpvaW4oJywgJykpLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcm9wcy5hZGRTdWNjZXNzVG9hc3QodCgnTWV0YWRhdGEgaGFzIGJlZW4gc3luY2VkJykpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgbWV0YWRhdGFMb2FkaW5nOiBmYWxzZSB9KTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2gocmVzcG9uc2UgPT5cbiAgICAgICAgZ2V0Q2xpZW50RXJyb3JPYmplY3QocmVzcG9uc2UpLnRoZW4oKHsgZXJyb3IsIHN0YXR1c1RleHQgfSkgPT4ge1xuICAgICAgICAgIHRoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3QoXG4gICAgICAgICAgICBlcnJvciB8fCBzdGF0dXNUZXh0IHx8IHQoJ0FuIGVycm9yIGhhcyBvY2N1cnJlZCcpLFxuICAgICAgICAgICk7XG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1ldGFkYXRhTG9hZGluZzogZmFsc2UgfSk7XG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgfVxuXG4gIGZpbmREdXBsaWNhdGVzKGFyciwgYWNjZXNzb3IpIHtcbiAgICBjb25zdCBzZWVuID0ge307XG4gICAgY29uc3QgZHVwcyA9IFtdO1xuICAgIGFyci5mb3JFYWNoKG9iaiA9PiB7XG4gICAgICBjb25zdCBpdGVtID0gYWNjZXNzb3Iob2JqKTtcbiAgICAgIGlmIChpdGVtIGluIHNlZW4pIHtcbiAgICAgICAgZHVwcy5wdXNoKGl0ZW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VlbltpdGVtXSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGR1cHM7XG4gIH1cblxuICB2YWxpZGF0ZShjYWxsYmFjaykge1xuICAgIGxldCBlcnJvcnMgPSBbXTtcbiAgICBsZXQgZHVwcztcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAvLyBMb29raW5nIGZvciBkdXBsaWNhdGUgY29sdW1uX25hbWVcbiAgICBkdXBzID0gdGhpcy5maW5kRHVwbGljYXRlcyhkYXRhc291cmNlLmNvbHVtbnMsIG9iaiA9PiBvYmouY29sdW1uX25hbWUpO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBkdXBzLm1hcChuYW1lID0+IHQoJ0NvbHVtbiBuYW1lIFslc10gaXMgZHVwbGljYXRlZCcsIG5hbWUpKSxcbiAgICApO1xuXG4gICAgLy8gTG9va2luZyBmb3IgZHVwbGljYXRlIG1ldHJpY19uYW1lXG4gICAgZHVwcyA9IHRoaXMuZmluZER1cGxpY2F0ZXMoZGF0YXNvdXJjZS5tZXRyaWNzLCBvYmogPT4gb2JqLm1ldHJpY19uYW1lKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgZHVwcy5tYXAobmFtZSA9PiB0KCdNZXRyaWMgbmFtZSBbJXNdIGlzIGR1cGxpY2F0ZWQnLCBuYW1lKSksXG4gICAgKTtcblxuICAgIC8vIE1ha2luZyBzdXJlIGNhbGN1bGF0ZWRDb2x1bW5zIGhhdmUgYW4gZXhwcmVzc2lvbiBkZWZpbmVkXG4gICAgY29uc3Qgbm9GaWx0ZXJDYWxjQ29scyA9IHRoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnMuZmlsdGVyKFxuICAgICAgY29sID0+ICFjb2wuZXhwcmVzc2lvbiAmJiAhY29sLmpzb24sXG4gICAgKTtcbiAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0KFxuICAgICAgbm9GaWx0ZXJDYWxjQ29scy5tYXAoY29sID0+XG4gICAgICAgIHQoJ0NhbGN1bGF0ZWQgY29sdW1uIFslc10gcmVxdWlyZXMgYW4gZXhwcmVzc2lvbicsIGNvbC5jb2x1bW5fbmFtZSksXG4gICAgICApLFxuICAgICk7XG5cbiAgICAvLyB2YWxpZGF0ZSBjdXJyZW5jeSBjb2RlXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3RhdGUuZGF0YXNvdXJjZS5tZXRyaWNzPy5mb3JFYWNoKFxuICAgICAgICBtZXRyaWMgPT5cbiAgICAgICAgICBtZXRyaWMuY3VycmVuY3k/LnN5bWJvbCAmJlxuICAgICAgICAgIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZW4tVVMnLCB7XG4gICAgICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JyxcbiAgICAgICAgICAgIGN1cnJlbmN5OiBtZXRyaWMuY3VycmVuY3kuc3ltYm9sLFxuICAgICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoW3QoJ0ludmFsaWQgY3VycmVuY3kgY29kZSBpbiBzYXZlZCBtZXRyaWNzJyldKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHsgZXJyb3JzIH0sIGNhbGxiYWNrKTtcbiAgfVxuXG4gIGhhbmRsZVRhYlNlbGVjdChhY3RpdmVUYWJLZXkpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgYWN0aXZlVGFiS2V5IH0pO1xuICB9XG5cbiAgc29ydE1ldHJpY3MobWV0cmljcykge1xuICAgIHJldHVybiBtZXRyaWNzLnNvcnQoKHsgaWQ6IGEgfSwgeyBpZDogYiB9KSA9PiBiIC0gYSk7XG4gIH1cblxuICByZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdCYXNpYycpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cImRlZmF1bHRfZW5kcG9pbnRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdEZWZhdWx0IFVSTCcpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0RlZmF1bHQgVVJMIHRvIHJlZGlyZWN0IHRvIHdoZW4gYWNjZXNzaW5nIGZyb20gdGhlIGRhdGFzZXQgbGlzdCBwYWdlJyxcbiAgICAgICAgICApfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJkZWZhdWx0X2VuZHBvaW50XCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiZmlsdGVyX3NlbGVjdF9lbmFibGVkXCJcbiAgICAgICAgICBsYWJlbD17dCgnQXV0b2NvbXBsZXRlIGZpbHRlcnMnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnV2hldGhlciB0byBwb3B1bGF0ZSBhdXRvY29tcGxldGUgZmlsdGVycyBvcHRpb25zJyl9XG4gICAgICAgICAgY29udHJvbD17PENoZWNrYm94Q29udHJvbCAvPn1cbiAgICAgICAgLz5cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZmV0Y2hfdmFsdWVzX3ByZWRpY2F0ZVwiXG4gICAgICAgICAgICBsYWJlbD17dCgnQXV0b2NvbXBsZXRlIHF1ZXJ5IHByZWRpY2F0ZScpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdXaGVuIHVzaW5nIFwiQXV0b2NvbXBsZXRlIGZpbHRlcnNcIiwgdGhpcyBjYW4gYmUgdXNlZCB0byBpbXByb3ZlIHBlcmZvcm1hbmNlICcgK1xuICAgICAgICAgICAgICAgICdvZiB0aGUgcXVlcnkgZmV0Y2hpbmcgdGhlIHZhbHVlcy4gVXNlIHRoaXMgb3B0aW9uIHRvIGFwcGx5IGEgJyArXG4gICAgICAgICAgICAgICAgJ3ByZWRpY2F0ZSAoV0hFUkUgY2xhdXNlKSB0byB0aGUgcXVlcnkgc2VsZWN0aW5nIHRoZSBkaXN0aW5jdCAnICtcbiAgICAgICAgICAgICAgICAndmFsdWVzIGZyb20gdGhlIHRhYmxlLiBUeXBpY2FsbHkgdGhlIGludGVudCB3b3VsZCBiZSB0byBsaW1pdCB0aGUgc2NhbiAnICtcbiAgICAgICAgICAgICAgICAnYnkgYXBwbHlpbmcgYSByZWxhdGl2ZSB0aW1lIGZpbHRlciBvbiBhIHBhcnRpdGlvbmVkIG9yIGluZGV4ZWQgdGltZS1yZWxhdGVkIGZpZWxkLicsXG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICBsYW5ndWFnZT1cInNxbFwiXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZmV0Y2hfdmFsdWVzX3ByZWRpY2F0ZVwiXG4gICAgICAgICAgICAgICAgbWluTGluZXM9ezV9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cImV4dHJhXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdFeHRyYScpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdFeHRyYSBkYXRhIHRvIHNwZWNpZnkgdGFibGUgbWV0YWRhdGEuIEN1cnJlbnRseSBzdXBwb3J0cyAnICtcbiAgICAgICAgICAgICAgICAnbWV0YWRhdGEgb2YgdGhlIGZvcm1hdDogYHsgXCJjZXJ0aWZpY2F0aW9uXCI6IHsgXCJjZXJ0aWZpZWRfYnlcIjogJyArXG4gICAgICAgICAgICAgICAgJ1wiRGF0YSBQbGF0Zm9ybSBUZWFtXCIsIFwiZGV0YWlsc1wiOiBcIlRoaXMgdGFibGUgaXMgdGhlIHNvdXJjZSBvZiB0cnV0aC5cIiAnICtcbiAgICAgICAgICAgICAgICAnfSwgXCJ3YXJuaW5nX21hcmtkb3duXCI6IFwiVGhpcyBpcyBhIHdhcm5pbmcuXCIgfWAuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImV4dHJhXCJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZT1cImpzb25cIlxuICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8T3duZXJzU2VsZWN0b3JcbiAgICAgICAgICBkYXRhc291cmNlPXtkYXRhc291cmNlfVxuICAgICAgICAgIG9uQ2hhbmdlPXtuZXdPd25lcnMgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UoeyAuLi5kYXRhc291cmNlLCBvd25lcnM6IG5ld093bmVycyB9KTtcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgPC9GaWVsZHNldD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyQWR2YW5jZWRGaWVsZHNldCgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGaWVsZHNldFxuICAgICAgICB0aXRsZT17dCgnQWR2YW5jZWQnKX1cbiAgICAgICAgaXRlbT17ZGF0YXNvdXJjZX1cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cImNhY2hlX3RpbWVvdXRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdDYWNoZSB0aW1lb3V0Jyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnVGhlIGR1cmF0aW9uIG9mIHRpbWUgaW4gc2Vjb25kcyBiZWZvcmUgdGhlIGNhY2hlIGlzIGludmFsaWRhdGVkLiBTZXQgdG8gLTEgdG8gYnlwYXNzIHRoZSBjYWNoZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImNhY2hlX3RpbWVvdXRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgZmllbGRLZXk9XCJvZmZzZXRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdIb3VycyBvZmZzZXQnKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwib2Zmc2V0XCIgLz59XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnVGhlIG51bWJlciBvZiBob3VycywgbmVnYXRpdmUgb3IgcG9zaXRpdmUsIHRvIHNoaWZ0IHRoZSB0aW1lIGNvbHVtbi4gVGhpcyBjYW4gYmUgdXNlZCB0byBtb3ZlIFVUQyB0aW1lIHRvIGxvY2FsIHRpbWUuJyxcbiAgICAgICAgICApfVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJ0ZW1wbGF0ZV9wYXJhbXNcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ1RlbXBsYXRlIHBhcmFtZXRlcnMnKX1cbiAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAnQSBzZXQgb2YgcGFyYW1ldGVycyB0aGF0IGJlY29tZSBhdmFpbGFibGUgaW4gdGhlIHF1ZXJ5IHVzaW5nIEppbmphIHRlbXBsYXRpbmcgc3ludGF4JyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwidGVtcGxhdGVfcGFyYW1zXCIgLz59XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJub3JtYWxpemVfY29sdW1uc1wiXG4gICAgICAgICAgbGFiZWw9e3QoJ05vcm1hbGl6ZSBjb2x1bW4gbmFtZXMnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdBbGxvdyBjb2x1bW4gbmFtZXMgdG8gYmUgY2hhbmdlZCB0byBjYXNlIGluc2Vuc2l0aXZlIGZvcm1hdCwgaWYgc3VwcG9ydGVkIChlLmcuIE9yYWNsZSwgU25vd2ZsYWtlKS4nLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PENoZWNrYm94Q29udHJvbCBjb250cm9sSWQ9XCJub3JtYWxpemVfY29sdW1uc1wiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCJcbiAgICAgICAgICBsYWJlbD17dCgnQWx3YXlzIGZpbHRlciBtYWluIGRhdGV0aW1lIGNvbHVtbicpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgYFdoZW4gdGhlIHNlY29uZGFyeSB0ZW1wb3JhbCBjb2x1bW5zIGFyZSBmaWx0ZXJlZCwgYXBwbHkgdGhlIHNhbWUgZmlsdGVyIHRvIHRoZSBtYWluIGRhdGV0aW1lIGNvbHVtbi5gLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PENoZWNrYm94Q29udHJvbCBjb250cm9sSWQ9XCJhbHdheXNfZmlsdGVyX21haW5fZHR0bVwiIC8+fVxuICAgICAgICAvPlxuICAgICAgPC9GaWVsZHNldD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU3BhdGlhbFRhYigpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBzcGF0aWFscywgYWxsX2NvbHM6IGFsbENvbHMgfSA9IGRhdGFzb3VyY2U7XG4gICAgcmV0dXJuIChcbiAgICAgIDxUYWJzLlRhYlBhbmVcbiAgICAgICAgdGFiPXs8Q29sbGVjdGlvblRhYlRpdGxlIGNvbGxlY3Rpb249e3NwYXRpYWxzfSB0aXRsZT17dCgnU3BhdGlhbCcpfSAvPn1cbiAgICAgICAga2V5PXs0fVxuICAgICAgPlxuICAgICAgICA8Q29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgdGFibGVDb2x1bW5zPXtbJ25hbWUnLCAnY29uZmlnJ119XG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMsICdzcGF0aWFscycpfVxuICAgICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgICBuYW1lOiB0KCc8bmV3IHNwYXRpYWw+JyksXG4gICAgICAgICAgICB0eXBlOiB0KCc8bm8gdHlwZT4nKSxcbiAgICAgICAgICAgIGNvbmZpZzogbnVsbCxcbiAgICAgICAgICB9KX1cbiAgICAgICAgICBjb2xsZWN0aW9uPXtzcGF0aWFsc31cbiAgICAgICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgICAgICBpdGVtUmVuZGVyZXJzPXt7XG4gICAgICAgICAgICBuYW1lOiAoZCwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPEVkaXRhYmxlVGl0bGUgY2FuRWRpdCB0aXRsZT17ZH0gb25TYXZlVGl0bGU9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIGNvbmZpZzogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICAgIDxTcGF0aWFsQ29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSBjaG9pY2VzPXthbGxDb2xzfSAvPlxuICAgICAgICAgICAgKSxcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlclNvdXJjZUZpZWxkc2V0KHRoZW1lKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICA8RWRpdExvY2tDb250YWluZXI+XG4gICAgICAgICAgPHNwYW4gcm9sZT1cImJ1dHRvblwiIHRhYkluZGV4PXswfSBvbkNsaWNrPXt0aGlzLm9uQ2hhbmdlRWRpdE1vZGV9PlxuICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNFZGl0TW9kZSA/IChcbiAgICAgICAgICAgICAgPEljb25zLkxvY2tVbmxvY2tlZCBpY29uQ29sb3I9e3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX0gLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDxJY29ucy5Mb2NrTG9ja2VkIGljb25Db2xvcj17dGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfSAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgeyF0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiYgKFxuICAgICAgICAgICAgPGRpdj57dCgnQ2xpY2sgdGhlIGxvY2sgdG8gbWFrZSBjaGFuZ2VzLicpfTwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgICAge3RoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJiAoXG4gICAgICAgICAgICA8ZGl2Pnt0KCdDbGljayB0aGUgbG9jayB0byBwcmV2ZW50IGZ1cnRoZXIgY2hhbmdlcy4nKX08L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICA8L0VkaXRMb2NrQ29udGFpbmVyPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm0tbC0xMCBtLXQtMjAgbS1iLTEwXCI+XG4gICAgICAgICAge0RBVEFTT1VSQ0VfVFlQRVNfQVJSLm1hcCh0eXBlID0+IChcbiAgICAgICAgICAgIDxSYWRpb1xuICAgICAgICAgICAgICBrZXk9e3R5cGUua2V5fVxuICAgICAgICAgICAgICB2YWx1ZT17dHlwZS5rZXl9XG4gICAgICAgICAgICAgIGlubGluZVxuICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VUeXBlQ2hhbmdlLmJpbmQodGhpcywgdHlwZS5rZXkpfVxuICAgICAgICAgICAgICBjaGVja2VkPXt0aGlzLnN0YXRlLmRhdGFzb3VyY2VUeXBlID09PSB0eXBlLmtleX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHt0eXBlLmxhYmVsfVxuICAgICAgICAgICAgPC9SYWRpbz5cbiAgICAgICAgICApKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxociAvPlxuICAgICAgICA8RmllbGRzZXQgaXRlbT17ZGF0YXNvdXJjZX0gb25DaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfSBjb21wYWN0PlxuICAgICAgICAgIHt0aGlzLnN0YXRlLmRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnZpcnR1YWwua2V5ICYmIChcbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cImRhdGFiYXNlU2VsZWN0b3JcIlxuICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCd2aXJ0dWFsJyl9XG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyBtYXJnaW5Ub3A6IDggfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEYXRhYmFzZVNlbGVjdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGI9e2RhdGFzb3VyY2U/LmRhdGFiYXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGFsb2c9e2RhdGFzb3VyY2UuY2F0YWxvZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE9e2RhdGFzb3VyY2Uuc2NoZW1hfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2F0YWxvZ0NoYW5nZT17Y2F0YWxvZyA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ2NhdGFsb2cnLCBjYXRhbG9nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNjaGVtYUNoYW5nZT17c2NoZW1hID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnc2NoZW1hJywgc2NoZW1hKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkRiQ2hhbmdlPXtkYXRhYmFzZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ2RhdGFiYXNlJywgZGF0YWJhc2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1Nb2RlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcj17dGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkT25seT17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjc3M9e3sgd2lkdGg6ICdjYWxjKDEwMCUgLSAzNHB4KScsIG1hcmdpblRvcDogLTE2IH19PlxuICAgICAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJ0YWJsZV9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdOYW1lJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwidGFibGVfbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RhYmxlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgndGFibGVfbmFtZScsIHRhYmxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdEYXRhc2V0IG5hbWUnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwic3FsXCJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ1NRTCcpfVxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgICAgICAgICAnV2hlbiBzcGVjaWZ5aW5nIFNRTCwgdGhlIGRhdGFzb3VyY2UgYWN0cyBhcyBhIHZpZXcuICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1N1cGVyc2V0IHdpbGwgdXNlIHRoaXMgc3RhdGVtZW50IGFzIGEgc3VicXVlcnkgd2hpbGUgZ3JvdXBpbmcgYW5kIGZpbHRlcmluZyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdvbiB0aGUgZ2VuZXJhdGVkIHBhcmVudCBxdWVyaWVzLicsXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWluTGluZXM9ezIwfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4TGluZXM9e0luZmluaXR5fVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9eyF0aGlzLnN0YXRlLmlzRWRpdE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNpemU9XCJib3RoXCJcbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5kYXRhc291cmNlVHlwZSA9PT0gREFUQVNPVVJDRV9UWVBFUy5waHlzaWNhbC5rZXkgJiYgKFxuICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInRhYmxlU2VsZWN0b3JcIlxuICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ1BoeXNpY2FsJyl9XG4gICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjc3M9e3sgbWFyZ2luVG9wOiA4IH19PlxuICAgICAgICAgICAgICAgICAgICAgIDxUYWJsZVNlbGVjdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhcmFibGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2U9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGF0YXNvdXJjZS5kYXRhYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2VfbmFtZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlPy5kYXRhYmFzZV9uYW1lIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXNvdXJjZS5kYXRhYmFzZT8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICBkYklkPXtkYXRhc291cmNlLmRhdGFiYXNlPy5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yPXt0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0YWxvZz17ZGF0YXNvdXJjZS5jYXRhbG9nfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hPXtkYXRhc291cmNlLnNjaGVtYX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNxbExhYk1vZGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVWYWx1ZT17ZGF0YXNvdXJjZS50YWJsZV9uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DYXRhbG9nQ2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjYXRhbG9nID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnY2F0YWxvZycsIGNhdGFsb2cpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU2NoZW1hQ2hhbmdlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5pc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBzY2hlbWEgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdzY2hlbWEnLCBzY2hlbWEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRGJDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGRhdGFiYXNlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YWJhc2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uVGFibGVTZWxlY3RDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRhYmxlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgndGFibGVfbmFtZScsIHRhYmxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkT25seT17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAgICAgICAnVGhlIHBvaW50ZXIgdG8gYSBwaHlzaWNhbCB0YWJsZSAob3IgdmlldykuIEtlZXAgaW4gbWluZCB0aGF0IHRoZSBjaGFydCBpcyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAnYXNzb2NpYXRlZCB0byB0aGlzIFN1cGVyc2V0IGxvZ2ljYWwgdGFibGUsIGFuZCB0aGlzIGxvZ2ljYWwgdGFibGUgcG9pbnRzICcgK1xuICAgICAgICAgICAgICAgICAgICAgICd0aGUgcGh5c2ljYWwgdGFibGUgcmVmZXJlbmNlZCBoZXJlLicsXG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICApfVxuICAgICAgICA8L0ZpZWxkc2V0PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlckVycm9ycygpIHtcbiAgICBpZiAodGhpcy5zdGF0ZS5lcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPEFsZXJ0XG4gICAgICAgICAgY3NzPXt0aGVtZSA9PiAoeyBtYXJnaW5Cb3R0b206IHRoZW1lLmdyaWRVbml0ICogNCB9KX1cbiAgICAgICAgICB0eXBlPVwiZXJyb3JcIlxuICAgICAgICAgIG1lc3NhZ2U9e1xuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuZXJyb3JzLm1hcChlcnIgPT4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtlcnJ9PntlcnJ9PC9kaXY+XG4gICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgPC8+XG4gICAgICAgICAgfVxuICAgICAgICAvPlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZW5kZXJNZXRyaWNDb2xsZWN0aW9uKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IG1ldHJpY3MgfSA9IGRhdGFzb3VyY2U7XG4gICAgY29uc3Qgc29ydGVkTWV0cmljcyA9IG1ldHJpY3M/Lmxlbmd0aCA/IHRoaXMuc29ydE1ldHJpY3MobWV0cmljcykgOiBbXTtcbiAgICByZXR1cm4gKFxuICAgICAgPENvbGxlY3Rpb25UYWJsZVxuICAgICAgICB0YWJsZUNvbHVtbnM9e1snbWV0cmljX25hbWUnLCAndmVyYm9zZV9uYW1lJywgJ2V4cHJlc3Npb24nXX1cbiAgICAgICAgc29ydENvbHVtbnM9e1snbWV0cmljX25hbWUnLCAndmVyYm9zZV9uYW1lJywgJ2V4cHJlc3Npb24nXX1cbiAgICAgICAgY29sdW1uTGFiZWxzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoJ01ldHJpYyBLZXknKSxcbiAgICAgICAgICB2ZXJib3NlX25hbWU6IHQoJ0xhYmVsJyksXG4gICAgICAgICAgZXhwcmVzc2lvbjogdCgnU1FMIGV4cHJlc3Npb24nKSxcbiAgICAgICAgfX1cbiAgICAgICAgY29sdW1uTGFiZWxUb29sdGlwcz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KFxuICAgICAgICAgICAgJ1RoaXMgZmllbGQgaXMgdXNlZCBhcyBhIHVuaXF1ZSBpZGVudGlmaWVyIHRvIGF0dGFjaCAnICtcbiAgICAgICAgICAgICAgJ3RoZSBtZXRyaWMgdG8gY2hhcnRzLiBJdCBpcyBhbHNvIHVzZWQgYXMgdGhlIGFsaWFzIGluIHRoZSAnICtcbiAgICAgICAgICAgICAgJ1NRTCBxdWVyeS4nLFxuICAgICAgICAgICksXG4gICAgICAgIH19XG4gICAgICAgIGV4cGFuZEZpZWxkc2V0PXtcbiAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj5cbiAgICAgICAgICAgIDxGaWVsZHNldCBjb21wYWN0PlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnRGVzY3JpcHRpb24nKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZDNmb3JtYXRcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdEMyBmb3JtYXQnKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJkM2Zvcm1hdFwiIHBsYWNlaG9sZGVyPVwiJXkvJW0vJWRcIiAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJjdXJyZW5jeVwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ01ldHJpYyBjdXJyZW5jeScpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPEN1cnJlbmN5Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW5jeVNlbGVjdE92ZXJyaWRlUHJvcHM9e3tcbiAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogdCgnU2VsZWN0IG9yIHR5cGUgY3VycmVuY3kgc3ltYm9sJyksXG4gICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgIHN5bWJvbFNlbGVjdEFkZGl0aW9uYWxTdHlsZXM9e2Nzc2BcbiAgICAgICAgICAgICAgICAgICAgICBtYXgtd2lkdGg6IDMwJTtcbiAgICAgICAgICAgICAgICAgICAgYH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWVkIGJ5Jyl9XG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAgICAgJ1BlcnNvbiBvciBncm91cCB0aGF0IGhhcyBjZXJ0aWZpZWQgdGhpcyBtZXRyaWMnLFxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWVkX2J5XCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0NlcnRpZmllZCBieScpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmljYXRpb25fZGV0YWlsc1wiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ0RldGFpbHMgb2YgdGhlIGNlcnRpZmljYXRpb24nKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpY2F0aW9uX2RldGFpbHNcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQ2VydGlmaWNhdGlvbiBkZXRhaWxzJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ1dhcm5pbmcnKX1cbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cIndhcm5pbmdfbWFya2Rvd25cIlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdPcHRpb25hbCB3YXJuaW5nIGFib3V0IHVzZSBvZiB0aGlzIG1ldHJpYycpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ3YXJuaW5nX21hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJtYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICAgICAgPC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICB9XG4gICAgICAgIGNvbGxlY3Rpb249e3NvcnRlZE1ldHJpY3N9XG4gICAgICAgIGFsbG93QWRkSXRlbVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcywgJ21ldHJpY3MnKX1cbiAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdCgnPG5ldyBtZXRyaWM+JyksXG4gICAgICAgICAgdmVyYm9zZV9uYW1lOiAnJyxcbiAgICAgICAgICBleHByZXNzaW9uOiAnJyxcbiAgICAgICAgfSl9XG4gICAgICAgIGl0ZW1DZWxsUHJvcHM9e3tcbiAgICAgICAgICBleHByZXNzaW9uOiAoKSA9PiAoe1xuICAgICAgICAgICAgd2lkdGg6ICcyNDBweCcsXG4gICAgICAgICAgfSksXG4gICAgICAgIH19XG4gICAgICAgIGl0ZW1SZW5kZXJlcnM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogKHYsIG9uQ2hhbmdlLCBfLCByZWNvcmQpID0+IChcbiAgICAgICAgICAgIDxGbGV4Um93Q29udGFpbmVyPlxuICAgICAgICAgICAgICB7cmVjb3JkLmlzX2NlcnRpZmllZCAmJiAoXG4gICAgICAgICAgICAgICAgPENlcnRpZmllZEJhZGdlXG4gICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRCeT17cmVjb3JkLmNlcnRpZmllZF9ieX1cbiAgICAgICAgICAgICAgICAgIGRldGFpbHM9e3JlY29yZC5jZXJ0aWZpY2F0aW9uX2RldGFpbHN9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAge3JlY29yZC53YXJuaW5nX21hcmtkb3duICYmIChcbiAgICAgICAgICAgICAgICA8V2FybmluZ0ljb25XaXRoVG9vbHRpcFxuICAgICAgICAgICAgICAgICAgd2FybmluZ01hcmtkb3duPXtyZWNvcmQud2FybmluZ19tYXJrZG93bn1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZSBjYW5FZGl0IHRpdGxlPXt2fSBvblNhdmVUaXRsZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgICA8L0ZsZXhSb3dDb250YWluZXI+XG4gICAgICAgICAgKSxcbiAgICAgICAgICB2ZXJib3NlX25hbWU6ICh2LCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgPFRleHRDb250cm9sIGNhbkVkaXQgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkNoYW5nZX0gLz5cbiAgICAgICAgICApLFxuICAgICAgICAgIGV4cHJlc3Npb246ICh2LCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICBjYW5FZGl0XG4gICAgICAgICAgICAgIGluaXRpYWxWYWx1ZT17dn1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAgICAgICBleHRyYUNsYXNzZXM9e1snZGF0YXNvdXJjZS1zcWwtZXhwcmVzc2lvbiddfVxuICAgICAgICAgICAgICBsYW5ndWFnZT1cInNxbFwiXG4gICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICBtaW5MaW5lcz17NX1cbiAgICAgICAgICAgICAgdGV4dEFyZWFTdHlsZXM9e3sgbWluV2lkdGg6ICcyMDBweCcsIG1heFdpZHRoOiAnNDUwcHgnIH19XG4gICAgICAgICAgICAgIHJlc2l6ZT1cImJvdGhcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAodiwgb25DaGFuZ2UsIGxhYmVsKSA9PiAoXG4gICAgICAgICAgICA8U3RhY2tlZEZpZWxkXG4gICAgICAgICAgICAgIGxhYmVsPXtsYWJlbH1cbiAgICAgICAgICAgICAgZm9ybUVsZW1lbnQ9ezxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPn1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgICBkM2Zvcm1hdDogKHYsIG9uQ2hhbmdlLCBsYWJlbCkgPT4gKFxuICAgICAgICAgICAgPFN0YWNrZWRGaWVsZFxuICAgICAgICAgICAgICBsYWJlbD17bGFiZWx9XG4gICAgICAgICAgICAgIGZvcm1FbGVtZW50PXs8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkNoYW5nZX0gLz59XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgIH19XG4gICAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgICBzdGlja3lIZWFkZXJcbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UsIGFjdGl2ZVRhYktleSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IG1ldHJpY3MgfSA9IGRhdGFzb3VyY2U7XG4gICAgY29uc3Qgc29ydGVkTWV0cmljcyA9IG1ldHJpY3M/Lmxlbmd0aCA/IHRoaXMuc29ydE1ldHJpY3MobWV0cmljcykgOiBbXTtcbiAgICBjb25zdCB7IHRoZW1lIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxEYXRhc291cmNlQ29udGFpbmVyIGRhdGEtdGVzdD1cImRhdGFzb3VyY2UtZWRpdG9yXCI+XG4gICAgICAgIHt0aGlzLnJlbmRlckVycm9ycygpfVxuICAgICAgICA8QWxlcnRcbiAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7IG1hcmdpbkJvdHRvbTogdGhlbWUuZ3JpZFVuaXQgKiA0IH0pfVxuICAgICAgICAgIHR5cGU9XCJ3YXJuaW5nXCJcbiAgICAgICAgICBtZXNzYWdlPXtcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIHsnICd9XG4gICAgICAgICAgICAgIDxzdHJvbmc+e3QoJ0JlIGNhcmVmdWwuJyl9IDwvc3Ryb25nPlxuICAgICAgICAgICAgICB7dChcbiAgICAgICAgICAgICAgICAnQ2hhbmdpbmcgdGhlc2Ugc2V0dGluZ3Mgd2lsbCBhZmZlY3QgYWxsIGNoYXJ0cyB1c2luZyB0aGlzIGRhdGFzZXQsIGluY2x1ZGluZyBjaGFydHMgb3duZWQgYnkgb3RoZXIgcGVvcGxlLicsXG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICAgIDxTdHlsZWRUYWJsZVRhYnNcbiAgICAgICAgICBmdWxsV2lkdGg9e2ZhbHNlfVxuICAgICAgICAgIGlkPVwidGFibGUtdGFic1wiXG4gICAgICAgICAgZGF0YS10ZXN0PVwiZWRpdC1kYXRhc2V0LXRhYnNcIlxuICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZVRhYlNlbGVjdH1cbiAgICAgICAgICBkZWZhdWx0QWN0aXZlS2V5PXthY3RpdmVUYWJLZXl9XG4gICAgICAgID5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lIGtleT17MH0gdGFiPXt0KCdTb3VyY2UnKX0+XG4gICAgICAgICAgICB7dGhpcy5yZW5kZXJTb3VyY2VGaWVsZHNldCh0aGVtZSl9XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgPENvbGxlY3Rpb25UYWJUaXRsZVxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb249e3NvcnRlZE1ldHJpY3N9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ01ldHJpY3MnKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleT17MX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7dGhpcy5yZW5kZXJNZXRyaWNDb2xsZWN0aW9uKCl9XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgPENvbGxlY3Rpb25UYWJUaXRsZVxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb249e3RoaXMuc3RhdGUuZGF0YWJhc2VDb2x1bW5zfVxuICAgICAgICAgICAgICAgIHRpdGxlPXt0KCdDb2x1bW5zJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXk9ezJ9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPFN0eWxlZENvbHVtbnNUYWJXcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgICA8U3R5bGVkQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uU2l6ZT1cInNtYWxsXCJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uU3R5bGU9XCJ0ZXJ0aWFyeVwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuc3luY01ldGFkYXRhfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJzeW5jLWZyb20tc291cmNlXCJcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtZGF0YWJhc2VcIiAvPnsnICd9XG4gICAgICAgICAgICAgICAgICAgIHt0KCdTeW5jIGNvbHVtbnMgZnJvbSBzb3VyY2UnKX1cbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgICAgICAgPC9Db2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQ29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29sdW1ucy10YWJsZVwiXG4gICAgICAgICAgICAgICAgY29sdW1ucz17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgZGF0YXNvdXJjZT17ZGF0YXNvdXJjZX1cbiAgICAgICAgICAgICAgICBvbkNvbHVtbnNDaGFuZ2U9e2RhdGFiYXNlQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgZGF0YWJhc2VDb2x1bW5zIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLm1ldGFkYXRhTG9hZGluZyAmJiA8TG9hZGluZyAvPn1cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICAgICAgdGFiPXtcbiAgICAgICAgICAgICAgPENvbGxlY3Rpb25UYWJUaXRsZVxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb249e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NhbGN1bGF0ZWQgY29sdW1ucycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXszfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICAgICAgPENvbHVtbkNvbGxlY3Rpb25UYWJsZVxuICAgICAgICAgICAgICAgIGNvbHVtbnM9e3RoaXMuc3RhdGUuY2FsY3VsYXRlZENvbHVtbnN9XG4gICAgICAgICAgICAgICAgb25Db2x1bW5zQ2hhbmdlPXtjYWxjdWxhdGVkQ29sdW1ucyA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5zKHsgY2FsY3VsYXRlZENvbHVtbnMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29sdW1uTGFiZWxUb29sdGlwcz17e1xuICAgICAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoXG4gICAgICAgICAgICAgICAgICAgICdUaGlzIGZpZWxkIGlzIHVzZWQgYXMgYSB1bmlxdWUgaWRlbnRpZmllciB0byBhdHRhY2ggJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBjYWxjdWxhdGVkIGRpbWVuc2lvbiB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAnYXMgdGhlIGFsaWFzIGluIHRoZSBTUUwgcXVlcnkuJyxcbiAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBvbkRhdGFzb3VyY2VDaGFuZ2U9e3RoaXMub25EYXRhc291cmNlQ2hhbmdlfVxuICAgICAgICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgICAgICAgZWRpdGFibGVDb2x1bW5OYW1lXG4gICAgICAgICAgICAgICAgc2hvd0V4cHJlc3Npb25cbiAgICAgICAgICAgICAgICBhbGxvd0FkZEl0ZW1cbiAgICAgICAgICAgICAgICBhbGxvd0VkaXREYXRhVHlwZVxuICAgICAgICAgICAgICAgIGl0ZW1HZW5lcmF0b3I9eygpID0+ICh7XG4gICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdCgnPG5ldyBjb2x1bW4+JyksXG4gICAgICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZ3JvdXBieTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IHQoJzxlbnRlciBTUUwgZXhwcmVzc2lvbiBoZXJlPicpLFxuICAgICAgICAgICAgICAgICAgX19leHBhbmRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvU3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSBrZXk9ezR9IHRhYj17dCgnU2V0dGluZ3MnKX0+XG4gICAgICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj57dGhpcy5yZW5kZXJTZXR0aW5nc0ZpZWxkc2V0KCl9PC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgPEZvcm1Db250YWluZXI+e3RoaXMucmVuZGVyQWR2YW5jZWRGaWVsZHNldCgpfTwvRm9ybUNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgPC9TdHlsZWRUYWJsZVRhYnM+XG4gICAgICA8L0RhdGFzb3VyY2VDb250YWluZXI+XG4gICAgKTtcbiAgfVxufVxuXG5EYXRhc291cmNlRWRpdG9yLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcbkRhdGFzb3VyY2VFZGl0b3IucHJvcFR5cGVzID0gcHJvcFR5cGVzO1xuXG5jb25zdCBEYXRhU291cmNlQ29tcG9uZW50ID0gd2l0aFRoZW1lKERhdGFzb3VyY2VFZGl0b3IpO1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoVG9hc3RzKERhdGFTb3VyY2VDb21wb25lbnQpO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\n\nfunction CollectionTabTitle({ title, collection }) {\n  return (\n    _jsxs(\"div\", {\n      css: _ref,\n      \"data-test\": `collection-tab-${title}`, children: [\n\n      title, ' ',\n      _jsx(StyledBadge, { count: collection ? collection.length : 0, showZero: true })] }\n    ));\n\n}\n\nCollectionTabTitle.propTypes = {\n  title: PropTypes.string,\n  collection: PropTypes.array\n};\n\nfunction ColumnCollectionTable({\n  columns,\n  datasource,\n  onColumnsChange,\n  onDatasourceChange,\n  editableColumnName,\n  showExpression,\n  allowAddItem,\n  allowEditDataType,\n  itemGenerator,\n  columnLabelTooltips\n}) {\n  return (\n    _jsx(CollectionTable, {\n      tableColumns:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      [\n      'column_name',\n      'advanced_data_type',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'] :\n\n      [\n      'column_name',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'],\n\n\n      sortColumns:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      [\n      'column_name',\n      'advanced_data_type',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'] :\n\n      [\n      'column_name',\n      'type',\n      'is_dttm',\n      'main_dttm_col',\n      'filterable',\n      'groupby'],\n\n\n      allowDeletes: true,\n      allowAddItem: allowAddItem,\n      itemGenerator: itemGenerator,\n      collection: columns,\n      columnLabelTooltips: columnLabelTooltips,\n      stickyHeader: true,\n      expandFieldset:\n      _jsx(FormContainer, { children:\n        _jsxs(Fieldset, { compact: true, children: [\n          showExpression &&\n          _jsx(Field, {\n            fieldKey: \"expression\",\n            label: t('SQL expression'),\n            control:\n            _jsx(TextAreaControl, {\n              language: \"markdown\",\n              offerEditInModal: false,\n              resize: \"vertical\" }\n            ) }\n\n          ),\n\n          _jsx(Field, {\n            fieldKey: \"verbose_name\",\n            label: t('Label'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"verbose_name\",\n              placeholder: t('Label') }\n            ) }\n\n          ),\n          _jsx(Field, {\n            fieldKey: \"description\",\n            label: t('Description'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"description\",\n              placeholder: t('Description') }\n            ) }\n\n          ),\n          allowEditDataType &&\n          _jsx(Field, {\n            fieldKey: \"type\",\n            label: t('Data type'),\n            control:\n            _jsx(Select, {\n              ariaLabel: t('Data type'),\n              options: DATA_TYPES,\n              name: \"type\",\n              allowNewOptions: true,\n              allowClear: true }\n            ) }\n\n          ),\n\n          isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n          _jsx(Field, {\n            fieldKey: \"advanced_data_type\",\n            label: t('Advanced data type'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"advanced_data_type\",\n              placeholder: t('Advanced Data type') }\n            ) }\n\n          ) :\n\n          _jsx(_Fragment, {}),\n\n          _jsx(Field, {\n            fieldKey: \"python_date_format\",\n            label: t('Datetime format'),\n            description:\n            /* Note the fragmented translations may not work. */\n            _jsxs(\"div\", { children: [\n              t('The pattern of timestamp format. For strings use '),\n              _jsx(\"a\", { href: \"https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior\", children:\n                t('Python datetime string pattern') }\n              ),\n              t(' expression which needs to adhere to the '),\n              _jsx(\"a\", { href: \"https://en.wikipedia.org/wiki/ISO_8601\", children:\n                t('ISO 8601') }\n              ),\n              t(` standard to ensure that the lexicographical ordering\n                      coincides with the chronological ordering. If the\n                      timestamp format does not adhere to the ISO 8601 standard\n                      you will need to define an expression and type for\n                      transforming the string into a date or timestamp. Note\n                      currently time zones are not supported. If time is stored\n                      in epoch format, put \\`epoch_s\\` or \\`epoch_ms\\`. If no pattern\n                      is specified we fall back to using the optional defaults on a per\n                      database/column name level via the extra parameter.`)] }\n            ),\n\n            control:\n            _jsx(TextControl, {\n              controlId: \"python_date_format\",\n              placeholder: \"%Y-%m-%d\" }\n            ) }\n\n          ),\n          _jsx(Field, {\n            fieldKey: \"certified_by\",\n            label: t('Certified By'),\n            description: t('Person or group that has certified this metric'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"certified\",\n              placeholder: t('Certified by') }\n            ) }\n\n          ),\n          _jsx(Field, {\n            fieldKey: \"certification_details\",\n            label: t('Certification details'),\n            description: t('Details of the certification'),\n            control:\n            _jsx(TextControl, {\n              controlId: \"certificationDetails\",\n              placeholder: t('Certification details') }\n            ) }\n\n          )] }\n        ) }\n      ),\n\n      columnLabels:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      {\n        column_name: t('Column'),\n        advanced_data_type: t('Advanced data type'),\n        type: t('Data type'),\n        groupby: t('Is dimension'),\n        is_dttm: t('Is temporal'),\n        main_dttm_col: t('Default datetime'),\n        filterable: t('Is filterable')\n      } :\n      {\n        column_name: t('Column'),\n        type: t('Data type'),\n        groupby: t('Is dimension'),\n        is_dttm: t('Is temporal'),\n        main_dttm_col: t('Default datetime'),\n        filterable: t('Is filterable')\n      },\n\n      onChange: onColumnsChange,\n      itemRenderers:\n      isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ?\n      {\n        column_name: (v, onItemChange, _, record) =>\n        editableColumnName ?\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          _jsx(EditableTitle, {\n            canEdit: true,\n            title: v,\n            onSaveTitle: onItemChange }\n          )] }\n        ) :\n\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          v] }\n        ),\n\n        main_dttm_col: (value, _onItemChange, _label, record) => {\n          const checked = datasource.main_dttm_col === record.column_name;\n          const disabled = !columns.find(\n            (column) => column.column_name === record.column_name\n          ).is_dttm;\n          return (\n            _jsx(Radio, {\n              \"data-test\": `radio-default-dttm-${record.column_name}`,\n              checked: checked,\n              disabled: disabled,\n              onChange: () =>\n              onDatasourceChange({\n                ...datasource,\n                main_dttm_col: record.column_name\n              }) }\n\n            ));\n\n        },\n        type: (d) => d ? _jsx(Label, { children: d }) : null,\n        advanced_data_type: (d) =>\n        _jsx(Label, { onChange: onColumnsChange, children: d }),\n\n        is_dttm: checkboxGenerator,\n        filterable: checkboxGenerator,\n        groupby: checkboxGenerator\n      } :\n      {\n        column_name: (v, onItemChange, _, record) =>\n        editableColumnName ?\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          _jsx(TextControl, { value: v, onChange: onItemChange })] }\n        ) :\n\n        _jsxs(StyledLabelWrapper, { children: [\n          record.is_certified &&\n          _jsx(CertifiedBadge, {\n            certifiedBy: record.certified_by,\n            details: record.certification_details }\n          ),\n\n          v] }\n        ),\n\n        main_dttm_col: (value, _onItemChange, _label, record) => {\n          const checked = datasource.main_dttm_col === record.column_name;\n          const disabled = !columns.find(\n            (column) => column.column_name === record.column_name\n          ).is_dttm;\n          return (\n            _jsx(Radio, {\n              \"data-test\": `radio-default-dttm-${record.column_name}`,\n              checked: checked,\n              disabled: disabled,\n              onChange: () =>\n              onDatasourceChange({\n                ...datasource,\n                main_dttm_col: record.column_name\n              }) }\n\n            ));\n\n        },\n        type: (d) => d ? _jsx(Label, { children: d }) : null,\n        is_dttm: checkboxGenerator,\n        filterable: checkboxGenerator,\n        groupby: checkboxGenerator\n      } }\n\n    ));\n\n}\nColumnCollectionTable.propTypes = {\n  columns: PropTypes.array.isRequired,\n  datasource: PropTypes.object.isRequired,\n  onColumnsChange: PropTypes.func.isRequired,\n  onDatasourceChange: PropTypes.func.isRequired,\n  editableColumnName: PropTypes.bool,\n  showExpression: PropTypes.bool,\n  allowAddItem: PropTypes.bool,\n  allowEditDataType: PropTypes.bool,\n  itemGenerator: PropTypes.func\n};\nColumnCollectionTable.defaultProps = {\n  editableColumnName: false,\n  showExpression: false,\n  allowAddItem: false,\n  allowEditDataType: false,\n  itemGenerator: () => ({\n    column_name: t('<new column>'),\n    filterable: true,\n    groupby: true\n  })\n};\n\nfunction StackedField({ label, formElement }) {\n  return (\n    _jsxs(\"div\", { children: [\n      _jsx(\"div\", { children:\n        _jsx(\"strong\", { children: label }) }\n      ),\n      _jsx(\"div\", { children: formElement })] }\n    ));\n\n}\n\nStackedField.propTypes = {\n  label: PropTypes.string,\n  formElement: PropTypes.node\n};\n\nfunction FormContainer({ children }) {\n  return _jsx(Card, { padded: true, children: children });\n}\n\nFormContainer.propTypes = {\n  children: PropTypes.node\n};\n\nconst propTypes = {\n  datasource: PropTypes.object.isRequired,\n  onChange: PropTypes.func,\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  setIsEditing: PropTypes.func\n};\n\nconst defaultProps = {\n  onChange: () => {},\n  setIsEditing: () => {}\n};\n\nfunction OwnersSelector({ datasource, onChange }) {\n  const loadOptions = useCallback((search = '', page, pageSize) => {\n    const query = rison.encode({ filter: search, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dataset/related/owners?q=${query}`\n    }).then((response) => ({\n      data: response.json.result.\n      filter((item) => item.extra.active).\n      map((item) => ({\n        value: item.value,\n        label: item.text\n      })),\n      totalCount: response.json.count\n    }));\n  }, []);\n\n  return (\n    _jsx(AsyncSelect, {\n      ariaLabel: t('Select owners'),\n      mode: \"multiple\",\n      name: \"owners\",\n      value: datasource.owners,\n      options: loadOptions,\n      onChange: onChange,\n      header: _jsx(FormLabel, { children: t('Owners') }),\n      allowClear: true }\n    ));\n\n}__signature__(OwnersSelector, \"useCallback{loadOptions}\");var _ref2 = process.env.NODE_ENV === \"production\" ? { name: \"hkh81z\", styles: \"margin-top:8px\" } : { name: \"17jm38f-DatasourceEditor\", styles: \"margin-top:8px;label:DatasourceEditor;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFra0M2QiIsImZpbGUiOiIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL0RhdGFzb3VyY2UvRGF0YXNvdXJjZUVkaXRvci5qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgQ2FyZCBmcm9tICdzcmMvY29tcG9uZW50cy9DYXJkJztcbmltcG9ydCBBbGVydCBmcm9tICdzcmMvY29tcG9uZW50cy9BbGVydCc7XG5pbXBvcnQgQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQmFkZ2UnO1xuaW1wb3J0IHsgbmFub2lkIH0gZnJvbSAnbmFub2lkJztcbmltcG9ydCB7XG4gIGNzcyxcbiAgaXNGZWF0dXJlRW5hYmxlZCxcbiAgZ2V0Q3VycmVuY3lTeW1ib2wsXG4gIGVuc3VyZUlzQXJyYXksXG4gIEZlYXR1cmVGbGFnLFxuICBzdHlsZWQsXG4gIFN1cGVyc2V0Q2xpZW50LFxuICB0LFxuICB3aXRoVGhlbWUsXG4gIGdldENsaWVudEVycm9yT2JqZWN0LFxufSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyBTZWxlY3QsIEFzeW5jU2VsZWN0LCBSb3csIENvbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCB7IEZvcm1MYWJlbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IFRhYnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFicyc7XG5pbXBvcnQgQ2VydGlmaWVkQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ2VydGlmaWVkQmFkZ2UnO1xuaW1wb3J0IFdhcm5pbmdJY29uV2l0aFRvb2x0aXAgZnJvbSAnc3JjL2NvbXBvbmVudHMvV2FybmluZ0ljb25XaXRoVG9vbHRpcCc7XG5pbXBvcnQgRGF0YWJhc2VTZWxlY3RvciBmcm9tICdzcmMvY29tcG9uZW50cy9EYXRhYmFzZVNlbGVjdG9yJztcbmltcG9ydCBMYWJlbCBmcm9tICdzcmMvY29tcG9uZW50cy9MYWJlbCc7XG5pbXBvcnQgTG9hZGluZyBmcm9tICdzcmMvY29tcG9uZW50cy9Mb2FkaW5nJztcbmltcG9ydCBUYWJsZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYmxlU2VsZWN0b3InO1xuaW1wb3J0IEVkaXRhYmxlVGl0bGUgZnJvbSAnc3JjL2NvbXBvbmVudHMvRWRpdGFibGVUaXRsZSc7XG5pbXBvcnQgQ2hlY2tib3hDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ2hlY2tib3hDb250cm9sJztcbmltcG9ydCBUZXh0Q29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1RleHRDb250cm9sJztcbmltcG9ydCBUZXh0QXJlYUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9UZXh0QXJlYUNvbnRyb2wnO1xuaW1wb3J0IFNwYXRpYWxDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvU3BhdGlhbENvbnRyb2wnO1xuaW1wb3J0IHdpdGhUb2FzdHMgZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVzc2FnZVRvYXN0cy93aXRoVG9hc3RzJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgQ3VycmVuY3lDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ3VycmVuY3lDb250cm9sJztcbmltcG9ydCBDb2xsZWN0aW9uVGFibGUgZnJvbSAnLi9Db2xsZWN0aW9uVGFibGUnO1xuaW1wb3J0IEZpZWxkc2V0IGZyb20gJy4vRmllbGRzZXQnO1xuaW1wb3J0IEZpZWxkIGZyb20gJy4vRmllbGQnO1xuXG5jb25zdCBEYXRhc291cmNlQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgLmNoYW5nZS13YXJuaW5nIHtcbiAgICBtYXJnaW46IDE2cHggMTBweCAwO1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy53YXJuaW5nLmJhc2V9O1xuICB9XG5cbiAgLmNoYW5nZS13YXJuaW5nIC5ib2xkIHtcbiAgICBmb250LXdlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LndlaWdodHMuYm9sZH07XG4gIH1cblxuICAuZm9ybS1ncm91cC5oYXMtZmVlZGJhY2sgPiAuaGVscC1ibG9jayB7XG4gICAgbWFyZ2luLXRvcDogOHB4O1xuICB9XG5cbiAgLmZvcm0tZ3JvdXAuZm9ybS1ncm91cC1tZCB7XG4gICAgbWFyZ2luLWJvdHRvbTogOHB4O1xuICB9XG5gO1xuXG5jb25zdCBGbGV4Um93Q29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgZGlzcGxheTogZmxleDtcblxuICBzdmcge1xuICAgIG1hcmdpbi1yaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkVGFibGVUYWJzID0gc3R5bGVkKFRhYnMpYFxuICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgLmFudC10YWJzLWNvbnRlbnQtaG9sZGVyIHtcbiAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkQmFkZ2UgPSBzdHlsZWQoQmFkZ2UpYFxuICAuYW50ZDUtYmFkZ2UtY291bnQge1xuICAgIGxpbmUtaGVpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBoZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA0fXB4O1xuICAgIG1hcmdpbi1sZWZ0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBFZGl0TG9ja0NvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGZvbnQtc2l6ZTogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LnNpemVzLnN9cHg7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGEge1xuICAgIHBhZGRpbmc6IDAgMTBweDtcbiAgfVxuYDtcblxuY29uc3QgQ29sdW1uQnV0dG9uV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIHRleHQtYWxpZ246IHJpZ2h0O1xuICAkeyh7IHRoZW1lIH0pID0+IGBtYXJnaW4tYm90dG9tOiAke3RoZW1lLmdyaWRVbml0ICogMn1weGB9XG5gO1xuXG5jb25zdCBTdHlsZWRMYWJlbFdyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBzcGFuIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZENvbHVtbnNUYWJXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgLnRhYmxlID4gdGJvZHkgPiB0ciA+IHRkIHtcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICB9XG5cbiAgLmFudC10YWcge1xuICAgIG1hcmdpbi10b3A6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZEJ1dHRvbldyYXBwZXIgPSBzdHlsZWQuc3BhbmBcbiAgJHsoeyB0aGVtZSB9KSA9PiBgXG4gICAgbWFyZ2luLXRvcDogJHt0aGVtZS5ncmlkVW5pdCAqIDN9cHg7XG4gICAgbWFyZ2luLWxlZnQ6ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4O1xuICBgfVxuYDtcblxuY29uc3QgY2hlY2tib3hHZW5lcmF0b3IgPSAoZCwgb25DaGFuZ2UpID0+IChcbiAgPENoZWNrYm94Q29udHJvbCB2YWx1ZT17ZH0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuKTtcbmNvbnN0IERBVEFfVFlQRVMgPSBbXG4gIHsgdmFsdWU6ICdTVFJJTkcnLCBsYWJlbDogdCgnU1RSSU5HJykgfSxcbiAgeyB2YWx1ZTogJ05VTUVSSUMnLCBsYWJlbDogdCgnTlVNRVJJQycpIH0sXG4gIHsgdmFsdWU6ICdEQVRFVElNRScsIGxhYmVsOiB0KCdEQVRFVElNRScpIH0sXG4gIHsgdmFsdWU6ICdCT09MRUFOJywgbGFiZWw6IHQoJ0JPT0xFQU4nKSB9LFxuXTtcblxuY29uc3QgREFUQVNPVVJDRV9UWVBFU19BUlIgPSBbXG4gIHsga2V5OiAncGh5c2ljYWwnLCBsYWJlbDogdCgnUGh5c2ljYWwgKHRhYmxlIG9yIHZpZXcpJykgfSxcbiAgeyBrZXk6ICd2aXJ0dWFsJywgbGFiZWw6IHQoJ1ZpcnR1YWwgKFNRTCknKSB9LFxuXTtcbmNvbnN0IERBVEFTT1VSQ0VfVFlQRVMgPSB7fTtcbkRBVEFTT1VSQ0VfVFlQRVNfQVJSLmZvckVhY2gobyA9PiB7XG4gIERBVEFTT1VSQ0VfVFlQRVNbby5rZXldID0gbztcbn0pO1xuXG5mdW5jdGlvbiBDb2xsZWN0aW9uVGFiVGl0bGUoeyB0aXRsZSwgY29sbGVjdGlvbiB9KSB7XG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY3NzPXt7IGRpc3BsYXk6ICdmbGV4JywgYWxpZ25JdGVtczogJ2NlbnRlcicgfX1cbiAgICAgIGRhdGEtdGVzdD17YGNvbGxlY3Rpb24tdGFiLSR7dGl0bGV9YH1cbiAgICA+XG4gICAgICB7dGl0bGV9eycgJ31cbiAgICAgIDxTdHlsZWRCYWRnZSBjb3VudD17Y29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMH0gc2hvd1plcm8gLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuQ29sbGVjdGlvblRhYlRpdGxlLnByb3BUeXBlcyA9IHtcbiAgdGl0bGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGNvbGxlY3Rpb246IFByb3BUeXBlcy5hcnJheSxcbn07XG5cbmZ1bmN0aW9uIENvbHVtbkNvbGxlY3Rpb25UYWJsZSh7XG4gIGNvbHVtbnMsXG4gIGRhdGFzb3VyY2UsXG4gIG9uQ29sdW1uc0NoYW5nZSxcbiAgb25EYXRhc291cmNlQ2hhbmdlLFxuICBlZGl0YWJsZUNvbHVtbk5hbWUsXG4gIHNob3dFeHByZXNzaW9uLFxuICBhbGxvd0FkZEl0ZW0sXG4gIGFsbG93RWRpdERhdGFUeXBlLFxuICBpdGVtR2VuZXJhdG9yLFxuICBjb2x1bW5MYWJlbFRvb2x0aXBzLFxufSkge1xuICByZXR1cm4gKFxuICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgIHRhYmxlQ29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBzb3J0Q29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgIGFsbG93QWRkSXRlbT17YWxsb3dBZGRJdGVtfVxuICAgICAgaXRlbUdlbmVyYXRvcj17aXRlbUdlbmVyYXRvcn1cbiAgICAgIGNvbGxlY3Rpb249e2NvbHVtbnN9XG4gICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXtjb2x1bW5MYWJlbFRvb2x0aXBzfVxuICAgICAgc3RpY2t5SGVhZGVyXG4gICAgICBleHBhbmRGaWVsZHNldD17XG4gICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgIDxGaWVsZHNldCBjb21wYWN0PlxuICAgICAgICAgICAge3Nob3dFeHByZXNzaW9uICYmIChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJleHByZXNzaW9uXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMIGV4cHJlc3Npb24nKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJtYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnTGFiZWwnKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0xhYmVsJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHthbGxvd0VkaXREYXRhVHlwZSAmJiAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidHlwZVwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICBhcmlhTGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zPXtEQVRBX1RZUEVTfVxuICAgICAgICAgICAgICAgICAgICBuYW1lPVwidHlwZVwiXG4gICAgICAgICAgICAgICAgICAgIGFsbG93TmV3T3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICBhbGxvd0NsZWFyXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcykgPyAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQWR2YW5jZWQgZGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0FkdmFuY2VkIERhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8PjwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cInB5dGhvbl9kYXRlX2Zvcm1hdFwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdEYXRldGltZSBmb3JtYXQnKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e1xuICAgICAgICAgICAgICAgIC8qIE5vdGUgdGhlIGZyYWdtZW50ZWQgdHJhbnNsYXRpb25zIG1heSBub3Qgd29yay4gKi9cbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAge3QoJ1RoZSBwYXR0ZXJuIG9mIHRpbWVzdGFtcCBmb3JtYXQuIEZvciBzdHJpbmdzIHVzZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2RvY3MucHl0aG9uLm9yZy8yL2xpYnJhcnkvZGF0ZXRpbWUuaHRtbCNzdHJmdGltZS1zdHJwdGltZS1iZWhhdmlvclwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnUHl0aG9uIGRhdGV0aW1lIHN0cmluZyBwYXR0ZXJuJyl9XG4gICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICB7dCgnIGV4cHJlc3Npb24gd2hpY2ggbmVlZHMgdG8gYWRoZXJlIHRvIHRoZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9JU09fODYwMVwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnSVNPIDg2MDEnKX1cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgIHt0KGAgc3RhbmRhcmQgdG8gZW5zdXJlIHRoYXQgdGhlIGxleGljb2dyYXBoaWNhbCBvcmRlcmluZ1xuICAgICAgICAgICAgICAgICAgICAgIGNvaW5jaWRlcyB3aXRoIHRoZSBjaHJvbm9sb2dpY2FsIG9yZGVyaW5nLiBJZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgZm9ybWF0IGRvZXMgbm90IGFkaGVyZSB0byB0aGUgSVNPIDg2MDEgc3RhbmRhcmRcbiAgICAgICAgICAgICAgICAgICAgICB5b3Ugd2lsbCBuZWVkIHRvIGRlZmluZSBhbiBleHByZXNzaW9uIGFuZCB0eXBlIGZvclxuICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWluZyB0aGUgc3RyaW5nIGludG8gYSBkYXRlIG9yIHRpbWVzdGFtcC4gTm90ZVxuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseSB0aW1lIHpvbmVzIGFyZSBub3Qgc3VwcG9ydGVkLiBJZiB0aW1lIGlzIHN0b3JlZFxuICAgICAgICAgICAgICAgICAgICAgIGluIGVwb2NoIGZvcm1hdCwgcHV0IFxcYGVwb2NoX3NcXGAgb3IgXFxgZXBvY2hfbXNcXGAuIElmIG5vIHBhdHRlcm5cbiAgICAgICAgICAgICAgICAgICAgICBpcyBzcGVjaWZpZWQgd2UgZmFsbCBiYWNrIHRvIHVzaW5nIHRoZSBvcHRpb25hbCBkZWZhdWx0cyBvbiBhIHBlclxuICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlL2NvbHVtbiBuYW1lIGxldmVsIHZpYSB0aGUgZXh0cmEgcGFyYW1ldGVyLmApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwicHl0aG9uX2RhdGVfZm9ybWF0XCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiJVktJW0tJWRcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWVkIEJ5Jyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWVkXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25EZXRhaWxzXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICAgIDwvRm9ybUNvbnRhaW5lcj5cbiAgICAgIH1cbiAgICAgIGNvbHVtbkxhYmVscz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCdDb2x1bW4nKSxcbiAgICAgICAgICAgICAgYWR2YW5jZWRfZGF0YV90eXBlOiB0KCdBZHZhbmNlZCBkYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgdHlwZTogdCgnRGF0YSB0eXBlJyksXG4gICAgICAgICAgICAgIGdyb3VwYnk6IHQoJ0lzIGRpbWVuc2lvbicpLFxuICAgICAgICAgICAgICBpc19kdHRtOiB0KCdJcyB0ZW1wb3JhbCcpLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiB0KCdEZWZhdWx0IGRhdGV0aW1lJyksXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IHQoJ0lzIGZpbHRlcmFibGUnKSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJ0NvbHVtbicpLFxuICAgICAgICAgICAgICB0eXBlOiB0KCdEYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgZ3JvdXBieTogdCgnSXMgZGltZW5zaW9uJyksXG4gICAgICAgICAgICAgIGlzX2R0dG06IHQoJ0lzIHRlbXBvcmFsJyksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHQoJ0RlZmF1bHQgZGF0ZXRpbWUnKSxcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdCgnSXMgZmlsdGVyYWJsZScpLFxuICAgICAgICAgICAgfVxuICAgICAgfVxuICAgICAgb25DaGFuZ2U9e29uQ29sdW1uc0NoYW5nZX1cbiAgICAgIGl0ZW1SZW5kZXJlcnM9e1xuICAgICAgICBpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKVxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZVxuICAgICAgICAgICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17dn1cbiAgICAgICAgICAgICAgICAgICAgICBvblNhdmVUaXRsZT17b25JdGVtQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dn1cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6ICh2YWx1ZSwgX29uSXRlbUNoYW5nZSwgX2xhYmVsLCByZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGVja2VkID0gZGF0YXNvdXJjZS5tYWluX2R0dG1fY29sID09PSByZWNvcmQuY29sdW1uX25hbWU7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlzYWJsZWQgPSAhY29sdW1ucy5maW5kKFxuICAgICAgICAgICAgICAgICAgY29sdW1uID0+IGNvbHVtbi5jb2x1bW5fbmFtZSA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICkuaXNfZHR0bTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD17YHJhZGlvLWRlZmF1bHQtZHR0bS0ke3JlY29yZC5jb2x1bW5fbmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtjaGVja2VkfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdHlwZTogZCA9PiAoZCA/IDxMYWJlbD57ZH08L0xhYmVsPiA6IG51bGwpLFxuICAgICAgICAgICAgICBhZHZhbmNlZF9kYXRhX3R5cGU6IGQgPT4gKFxuICAgICAgICAgICAgICAgIDxMYWJlbCBvbkNoYW5nZT17b25Db2x1bW5zQ2hhbmdlfT57ZH08L0xhYmVsPlxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBpc19kdHRtOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGdyb3VwYnk6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDoge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkl0ZW1DaGFuZ2V9IC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt2fVxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogKHZhbHVlLCBfb25JdGVtQ2hhbmdlLCBfbGFiZWwsIHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSBkYXRhc291cmNlLm1haW5fZHR0bV9jb2wgPT09IHJlY29yZC5jb2x1bW5fbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFjb2x1bW5zLmZpbmQoXG4gICAgICAgICAgICAgICAgICBjb2x1bW4gPT4gY29sdW1uLmNvbHVtbl9uYW1lID09PSByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgKS5pc19kdHRtO1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PXtgcmFkaW8tZGVmYXVsdC1kdHRtLSR7cmVjb3JkLmNvbHVtbl9uYW1lfWB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NoZWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+XG4gICAgICAgICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0eXBlOiBkID0+IChkID8gPExhYmVsPntkfTwvTGFiZWw+IDogbnVsbCksXG4gICAgICAgICAgICAgIGlzX2R0dG06IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZ3JvdXBieTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICB9XG4gICAgICB9XG4gICAgLz5cbiAgKTtcbn1cbkNvbHVtbkNvbGxlY3Rpb25UYWJsZS5wcm9wVHlwZXMgPSB7XG4gIGNvbHVtbnM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ29sdW1uc0NoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25EYXRhc291cmNlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBlZGl0YWJsZUNvbHVtbk5hbWU6IFByb3BUeXBlcy5ib29sLFxuICBzaG93RXhwcmVzc2lvbjogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93QWRkSXRlbTogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93RWRpdERhdGFUeXBlOiBQcm9wVHlwZXMuYm9vbCxcbiAgaXRlbUdlbmVyYXRvcjogUHJvcFR5cGVzLmZ1bmMsXG59O1xuQ29sdW1uQ29sbGVjdGlvblRhYmxlLmRlZmF1bHRQcm9wcyA9IHtcbiAgZWRpdGFibGVDb2x1bW5OYW1lOiBmYWxzZSxcbiAgc2hvd0V4cHJlc3Npb246IGZhbHNlLFxuICBhbGxvd0FkZEl0ZW06IGZhbHNlLFxuICBhbGxvd0VkaXREYXRhVHlwZTogZmFsc2UsXG4gIGl0ZW1HZW5lcmF0b3I6ICgpID0+ICh7XG4gICAgY29sdW1uX25hbWU6IHQoJzxuZXcgY29sdW1uPicpLFxuICAgIGZpbHRlcmFibGU6IHRydWUsXG4gICAgZ3JvdXBieTogdHJ1ZSxcbiAgfSksXG59O1xuXG5mdW5jdGlvbiBTdGFja2VkRmllbGQoeyBsYWJlbCwgZm9ybUVsZW1lbnQgfSkge1xuICByZXR1cm4gKFxuICAgIDxkaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICA8c3Ryb25nPntsYWJlbH08L3N0cm9uZz5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj57Zm9ybUVsZW1lbnR9PC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cblN0YWNrZWRGaWVsZC5wcm9wVHlwZXMgPSB7XG4gIGxhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBmb3JtRWxlbWVudDogUHJvcFR5cGVzLm5vZGUsXG59O1xuXG5mdW5jdGlvbiBGb3JtQ29udGFpbmVyKHsgY2hpbGRyZW4gfSkge1xuICByZXR1cm4gPENhcmQgcGFkZGVkPntjaGlsZHJlbn08L0NhcmQ+O1xufVxuXG5Gb3JtQ29udGFpbmVyLnByb3BUeXBlcyA9IHtcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5ub2RlLFxufTtcblxuY29uc3QgcHJvcFR5cGVzID0ge1xuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgYWRkU3VjY2Vzc1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBhZGREYW5nZXJUb2FzdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2V0SXNFZGl0aW5nOiBQcm9wVHlwZXMuZnVuYyxcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgb25DaGFuZ2U6ICgpID0+IHt9LFxuICBzZXRJc0VkaXRpbmc6ICgpID0+IHt9LFxufTtcblxuZnVuY3Rpb24gT3duZXJzU2VsZWN0b3IoeyBkYXRhc291cmNlLCBvbkNoYW5nZSB9KSB7XG4gIGNvbnN0IGxvYWRPcHRpb25zID0gdXNlQ2FsbGJhY2soKHNlYXJjaCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gcmlzb24uZW5jb2RlKHsgZmlsdGVyOiBzZWFyY2gsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgcmV0dXJuIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGF0YXNldC9yZWxhdGVkL293bmVycz9xPSR7cXVlcnl9YCxcbiAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdFxuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5leHRyYS5hY3RpdmUpXG4gICAgICAgIC5tYXAoaXRlbSA9PiAoe1xuICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgIH0pKSxcbiAgICAgIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQsXG4gICAgfSkpO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8QXN5bmNTZWxlY3RcbiAgICAgIGFyaWFMYWJlbD17dCgnU2VsZWN0IG93bmVycycpfVxuICAgICAgbW9kZT1cIm11bHRpcGxlXCJcbiAgICAgIG5hbWU9XCJvd25lcnNcIlxuICAgICAgdmFsdWU9e2RhdGFzb3VyY2Uub3duZXJzfVxuICAgICAgb3B0aW9ucz17bG9hZE9wdGlvbnN9XG4gICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICBoZWFkZXI9ezxGb3JtTGFiZWw+e3QoJ093bmVycycpfTwvRm9ybUxhYmVsPn1cbiAgICAgIGFsbG93Q2xlYXJcbiAgICAvPlxuICApO1xufVxuXG5jbGFzcyBEYXRhc291cmNlRWRpdG9yIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBkYXRhc291cmNlOiB7XG4gICAgICAgIC4uLnByb3BzLmRhdGFzb3VyY2UsXG4gICAgICAgIG93bmVyczogcHJvcHMuZGF0YXNvdXJjZS5vd25lcnMubWFwKG93bmVyID0+ICh7XG4gICAgICAgICAgdmFsdWU6IG93bmVyLnZhbHVlIHx8IG93bmVyLmlkLFxuICAgICAgICAgIGxhYmVsOiBvd25lci5sYWJlbCB8fCBgJHtvd25lci5maXJzdF9uYW1lfSAke293bmVyLmxhc3RfbmFtZX1gLFxuICAgICAgICB9KSksXG4gICAgICAgIG1ldHJpY3M6IHByb3BzLmRhdGFzb3VyY2UubWV0cmljcz8ubWFwKG1ldHJpYyA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWNhdGlvbkRldGFpbHMsXG4gICAgICAgICAgfSA9IG1ldHJpYztcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uOiB7IGRldGFpbHMsIGNlcnRpZmllZF9ieTogY2VydGlmaWVkQnkgfSA9IHt9LFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duLFxuICAgICAgICAgIH0gPSBKU09OLnBhcnNlKG1ldHJpYy5leHRyYSB8fCAne30nKSB8fCB7fTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4ubWV0cmljLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpY2F0aW9uRGV0YWlscyB8fCBkZXRhaWxzLFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duIHx8ICcnLFxuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeSB8fCBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgaXNTcWxhOlxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLmRhdGFzb3VyY2VfdHlwZSA9PT0gJ3RhYmxlJyB8fFxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLnR5cGUgPT09ICd0YWJsZScsXG4gICAgICBpc0VkaXRNb2RlOiBmYWxzZSxcbiAgICAgIGRhdGFiYXNlQ29sdW1uczogcHJvcHMuZGF0YXNvdXJjZS5jb2x1bW5zLmZpbHRlcihjb2wgPT4gIWNvbC5leHByZXNzaW9uKSxcbiAgICAgIGNhbGN1bGF0ZWRDb2x1bW5zOiBwcm9wcy5kYXRhc291cmNlLmNvbHVtbnMuZmlsdGVyKFxuICAgICAgICBjb2wgPT4gISFjb2wuZXhwcmVzc2lvbixcbiAgICAgICksXG4gICAgICBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlLFxuICAgICAgYWN0aXZlVGFiS2V5OiAwLFxuICAgICAgZGF0YXNvdXJjZVR5cGU6IHByb3BzLmRhdGFzb3VyY2Uuc3FsXG4gICAgICAgID8gREFUQVNPVVJDRV9UWVBFUy52aXJ0dWFsLmtleVxuICAgICAgICA6IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5LFxuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25DaGFuZ2VFZGl0TW9kZSA9IHRoaXMub25DaGFuZ2VFZGl0TW9kZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSA9IHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlQ2hhbmdlID0gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhID1cbiAgICAgIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEuYmluZCh0aGlzKTtcbiAgICB0aGlzLnN5bmNNZXRhZGF0YSA9IHRoaXMuc3luY01ldGFkYXRhLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZXRDb2x1bW5zID0gdGhpcy5zZXRDb2x1bW5zLmJpbmQodGhpcyk7XG4gICAgdGhpcy52YWxpZGF0ZUFuZENoYW5nZSA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZVRhYlNlbGVjdCA9IHRoaXMuaGFuZGxlVGFiU2VsZWN0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5jdXJyZW5jaWVzID0gZW5zdXJlSXNBcnJheShwcm9wcy5jdXJyZW5jaWVzKS5tYXAoY3VycmVuY3lDb2RlID0+ICh7XG4gICAgICB2YWx1ZTogY3VycmVuY3lDb2RlLFxuICAgICAgbGFiZWw6IGAke2dldEN1cnJlbmN5U3ltYm9sKHtcbiAgICAgICAgc3ltYm9sOiBjdXJyZW5jeUNvZGUsXG4gICAgICB9KX0gKCR7Y3VycmVuY3lDb2RlfSlgLFxuICAgIH0pKTtcbiAgfVxuXG4gIG9uQ2hhbmdlKCkge1xuICAgIC8vIEVtcHR5aW5nIFNRTCBpZiBcIlBoeXNpY2FsXCIgcmFkaW8gYnV0dG9uIGlzIHNlbGVjdGVkXG4gICAgLy8gQ3VycmVudGx5IHRoZSBsb2dpYyB0byBrbm93IHdoZXRoZXIgdGhlIHNvdXJjZSBpc1xuICAgIC8vIHBoeXNpY2FsIG9yIHZpcnR1YWwgaXMgYmFzZWQgb24gd2hldGhlciBTUUwgaXMgZW1wdHkgb3Igbm90LlxuICAgIGNvbnN0IHsgZGF0YXNvdXJjZVR5cGUsIGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qgc3FsID1cbiAgICAgIGRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSA/ICcnIDogZGF0YXNvdXJjZS5zcWw7XG4gICAgY29uc3QgbmV3RGF0YXNvdXJjZSA9IHtcbiAgICAgIC4uLnRoaXMuc3RhdGUuZGF0YXNvdXJjZSxcbiAgICAgIHNxbCxcbiAgICAgIGNvbHVtbnM6IFsuLi50aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1ucywgLi4udGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc10sXG4gICAgfTtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKG5ld0RhdGFzb3VyY2UsIHRoaXMuc3RhdGUuZXJyb3JzKTtcbiAgfVxuXG4gIG9uQ2hhbmdlRWRpdE1vZGUoKSB7XG4gICAgdGhpcy5wcm9wcy5zZXRJc0VkaXRpbmcoIXRoaXMuc3RhdGUuaXNFZGl0TW9kZSk7XG4gICAgdGhpcy5zZXRTdGF0ZShwcmV2U3RhdGUgPT4gKHsgaXNFZGl0TW9kZTogIXByZXZTdGF0ZS5pc0VkaXRNb2RlIH0pKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCBjYWxsYmFjayA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGF0YXNvdXJjZSB9LCBjYWxsYmFjayk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKGF0dHIsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjsgLy8gaWYgdmFsdWUgaXMgdW5kZWZpbmVkIGRvIG5vdCB1cGRhdGUgc3RhdGVcbiAgICBjb25zdCBkYXRhc291cmNlID0geyAuLi50aGlzLnN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfTtcbiAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgcHJldlN0YXRlID0+ICh7XG4gICAgICAgIGRhdGFzb3VyY2U6IHsgLi4ucHJldlN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfSxcbiAgICAgIH0pLFxuICAgICAgYXR0ciA9PT0gJ3RhYmxlX25hbWUnXG4gICAgICAgID8gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UoZGF0YXNvdXJjZSwgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSlcbiAgICAgICAgOiB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKSxcbiAgICApO1xuICB9XG5cbiAgb25EYXRhc291cmNlVHlwZUNoYW5nZShkYXRhc291cmNlVHlwZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhc291cmNlVHlwZSB9KTtcbiAgfVxuXG4gIHNldENvbHVtbnMob2JqKSB7XG4gICAgLy8gdXBkYXRlIGNhbGN1bGF0ZWRDb2x1bW5zIG9yIGRhdGFiYXNlQ29sdW1uc1xuICAgIHRoaXMuc2V0U3RhdGUob2JqLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKTtcbiAgfVxuXG4gIHZhbGlkYXRlQW5kQ2hhbmdlKCkge1xuICAgIHRoaXMudmFsaWRhdGUodGhpcy5vbkNoYW5nZSk7XG4gIH1cblxuICB0YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSgpIHtcbiAgICB0aGlzLnZhbGlkYXRlKCgpID0+IHtcbiAgICAgIHRoaXMuc3luY01ldGFkYXRhKCk7XG4gICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVDb2x1bW5zKGNvbHMpIHtcbiAgICAvLyBjb2xzOiBBcnJheTx7Y29sdW1uX25hbWU6IHN0cmluZzsgaXNfZHR0bTogYm9vbGVhbjsgdHlwZTogc3RyaW5nO30+XG4gICAgY29uc3QgeyBkYXRhYmFzZUNvbHVtbnMgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgZGF0YWJhc2VDb2x1bW5OYW1lcyA9IGNvbHMubWFwKGNvbCA9PiBjb2wuY29sdW1uX25hbWUpO1xuICAgIGNvbnN0IGN1cnJlbnRDb2xzID0gZGF0YWJhc2VDb2x1bW5zLnJlZHVjZShcbiAgICAgIChhZ2csIGNvbCkgPT4gKHtcbiAgICAgICAgLi4uYWdnLFxuICAgICAgICBbY29sLmNvbHVtbl9uYW1lXTogY29sLFxuICAgICAgfSksXG4gICAgICB7fSxcbiAgICApO1xuICAgIGNvbnN0IGZpbmFsQ29sdW1ucyA9IFtdO1xuICAgIGNvbnN0IHJlc3VsdHMgPSB7XG4gICAgICBhZGRlZDogW10sXG4gICAgICBtb2RpZmllZDogW10sXG4gICAgICByZW1vdmVkOiBkYXRhYmFzZUNvbHVtbnNcbiAgICAgICAgLm1hcChjb2wgPT4gY29sLmNvbHVtbl9uYW1lKVxuICAgICAgICAuZmlsdGVyKGNvbCA9PiAhZGF0YWJhc2VDb2x1bW5OYW1lcy5pbmNsdWRlcyhjb2wpKSxcbiAgICB9O1xuICAgIGNvbHMuZm9yRWFjaChjb2wgPT4ge1xuICAgICAgY29uc3QgY3VycmVudENvbCA9IGN1cnJlbnRDb2xzW2NvbC5jb2x1bW5fbmFtZV07XG4gICAgICBpZiAoIWN1cnJlbnRDb2wpIHtcbiAgICAgICAgLy8gbmV3IGNvbHVtblxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaCh7XG4gICAgICAgICAgaWQ6IG5hbm9pZCgpLFxuICAgICAgICAgIGNvbHVtbl9uYW1lOiBjb2wuY29sdW1uX25hbWUsXG4gICAgICAgICAgdHlwZTogY29sLnR5cGUsXG4gICAgICAgICAgZ3JvdXBieTogdHJ1ZSxcbiAgICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgICAgICAgIGlzX2R0dG06IGNvbC5pc19kdHRtLFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0cy5hZGRlZC5wdXNoKGNvbC5jb2x1bW5fbmFtZSk7XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICBjdXJyZW50Q29sLnR5cGUgIT09IGNvbC50eXBlIHx8XG4gICAgICAgICghY3VycmVudENvbC5pc19kdHRtICYmIGNvbC5pc19kdHRtKVxuICAgICAgKSB7XG4gICAgICAgIC8vIG1vZGlmaWVkIGNvbHVtblxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaCh7XG4gICAgICAgICAgLi4uY3VycmVudENvbCxcbiAgICAgICAgICB0eXBlOiBjb2wudHlwZSxcbiAgICAgICAgICBpc19kdHRtOiBjdXJyZW50Q29sLmlzX2R0dG0gfHwgY29sLmlzX2R0dG0sXG4gICAgICAgIH0pO1xuICAgICAgICByZXN1bHRzLm1vZGlmaWVkLnB1c2goY29sLmNvbHVtbl9uYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHVuY2hhbmdlZFxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaChjdXJyZW50Q29sKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoXG4gICAgICByZXN1bHRzLmFkZGVkLmxlbmd0aCB8fFxuICAgICAgcmVzdWx0cy5tb2RpZmllZC5sZW5ndGggfHxcbiAgICAgIHJlc3VsdHMucmVtb3ZlZC5sZW5ndGhcbiAgICApIHtcbiAgICAgIHRoaXMuc2V0Q29sdW1ucyh7IGRhdGFiYXNlQ29sdW1uczogZmluYWxDb2x1bW5zIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxuXG4gIHN5bmNNZXRhZGF0YSgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgZGF0YXNvdXJjZV90eXBlOiBkYXRhc291cmNlLnR5cGUgfHwgZGF0YXNvdXJjZS5kYXRhc291cmNlX3R5cGUsXG4gICAgICBkYXRhYmFzZV9uYW1lOlxuICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlLmRhdGFiYXNlX25hbWUgfHwgZGF0YXNvdXJjZS5kYXRhYmFzZS5uYW1lLFxuICAgICAgY2F0YWxvZ19uYW1lOiBkYXRhc291cmNlLmNhdGFsb2csXG4gICAgICBzY2hlbWFfbmFtZTogZGF0YXNvdXJjZS5zY2hlbWEsXG4gICAgICB0YWJsZV9uYW1lOiBkYXRhc291cmNlLnRhYmxlX25hbWUsXG4gICAgICBub3JtYWxpemVfY29sdW1uczogZGF0YXNvdXJjZS5ub3JtYWxpemVfY29sdW1ucyxcbiAgICAgIGFsd2F5c19maWx0ZXJfbWFpbl9kdHRtOiBkYXRhc291cmNlLmFsd2F5c19maWx0ZXJfbWFpbl9kdHRtLFxuICAgIH07XG4gICAgT2JqZWN0LmVudHJpZXMocGFyYW1zKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIC8vIHJpc29uIGNhbid0IGVuY29kZSB0aGUgdW5kZWZpbmVkIHZhbHVlXG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwYXJhbXNba2V5XSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgZW5kcG9pbnQgPSBgL2RhdGFzb3VyY2UvZXh0ZXJuYWxfbWV0YWRhdGFfYnlfbmFtZS8/cT0ke3Jpc29uLmVuY29kZV91cmkoXG4gICAgICBwYXJhbXMsXG4gICAgKX1gO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IHRydWUgfSk7XG5cbiAgICBTdXBlcnNldENsaWVudC5nZXQoeyBlbmRwb2ludCB9KVxuICAgICAgLnRoZW4oKHsganNvbiB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLnVwZGF0ZUNvbHVtbnMoanNvbik7XG4gICAgICAgIGlmIChyZXN1bHRzLm1vZGlmaWVkLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0KFxuICAgICAgICAgICAgdCgnTW9kaWZpZWQgY29sdW1uczogJXMnLCByZXN1bHRzLm1vZGlmaWVkLmpvaW4oJywgJykpLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdHMucmVtb3ZlZC5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdChcbiAgICAgICAgICAgIHQoJ1JlbW92ZWQgY29sdW1uczogJXMnLCByZXN1bHRzLnJlbW92ZWQuam9pbignLCAnKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0cy5hZGRlZC5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdChcbiAgICAgICAgICAgIHQoJ05ldyBjb2x1bW5zIGFkZGVkOiAlcycsIHJlc3VsdHMuYWRkZWQuam9pbignLCAnKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdCh0KCdNZXRhZGF0YSBoYXMgYmVlbiBzeW5jZWQnKSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlIH0pO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChyZXNwb25zZSA9PlxuICAgICAgICBnZXRDbGllbnRFcnJvck9iamVjdChyZXNwb25zZSkudGhlbigoeyBlcnJvciwgc3RhdHVzVGV4dCB9KSA9PiB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdChcbiAgICAgICAgICAgIGVycm9yIHx8IHN0YXR1c1RleHQgfHwgdCgnQW4gZXJyb3IgaGFzIG9jY3VycmVkJyksXG4gICAgICAgICAgKTtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgbWV0YWRhdGFMb2FkaW5nOiBmYWxzZSB9KTtcbiAgICAgICAgfSksXG4gICAgICApO1xuICB9XG5cbiAgZmluZER1cGxpY2F0ZXMoYXJyLCBhY2Nlc3Nvcikge1xuICAgIGNvbnN0IHNlZW4gPSB7fTtcbiAgICBjb25zdCBkdXBzID0gW107XG4gICAgYXJyLmZvckVhY2gob2JqID0+IHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBhY2Nlc3NvcihvYmopO1xuICAgICAgaWYgKGl0ZW0gaW4gc2Vlbikge1xuICAgICAgICBkdXBzLnB1c2goaXRlbSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWVuW2l0ZW1dID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZHVwcztcbiAgfVxuXG4gIHZhbGlkYXRlKGNhbGxiYWNrKSB7XG4gICAgbGV0IGVycm9ycyA9IFtdO1xuICAgIGxldCBkdXBzO1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIC8vIExvb2tpbmcgZm9yIGR1cGxpY2F0ZSBjb2x1bW5fbmFtZVxuICAgIGR1cHMgPSB0aGlzLmZpbmREdXBsaWNhdGVzKGRhdGFzb3VyY2UuY29sdW1ucywgb2JqID0+IG9iai5jb2x1bW5fbmFtZSk7XG4gICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChcbiAgICAgIGR1cHMubWFwKG5hbWUgPT4gdCgnQ29sdW1uIG5hbWUgWyVzXSBpcyBkdXBsaWNhdGVkJywgbmFtZSkpLFxuICAgICk7XG5cbiAgICAvLyBMb29raW5nIGZvciBkdXBsaWNhdGUgbWV0cmljX25hbWVcbiAgICBkdXBzID0gdGhpcy5maW5kRHVwbGljYXRlcyhkYXRhc291cmNlLm1ldHJpY3MsIG9iaiA9PiBvYmoubWV0cmljX25hbWUpO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBkdXBzLm1hcChuYW1lID0+IHQoJ01ldHJpYyBuYW1lIFslc10gaXMgZHVwbGljYXRlZCcsIG5hbWUpKSxcbiAgICApO1xuXG4gICAgLy8gTWFraW5nIHN1cmUgY2FsY3VsYXRlZENvbHVtbnMgaGF2ZSBhbiBleHByZXNzaW9uIGRlZmluZWRcbiAgICBjb25zdCBub0ZpbHRlckNhbGNDb2xzID0gdGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1ucy5maWx0ZXIoXG4gICAgICBjb2wgPT4gIWNvbC5leHByZXNzaW9uICYmICFjb2wuanNvbixcbiAgICApO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBub0ZpbHRlckNhbGNDb2xzLm1hcChjb2wgPT5cbiAgICAgICAgdCgnQ2FsY3VsYXRlZCBjb2x1bW4gWyVzXSByZXF1aXJlcyBhbiBleHByZXNzaW9uJywgY29sLmNvbHVtbl9uYW1lKSxcbiAgICAgICksXG4gICAgKTtcblxuICAgIC8vIHZhbGlkYXRlIGN1cnJlbmN5IGNvZGVcbiAgICB0cnkge1xuICAgICAgdGhpcy5zdGF0ZS5kYXRhc291cmNlLm1ldHJpY3M/LmZvckVhY2goXG4gICAgICAgIG1ldHJpYyA9PlxuICAgICAgICAgIG1ldHJpYy5jdXJyZW5jeT8uc3ltYm9sICYmXG4gICAgICAgICAgbmV3IEludGwuTnVtYmVyRm9ybWF0KCdlbi1VUycsIHtcbiAgICAgICAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgICAgICAgY3VycmVuY3k6IG1ldHJpYy5jdXJyZW5jeS5zeW1ib2wsXG4gICAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0gY2F0Y2gge1xuICAgICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChbdCgnSW52YWxpZCBjdXJyZW5jeSBjb2RlIGluIHNhdmVkIG1ldHJpY3MnKV0pO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoeyBlcnJvcnMgfSwgY2FsbGJhY2spO1xuICB9XG5cbiAgaGFuZGxlVGFiU2VsZWN0KGFjdGl2ZVRhYktleSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBhY3RpdmVUYWJLZXkgfSk7XG4gIH1cblxuICBzb3J0TWV0cmljcyhtZXRyaWNzKSB7XG4gICAgcmV0dXJuIG1ldHJpY3Muc29ydCgoeyBpZDogYSB9LCB7IGlkOiBiIH0pID0+IGIgLSBhKTtcbiAgfVxuXG4gIHJlbmRlclNldHRpbmdzRmllbGRzZXQoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8RmllbGRzZXRcbiAgICAgICAgdGl0bGU9e3QoJ0Jhc2ljJyl9XG4gICAgICAgIGl0ZW09e2RhdGFzb3VyY2V9XG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX1cbiAgICAgID5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgZmllbGRLZXk9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwibWFya2Rvd25cIlxuICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiZGVmYXVsdF9lbmRwb2ludFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0RlZmF1bHQgVVJMJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnRGVmYXVsdCBVUkwgdG8gcmVkaXJlY3QgdG8gd2hlbiBhY2Nlc3NpbmcgZnJvbSB0aGUgZGF0YXNldCBsaXN0IHBhZ2UnLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImRlZmF1bHRfZW5kcG9pbnRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJmaWx0ZXJfc2VsZWN0X2VuYWJsZWRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgZmlsdGVycycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdXaGV0aGVyIHRvIHBvcHVsYXRlIGF1dG9jb21wbGV0ZSBmaWx0ZXJzIG9wdGlvbnMnKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIC8+fVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgcXVlcnkgcHJlZGljYXRlJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ1doZW4gdXNpbmcgXCJBdXRvY29tcGxldGUgZmlsdGVyc1wiLCB0aGlzIGNhbiBiZSB1c2VkIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UgJyArXG4gICAgICAgICAgICAgICAgJ29mIHRoZSBxdWVyeSBmZXRjaGluZyB0aGUgdmFsdWVzLiBVc2UgdGhpcyBvcHRpb24gdG8gYXBwbHkgYSAnICtcbiAgICAgICAgICAgICAgICAncHJlZGljYXRlIChXSEVSRSBjbGF1c2UpIHRvIHRoZSBxdWVyeSBzZWxlY3RpbmcgdGhlIGRpc3RpbmN0ICcgK1xuICAgICAgICAgICAgICAgICd2YWx1ZXMgZnJvbSB0aGUgdGFibGUuIFR5cGljYWxseSB0aGUgaW50ZW50IHdvdWxkIGJlIHRvIGxpbWl0IHRoZSBzY2FuICcgK1xuICAgICAgICAgICAgICAgICdieSBhcHBseWluZyBhIHJlbGF0aXZlIHRpbWUgZmlsdGVyIG9uIGEgcGFydGl0aW9uZWQgb3IgaW5kZXhlZCB0aW1lLXJlbGF0ZWQgZmllbGQuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgICAgICBtaW5MaW5lcz17NX1cbiAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZXh0cmFcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ0V4dHJhJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ0V4dHJhIGRhdGEgdG8gc3BlY2lmeSB0YWJsZSBtZXRhZGF0YS4gQ3VycmVudGx5IHN1cHBvcnRzICcgK1xuICAgICAgICAgICAgICAgICdtZXRhZGF0YSBvZiB0aGUgZm9ybWF0OiBgeyBcImNlcnRpZmljYXRpb25cIjogeyBcImNlcnRpZmllZF9ieVwiOiAnICtcbiAgICAgICAgICAgICAgICAnXCJEYXRhIFBsYXRmb3JtIFRlYW1cIiwgXCJkZXRhaWxzXCI6IFwiVGhpcyB0YWJsZSBpcyB0aGUgc291cmNlIG9mIHRydXRoLlwiICcgK1xuICAgICAgICAgICAgICAgICd9LCBcIndhcm5pbmdfbWFya2Rvd25cIjogXCJUaGlzIGlzIGEgd2FybmluZy5cIiB9YC4nLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZXh0cmFcIlxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxPd25lcnNTZWxlY3RvclxuICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgb25DaGFuZ2U9e25ld093bmVycyA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZSh7IC4uLmRhdGFzb3VyY2UsIG93bmVyczogbmV3T3duZXJzIH0pO1xuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdBZHZhbmNlZCcpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiY2FjaGVfdGltZW91dFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0NhY2hlIHRpbWVvdXQnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgZHVyYXRpb24gb2YgdGltZSBpbiBzZWNvbmRzIGJlZm9yZSB0aGUgY2FjaGUgaXMgaW52YWxpZGF0ZWQuIFNldCB0byAtMSB0byBieXBhc3MgdGhlIGNhY2hlLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwiY2FjaGVfdGltZW91dFwiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cIm9mZnNldFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0hvdXJzIG9mZnNldCcpfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJvZmZzZXRcIiAvPn1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgbnVtYmVyIG9mIGhvdXJzLCBuZWdhdGl2ZSBvciBwb3NpdGl2ZSwgdG8gc2hpZnQgdGhlIHRpbWUgY29sdW1uLiBUaGlzIGNhbiBiZSB1c2VkIHRvIG1vdmUgVVRDIHRpbWUgdG8gbG9jYWwgdGltZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cInRlbXBsYXRlX3BhcmFtc1wiXG4gICAgICAgICAgICBsYWJlbD17dCgnVGVtcGxhdGUgcGFyYW1ldGVycycpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdBIHNldCBvZiBwYXJhbWV0ZXJzIHRoYXQgYmVjb21lIGF2YWlsYWJsZSBpbiB0aGUgcXVlcnkgdXNpbmcgSmluamEgdGVtcGxhdGluZyBzeW50YXgnLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJ0ZW1wbGF0ZV9wYXJhbXNcIiAvPn1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cIm5vcm1hbGl6ZV9jb2x1bW5zXCJcbiAgICAgICAgICBsYWJlbD17dCgnTm9ybWFsaXplIGNvbHVtbiBuYW1lcycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0FsbG93IGNvbHVtbiBuYW1lcyB0byBiZSBjaGFuZ2VkIHRvIGNhc2UgaW5zZW5zaXRpdmUgZm9ybWF0LCBpZiBzdXBwb3J0ZWQgKGUuZy4gT3JhY2xlLCBTbm93Zmxha2UpLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cIm5vcm1hbGl6ZV9jb2x1bW5zXCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiYWx3YXlzX2ZpbHRlcl9tYWluX2R0dG1cIlxuICAgICAgICAgIGxhYmVsPXt0KCdBbHdheXMgZmlsdGVyIG1haW4gZGF0ZXRpbWUgY29sdW1uJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICBgV2hlbiB0aGUgc2Vjb25kYXJ5IHRlbXBvcmFsIGNvbHVtbnMgYXJlIGZpbHRlcmVkLCBhcHBseSB0aGUgc2FtZSBmaWx0ZXIgdG8gdGhlIG1haW4gZGF0ZXRpbWUgY29sdW1uLmAsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCIgLz59XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJTcGF0aWFsVGFiKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IHNwYXRpYWxzLCBhbGxfY29sczogYWxsQ29scyB9ID0gZGF0YXNvdXJjZTtcbiAgICByZXR1cm4gKFxuICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICB0YWI9ezxDb2xsZWN0aW9uVGFiVGl0bGUgY29sbGVjdGlvbj17c3BhdGlhbHN9IHRpdGxlPXt0KCdTcGF0aWFsJyl9IC8+fVxuICAgICAgICBrZXk9ezR9XG4gICAgICA+XG4gICAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgICB0YWJsZUNvbHVtbnM9e1snbmFtZScsICdjb25maWcnXX1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcywgJ3NwYXRpYWxzJyl9XG4gICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHQoJzxuZXcgc3BhdGlhbD4nKSxcbiAgICAgICAgICAgIHR5cGU6IHQoJzxubyB0eXBlPicpLFxuICAgICAgICAgICAgY29uZmlnOiBudWxsLFxuICAgICAgICAgIH0pfVxuICAgICAgICAgIGNvbGxlY3Rpb249e3NwYXRpYWxzfVxuICAgICAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgICAgIGl0ZW1SZW5kZXJlcnM9e3tcbiAgICAgICAgICAgIG5hbWU6IChkLCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZSBjYW5FZGl0IHRpdGxlPXtkfSBvblNhdmVUaXRsZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgY29uZmlnOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPFNwYXRpYWxDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IGNob2ljZXM9e2FsbENvbHN9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU291cmNlRmllbGRzZXQodGhlbWUpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxFZGl0TG9ja0NvbnRhaW5lcj5cbiAgICAgICAgICA8c3BhbiByb2xlPVwiYnV0dG9uXCIgdGFiSW5kZXg9ezB9IG9uQ2xpY2s9e3RoaXMub25DaGFuZ2VFZGl0TW9kZX0+XG4gICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0VkaXRNb2RlID8gKFxuICAgICAgICAgICAgICA8SWNvbnMuTG9ja1VubG9ja2VkIGljb25Db2xvcj17dGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfSAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPEljb25zLkxvY2tMb2NrZWQgaWNvbkNvbG9yPXt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9IC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICB7IXRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJiAoXG4gICAgICAgICAgICA8ZGl2Pnt0KCdDbGljayB0aGUgbG9jayB0byBtYWtlIGNoYW5nZXMuJyl9PC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmIChcbiAgICAgICAgICAgIDxkaXY+e3QoJ0NsaWNrIHRoZSBsb2NrIHRvIHByZXZlbnQgZnVydGhlciBjaGFuZ2VzLicpfTwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRWRpdExvY2tDb250YWluZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibS1sLTEwIG0tdC0yMCBtLWItMTBcIj5cbiAgICAgICAgICB7REFUQVNPVVJDRV9UWVBFU19BUlIubWFwKHR5cGUgPT4gKFxuICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgIGtleT17dHlwZS5rZXl9XG4gICAgICAgICAgICAgIHZhbHVlPXt0eXBlLmtleX1cbiAgICAgICAgICAgICAgaW5saW5lXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVR5cGVDaGFuZ2UuYmluZCh0aGlzLCB0eXBlLmtleSl9XG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IHR5cGUua2V5fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3R5cGUubGFiZWx9XG4gICAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxGaWVsZHNldCBpdGVtPXtkYXRhc291cmNlfSBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9IGNvbXBhY3Q+XG4gICAgICAgICAge3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMudmlydHVhbC5rZXkgJiYgKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGF0YWJhc2VTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ3ZpcnR1YWwnKX1cbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IG1hcmdpblRvcDogOCB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERhdGFiYXNlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYj17ZGF0YXNvdXJjZT8uZGF0YWJhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0YWxvZz17ZGF0YXNvdXJjZS5jYXRhbG9nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYT17ZGF0YXNvdXJjZS5zY2hlbWF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DYXRhbG9nQ2hhbmdlPXtjYXRhbG9nID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnY2F0YWxvZycsIGNhdGFsb2cpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2NoZW1hQ2hhbmdlPXtzY2hlbWEgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdzY2hlbWEnLCBzY2hlbWEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRGJDaGFuZ2U9e2RhdGFiYXNlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnZGF0YWJhc2UnLCBkYXRhYmFzZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yPXt0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyB3aWR0aDogJ2NhbGMoMTAwJSAtIDM0cHgpJywgbWFyZ2luVG9wOiAtMTYgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInRhYmxlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ05hbWUnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ0YWJsZV9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGFibGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0RhdGFzZXQgbmFtZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMJyl9XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAgICAgICAgICdXaGVuIHNwZWNpZnlpbmcgU1FMLCB0aGUgZGF0YXNvdXJjZSBhY3RzIGFzIGEgdmlldy4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnU3VwZXJzZXQgd2lsbCB1c2UgdGhpcyBzdGF0ZW1lbnQgYXMgYSBzdWJxdWVyeSB3aGlsZSBncm91cGluZyBhbmQgZmlsdGVyaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ29uIHRoZSBnZW5lcmF0ZWQgcGFyZW50IHF1ZXJpZXMuJyxcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5MaW5lcz17MjB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhMaW5lcz17SW5maW5pdHl9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkT25seT17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cImJvdGhcIlxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLnN0YXRlLmRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSAmJiAoXG4gICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidGFibGVTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICBsYWJlbD17dCgnUGh5c2ljYWwnKX1cbiAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyBtYXJnaW5Ub3A6IDggfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPFRhYmxlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyYWJsZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLmRhdGFiYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZV9uYW1lOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuZGF0YWJhc2U/LmRhdGFiYXNlX25hbWUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlPy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSWQ9e2RhdGFzb3VyY2UuZGF0YWJhc2U/LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXJyb3I9e3RoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRhbG9nPXtkYXRhc291cmNlLmNhdGFsb2d9XG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE9e2RhdGFzb3VyY2Uuc2NoZW1hfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsTGFiTW9kZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVZhbHVlPXtkYXRhc291cmNlLnRhYmxlX25hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNhdGFsb2dDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNhdGFsb2cgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdjYXRhbG9nJywgY2F0YWxvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25TY2hlbWFDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHNjaGVtYSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3NjaGVtYScsIHNjaGVtYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25EYkNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZGF0YWJhc2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhYmFzZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25UYWJsZVNlbGVjdENoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGFibGUgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAgICdUaGUgcG9pbnRlciB0byBhIHBoeXNpY2FsIHRhYmxlIChvciB2aWV3KS4gS2VlcCBpbiBtaW5kIHRoYXQgdGhlIGNoYXJ0IGlzICcgK1xuICAgICAgICAgICAgICAgICAgICAgICdhc3NvY2lhdGVkIHRvIHRoaXMgU3VwZXJzZXQgbG9naWNhbCB0YWJsZSwgYW5kIHRoaXMgbG9naWNhbCB0YWJsZSBwb2ludHMgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBwaHlzaWNhbCB0YWJsZSByZWZlcmVuY2VkIGhlcmUuJyxcbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyRXJyb3JzKCkge1xuICAgIGlmICh0aGlzLnN0YXRlLmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8QWxlcnRcbiAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7IG1hcmdpbkJvdHRvbTogdGhlbWUuZ3JpZFVuaXQgKiA0IH0pfVxuICAgICAgICAgIHR5cGU9XCJlcnJvclwiXG4gICAgICAgICAgbWVzc2FnZT17XG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5lcnJvcnMubWFwKGVyciA9PiAoXG4gICAgICAgICAgICAgICAgPGRpdiBrZXk9e2Vycn0+e2Vycn08L2Rpdj5cbiAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIHJldHVybiAoXG4gICAgICA8Q29sbGVjdGlvblRhYmxlXG4gICAgICAgIHRhYmxlQ29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBzb3J0Q29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBjb2x1bW5MYWJlbHM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdCgnTWV0cmljIEtleScpLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogdCgnTGFiZWwnKSxcbiAgICAgICAgICBleHByZXNzaW9uOiB0KCdTUUwgZXhwcmVzc2lvbicpLFxuICAgICAgICB9fVxuICAgICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoXG4gICAgICAgICAgICAnVGhpcyBmaWVsZCBpcyB1c2VkIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgdG8gYXR0YWNoICcgK1xuICAgICAgICAgICAgICAndGhlIG1ldHJpYyB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCBhcyB0aGUgYWxpYXMgaW4gdGhlICcgK1xuICAgICAgICAgICAgICAnU1FMIHF1ZXJ5LicsXG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgZXhwYW5kRmllbGRzZXQ9e1xuICAgICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgPEZpZWxkc2V0IGNvbXBhY3Q+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkM2Zvcm1hdFwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0QzIGZvcm1hdCcpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sIGNvbnRyb2xJZD1cImQzZm9ybWF0XCIgcGxhY2Vob2xkZXI9XCIleS8lbS8lZFwiIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImN1cnJlbmN5XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnTWV0cmljIGN1cnJlbmN5Jyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8Q3VycmVuY3lDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5U2VsZWN0T3ZlcnJpZGVQcm9wcz17e1xuICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0KCdTZWxlY3Qgb3IgdHlwZSBjdXJyZW5jeSBzeW1ib2wnKSxcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VsZWN0QWRkaXRpb25hbFN0eWxlcz17Y3NzYFxuICAgICAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogMzAlO1xuICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAnUGVyc29uIG9yIGdyb3VwIHRoYXQgaGFzIGNlcnRpZmllZCB0aGlzIG1ldHJpYycsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQ2VydGlmaWVkIGJ5Jyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25fZGV0YWlsc1wiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnV2FybmluZycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwid2FybmluZ19tYXJrZG93blwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ09wdGlvbmFsIHdhcm5pbmcgYWJvdXQgdXNlIG9mIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cIndhcm5pbmdfbWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgICAgICA8L0Zvcm1Db250YWluZXI+XG4gICAgICAgIH1cbiAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgYWxsb3dBZGRJdGVtXG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UuYmluZCh0aGlzLCAnbWV0cmljcycpfVxuICAgICAgICBpdGVtR2VuZXJhdG9yPXsoKSA9PiAoe1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KCc8bmV3IG1ldHJpYz4nKSxcbiAgICAgICAgICB2ZXJib3NlX25hbWU6ICcnLFxuICAgICAgICAgIGV4cHJlc3Npb246ICcnLFxuICAgICAgICB9KX1cbiAgICAgICAgaXRlbUNlbGxQcm9wcz17e1xuICAgICAgICAgIGV4cHJlc3Npb246ICgpID0+ICh7XG4gICAgICAgICAgICB3aWR0aDogJzI0MHB4JyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfX1cbiAgICAgICAgaXRlbVJlbmRlcmVycz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiAodiwgb25DaGFuZ2UsIF8sIHJlY29yZCkgPT4gKFxuICAgICAgICAgICAgPEZsZXhSb3dDb250YWluZXI+XG4gICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7cmVjb3JkLndhcm5pbmdfbWFya2Rvd24gJiYgKFxuICAgICAgICAgICAgICAgIDxXYXJuaW5nSWNvbldpdGhUb29sdGlwXG4gICAgICAgICAgICAgICAgICB3YXJuaW5nTWFya2Rvd249e3JlY29yZC53YXJuaW5nX21hcmtkb3dufVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxFZGl0YWJsZVRpdGxlIGNhbkVkaXQgdGl0bGU9e3Z9IG9uU2F2ZVRpdGxlPXtvbkNoYW5nZX0gLz5cbiAgICAgICAgICAgIDwvRmxleFJvd0NvbnRhaW5lcj5cbiAgICAgICAgICApLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dENvbnRyb2wgY2FuRWRpdCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZXhwcmVzc2lvbjogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlPXt2fVxuICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgIGV4dHJhQ2xhc3Nlcz17WydkYXRhc291cmNlLXNxbC1leHByZXNzaW9uJ119XG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIG1pbkxpbmVzPXs1fVxuICAgICAgICAgICAgICB0ZXh0QXJlYVN0eWxlcz17eyBtaW5XaWR0aDogJzIwMHB4JywgbWF4V2lkdGg6ICc0NTBweCcgfX1cbiAgICAgICAgICAgICAgcmVzaXplPVwiYm90aFwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZGVzY3JpcHRpb246ICh2LCBvbkNoYW5nZSwgbGFiZWwpID0+IChcbiAgICAgICAgICAgIDxTdGFja2VkRmllbGRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICBmb3JtRWxlbWVudD17PFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICAgIGQzZm9ybWF0OiAodiwgb25DaGFuZ2UsIGxhYmVsKSA9PiAoXG4gICAgICAgICAgICA8U3RhY2tlZEZpZWxkXG4gICAgICAgICAgICAgIGxhYmVsPXtsYWJlbH1cbiAgICAgICAgICAgICAgZm9ybUVsZW1lbnQ9ezxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPn1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgYWxsb3dEZWxldGVzXG4gICAgICAgIHN0aWNreUhlYWRlclxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSwgYWN0aXZlVGFiS2V5IH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIGNvbnN0IHsgdGhlbWUgfSA9IHRoaXMucHJvcHM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPERhdGFzb3VyY2VDb250YWluZXIgZGF0YS10ZXN0PVwiZGF0YXNvdXJjZS1lZGl0b3JcIj5cbiAgICAgICAge3RoaXMucmVuZGVyRXJyb3JzKCl9XG4gICAgICAgIDxBbGVydFxuICAgICAgICAgIGNzcz17dGhlbWUgPT4gKHsgbWFyZ2luQm90dG9tOiB0aGVtZS5ncmlkVW5pdCAqIDQgfSl9XG4gICAgICAgICAgdHlwZT1cIndhcm5pbmdcIlxuICAgICAgICAgIG1lc3NhZ2U9e1xuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgeycgJ31cbiAgICAgICAgICAgICAgPHN0cm9uZz57dCgnQmUgY2FyZWZ1bC4nKX0gPC9zdHJvbmc+XG4gICAgICAgICAgICAgIHt0KFxuICAgICAgICAgICAgICAgICdDaGFuZ2luZyB0aGVzZSBzZXR0aW5ncyB3aWxsIGFmZmVjdCBhbGwgY2hhcnRzIHVzaW5nIHRoaXMgZGF0YXNldCwgaW5jbHVkaW5nIGNoYXJ0cyBvd25lZCBieSBvdGhlciBwZW9wbGUuJyxcbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICAgPFN0eWxlZFRhYmxlVGFic1xuICAgICAgICAgIGZ1bGxXaWR0aD17ZmFsc2V9XG4gICAgICAgICAgaWQ9XCJ0YWJsZS10YWJzXCJcbiAgICAgICAgICBkYXRhLXRlc3Q9XCJlZGl0LWRhdGFzZXQtdGFic1wiXG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlVGFiU2VsZWN0fVxuICAgICAgICAgIGRlZmF1bHRBY3RpdmVLZXk9e2FjdGl2ZVRhYktleX1cbiAgICAgICAgPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUga2V5PXswfSB0YWI9e3QoJ1NvdXJjZScpfT5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlclNvdXJjZUZpZWxkc2V0KHRoZW1lKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnTWV0cmljcycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXsxfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NvbHVtbnMnKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleT17Mn1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8U3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRCdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBidXR0b25TaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICAgICAgICBidXR0b25TdHlsZT1cInRlcnRpYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5zeW5jTWV0YWRhdGF9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInN5bmMtZnJvbS1zb3VyY2VcIlxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1kYXRhYmFzZVwiIC8+eycgJ31cbiAgICAgICAgICAgICAgICAgICAge3QoJ1N5bmMgY29sdW1ucyBmcm9tIHNvdXJjZScpfVxuICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPC9TdHlsZWRCdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICA8L0NvbHVtbkJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5Db2xsZWN0aW9uVGFibGVcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjb2x1bW5zLXRhYmxlXCJcbiAgICAgICAgICAgICAgICBjb2x1bW5zPXt0aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1uc31cbiAgICAgICAgICAgICAgICBkYXRhc291cmNlPXtkYXRhc291cmNlfVxuICAgICAgICAgICAgICAgIG9uQ29sdW1uc0NoYW5nZT17ZGF0YWJhc2VDb2x1bW5zID0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENvbHVtbnMoeyBkYXRhYmFzZUNvbHVtbnMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUubWV0YWRhdGFMb2FkaW5nICYmIDxMb2FkaW5nIC8+fVxuICAgICAgICAgICAgPC9TdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17dGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnQ2FsY3VsYXRlZCBjb2x1bW5zJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXk9ezN9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPFN0eWxlZENvbHVtbnNUYWJXcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQ29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgICAgICAgY29sdW1ucz17dGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc31cbiAgICAgICAgICAgICAgICBvbkNvbHVtbnNDaGFuZ2U9e2NhbGN1bGF0ZWRDb2x1bW5zID0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENvbHVtbnMoeyBjYWxjdWxhdGVkQ29sdW1ucyB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXt7XG4gICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdChcbiAgICAgICAgICAgICAgICAgICAgJ1RoaXMgZmllbGQgaXMgdXNlZCBhcyBhIHVuaXF1ZSBpZGVudGlmaWVyIHRvIGF0dGFjaCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAndGhlIGNhbGN1bGF0ZWQgZGltZW5zaW9uIHRvIGNoYXJ0cy4gSXQgaXMgYWxzbyB1c2VkICcgK1xuICAgICAgICAgICAgICAgICAgICAgICdhcyB0aGUgYWxpYXMgaW4gdGhlIFNRTCBxdWVyeS4nLFxuICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICAgICAgICAgICAgZGF0YXNvdXJjZT17ZGF0YXNvdXJjZX1cbiAgICAgICAgICAgICAgICBlZGl0YWJsZUNvbHVtbk5hbWVcbiAgICAgICAgICAgICAgICBzaG93RXhwcmVzc2lvblxuICAgICAgICAgICAgICAgIGFsbG93QWRkSXRlbVxuICAgICAgICAgICAgICAgIGFsbG93RWRpdERhdGFUeXBlXG4gICAgICAgICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCc8bmV3IGNvbHVtbj4nKSxcbiAgICAgICAgICAgICAgICAgIGZpbHRlcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBncm91cGJ5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogdCgnPGVudGVyIFNRTCBleHByZXNzaW9uIGhlcmU+JyksXG4gICAgICAgICAgICAgICAgICBfX2V4cGFuZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9TdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lIGtleT17NH0gdGFiPXt0KCdTZXR0aW5ncycpfT5cbiAgICAgICAgICAgIDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICAgIDxGb3JtQ29udGFpbmVyPnt0aGlzLnJlbmRlclNldHRpbmdzRmllbGRzZXQoKX08L0Zvcm1Db250YWluZXI+XG4gICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj57dGhpcy5yZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCl9PC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICA8L1N0eWxlZFRhYmxlVGFicz5cbiAgICAgIDwvRGF0YXNvdXJjZUNvbnRhaW5lcj5cbiAgICApO1xuICB9XG59XG5cbkRhdGFzb3VyY2VFZGl0b3IuZGVmYXVsdFByb3BzID0gZGVmYXVsdFByb3BzO1xuRGF0YXNvdXJjZUVkaXRvci5wcm9wVHlwZXMgPSBwcm9wVHlwZXM7XG5cbmNvbnN0IERhdGFTb3VyY2VDb21wb25lbnQgPSB3aXRoVGhlbWUoRGF0YXNvdXJjZUVkaXRvcik7XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhUb2FzdHMoRGF0YVNvdXJjZUNvbXBvbmVudCk7XG4iXX0= */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };var _ref3 = process.env.NODE_ENV === \"production\" ? { name: \"hkh81z\", styles: \"margin-top:8px\" } : { name: \"17jm38f-DatasourceEditor\", styles: \"margin-top:8px;label:DatasourceEditor;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF5b0N5QiIsImZpbGUiOiIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL0RhdGFzb3VyY2UvRGF0YXNvdXJjZUVkaXRvci5qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgQ2FyZCBmcm9tICdzcmMvY29tcG9uZW50cy9DYXJkJztcbmltcG9ydCBBbGVydCBmcm9tICdzcmMvY29tcG9uZW50cy9BbGVydCc7XG5pbXBvcnQgQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQmFkZ2UnO1xuaW1wb3J0IHsgbmFub2lkIH0gZnJvbSAnbmFub2lkJztcbmltcG9ydCB7XG4gIGNzcyxcbiAgaXNGZWF0dXJlRW5hYmxlZCxcbiAgZ2V0Q3VycmVuY3lTeW1ib2wsXG4gIGVuc3VyZUlzQXJyYXksXG4gIEZlYXR1cmVGbGFnLFxuICBzdHlsZWQsXG4gIFN1cGVyc2V0Q2xpZW50LFxuICB0LFxuICB3aXRoVGhlbWUsXG4gIGdldENsaWVudEVycm9yT2JqZWN0LFxufSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyBTZWxlY3QsIEFzeW5jU2VsZWN0LCBSb3csIENvbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCB7IEZvcm1MYWJlbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IFRhYnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFicyc7XG5pbXBvcnQgQ2VydGlmaWVkQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ2VydGlmaWVkQmFkZ2UnO1xuaW1wb3J0IFdhcm5pbmdJY29uV2l0aFRvb2x0aXAgZnJvbSAnc3JjL2NvbXBvbmVudHMvV2FybmluZ0ljb25XaXRoVG9vbHRpcCc7XG5pbXBvcnQgRGF0YWJhc2VTZWxlY3RvciBmcm9tICdzcmMvY29tcG9uZW50cy9EYXRhYmFzZVNlbGVjdG9yJztcbmltcG9ydCBMYWJlbCBmcm9tICdzcmMvY29tcG9uZW50cy9MYWJlbCc7XG5pbXBvcnQgTG9hZGluZyBmcm9tICdzcmMvY29tcG9uZW50cy9Mb2FkaW5nJztcbmltcG9ydCBUYWJsZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYmxlU2VsZWN0b3InO1xuaW1wb3J0IEVkaXRhYmxlVGl0bGUgZnJvbSAnc3JjL2NvbXBvbmVudHMvRWRpdGFibGVUaXRsZSc7XG5pbXBvcnQgQ2hlY2tib3hDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ2hlY2tib3hDb250cm9sJztcbmltcG9ydCBUZXh0Q29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1RleHRDb250cm9sJztcbmltcG9ydCBUZXh0QXJlYUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9UZXh0QXJlYUNvbnRyb2wnO1xuaW1wb3J0IFNwYXRpYWxDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvU3BhdGlhbENvbnRyb2wnO1xuaW1wb3J0IHdpdGhUb2FzdHMgZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVzc2FnZVRvYXN0cy93aXRoVG9hc3RzJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgQ3VycmVuY3lDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ3VycmVuY3lDb250cm9sJztcbmltcG9ydCBDb2xsZWN0aW9uVGFibGUgZnJvbSAnLi9Db2xsZWN0aW9uVGFibGUnO1xuaW1wb3J0IEZpZWxkc2V0IGZyb20gJy4vRmllbGRzZXQnO1xuaW1wb3J0IEZpZWxkIGZyb20gJy4vRmllbGQnO1xuXG5jb25zdCBEYXRhc291cmNlQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgLmNoYW5nZS13YXJuaW5nIHtcbiAgICBtYXJnaW46IDE2cHggMTBweCAwO1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy53YXJuaW5nLmJhc2V9O1xuICB9XG5cbiAgLmNoYW5nZS13YXJuaW5nIC5ib2xkIHtcbiAgICBmb250LXdlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LndlaWdodHMuYm9sZH07XG4gIH1cblxuICAuZm9ybS1ncm91cC5oYXMtZmVlZGJhY2sgPiAuaGVscC1ibG9jayB7XG4gICAgbWFyZ2luLXRvcDogOHB4O1xuICB9XG5cbiAgLmZvcm0tZ3JvdXAuZm9ybS1ncm91cC1tZCB7XG4gICAgbWFyZ2luLWJvdHRvbTogOHB4O1xuICB9XG5gO1xuXG5jb25zdCBGbGV4Um93Q29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgZGlzcGxheTogZmxleDtcblxuICBzdmcge1xuICAgIG1hcmdpbi1yaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkVGFibGVUYWJzID0gc3R5bGVkKFRhYnMpYFxuICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgLmFudC10YWJzLWNvbnRlbnQtaG9sZGVyIHtcbiAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkQmFkZ2UgPSBzdHlsZWQoQmFkZ2UpYFxuICAuYW50ZDUtYmFkZ2UtY291bnQge1xuICAgIGxpbmUtaGVpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBoZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA0fXB4O1xuICAgIG1hcmdpbi1sZWZ0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBFZGl0TG9ja0NvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGZvbnQtc2l6ZTogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LnNpemVzLnN9cHg7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGEge1xuICAgIHBhZGRpbmc6IDAgMTBweDtcbiAgfVxuYDtcblxuY29uc3QgQ29sdW1uQnV0dG9uV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIHRleHQtYWxpZ246IHJpZ2h0O1xuICAkeyh7IHRoZW1lIH0pID0+IGBtYXJnaW4tYm90dG9tOiAke3RoZW1lLmdyaWRVbml0ICogMn1weGB9XG5gO1xuXG5jb25zdCBTdHlsZWRMYWJlbFdyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBzcGFuIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZENvbHVtbnNUYWJXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgLnRhYmxlID4gdGJvZHkgPiB0ciA+IHRkIHtcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICB9XG5cbiAgLmFudC10YWcge1xuICAgIG1hcmdpbi10b3A6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZEJ1dHRvbldyYXBwZXIgPSBzdHlsZWQuc3BhbmBcbiAgJHsoeyB0aGVtZSB9KSA9PiBgXG4gICAgbWFyZ2luLXRvcDogJHt0aGVtZS5ncmlkVW5pdCAqIDN9cHg7XG4gICAgbWFyZ2luLWxlZnQ6ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4O1xuICBgfVxuYDtcblxuY29uc3QgY2hlY2tib3hHZW5lcmF0b3IgPSAoZCwgb25DaGFuZ2UpID0+IChcbiAgPENoZWNrYm94Q29udHJvbCB2YWx1ZT17ZH0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuKTtcbmNvbnN0IERBVEFfVFlQRVMgPSBbXG4gIHsgdmFsdWU6ICdTVFJJTkcnLCBsYWJlbDogdCgnU1RSSU5HJykgfSxcbiAgeyB2YWx1ZTogJ05VTUVSSUMnLCBsYWJlbDogdCgnTlVNRVJJQycpIH0sXG4gIHsgdmFsdWU6ICdEQVRFVElNRScsIGxhYmVsOiB0KCdEQVRFVElNRScpIH0sXG4gIHsgdmFsdWU6ICdCT09MRUFOJywgbGFiZWw6IHQoJ0JPT0xFQU4nKSB9LFxuXTtcblxuY29uc3QgREFUQVNPVVJDRV9UWVBFU19BUlIgPSBbXG4gIHsga2V5OiAncGh5c2ljYWwnLCBsYWJlbDogdCgnUGh5c2ljYWwgKHRhYmxlIG9yIHZpZXcpJykgfSxcbiAgeyBrZXk6ICd2aXJ0dWFsJywgbGFiZWw6IHQoJ1ZpcnR1YWwgKFNRTCknKSB9LFxuXTtcbmNvbnN0IERBVEFTT1VSQ0VfVFlQRVMgPSB7fTtcbkRBVEFTT1VSQ0VfVFlQRVNfQVJSLmZvckVhY2gobyA9PiB7XG4gIERBVEFTT1VSQ0VfVFlQRVNbby5rZXldID0gbztcbn0pO1xuXG5mdW5jdGlvbiBDb2xsZWN0aW9uVGFiVGl0bGUoeyB0aXRsZSwgY29sbGVjdGlvbiB9KSB7XG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY3NzPXt7IGRpc3BsYXk6ICdmbGV4JywgYWxpZ25JdGVtczogJ2NlbnRlcicgfX1cbiAgICAgIGRhdGEtdGVzdD17YGNvbGxlY3Rpb24tdGFiLSR7dGl0bGV9YH1cbiAgICA+XG4gICAgICB7dGl0bGV9eycgJ31cbiAgICAgIDxTdHlsZWRCYWRnZSBjb3VudD17Y29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMH0gc2hvd1plcm8gLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuQ29sbGVjdGlvblRhYlRpdGxlLnByb3BUeXBlcyA9IHtcbiAgdGl0bGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGNvbGxlY3Rpb246IFByb3BUeXBlcy5hcnJheSxcbn07XG5cbmZ1bmN0aW9uIENvbHVtbkNvbGxlY3Rpb25UYWJsZSh7XG4gIGNvbHVtbnMsXG4gIGRhdGFzb3VyY2UsXG4gIG9uQ29sdW1uc0NoYW5nZSxcbiAgb25EYXRhc291cmNlQ2hhbmdlLFxuICBlZGl0YWJsZUNvbHVtbk5hbWUsXG4gIHNob3dFeHByZXNzaW9uLFxuICBhbGxvd0FkZEl0ZW0sXG4gIGFsbG93RWRpdERhdGFUeXBlLFxuICBpdGVtR2VuZXJhdG9yLFxuICBjb2x1bW5MYWJlbFRvb2x0aXBzLFxufSkge1xuICByZXR1cm4gKFxuICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgIHRhYmxlQ29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBzb3J0Q29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgIGFsbG93QWRkSXRlbT17YWxsb3dBZGRJdGVtfVxuICAgICAgaXRlbUdlbmVyYXRvcj17aXRlbUdlbmVyYXRvcn1cbiAgICAgIGNvbGxlY3Rpb249e2NvbHVtbnN9XG4gICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXtjb2x1bW5MYWJlbFRvb2x0aXBzfVxuICAgICAgc3RpY2t5SGVhZGVyXG4gICAgICBleHBhbmRGaWVsZHNldD17XG4gICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgIDxGaWVsZHNldCBjb21wYWN0PlxuICAgICAgICAgICAge3Nob3dFeHByZXNzaW9uICYmIChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJleHByZXNzaW9uXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMIGV4cHJlc3Npb24nKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJtYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnTGFiZWwnKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0xhYmVsJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHthbGxvd0VkaXREYXRhVHlwZSAmJiAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidHlwZVwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICBhcmlhTGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zPXtEQVRBX1RZUEVTfVxuICAgICAgICAgICAgICAgICAgICBuYW1lPVwidHlwZVwiXG4gICAgICAgICAgICAgICAgICAgIGFsbG93TmV3T3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICBhbGxvd0NsZWFyXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcykgPyAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQWR2YW5jZWQgZGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0FkdmFuY2VkIERhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8PjwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cInB5dGhvbl9kYXRlX2Zvcm1hdFwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdEYXRldGltZSBmb3JtYXQnKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e1xuICAgICAgICAgICAgICAgIC8qIE5vdGUgdGhlIGZyYWdtZW50ZWQgdHJhbnNsYXRpb25zIG1heSBub3Qgd29yay4gKi9cbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAge3QoJ1RoZSBwYXR0ZXJuIG9mIHRpbWVzdGFtcCBmb3JtYXQuIEZvciBzdHJpbmdzIHVzZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2RvY3MucHl0aG9uLm9yZy8yL2xpYnJhcnkvZGF0ZXRpbWUuaHRtbCNzdHJmdGltZS1zdHJwdGltZS1iZWhhdmlvclwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnUHl0aG9uIGRhdGV0aW1lIHN0cmluZyBwYXR0ZXJuJyl9XG4gICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICB7dCgnIGV4cHJlc3Npb24gd2hpY2ggbmVlZHMgdG8gYWRoZXJlIHRvIHRoZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9JU09fODYwMVwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnSVNPIDg2MDEnKX1cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgIHt0KGAgc3RhbmRhcmQgdG8gZW5zdXJlIHRoYXQgdGhlIGxleGljb2dyYXBoaWNhbCBvcmRlcmluZ1xuICAgICAgICAgICAgICAgICAgICAgIGNvaW5jaWRlcyB3aXRoIHRoZSBjaHJvbm9sb2dpY2FsIG9yZGVyaW5nLiBJZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgZm9ybWF0IGRvZXMgbm90IGFkaGVyZSB0byB0aGUgSVNPIDg2MDEgc3RhbmRhcmRcbiAgICAgICAgICAgICAgICAgICAgICB5b3Ugd2lsbCBuZWVkIHRvIGRlZmluZSBhbiBleHByZXNzaW9uIGFuZCB0eXBlIGZvclxuICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWluZyB0aGUgc3RyaW5nIGludG8gYSBkYXRlIG9yIHRpbWVzdGFtcC4gTm90ZVxuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseSB0aW1lIHpvbmVzIGFyZSBub3Qgc3VwcG9ydGVkLiBJZiB0aW1lIGlzIHN0b3JlZFxuICAgICAgICAgICAgICAgICAgICAgIGluIGVwb2NoIGZvcm1hdCwgcHV0IFxcYGVwb2NoX3NcXGAgb3IgXFxgZXBvY2hfbXNcXGAuIElmIG5vIHBhdHRlcm5cbiAgICAgICAgICAgICAgICAgICAgICBpcyBzcGVjaWZpZWQgd2UgZmFsbCBiYWNrIHRvIHVzaW5nIHRoZSBvcHRpb25hbCBkZWZhdWx0cyBvbiBhIHBlclxuICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlL2NvbHVtbiBuYW1lIGxldmVsIHZpYSB0aGUgZXh0cmEgcGFyYW1ldGVyLmApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwicHl0aG9uX2RhdGVfZm9ybWF0XCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiJVktJW0tJWRcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWVkIEJ5Jyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWVkXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25EZXRhaWxzXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICAgIDwvRm9ybUNvbnRhaW5lcj5cbiAgICAgIH1cbiAgICAgIGNvbHVtbkxhYmVscz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCdDb2x1bW4nKSxcbiAgICAgICAgICAgICAgYWR2YW5jZWRfZGF0YV90eXBlOiB0KCdBZHZhbmNlZCBkYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgdHlwZTogdCgnRGF0YSB0eXBlJyksXG4gICAgICAgICAgICAgIGdyb3VwYnk6IHQoJ0lzIGRpbWVuc2lvbicpLFxuICAgICAgICAgICAgICBpc19kdHRtOiB0KCdJcyB0ZW1wb3JhbCcpLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiB0KCdEZWZhdWx0IGRhdGV0aW1lJyksXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IHQoJ0lzIGZpbHRlcmFibGUnKSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJ0NvbHVtbicpLFxuICAgICAgICAgICAgICB0eXBlOiB0KCdEYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgZ3JvdXBieTogdCgnSXMgZGltZW5zaW9uJyksXG4gICAgICAgICAgICAgIGlzX2R0dG06IHQoJ0lzIHRlbXBvcmFsJyksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHQoJ0RlZmF1bHQgZGF0ZXRpbWUnKSxcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdCgnSXMgZmlsdGVyYWJsZScpLFxuICAgICAgICAgICAgfVxuICAgICAgfVxuICAgICAgb25DaGFuZ2U9e29uQ29sdW1uc0NoYW5nZX1cbiAgICAgIGl0ZW1SZW5kZXJlcnM9e1xuICAgICAgICBpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKVxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZVxuICAgICAgICAgICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17dn1cbiAgICAgICAgICAgICAgICAgICAgICBvblNhdmVUaXRsZT17b25JdGVtQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dn1cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6ICh2YWx1ZSwgX29uSXRlbUNoYW5nZSwgX2xhYmVsLCByZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGVja2VkID0gZGF0YXNvdXJjZS5tYWluX2R0dG1fY29sID09PSByZWNvcmQuY29sdW1uX25hbWU7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlzYWJsZWQgPSAhY29sdW1ucy5maW5kKFxuICAgICAgICAgICAgICAgICAgY29sdW1uID0+IGNvbHVtbi5jb2x1bW5fbmFtZSA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICkuaXNfZHR0bTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD17YHJhZGlvLWRlZmF1bHQtZHR0bS0ke3JlY29yZC5jb2x1bW5fbmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtjaGVja2VkfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdHlwZTogZCA9PiAoZCA/IDxMYWJlbD57ZH08L0xhYmVsPiA6IG51bGwpLFxuICAgICAgICAgICAgICBhZHZhbmNlZF9kYXRhX3R5cGU6IGQgPT4gKFxuICAgICAgICAgICAgICAgIDxMYWJlbCBvbkNoYW5nZT17b25Db2x1bW5zQ2hhbmdlfT57ZH08L0xhYmVsPlxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBpc19kdHRtOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGdyb3VwYnk6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDoge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkl0ZW1DaGFuZ2V9IC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt2fVxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogKHZhbHVlLCBfb25JdGVtQ2hhbmdlLCBfbGFiZWwsIHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSBkYXRhc291cmNlLm1haW5fZHR0bV9jb2wgPT09IHJlY29yZC5jb2x1bW5fbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFjb2x1bW5zLmZpbmQoXG4gICAgICAgICAgICAgICAgICBjb2x1bW4gPT4gY29sdW1uLmNvbHVtbl9uYW1lID09PSByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgKS5pc19kdHRtO1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PXtgcmFkaW8tZGVmYXVsdC1kdHRtLSR7cmVjb3JkLmNvbHVtbl9uYW1lfWB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NoZWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+XG4gICAgICAgICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0eXBlOiBkID0+IChkID8gPExhYmVsPntkfTwvTGFiZWw+IDogbnVsbCksXG4gICAgICAgICAgICAgIGlzX2R0dG06IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZ3JvdXBieTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICB9XG4gICAgICB9XG4gICAgLz5cbiAgKTtcbn1cbkNvbHVtbkNvbGxlY3Rpb25UYWJsZS5wcm9wVHlwZXMgPSB7XG4gIGNvbHVtbnM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ29sdW1uc0NoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25EYXRhc291cmNlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBlZGl0YWJsZUNvbHVtbk5hbWU6IFByb3BUeXBlcy5ib29sLFxuICBzaG93RXhwcmVzc2lvbjogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93QWRkSXRlbTogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93RWRpdERhdGFUeXBlOiBQcm9wVHlwZXMuYm9vbCxcbiAgaXRlbUdlbmVyYXRvcjogUHJvcFR5cGVzLmZ1bmMsXG59O1xuQ29sdW1uQ29sbGVjdGlvblRhYmxlLmRlZmF1bHRQcm9wcyA9IHtcbiAgZWRpdGFibGVDb2x1bW5OYW1lOiBmYWxzZSxcbiAgc2hvd0V4cHJlc3Npb246IGZhbHNlLFxuICBhbGxvd0FkZEl0ZW06IGZhbHNlLFxuICBhbGxvd0VkaXREYXRhVHlwZTogZmFsc2UsXG4gIGl0ZW1HZW5lcmF0b3I6ICgpID0+ICh7XG4gICAgY29sdW1uX25hbWU6IHQoJzxuZXcgY29sdW1uPicpLFxuICAgIGZpbHRlcmFibGU6IHRydWUsXG4gICAgZ3JvdXBieTogdHJ1ZSxcbiAgfSksXG59O1xuXG5mdW5jdGlvbiBTdGFja2VkRmllbGQoeyBsYWJlbCwgZm9ybUVsZW1lbnQgfSkge1xuICByZXR1cm4gKFxuICAgIDxkaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICA8c3Ryb25nPntsYWJlbH08L3N0cm9uZz5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj57Zm9ybUVsZW1lbnR9PC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cblN0YWNrZWRGaWVsZC5wcm9wVHlwZXMgPSB7XG4gIGxhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBmb3JtRWxlbWVudDogUHJvcFR5cGVzLm5vZGUsXG59O1xuXG5mdW5jdGlvbiBGb3JtQ29udGFpbmVyKHsgY2hpbGRyZW4gfSkge1xuICByZXR1cm4gPENhcmQgcGFkZGVkPntjaGlsZHJlbn08L0NhcmQ+O1xufVxuXG5Gb3JtQ29udGFpbmVyLnByb3BUeXBlcyA9IHtcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5ub2RlLFxufTtcblxuY29uc3QgcHJvcFR5cGVzID0ge1xuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgYWRkU3VjY2Vzc1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBhZGREYW5nZXJUb2FzdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2V0SXNFZGl0aW5nOiBQcm9wVHlwZXMuZnVuYyxcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgb25DaGFuZ2U6ICgpID0+IHt9LFxuICBzZXRJc0VkaXRpbmc6ICgpID0+IHt9LFxufTtcblxuZnVuY3Rpb24gT3duZXJzU2VsZWN0b3IoeyBkYXRhc291cmNlLCBvbkNoYW5nZSB9KSB7XG4gIGNvbnN0IGxvYWRPcHRpb25zID0gdXNlQ2FsbGJhY2soKHNlYXJjaCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gcmlzb24uZW5jb2RlKHsgZmlsdGVyOiBzZWFyY2gsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgcmV0dXJuIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGF0YXNldC9yZWxhdGVkL293bmVycz9xPSR7cXVlcnl9YCxcbiAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdFxuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5leHRyYS5hY3RpdmUpXG4gICAgICAgIC5tYXAoaXRlbSA9PiAoe1xuICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgIH0pKSxcbiAgICAgIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQsXG4gICAgfSkpO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8QXN5bmNTZWxlY3RcbiAgICAgIGFyaWFMYWJlbD17dCgnU2VsZWN0IG93bmVycycpfVxuICAgICAgbW9kZT1cIm11bHRpcGxlXCJcbiAgICAgIG5hbWU9XCJvd25lcnNcIlxuICAgICAgdmFsdWU9e2RhdGFzb3VyY2Uub3duZXJzfVxuICAgICAgb3B0aW9ucz17bG9hZE9wdGlvbnN9XG4gICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICBoZWFkZXI9ezxGb3JtTGFiZWw+e3QoJ093bmVycycpfTwvRm9ybUxhYmVsPn1cbiAgICAgIGFsbG93Q2xlYXJcbiAgICAvPlxuICApO1xufVxuXG5jbGFzcyBEYXRhc291cmNlRWRpdG9yIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBkYXRhc291cmNlOiB7XG4gICAgICAgIC4uLnByb3BzLmRhdGFzb3VyY2UsXG4gICAgICAgIG93bmVyczogcHJvcHMuZGF0YXNvdXJjZS5vd25lcnMubWFwKG93bmVyID0+ICh7XG4gICAgICAgICAgdmFsdWU6IG93bmVyLnZhbHVlIHx8IG93bmVyLmlkLFxuICAgICAgICAgIGxhYmVsOiBvd25lci5sYWJlbCB8fCBgJHtvd25lci5maXJzdF9uYW1lfSAke293bmVyLmxhc3RfbmFtZX1gLFxuICAgICAgICB9KSksXG4gICAgICAgIG1ldHJpY3M6IHByb3BzLmRhdGFzb3VyY2UubWV0cmljcz8ubWFwKG1ldHJpYyA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWNhdGlvbkRldGFpbHMsXG4gICAgICAgICAgfSA9IG1ldHJpYztcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uOiB7IGRldGFpbHMsIGNlcnRpZmllZF9ieTogY2VydGlmaWVkQnkgfSA9IHt9LFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duLFxuICAgICAgICAgIH0gPSBKU09OLnBhcnNlKG1ldHJpYy5leHRyYSB8fCAne30nKSB8fCB7fTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4ubWV0cmljLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpY2F0aW9uRGV0YWlscyB8fCBkZXRhaWxzLFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duIHx8ICcnLFxuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeSB8fCBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgaXNTcWxhOlxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLmRhdGFzb3VyY2VfdHlwZSA9PT0gJ3RhYmxlJyB8fFxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLnR5cGUgPT09ICd0YWJsZScsXG4gICAgICBpc0VkaXRNb2RlOiBmYWxzZSxcbiAgICAgIGRhdGFiYXNlQ29sdW1uczogcHJvcHMuZGF0YXNvdXJjZS5jb2x1bW5zLmZpbHRlcihjb2wgPT4gIWNvbC5leHByZXNzaW9uKSxcbiAgICAgIGNhbGN1bGF0ZWRDb2x1bW5zOiBwcm9wcy5kYXRhc291cmNlLmNvbHVtbnMuZmlsdGVyKFxuICAgICAgICBjb2wgPT4gISFjb2wuZXhwcmVzc2lvbixcbiAgICAgICksXG4gICAgICBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlLFxuICAgICAgYWN0aXZlVGFiS2V5OiAwLFxuICAgICAgZGF0YXNvdXJjZVR5cGU6IHByb3BzLmRhdGFzb3VyY2Uuc3FsXG4gICAgICAgID8gREFUQVNPVVJDRV9UWVBFUy52aXJ0dWFsLmtleVxuICAgICAgICA6IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5LFxuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25DaGFuZ2VFZGl0TW9kZSA9IHRoaXMub25DaGFuZ2VFZGl0TW9kZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSA9IHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlQ2hhbmdlID0gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhID1cbiAgICAgIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEuYmluZCh0aGlzKTtcbiAgICB0aGlzLnN5bmNNZXRhZGF0YSA9IHRoaXMuc3luY01ldGFkYXRhLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZXRDb2x1bW5zID0gdGhpcy5zZXRDb2x1bW5zLmJpbmQodGhpcyk7XG4gICAgdGhpcy52YWxpZGF0ZUFuZENoYW5nZSA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZVRhYlNlbGVjdCA9IHRoaXMuaGFuZGxlVGFiU2VsZWN0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5jdXJyZW5jaWVzID0gZW5zdXJlSXNBcnJheShwcm9wcy5jdXJyZW5jaWVzKS5tYXAoY3VycmVuY3lDb2RlID0+ICh7XG4gICAgICB2YWx1ZTogY3VycmVuY3lDb2RlLFxuICAgICAgbGFiZWw6IGAke2dldEN1cnJlbmN5U3ltYm9sKHtcbiAgICAgICAgc3ltYm9sOiBjdXJyZW5jeUNvZGUsXG4gICAgICB9KX0gKCR7Y3VycmVuY3lDb2RlfSlgLFxuICAgIH0pKTtcbiAgfVxuXG4gIG9uQ2hhbmdlKCkge1xuICAgIC8vIEVtcHR5aW5nIFNRTCBpZiBcIlBoeXNpY2FsXCIgcmFkaW8gYnV0dG9uIGlzIHNlbGVjdGVkXG4gICAgLy8gQ3VycmVudGx5IHRoZSBsb2dpYyB0byBrbm93IHdoZXRoZXIgdGhlIHNvdXJjZSBpc1xuICAgIC8vIHBoeXNpY2FsIG9yIHZpcnR1YWwgaXMgYmFzZWQgb24gd2hldGhlciBTUUwgaXMgZW1wdHkgb3Igbm90LlxuICAgIGNvbnN0IHsgZGF0YXNvdXJjZVR5cGUsIGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qgc3FsID1cbiAgICAgIGRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSA/ICcnIDogZGF0YXNvdXJjZS5zcWw7XG4gICAgY29uc3QgbmV3RGF0YXNvdXJjZSA9IHtcbiAgICAgIC4uLnRoaXMuc3RhdGUuZGF0YXNvdXJjZSxcbiAgICAgIHNxbCxcbiAgICAgIGNvbHVtbnM6IFsuLi50aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1ucywgLi4udGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc10sXG4gICAgfTtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKG5ld0RhdGFzb3VyY2UsIHRoaXMuc3RhdGUuZXJyb3JzKTtcbiAgfVxuXG4gIG9uQ2hhbmdlRWRpdE1vZGUoKSB7XG4gICAgdGhpcy5wcm9wcy5zZXRJc0VkaXRpbmcoIXRoaXMuc3RhdGUuaXNFZGl0TW9kZSk7XG4gICAgdGhpcy5zZXRTdGF0ZShwcmV2U3RhdGUgPT4gKHsgaXNFZGl0TW9kZTogIXByZXZTdGF0ZS5pc0VkaXRNb2RlIH0pKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCBjYWxsYmFjayA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGF0YXNvdXJjZSB9LCBjYWxsYmFjayk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKGF0dHIsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjsgLy8gaWYgdmFsdWUgaXMgdW5kZWZpbmVkIGRvIG5vdCB1cGRhdGUgc3RhdGVcbiAgICBjb25zdCBkYXRhc291cmNlID0geyAuLi50aGlzLnN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfTtcbiAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgcHJldlN0YXRlID0+ICh7XG4gICAgICAgIGRhdGFzb3VyY2U6IHsgLi4ucHJldlN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfSxcbiAgICAgIH0pLFxuICAgICAgYXR0ciA9PT0gJ3RhYmxlX25hbWUnXG4gICAgICAgID8gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UoZGF0YXNvdXJjZSwgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSlcbiAgICAgICAgOiB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKSxcbiAgICApO1xuICB9XG5cbiAgb25EYXRhc291cmNlVHlwZUNoYW5nZShkYXRhc291cmNlVHlwZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhc291cmNlVHlwZSB9KTtcbiAgfVxuXG4gIHNldENvbHVtbnMob2JqKSB7XG4gICAgLy8gdXBkYXRlIGNhbGN1bGF0ZWRDb2x1bW5zIG9yIGRhdGFiYXNlQ29sdW1uc1xuICAgIHRoaXMuc2V0U3RhdGUob2JqLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKTtcbiAgfVxuXG4gIHZhbGlkYXRlQW5kQ2hhbmdlKCkge1xuICAgIHRoaXMudmFsaWRhdGUodGhpcy5vbkNoYW5nZSk7XG4gIH1cblxuICB0YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSgpIHtcbiAgICB0aGlzLnZhbGlkYXRlKCgpID0+IHtcbiAgICAgIHRoaXMuc3luY01ldGFkYXRhKCk7XG4gICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVDb2x1bW5zKGNvbHMpIHtcbiAgICAvLyBjb2xzOiBBcnJheTx7Y29sdW1uX25hbWU6IHN0cmluZzsgaXNfZHR0bTogYm9vbGVhbjsgdHlwZTogc3RyaW5nO30+XG4gICAgY29uc3QgeyBkYXRhYmFzZUNvbHVtbnMgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgZGF0YWJhc2VDb2x1bW5OYW1lcyA9IGNvbHMubWFwKGNvbCA9PiBjb2wuY29sdW1uX25hbWUpO1xuICAgIGNvbnN0IGN1cnJlbnRDb2xzID0gZGF0YWJhc2VDb2x1bW5zLnJlZHVjZShcbiAgICAgIChhZ2csIGNvbCkgPT4gKHtcbiAgICAgICAgLi4uYWdnLFxuICAgICAgICBbY29sLmNvbHVtbl9uYW1lXTogY29sLFxuICAgICAgfSksXG4gICAgICB7fSxcbiAgICApO1xuICAgIGNvbnN0IGZpbmFsQ29sdW1ucyA9IFtdO1xuICAgIGNvbnN0IHJlc3VsdHMgPSB7XG4gICAgICBhZGRlZDogW10sXG4gICAgICBtb2RpZmllZDogW10sXG4gICAgICByZW1vdmVkOiBkYXRhYmFzZUNvbHVtbnNcbiAgICAgICAgLm1hcChjb2wgPT4gY29sLmNvbHVtbl9uYW1lKVxuICAgICAgICAuZmlsdGVyKGNvbCA9PiAhZGF0YWJhc2VDb2x1bW5OYW1lcy5pbmNsdWRlcyhjb2wpKSxcbiAgICB9O1xuICAgIGNvbHMuZm9yRWFjaChjb2wgPT4ge1xuICAgICAgY29uc3QgY3VycmVudENvbCA9IGN1cnJlbnRDb2xzW2NvbC5jb2x1bW5fbmFtZV07XG4gICAgICBpZiAoIWN1cnJlbnRDb2wpIHtcbiAgICAgICAgLy8gbmV3IGNvbHVtblxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaCh7XG4gICAgICAgICAgaWQ6IG5hbm9pZCgpLFxuICAgICAgICAgIGNvbHVtbl9uYW1lOiBjb2wuY29sdW1uX25hbWUsXG4gICAgICAgICAgdHlwZTogY29sLnR5cGUsXG4gICAgICAgICAgZ3JvdXBieTogdHJ1ZSxcbiAgICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgICAgICAgIGlzX2R0dG06IGNvbC5pc19kdHRtLFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0cy5hZGRlZC5wdXNoKGNvbC5jb2x1bW5fbmFtZSk7XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICBjdXJyZW50Q29sLnR5cGUgIT09IGNvbC50eXBlIHx8XG4gICAgICAgICghY3VycmVudENvbC5pc19kdHRtICYmIGNvbC5pc19kdHRtKVxuICAgICAgKSB7XG4gICAgICAgIC8vIG1vZGlmaWVkIGNvbHVtblxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaCh7XG4gICAgICAgICAgLi4uY3VycmVudENvbCxcbiAgICAgICAgICB0eXBlOiBjb2wudHlwZSxcbiAgICAgICAgICBpc19kdHRtOiBjdXJyZW50Q29sLmlzX2R0dG0gfHwgY29sLmlzX2R0dG0sXG4gICAgICAgIH0pO1xuICAgICAgICByZXN1bHRzLm1vZGlmaWVkLnB1c2goY29sLmNvbHVtbl9uYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHVuY2hhbmdlZFxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaChjdXJyZW50Q29sKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoXG4gICAgICByZXN1bHRzLmFkZGVkLmxlbmd0aCB8fFxuICAgICAgcmVzdWx0cy5tb2RpZmllZC5sZW5ndGggfHxcbiAgICAgIHJlc3VsdHMucmVtb3ZlZC5sZW5ndGhcbiAgICApIHtcbiAgICAgIHRoaXMuc2V0Q29sdW1ucyh7IGRhdGFiYXNlQ29sdW1uczogZmluYWxDb2x1bW5zIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxuXG4gIHN5bmNNZXRhZGF0YSgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgZGF0YXNvdXJjZV90eXBlOiBkYXRhc291cmNlLnR5cGUgfHwgZGF0YXNvdXJjZS5kYXRhc291cmNlX3R5cGUsXG4gICAgICBkYXRhYmFzZV9uYW1lOlxuICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlLmRhdGFiYXNlX25hbWUgfHwgZGF0YXNvdXJjZS5kYXRhYmFzZS5uYW1lLFxuICAgICAgY2F0YWxvZ19uYW1lOiBkYXRhc291cmNlLmNhdGFsb2csXG4gICAgICBzY2hlbWFfbmFtZTogZGF0YXNvdXJjZS5zY2hlbWEsXG4gICAgICB0YWJsZV9uYW1lOiBkYXRhc291cmNlLnRhYmxlX25hbWUsXG4gICAgICBub3JtYWxpemVfY29sdW1uczogZGF0YXNvdXJjZS5ub3JtYWxpemVfY29sdW1ucyxcbiAgICAgIGFsd2F5c19maWx0ZXJfbWFpbl9kdHRtOiBkYXRhc291cmNlLmFsd2F5c19maWx0ZXJfbWFpbl9kdHRtLFxuICAgIH07XG4gICAgT2JqZWN0LmVudHJpZXMocGFyYW1zKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIC8vIHJpc29uIGNhbid0IGVuY29kZSB0aGUgdW5kZWZpbmVkIHZhbHVlXG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwYXJhbXNba2V5XSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgZW5kcG9pbnQgPSBgL2RhdGFzb3VyY2UvZXh0ZXJuYWxfbWV0YWRhdGFfYnlfbmFtZS8/cT0ke3Jpc29uLmVuY29kZV91cmkoXG4gICAgICBwYXJhbXMsXG4gICAgKX1gO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IHRydWUgfSk7XG5cbiAgICBTdXBlcnNldENsaWVudC5nZXQoeyBlbmRwb2ludCB9KVxuICAgICAgLnRoZW4oKHsganNvbiB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLnVwZGF0ZUNvbHVtbnMoanNvbik7XG4gICAgICAgIGlmIChyZXN1bHRzLm1vZGlmaWVkLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0KFxuICAgICAgICAgICAgdCgnTW9kaWZpZWQgY29sdW1uczogJXMnLCByZXN1bHRzLm1vZGlmaWVkLmpvaW4oJywgJykpLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdHMucmVtb3ZlZC5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdChcbiAgICAgICAgICAgIHQoJ1JlbW92ZWQgY29sdW1uczogJXMnLCByZXN1bHRzLnJlbW92ZWQuam9pbignLCAnKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0cy5hZGRlZC5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdChcbiAgICAgICAgICAgIHQoJ05ldyBjb2x1bW5zIGFkZGVkOiAlcycsIHJlc3VsdHMuYWRkZWQuam9pbignLCAnKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdCh0KCdNZXRhZGF0YSBoYXMgYmVlbiBzeW5jZWQnKSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlIH0pO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChyZXNwb25zZSA9PlxuICAgICAgICBnZXRDbGllbnRFcnJvck9iamVjdChyZXNwb25zZSkudGhlbigoeyBlcnJvciwgc3RhdHVzVGV4dCB9KSA9PiB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdChcbiAgICAgICAgICAgIGVycm9yIHx8IHN0YXR1c1RleHQgfHwgdCgnQW4gZXJyb3IgaGFzIG9jY3VycmVkJyksXG4gICAgICAgICAgKTtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgbWV0YWRhdGFMb2FkaW5nOiBmYWxzZSB9KTtcbiAgICAgICAgfSksXG4gICAgICApO1xuICB9XG5cbiAgZmluZER1cGxpY2F0ZXMoYXJyLCBhY2Nlc3Nvcikge1xuICAgIGNvbnN0IHNlZW4gPSB7fTtcbiAgICBjb25zdCBkdXBzID0gW107XG4gICAgYXJyLmZvckVhY2gob2JqID0+IHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBhY2Nlc3NvcihvYmopO1xuICAgICAgaWYgKGl0ZW0gaW4gc2Vlbikge1xuICAgICAgICBkdXBzLnB1c2goaXRlbSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWVuW2l0ZW1dID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZHVwcztcbiAgfVxuXG4gIHZhbGlkYXRlKGNhbGxiYWNrKSB7XG4gICAgbGV0IGVycm9ycyA9IFtdO1xuICAgIGxldCBkdXBzO1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIC8vIExvb2tpbmcgZm9yIGR1cGxpY2F0ZSBjb2x1bW5fbmFtZVxuICAgIGR1cHMgPSB0aGlzLmZpbmREdXBsaWNhdGVzKGRhdGFzb3VyY2UuY29sdW1ucywgb2JqID0+IG9iai5jb2x1bW5fbmFtZSk7XG4gICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChcbiAgICAgIGR1cHMubWFwKG5hbWUgPT4gdCgnQ29sdW1uIG5hbWUgWyVzXSBpcyBkdXBsaWNhdGVkJywgbmFtZSkpLFxuICAgICk7XG5cbiAgICAvLyBMb29raW5nIGZvciBkdXBsaWNhdGUgbWV0cmljX25hbWVcbiAgICBkdXBzID0gdGhpcy5maW5kRHVwbGljYXRlcyhkYXRhc291cmNlLm1ldHJpY3MsIG9iaiA9PiBvYmoubWV0cmljX25hbWUpO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBkdXBzLm1hcChuYW1lID0+IHQoJ01ldHJpYyBuYW1lIFslc10gaXMgZHVwbGljYXRlZCcsIG5hbWUpKSxcbiAgICApO1xuXG4gICAgLy8gTWFraW5nIHN1cmUgY2FsY3VsYXRlZENvbHVtbnMgaGF2ZSBhbiBleHByZXNzaW9uIGRlZmluZWRcbiAgICBjb25zdCBub0ZpbHRlckNhbGNDb2xzID0gdGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1ucy5maWx0ZXIoXG4gICAgICBjb2wgPT4gIWNvbC5leHByZXNzaW9uICYmICFjb2wuanNvbixcbiAgICApO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBub0ZpbHRlckNhbGNDb2xzLm1hcChjb2wgPT5cbiAgICAgICAgdCgnQ2FsY3VsYXRlZCBjb2x1bW4gWyVzXSByZXF1aXJlcyBhbiBleHByZXNzaW9uJywgY29sLmNvbHVtbl9uYW1lKSxcbiAgICAgICksXG4gICAgKTtcblxuICAgIC8vIHZhbGlkYXRlIGN1cnJlbmN5IGNvZGVcbiAgICB0cnkge1xuICAgICAgdGhpcy5zdGF0ZS5kYXRhc291cmNlLm1ldHJpY3M/LmZvckVhY2goXG4gICAgICAgIG1ldHJpYyA9PlxuICAgICAgICAgIG1ldHJpYy5jdXJyZW5jeT8uc3ltYm9sICYmXG4gICAgICAgICAgbmV3IEludGwuTnVtYmVyRm9ybWF0KCdlbi1VUycsIHtcbiAgICAgICAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgICAgICAgY3VycmVuY3k6IG1ldHJpYy5jdXJyZW5jeS5zeW1ib2wsXG4gICAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0gY2F0Y2gge1xuICAgICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChbdCgnSW52YWxpZCBjdXJyZW5jeSBjb2RlIGluIHNhdmVkIG1ldHJpY3MnKV0pO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoeyBlcnJvcnMgfSwgY2FsbGJhY2spO1xuICB9XG5cbiAgaGFuZGxlVGFiU2VsZWN0KGFjdGl2ZVRhYktleSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBhY3RpdmVUYWJLZXkgfSk7XG4gIH1cblxuICBzb3J0TWV0cmljcyhtZXRyaWNzKSB7XG4gICAgcmV0dXJuIG1ldHJpY3Muc29ydCgoeyBpZDogYSB9LCB7IGlkOiBiIH0pID0+IGIgLSBhKTtcbiAgfVxuXG4gIHJlbmRlclNldHRpbmdzRmllbGRzZXQoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8RmllbGRzZXRcbiAgICAgICAgdGl0bGU9e3QoJ0Jhc2ljJyl9XG4gICAgICAgIGl0ZW09e2RhdGFzb3VyY2V9XG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX1cbiAgICAgID5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgZmllbGRLZXk9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwibWFya2Rvd25cIlxuICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiZGVmYXVsdF9lbmRwb2ludFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0RlZmF1bHQgVVJMJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnRGVmYXVsdCBVUkwgdG8gcmVkaXJlY3QgdG8gd2hlbiBhY2Nlc3NpbmcgZnJvbSB0aGUgZGF0YXNldCBsaXN0IHBhZ2UnLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImRlZmF1bHRfZW5kcG9pbnRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJmaWx0ZXJfc2VsZWN0X2VuYWJsZWRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgZmlsdGVycycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdXaGV0aGVyIHRvIHBvcHVsYXRlIGF1dG9jb21wbGV0ZSBmaWx0ZXJzIG9wdGlvbnMnKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIC8+fVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgcXVlcnkgcHJlZGljYXRlJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ1doZW4gdXNpbmcgXCJBdXRvY29tcGxldGUgZmlsdGVyc1wiLCB0aGlzIGNhbiBiZSB1c2VkIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UgJyArXG4gICAgICAgICAgICAgICAgJ29mIHRoZSBxdWVyeSBmZXRjaGluZyB0aGUgdmFsdWVzLiBVc2UgdGhpcyBvcHRpb24gdG8gYXBwbHkgYSAnICtcbiAgICAgICAgICAgICAgICAncHJlZGljYXRlIChXSEVSRSBjbGF1c2UpIHRvIHRoZSBxdWVyeSBzZWxlY3RpbmcgdGhlIGRpc3RpbmN0ICcgK1xuICAgICAgICAgICAgICAgICd2YWx1ZXMgZnJvbSB0aGUgdGFibGUuIFR5cGljYWxseSB0aGUgaW50ZW50IHdvdWxkIGJlIHRvIGxpbWl0IHRoZSBzY2FuICcgK1xuICAgICAgICAgICAgICAgICdieSBhcHBseWluZyBhIHJlbGF0aXZlIHRpbWUgZmlsdGVyIG9uIGEgcGFydGl0aW9uZWQgb3IgaW5kZXhlZCB0aW1lLXJlbGF0ZWQgZmllbGQuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgICAgICBtaW5MaW5lcz17NX1cbiAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZXh0cmFcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ0V4dHJhJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ0V4dHJhIGRhdGEgdG8gc3BlY2lmeSB0YWJsZSBtZXRhZGF0YS4gQ3VycmVudGx5IHN1cHBvcnRzICcgK1xuICAgICAgICAgICAgICAgICdtZXRhZGF0YSBvZiB0aGUgZm9ybWF0OiBgeyBcImNlcnRpZmljYXRpb25cIjogeyBcImNlcnRpZmllZF9ieVwiOiAnICtcbiAgICAgICAgICAgICAgICAnXCJEYXRhIFBsYXRmb3JtIFRlYW1cIiwgXCJkZXRhaWxzXCI6IFwiVGhpcyB0YWJsZSBpcyB0aGUgc291cmNlIG9mIHRydXRoLlwiICcgK1xuICAgICAgICAgICAgICAgICd9LCBcIndhcm5pbmdfbWFya2Rvd25cIjogXCJUaGlzIGlzIGEgd2FybmluZy5cIiB9YC4nLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZXh0cmFcIlxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxPd25lcnNTZWxlY3RvclxuICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgb25DaGFuZ2U9e25ld093bmVycyA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZSh7IC4uLmRhdGFzb3VyY2UsIG93bmVyczogbmV3T3duZXJzIH0pO1xuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdBZHZhbmNlZCcpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiY2FjaGVfdGltZW91dFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0NhY2hlIHRpbWVvdXQnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgZHVyYXRpb24gb2YgdGltZSBpbiBzZWNvbmRzIGJlZm9yZSB0aGUgY2FjaGUgaXMgaW52YWxpZGF0ZWQuIFNldCB0byAtMSB0byBieXBhc3MgdGhlIGNhY2hlLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwiY2FjaGVfdGltZW91dFwiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cIm9mZnNldFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0hvdXJzIG9mZnNldCcpfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJvZmZzZXRcIiAvPn1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgbnVtYmVyIG9mIGhvdXJzLCBuZWdhdGl2ZSBvciBwb3NpdGl2ZSwgdG8gc2hpZnQgdGhlIHRpbWUgY29sdW1uLiBUaGlzIGNhbiBiZSB1c2VkIHRvIG1vdmUgVVRDIHRpbWUgdG8gbG9jYWwgdGltZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cInRlbXBsYXRlX3BhcmFtc1wiXG4gICAgICAgICAgICBsYWJlbD17dCgnVGVtcGxhdGUgcGFyYW1ldGVycycpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdBIHNldCBvZiBwYXJhbWV0ZXJzIHRoYXQgYmVjb21lIGF2YWlsYWJsZSBpbiB0aGUgcXVlcnkgdXNpbmcgSmluamEgdGVtcGxhdGluZyBzeW50YXgnLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJ0ZW1wbGF0ZV9wYXJhbXNcIiAvPn1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cIm5vcm1hbGl6ZV9jb2x1bW5zXCJcbiAgICAgICAgICBsYWJlbD17dCgnTm9ybWFsaXplIGNvbHVtbiBuYW1lcycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0FsbG93IGNvbHVtbiBuYW1lcyB0byBiZSBjaGFuZ2VkIHRvIGNhc2UgaW5zZW5zaXRpdmUgZm9ybWF0LCBpZiBzdXBwb3J0ZWQgKGUuZy4gT3JhY2xlLCBTbm93Zmxha2UpLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cIm5vcm1hbGl6ZV9jb2x1bW5zXCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiYWx3YXlzX2ZpbHRlcl9tYWluX2R0dG1cIlxuICAgICAgICAgIGxhYmVsPXt0KCdBbHdheXMgZmlsdGVyIG1haW4gZGF0ZXRpbWUgY29sdW1uJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICBgV2hlbiB0aGUgc2Vjb25kYXJ5IHRlbXBvcmFsIGNvbHVtbnMgYXJlIGZpbHRlcmVkLCBhcHBseSB0aGUgc2FtZSBmaWx0ZXIgdG8gdGhlIG1haW4gZGF0ZXRpbWUgY29sdW1uLmAsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCIgLz59XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJTcGF0aWFsVGFiKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IHNwYXRpYWxzLCBhbGxfY29sczogYWxsQ29scyB9ID0gZGF0YXNvdXJjZTtcbiAgICByZXR1cm4gKFxuICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICB0YWI9ezxDb2xsZWN0aW9uVGFiVGl0bGUgY29sbGVjdGlvbj17c3BhdGlhbHN9IHRpdGxlPXt0KCdTcGF0aWFsJyl9IC8+fVxuICAgICAgICBrZXk9ezR9XG4gICAgICA+XG4gICAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgICB0YWJsZUNvbHVtbnM9e1snbmFtZScsICdjb25maWcnXX1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcywgJ3NwYXRpYWxzJyl9XG4gICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHQoJzxuZXcgc3BhdGlhbD4nKSxcbiAgICAgICAgICAgIHR5cGU6IHQoJzxubyB0eXBlPicpLFxuICAgICAgICAgICAgY29uZmlnOiBudWxsLFxuICAgICAgICAgIH0pfVxuICAgICAgICAgIGNvbGxlY3Rpb249e3NwYXRpYWxzfVxuICAgICAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgICAgIGl0ZW1SZW5kZXJlcnM9e3tcbiAgICAgICAgICAgIG5hbWU6IChkLCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZSBjYW5FZGl0IHRpdGxlPXtkfSBvblNhdmVUaXRsZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgY29uZmlnOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPFNwYXRpYWxDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IGNob2ljZXM9e2FsbENvbHN9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU291cmNlRmllbGRzZXQodGhlbWUpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxFZGl0TG9ja0NvbnRhaW5lcj5cbiAgICAgICAgICA8c3BhbiByb2xlPVwiYnV0dG9uXCIgdGFiSW5kZXg9ezB9IG9uQ2xpY2s9e3RoaXMub25DaGFuZ2VFZGl0TW9kZX0+XG4gICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0VkaXRNb2RlID8gKFxuICAgICAgICAgICAgICA8SWNvbnMuTG9ja1VubG9ja2VkIGljb25Db2xvcj17dGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfSAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPEljb25zLkxvY2tMb2NrZWQgaWNvbkNvbG9yPXt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9IC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICB7IXRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJiAoXG4gICAgICAgICAgICA8ZGl2Pnt0KCdDbGljayB0aGUgbG9jayB0byBtYWtlIGNoYW5nZXMuJyl9PC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmIChcbiAgICAgICAgICAgIDxkaXY+e3QoJ0NsaWNrIHRoZSBsb2NrIHRvIHByZXZlbnQgZnVydGhlciBjaGFuZ2VzLicpfTwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRWRpdExvY2tDb250YWluZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibS1sLTEwIG0tdC0yMCBtLWItMTBcIj5cbiAgICAgICAgICB7REFUQVNPVVJDRV9UWVBFU19BUlIubWFwKHR5cGUgPT4gKFxuICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgIGtleT17dHlwZS5rZXl9XG4gICAgICAgICAgICAgIHZhbHVlPXt0eXBlLmtleX1cbiAgICAgICAgICAgICAgaW5saW5lXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVR5cGVDaGFuZ2UuYmluZCh0aGlzLCB0eXBlLmtleSl9XG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IHR5cGUua2V5fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3R5cGUubGFiZWx9XG4gICAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxGaWVsZHNldCBpdGVtPXtkYXRhc291cmNlfSBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9IGNvbXBhY3Q+XG4gICAgICAgICAge3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMudmlydHVhbC5rZXkgJiYgKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGF0YWJhc2VTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ3ZpcnR1YWwnKX1cbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IG1hcmdpblRvcDogOCB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERhdGFiYXNlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYj17ZGF0YXNvdXJjZT8uZGF0YWJhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0YWxvZz17ZGF0YXNvdXJjZS5jYXRhbG9nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYT17ZGF0YXNvdXJjZS5zY2hlbWF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DYXRhbG9nQ2hhbmdlPXtjYXRhbG9nID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnY2F0YWxvZycsIGNhdGFsb2cpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2NoZW1hQ2hhbmdlPXtzY2hlbWEgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdzY2hlbWEnLCBzY2hlbWEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRGJDaGFuZ2U9e2RhdGFiYXNlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnZGF0YWJhc2UnLCBkYXRhYmFzZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yPXt0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyB3aWR0aDogJ2NhbGMoMTAwJSAtIDM0cHgpJywgbWFyZ2luVG9wOiAtMTYgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInRhYmxlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ05hbWUnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ0YWJsZV9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGFibGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0RhdGFzZXQgbmFtZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMJyl9XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAgICAgICAgICdXaGVuIHNwZWNpZnlpbmcgU1FMLCB0aGUgZGF0YXNvdXJjZSBhY3RzIGFzIGEgdmlldy4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnU3VwZXJzZXQgd2lsbCB1c2UgdGhpcyBzdGF0ZW1lbnQgYXMgYSBzdWJxdWVyeSB3aGlsZSBncm91cGluZyBhbmQgZmlsdGVyaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ29uIHRoZSBnZW5lcmF0ZWQgcGFyZW50IHF1ZXJpZXMuJyxcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5MaW5lcz17MjB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhMaW5lcz17SW5maW5pdHl9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkT25seT17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cImJvdGhcIlxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLnN0YXRlLmRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSAmJiAoXG4gICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidGFibGVTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICBsYWJlbD17dCgnUGh5c2ljYWwnKX1cbiAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyBtYXJnaW5Ub3A6IDggfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPFRhYmxlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyYWJsZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLmRhdGFiYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZV9uYW1lOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuZGF0YWJhc2U/LmRhdGFiYXNlX25hbWUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlPy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSWQ9e2RhdGFzb3VyY2UuZGF0YWJhc2U/LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXJyb3I9e3RoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRhbG9nPXtkYXRhc291cmNlLmNhdGFsb2d9XG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE9e2RhdGFzb3VyY2Uuc2NoZW1hfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsTGFiTW9kZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVZhbHVlPXtkYXRhc291cmNlLnRhYmxlX25hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNhdGFsb2dDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNhdGFsb2cgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdjYXRhbG9nJywgY2F0YWxvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25TY2hlbWFDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHNjaGVtYSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3NjaGVtYScsIHNjaGVtYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25EYkNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZGF0YWJhc2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhYmFzZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25UYWJsZVNlbGVjdENoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGFibGUgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAgICdUaGUgcG9pbnRlciB0byBhIHBoeXNpY2FsIHRhYmxlIChvciB2aWV3KS4gS2VlcCBpbiBtaW5kIHRoYXQgdGhlIGNoYXJ0IGlzICcgK1xuICAgICAgICAgICAgICAgICAgICAgICdhc3NvY2lhdGVkIHRvIHRoaXMgU3VwZXJzZXQgbG9naWNhbCB0YWJsZSwgYW5kIHRoaXMgbG9naWNhbCB0YWJsZSBwb2ludHMgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBwaHlzaWNhbCB0YWJsZSByZWZlcmVuY2VkIGhlcmUuJyxcbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyRXJyb3JzKCkge1xuICAgIGlmICh0aGlzLnN0YXRlLmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8QWxlcnRcbiAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7IG1hcmdpbkJvdHRvbTogdGhlbWUuZ3JpZFVuaXQgKiA0IH0pfVxuICAgICAgICAgIHR5cGU9XCJlcnJvclwiXG4gICAgICAgICAgbWVzc2FnZT17XG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5lcnJvcnMubWFwKGVyciA9PiAoXG4gICAgICAgICAgICAgICAgPGRpdiBrZXk9e2Vycn0+e2Vycn08L2Rpdj5cbiAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIHJldHVybiAoXG4gICAgICA8Q29sbGVjdGlvblRhYmxlXG4gICAgICAgIHRhYmxlQ29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBzb3J0Q29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBjb2x1bW5MYWJlbHM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdCgnTWV0cmljIEtleScpLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogdCgnTGFiZWwnKSxcbiAgICAgICAgICBleHByZXNzaW9uOiB0KCdTUUwgZXhwcmVzc2lvbicpLFxuICAgICAgICB9fVxuICAgICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoXG4gICAgICAgICAgICAnVGhpcyBmaWVsZCBpcyB1c2VkIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgdG8gYXR0YWNoICcgK1xuICAgICAgICAgICAgICAndGhlIG1ldHJpYyB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCBhcyB0aGUgYWxpYXMgaW4gdGhlICcgK1xuICAgICAgICAgICAgICAnU1FMIHF1ZXJ5LicsXG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgZXhwYW5kRmllbGRzZXQ9e1xuICAgICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgPEZpZWxkc2V0IGNvbXBhY3Q+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkM2Zvcm1hdFwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0QzIGZvcm1hdCcpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sIGNvbnRyb2xJZD1cImQzZm9ybWF0XCIgcGxhY2Vob2xkZXI9XCIleS8lbS8lZFwiIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImN1cnJlbmN5XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnTWV0cmljIGN1cnJlbmN5Jyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8Q3VycmVuY3lDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5U2VsZWN0T3ZlcnJpZGVQcm9wcz17e1xuICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0KCdTZWxlY3Qgb3IgdHlwZSBjdXJyZW5jeSBzeW1ib2wnKSxcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VsZWN0QWRkaXRpb25hbFN0eWxlcz17Y3NzYFxuICAgICAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogMzAlO1xuICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAnUGVyc29uIG9yIGdyb3VwIHRoYXQgaGFzIGNlcnRpZmllZCB0aGlzIG1ldHJpYycsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQ2VydGlmaWVkIGJ5Jyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25fZGV0YWlsc1wiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnV2FybmluZycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwid2FybmluZ19tYXJrZG93blwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ09wdGlvbmFsIHdhcm5pbmcgYWJvdXQgdXNlIG9mIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cIndhcm5pbmdfbWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgICAgICA8L0Zvcm1Db250YWluZXI+XG4gICAgICAgIH1cbiAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgYWxsb3dBZGRJdGVtXG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UuYmluZCh0aGlzLCAnbWV0cmljcycpfVxuICAgICAgICBpdGVtR2VuZXJhdG9yPXsoKSA9PiAoe1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KCc8bmV3IG1ldHJpYz4nKSxcbiAgICAgICAgICB2ZXJib3NlX25hbWU6ICcnLFxuICAgICAgICAgIGV4cHJlc3Npb246ICcnLFxuICAgICAgICB9KX1cbiAgICAgICAgaXRlbUNlbGxQcm9wcz17e1xuICAgICAgICAgIGV4cHJlc3Npb246ICgpID0+ICh7XG4gICAgICAgICAgICB3aWR0aDogJzI0MHB4JyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfX1cbiAgICAgICAgaXRlbVJlbmRlcmVycz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiAodiwgb25DaGFuZ2UsIF8sIHJlY29yZCkgPT4gKFxuICAgICAgICAgICAgPEZsZXhSb3dDb250YWluZXI+XG4gICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7cmVjb3JkLndhcm5pbmdfbWFya2Rvd24gJiYgKFxuICAgICAgICAgICAgICAgIDxXYXJuaW5nSWNvbldpdGhUb29sdGlwXG4gICAgICAgICAgICAgICAgICB3YXJuaW5nTWFya2Rvd249e3JlY29yZC53YXJuaW5nX21hcmtkb3dufVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxFZGl0YWJsZVRpdGxlIGNhbkVkaXQgdGl0bGU9e3Z9IG9uU2F2ZVRpdGxlPXtvbkNoYW5nZX0gLz5cbiAgICAgICAgICAgIDwvRmxleFJvd0NvbnRhaW5lcj5cbiAgICAgICAgICApLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dENvbnRyb2wgY2FuRWRpdCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZXhwcmVzc2lvbjogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlPXt2fVxuICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgIGV4dHJhQ2xhc3Nlcz17WydkYXRhc291cmNlLXNxbC1leHByZXNzaW9uJ119XG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIG1pbkxpbmVzPXs1fVxuICAgICAgICAgICAgICB0ZXh0QXJlYVN0eWxlcz17eyBtaW5XaWR0aDogJzIwMHB4JywgbWF4V2lkdGg6ICc0NTBweCcgfX1cbiAgICAgICAgICAgICAgcmVzaXplPVwiYm90aFwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZGVzY3JpcHRpb246ICh2LCBvbkNoYW5nZSwgbGFiZWwpID0+IChcbiAgICAgICAgICAgIDxTdGFja2VkRmllbGRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICBmb3JtRWxlbWVudD17PFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICAgIGQzZm9ybWF0OiAodiwgb25DaGFuZ2UsIGxhYmVsKSA9PiAoXG4gICAgICAgICAgICA8U3RhY2tlZEZpZWxkXG4gICAgICAgICAgICAgIGxhYmVsPXtsYWJlbH1cbiAgICAgICAgICAgICAgZm9ybUVsZW1lbnQ9ezxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPn1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgYWxsb3dEZWxldGVzXG4gICAgICAgIHN0aWNreUhlYWRlclxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSwgYWN0aXZlVGFiS2V5IH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIGNvbnN0IHsgdGhlbWUgfSA9IHRoaXMucHJvcHM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPERhdGFzb3VyY2VDb250YWluZXIgZGF0YS10ZXN0PVwiZGF0YXNvdXJjZS1lZGl0b3JcIj5cbiAgICAgICAge3RoaXMucmVuZGVyRXJyb3JzKCl9XG4gICAgICAgIDxBbGVydFxuICAgICAgICAgIGNzcz17dGhlbWUgPT4gKHsgbWFyZ2luQm90dG9tOiB0aGVtZS5ncmlkVW5pdCAqIDQgfSl9XG4gICAgICAgICAgdHlwZT1cIndhcm5pbmdcIlxuICAgICAgICAgIG1lc3NhZ2U9e1xuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgeycgJ31cbiAgICAgICAgICAgICAgPHN0cm9uZz57dCgnQmUgY2FyZWZ1bC4nKX0gPC9zdHJvbmc+XG4gICAgICAgICAgICAgIHt0KFxuICAgICAgICAgICAgICAgICdDaGFuZ2luZyB0aGVzZSBzZXR0aW5ncyB3aWxsIGFmZmVjdCBhbGwgY2hhcnRzIHVzaW5nIHRoaXMgZGF0YXNldCwgaW5jbHVkaW5nIGNoYXJ0cyBvd25lZCBieSBvdGhlciBwZW9wbGUuJyxcbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICAgPFN0eWxlZFRhYmxlVGFic1xuICAgICAgICAgIGZ1bGxXaWR0aD17ZmFsc2V9XG4gICAgICAgICAgaWQ9XCJ0YWJsZS10YWJzXCJcbiAgICAgICAgICBkYXRhLXRlc3Q9XCJlZGl0LWRhdGFzZXQtdGFic1wiXG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlVGFiU2VsZWN0fVxuICAgICAgICAgIGRlZmF1bHRBY3RpdmVLZXk9e2FjdGl2ZVRhYktleX1cbiAgICAgICAgPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUga2V5PXswfSB0YWI9e3QoJ1NvdXJjZScpfT5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlclNvdXJjZUZpZWxkc2V0KHRoZW1lKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnTWV0cmljcycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXsxfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NvbHVtbnMnKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleT17Mn1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8U3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRCdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBidXR0b25TaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICAgICAgICBidXR0b25TdHlsZT1cInRlcnRpYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5zeW5jTWV0YWRhdGF9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInN5bmMtZnJvbS1zb3VyY2VcIlxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1kYXRhYmFzZVwiIC8+eycgJ31cbiAgICAgICAgICAgICAgICAgICAge3QoJ1N5bmMgY29sdW1ucyBmcm9tIHNvdXJjZScpfVxuICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPC9TdHlsZWRCdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICA8L0NvbHVtbkJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5Db2xsZWN0aW9uVGFibGVcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjb2x1bW5zLXRhYmxlXCJcbiAgICAgICAgICAgICAgICBjb2x1bW5zPXt0aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1uc31cbiAgICAgICAgICAgICAgICBkYXRhc291cmNlPXtkYXRhc291cmNlfVxuICAgICAgICAgICAgICAgIG9uQ29sdW1uc0NoYW5nZT17ZGF0YWJhc2VDb2x1bW5zID0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENvbHVtbnMoeyBkYXRhYmFzZUNvbHVtbnMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUubWV0YWRhdGFMb2FkaW5nICYmIDxMb2FkaW5nIC8+fVxuICAgICAgICAgICAgPC9TdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17dGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnQ2FsY3VsYXRlZCBjb2x1bW5zJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXk9ezN9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPFN0eWxlZENvbHVtbnNUYWJXcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQ29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgICAgICAgY29sdW1ucz17dGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc31cbiAgICAgICAgICAgICAgICBvbkNvbHVtbnNDaGFuZ2U9e2NhbGN1bGF0ZWRDb2x1bW5zID0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENvbHVtbnMoeyBjYWxjdWxhdGVkQ29sdW1ucyB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXt7XG4gICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdChcbiAgICAgICAgICAgICAgICAgICAgJ1RoaXMgZmllbGQgaXMgdXNlZCBhcyBhIHVuaXF1ZSBpZGVudGlmaWVyIHRvIGF0dGFjaCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAndGhlIGNhbGN1bGF0ZWQgZGltZW5zaW9uIHRvIGNoYXJ0cy4gSXQgaXMgYWxzbyB1c2VkICcgK1xuICAgICAgICAgICAgICAgICAgICAgICdhcyB0aGUgYWxpYXMgaW4gdGhlIFNRTCBxdWVyeS4nLFxuICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICAgICAgICAgICAgZGF0YXNvdXJjZT17ZGF0YXNvdXJjZX1cbiAgICAgICAgICAgICAgICBlZGl0YWJsZUNvbHVtbk5hbWVcbiAgICAgICAgICAgICAgICBzaG93RXhwcmVzc2lvblxuICAgICAgICAgICAgICAgIGFsbG93QWRkSXRlbVxuICAgICAgICAgICAgICAgIGFsbG93RWRpdERhdGFUeXBlXG4gICAgICAgICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCc8bmV3IGNvbHVtbj4nKSxcbiAgICAgICAgICAgICAgICAgIGZpbHRlcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBncm91cGJ5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogdCgnPGVudGVyIFNRTCBleHByZXNzaW9uIGhlcmU+JyksXG4gICAgICAgICAgICAgICAgICBfX2V4cGFuZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9TdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lIGtleT17NH0gdGFiPXt0KCdTZXR0aW5ncycpfT5cbiAgICAgICAgICAgIDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICAgIDxGb3JtQ29udGFpbmVyPnt0aGlzLnJlbmRlclNldHRpbmdzRmllbGRzZXQoKX08L0Zvcm1Db250YWluZXI+XG4gICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj57dGhpcy5yZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCl9PC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICA8L1N0eWxlZFRhYmxlVGFicz5cbiAgICAgIDwvRGF0YXNvdXJjZUNvbnRhaW5lcj5cbiAgICApO1xuICB9XG59XG5cbkRhdGFzb3VyY2VFZGl0b3IuZGVmYXVsdFByb3BzID0gZGVmYXVsdFByb3BzO1xuRGF0YXNvdXJjZUVkaXRvci5wcm9wVHlwZXMgPSBwcm9wVHlwZXM7XG5cbmNvbnN0IERhdGFTb3VyY2VDb21wb25lbnQgPSB3aXRoVGhlbWUoRGF0YXNvdXJjZUVkaXRvcik7XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhUb2FzdHMoRGF0YVNvdXJjZUNvbXBvbmVudCk7XG4iXX0= */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\n\nclass DatasourceEditor extends PureComponent {\n  constructor(props) {var _props$datasource$met;\n    super(props);\n    this.state = {\n      datasource: {\n        ...props.datasource,\n        owners: props.datasource.owners.map((owner) => ({\n          value: owner.value || owner.id,\n          label: owner.label || `${owner.first_name} ${owner.last_name}`\n        })),\n        metrics: (_props$datasource$met = props.datasource.metrics) == null ? void 0 : _props$datasource$met.map((metric) => {\n          const {\n            certified_by: certifiedByMetric,\n            certification_details: certificationDetails\n          } = metric;\n          const {\n            certification: { details, certified_by: certifiedBy } = {},\n            warning_markdown: warningMarkdown\n          } = JSON.parse(metric.extra || '{}') || {};\n          return {\n            ...metric,\n            certification_details: certificationDetails || details,\n            warning_markdown: warningMarkdown || '',\n            certified_by: certifiedBy || certifiedByMetric\n          };\n        })\n      },\n      errors: [],\n      isSqla:\n      props.datasource.datasource_type === 'table' ||\n      props.datasource.type === 'table',\n      isEditMode: false,\n      databaseColumns: props.datasource.columns.filter((col) => !col.expression),\n      calculatedColumns: props.datasource.columns.filter(\n        (col) => !!col.expression\n      ),\n      metadataLoading: false,\n      activeTabKey: 0,\n      datasourceType: props.datasource.sql ?\n      DATASOURCE_TYPES.virtual.key :\n      DATASOURCE_TYPES.physical.key\n    };\n\n    this.onChange = this.onChange.bind(this);\n    this.onChangeEditMode = this.onChangeEditMode.bind(this);\n    this.onDatasourcePropChange = this.onDatasourcePropChange.bind(this);\n    this.onDatasourceChange = this.onDatasourceChange.bind(this);\n    this.tableChangeAndSyncMetadata =\n    this.tableChangeAndSyncMetadata.bind(this);\n    this.syncMetadata = this.syncMetadata.bind(this);\n    this.setColumns = this.setColumns.bind(this);\n    this.validateAndChange = this.validateAndChange.bind(this);\n    this.handleTabSelect = this.handleTabSelect.bind(this);\n    this.currencies = ensureIsArray(props.currencies).map((currencyCode) => ({\n      value: currencyCode,\n      label: `${getCurrencySymbol({\n        symbol: currencyCode\n      })} (${currencyCode})`\n    }));\n  }\n\n  onChange() {\n    // Emptying SQL if \"Physical\" radio button is selected\n    // Currently the logic to know whether the source is\n    // physical or virtual is based on whether SQL is empty or not.\n    const { datasourceType, datasource } = this.state;\n    const sql =\n    datasourceType === DATASOURCE_TYPES.physical.key ? '' : datasource.sql;\n    const newDatasource = {\n      ...this.state.datasource,\n      sql,\n      columns: [...this.state.databaseColumns, ...this.state.calculatedColumns]\n    };\n    this.props.onChange(newDatasource, this.state.errors);\n  }\n\n  onChangeEditMode() {\n    this.props.setIsEditing(!this.state.isEditMode);\n    this.setState((prevState) => ({ isEditMode: !prevState.isEditMode }));\n  }\n\n  onDatasourceChange(datasource, callback = this.validateAndChange) {\n    this.setState({ datasource }, callback);\n  }\n\n  onDatasourcePropChange(attr, value) {\n    if (value === undefined) return; // if value is undefined do not update state\n    const datasource = { ...this.state.datasource, [attr]: value };\n    this.setState(\n      (prevState) => ({\n        datasource: { ...prevState.datasource, [attr]: value }\n      }),\n      attr === 'table_name' ?\n      this.onDatasourceChange(datasource, this.tableChangeAndSyncMetadata) :\n      this.onDatasourceChange(datasource, this.validateAndChange)\n    );\n  }\n\n  onDatasourceTypeChange(datasourceType) {\n    this.setState({ datasourceType });\n  }\n\n  setColumns(obj) {\n    // update calculatedColumns or databaseColumns\n    this.setState(obj, this.validateAndChange);\n  }\n\n  validateAndChange() {\n    this.validate(this.onChange);\n  }\n\n  tableChangeAndSyncMetadata() {\n    this.validate(() => {\n      this.syncMetadata();\n      this.onChange();\n    });\n  }\n\n  updateColumns(cols) {\n    // cols: Array<{column_name: string; is_dttm: boolean; type: string;}>\n    const { databaseColumns } = this.state;\n    const databaseColumnNames = cols.map((col) => col.column_name);\n    const currentCols = databaseColumns.reduce(\n      (agg, col) => ({\n        ...agg,\n        [col.column_name]: col\n      }),\n      {}\n    );\n    const finalColumns = [];\n    const results = {\n      added: [],\n      modified: [],\n      removed: databaseColumns.\n      map((col) => col.column_name).\n      filter((col) => !databaseColumnNames.includes(col))\n    };\n    cols.forEach((col) => {\n      const currentCol = currentCols[col.column_name];\n      if (!currentCol) {\n        // new column\n        finalColumns.push({\n          id: nanoid(),\n          column_name: col.column_name,\n          type: col.type,\n          groupby: true,\n          filterable: true,\n          is_dttm: col.is_dttm\n        });\n        results.added.push(col.column_name);\n      } else if (\n      currentCol.type !== col.type ||\n      !currentCol.is_dttm && col.is_dttm)\n      {\n        // modified column\n        finalColumns.push({\n          ...currentCol,\n          type: col.type,\n          is_dttm: currentCol.is_dttm || col.is_dttm\n        });\n        results.modified.push(col.column_name);\n      } else {\n        // unchanged\n        finalColumns.push(currentCol);\n      }\n    });\n    if (\n    results.added.length ||\n    results.modified.length ||\n    results.removed.length)\n    {\n      this.setColumns({ databaseColumns: finalColumns });\n    }\n    return results;\n  }\n\n  syncMetadata() {\n    const { datasource } = this.state;\n    const params = {\n      datasource_type: datasource.type || datasource.datasource_type,\n      database_name:\n      datasource.database.database_name || datasource.database.name,\n      catalog_name: datasource.catalog,\n      schema_name: datasource.schema,\n      table_name: datasource.table_name,\n      normalize_columns: datasource.normalize_columns,\n      always_filter_main_dttm: datasource.always_filter_main_dttm\n    };\n    Object.entries(params).forEach(([key, value]) => {\n      // rison can't encode the undefined value\n      if (value === undefined) {\n        params[key] = null;\n      }\n    });\n    const endpoint = `/datasource/external_metadata_by_name/?q=${rison.encode_uri(\n      params\n    )}`;\n    this.setState({ metadataLoading: true });\n\n    SupersetClient.get({ endpoint }).\n    then(({ json }) => {\n      const results = this.updateColumns(json);\n      if (results.modified.length) {\n        this.props.addSuccessToast(\n          t('Modified columns: %s', results.modified.join(', '))\n        );\n      }\n      if (results.removed.length) {\n        this.props.addSuccessToast(\n          t('Removed columns: %s', results.removed.join(', '))\n        );\n      }\n      if (results.added.length) {\n        this.props.addSuccessToast(\n          t('New columns added: %s', results.added.join(', '))\n        );\n      }\n      this.props.addSuccessToast(t('Metadata has been synced'));\n      this.setState({ metadataLoading: false });\n    }).\n    catch((response) =>\n    getClientErrorObject(response).then(({ error, statusText }) => {\n      this.props.addDangerToast(\n        error || statusText || t('An error has occurred')\n      );\n      this.setState({ metadataLoading: false });\n    })\n    );\n  }\n\n  findDuplicates(arr, accessor) {\n    const seen = {};\n    const dups = [];\n    arr.forEach((obj) => {\n      const item = accessor(obj);\n      if (item in seen) {\n        dups.push(item);\n      } else {\n        seen[item] = null;\n      }\n    });\n    return dups;\n  }\n\n  validate(callback) {\n    let errors = [];\n    let dups;\n    const { datasource } = this.state;\n\n    // Looking for duplicate column_name\n    dups = this.findDuplicates(datasource.columns, (obj) => obj.column_name);\n    errors = errors.concat(\n      dups.map((name) => t('Column name [%s] is duplicated', name))\n    );\n\n    // Looking for duplicate metric_name\n    dups = this.findDuplicates(datasource.metrics, (obj) => obj.metric_name);\n    errors = errors.concat(\n      dups.map((name) => t('Metric name [%s] is duplicated', name))\n    );\n\n    // Making sure calculatedColumns have an expression defined\n    const noFilterCalcCols = this.state.calculatedColumns.filter(\n      (col) => !col.expression && !col.json\n    );\n    errors = errors.concat(\n      noFilterCalcCols.map((col) =>\n      t('Calculated column [%s] requires an expression', col.column_name)\n      )\n    );\n\n    // validate currency code\n    try {var _this$state$datasourc;\n      (_this$state$datasourc = this.state.datasource.metrics) == null ? void 0 : _this$state$datasourc.forEach(\n        (metric) => {var _metric$currency;return (\n            ((_metric$currency = metric.currency) == null ? void 0 : _metric$currency.symbol) &&\n            new Intl.NumberFormat('en-US', {\n              style: 'currency',\n              currency: metric.currency.symbol\n            }));}\n      );\n    } catch {\n      errors = errors.concat([t('Invalid currency code in saved metrics')]);\n    }\n\n    this.setState({ errors }, callback);\n  }\n\n  handleTabSelect(activeTabKey) {\n    this.setState({ activeTabKey });\n  }\n\n  sortMetrics(metrics) {\n    return metrics.sort(({ id: a }, { id: b }) => b - a);\n  }\n\n  renderSettingsFieldset() {\n    const { datasource } = this.state;\n    return (\n      _jsxs(Fieldset, {\n        title: t('Basic'),\n        item: datasource,\n        onChange: this.onDatasourceChange, children: [\n\n        _jsx(Field, {\n          fieldKey: \"description\",\n          label: t('Description'),\n          control:\n          _jsx(TextAreaControl, {\n            language: \"markdown\",\n            offerEditInModal: false,\n            resize: \"vertical\" }\n          ) }\n\n        ),\n        _jsx(Field, {\n          fieldKey: \"default_endpoint\",\n          label: t('Default URL'),\n          description: t(\n            'Default URL to redirect to when accessing from the dataset list page'\n          ),\n          control: _jsx(TextControl, { controlId: \"default_endpoint\" }) }\n        ),\n        _jsx(Field, {\n          inline: true,\n          fieldKey: \"filter_select_enabled\",\n          label: t('Autocomplete filters'),\n          description: t('Whether to populate autocomplete filters options'),\n          control: _jsx(CheckboxControl, {}) }\n        ),\n        this.state.isSqla &&\n        _jsx(Field, {\n          fieldKey: \"fetch_values_predicate\",\n          label: t('Autocomplete query predicate'),\n          description: t(\n            'When using \"Autocomplete filters\", this can be used to improve performance ' +\n            'of the query fetching the values. Use this option to apply a ' +\n            'predicate (WHERE clause) to the query selecting the distinct ' +\n            'values from the table. Typically the intent would be to limit the scan ' +\n            'by applying a relative time filter on a partitioned or indexed time-related field.'\n          ),\n          control:\n          _jsx(TextAreaControl, {\n            language: \"sql\",\n            controlId: \"fetch_values_predicate\",\n            minLines: 5,\n            resize: \"vertical\" }\n          ) }\n\n        ),\n\n        this.state.isSqla &&\n        _jsx(Field, {\n          fieldKey: \"extra\",\n          label: t('Extra'),\n          description: t(\n            'Extra data to specify table metadata. Currently supports ' +\n            'metadata of the format: `{ \"certification\": { \"certified_by\": ' +\n            '\"Data Platform Team\", \"details\": \"This table is the source of truth.\" ' +\n            '}, \"warning_markdown\": \"This is a warning.\" }`.'\n          ),\n          control:\n          _jsx(TextAreaControl, {\n            controlId: \"extra\",\n            language: \"json\",\n            offerEditInModal: false,\n            resize: \"vertical\" }\n          ) }\n\n        ),\n\n        _jsx(OwnersSelector, {\n          datasource: datasource,\n          onChange: (newOwners) => {\n            this.onDatasourceChange({ ...datasource, owners: newOwners });\n          } }\n        )] }\n      ));\n\n  }\n\n  renderAdvancedFieldset() {\n    const { datasource } = this.state;\n    return (\n      _jsxs(Fieldset, {\n        title: t('Advanced'),\n        item: datasource,\n        onChange: this.onDatasourceChange, children: [\n\n        _jsx(Field, {\n          fieldKey: \"cache_timeout\",\n          label: t('Cache timeout'),\n          description: t(\n            'The duration of time in seconds before the cache is invalidated. Set to -1 to bypass the cache.'\n          ),\n          control: _jsx(TextControl, { controlId: \"cache_timeout\" }) }\n        ),\n        _jsx(Field, {\n          fieldKey: \"offset\",\n          label: t('Hours offset'),\n          control: _jsx(TextControl, { controlId: \"offset\" }),\n          description: t(\n            'The number of hours, negative or positive, to shift the time column. This can be used to move UTC time to local time.'\n          ) }\n        ),\n        this.state.isSqla &&\n        _jsx(Field, {\n          fieldKey: \"template_params\",\n          label: t('Template parameters'),\n          description: t(\n            'A set of parameters that become available in the query using Jinja templating syntax'\n          ),\n          control: _jsx(TextControl, { controlId: \"template_params\" }) }\n        ),\n\n        _jsx(Field, {\n          inline: true,\n          fieldKey: \"normalize_columns\",\n          label: t('Normalize column names'),\n          description: t(\n            'Allow column names to be changed to case insensitive format, if supported (e.g. Oracle, Snowflake).'\n          ),\n          control: _jsx(CheckboxControl, { controlId: \"normalize_columns\" }) }\n        ),\n        _jsx(Field, {\n          inline: true,\n          fieldKey: \"always_filter_main_dttm\",\n          label: t('Always filter main datetime column'),\n          description: t(\n            `When the secondary temporal columns are filtered, apply the same filter to the main datetime column.`\n          ),\n          control: _jsx(CheckboxControl, { controlId: \"always_filter_main_dttm\" }) }\n        )] }\n      ));\n\n  }\n\n  renderSpatialTab() {\n    const { datasource } = this.state;\n    const { spatials, all_cols: allCols } = datasource;\n    return (\n      _jsx(Tabs.TabPane, {\n        tab: _jsx(CollectionTabTitle, { collection: spatials, title: t('Spatial') }), children:\n\n\n        _jsx(CollectionTable, {\n          tableColumns: ['name', 'config'],\n          onChange: this.onDatasourcePropChange.bind(this, 'spatials'),\n          itemGenerator: () => ({\n            name: t('<new spatial>'),\n            type: t('<no type>'),\n            config: null\n          }),\n          collection: spatials,\n          allowDeletes: true,\n          itemRenderers: {\n            name: (d, onChange) =>\n            _jsx(EditableTitle, { canEdit: true, title: d, onSaveTitle: onChange }),\n\n            config: (v, onChange) =>\n            _jsx(SpatialControl, { value: v, onChange: onChange, choices: allCols })\n\n          } }\n        ) }, 4\n      ));\n\n  }\n\n  renderSourceFieldset(theme) {var _datasource$database, _datasource$database2, _datasource$database3;\n    const { datasource } = this.state;\n    return (\n      _jsxs(\"div\", { children: [\n        _jsxs(EditLockContainer, { children: [\n          _jsx(\"span\", { role: \"button\", tabIndex: 0, onClick: this.onChangeEditMode, children:\n            this.state.isEditMode ?\n            _jsx(Icons.LockUnlocked, { iconColor: theme.colors.grayscale.base }) :\n\n            _jsx(Icons.LockLocked, { iconColor: theme.colors.grayscale.base }) }\n\n          ),\n          !this.state.isEditMode &&\n          _jsx(\"div\", { children: t('Click the lock to make changes.') }),\n\n          this.state.isEditMode &&\n          _jsx(\"div\", { children: t('Click the lock to prevent further changes.') })] }\n\n        ),\n        _jsx(\"div\", { className: \"m-l-10 m-t-20 m-b-10\", children:\n          DATASOURCE_TYPES_ARR.map((type) =>\n          _jsx(Radio, {\n\n            value: type.key,\n            inline: true,\n            onChange: this.onDatasourceTypeChange.bind(this, type.key),\n            checked: this.state.datasourceType === type.key,\n            disabled: !this.state.isEditMode, children:\n\n            type.label }, type.key\n          )\n          ) }\n        ),\n        _jsx(\"hr\", {}),\n        _jsxs(Fieldset, { item: datasource, onChange: this.onDatasourceChange, compact: true, children: [\n          this.state.datasourceType === DATASOURCE_TYPES.virtual.key &&\n          _jsx(\"div\", { children:\n            this.state.isSqla &&\n            _jsxs(_Fragment, { children: [\n              _jsxs(Col, { xs: 24, md: 12, children: [\n                _jsx(Field, {\n                  fieldKey: \"databaseSelector\",\n                  label: t('virtual'),\n                  control:\n                  _jsx(\"div\", { css: _ref2, children:\n                    _jsx(DatabaseSelector, {\n                      db: datasource == null ? void 0 : datasource.database,\n                      catalog: datasource.catalog,\n                      schema: datasource.schema,\n                      onCatalogChange: (catalog) =>\n                      this.state.isEditMode &&\n                      this.onDatasourcePropChange('catalog', catalog),\n\n                      onSchemaChange: (schema) =>\n                      this.state.isEditMode &&\n                      this.onDatasourcePropChange('schema', schema),\n\n                      onDbChange: (database) =>\n                      this.state.isEditMode &&\n                      this.onDatasourcePropChange('database', database),\n\n                      formMode: false,\n                      handleError: this.props.addDangerToast,\n                      readOnly: !this.state.isEditMode }\n                    ) }\n                  ) }\n\n                ),\n                _jsx(\"div\", { css: /*#__PURE__*/_css({ width: 'calc(100% - 34px)', marginTop: -16 }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:DatasourceEditor;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvRGF0YXNvdXJjZS9EYXRhc291cmNlRWRpdG9yLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEwbEN5QiIsImZpbGUiOiIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL0RhdGFzb3VyY2UvRGF0YXNvdXJjZUVkaXRvci5qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgUHVyZUNvbXBvbmVudCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgQ2FyZCBmcm9tICdzcmMvY29tcG9uZW50cy9DYXJkJztcbmltcG9ydCBBbGVydCBmcm9tICdzcmMvY29tcG9uZW50cy9BbGVydCc7XG5pbXBvcnQgQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQmFkZ2UnO1xuaW1wb3J0IHsgbmFub2lkIH0gZnJvbSAnbmFub2lkJztcbmltcG9ydCB7XG4gIGNzcyxcbiAgaXNGZWF0dXJlRW5hYmxlZCxcbiAgZ2V0Q3VycmVuY3lTeW1ib2wsXG4gIGVuc3VyZUlzQXJyYXksXG4gIEZlYXR1cmVGbGFnLFxuICBzdHlsZWQsXG4gIFN1cGVyc2V0Q2xpZW50LFxuICB0LFxuICB3aXRoVGhlbWUsXG4gIGdldENsaWVudEVycm9yT2JqZWN0LFxufSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyBTZWxlY3QsIEFzeW5jU2VsZWN0LCBSb3csIENvbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCB7IEZvcm1MYWJlbCB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdzcmMvY29tcG9uZW50cy9CdXR0b24nO1xuaW1wb3J0IFRhYnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFicyc7XG5pbXBvcnQgQ2VydGlmaWVkQmFkZ2UgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ2VydGlmaWVkQmFkZ2UnO1xuaW1wb3J0IFdhcm5pbmdJY29uV2l0aFRvb2x0aXAgZnJvbSAnc3JjL2NvbXBvbmVudHMvV2FybmluZ0ljb25XaXRoVG9vbHRpcCc7XG5pbXBvcnQgRGF0YWJhc2VTZWxlY3RvciBmcm9tICdzcmMvY29tcG9uZW50cy9EYXRhYmFzZVNlbGVjdG9yJztcbmltcG9ydCBMYWJlbCBmcm9tICdzcmMvY29tcG9uZW50cy9MYWJlbCc7XG5pbXBvcnQgTG9hZGluZyBmcm9tICdzcmMvY29tcG9uZW50cy9Mb2FkaW5nJztcbmltcG9ydCBUYWJsZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYmxlU2VsZWN0b3InO1xuaW1wb3J0IEVkaXRhYmxlVGl0bGUgZnJvbSAnc3JjL2NvbXBvbmVudHMvRWRpdGFibGVUaXRsZSc7XG5pbXBvcnQgQ2hlY2tib3hDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ2hlY2tib3hDb250cm9sJztcbmltcG9ydCBUZXh0Q29udHJvbCBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL1RleHRDb250cm9sJztcbmltcG9ydCBUZXh0QXJlYUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9UZXh0QXJlYUNvbnRyb2wnO1xuaW1wb3J0IFNwYXRpYWxDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvU3BhdGlhbENvbnRyb2wnO1xuaW1wb3J0IHdpdGhUb2FzdHMgZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVzc2FnZVRvYXN0cy93aXRoVG9hc3RzJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgQ3VycmVuY3lDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ3VycmVuY3lDb250cm9sJztcbmltcG9ydCBDb2xsZWN0aW9uVGFibGUgZnJvbSAnLi9Db2xsZWN0aW9uVGFibGUnO1xuaW1wb3J0IEZpZWxkc2V0IGZyb20gJy4vRmllbGRzZXQnO1xuaW1wb3J0IEZpZWxkIGZyb20gJy4vRmllbGQnO1xuXG5jb25zdCBEYXRhc291cmNlQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgLmNoYW5nZS13YXJuaW5nIHtcbiAgICBtYXJnaW46IDE2cHggMTBweCAwO1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy53YXJuaW5nLmJhc2V9O1xuICB9XG5cbiAgLmNoYW5nZS13YXJuaW5nIC5ib2xkIHtcbiAgICBmb250LXdlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LndlaWdodHMuYm9sZH07XG4gIH1cblxuICAuZm9ybS1ncm91cC5oYXMtZmVlZGJhY2sgPiAuaGVscC1ibG9jayB7XG4gICAgbWFyZ2luLXRvcDogOHB4O1xuICB9XG5cbiAgLmZvcm0tZ3JvdXAuZm9ybS1ncm91cC1tZCB7XG4gICAgbWFyZ2luLWJvdHRvbTogOHB4O1xuICB9XG5gO1xuXG5jb25zdCBGbGV4Um93Q29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgZGlzcGxheTogZmxleDtcblxuICBzdmcge1xuICAgIG1hcmdpbi1yaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkVGFibGVUYWJzID0gc3R5bGVkKFRhYnMpYFxuICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgLmFudC10YWJzLWNvbnRlbnQtaG9sZGVyIHtcbiAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkQmFkZ2UgPSBzdHlsZWQoQmFkZ2UpYFxuICAuYW50ZDUtYmFkZ2UtY291bnQge1xuICAgIGxpbmUtaGVpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBoZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA0fXB4O1xuICAgIG1hcmdpbi1sZWZ0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICB9XG5gO1xuXG5jb25zdCBFZGl0TG9ja0NvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGZvbnQtc2l6ZTogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LnNpemVzLnN9cHg7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGEge1xuICAgIHBhZGRpbmc6IDAgMTBweDtcbiAgfVxuYDtcblxuY29uc3QgQ29sdW1uQnV0dG9uV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIHRleHQtYWxpZ246IHJpZ2h0O1xuICAkeyh7IHRoZW1lIH0pID0+IGBtYXJnaW4tYm90dG9tOiAke3RoZW1lLmdyaWRVbml0ICogMn1weGB9XG5gO1xuXG5jb25zdCBTdHlsZWRMYWJlbFdyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBzcGFuIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZENvbHVtbnNUYWJXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgLnRhYmxlID4gdGJvZHkgPiB0ciA+IHRkIHtcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICB9XG5cbiAgLmFudC10YWcge1xuICAgIG1hcmdpbi10b3A6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gIH1cbmA7XG5cbmNvbnN0IFN0eWxlZEJ1dHRvbldyYXBwZXIgPSBzdHlsZWQuc3BhbmBcbiAgJHsoeyB0aGVtZSB9KSA9PiBgXG4gICAgbWFyZ2luLXRvcDogJHt0aGVtZS5ncmlkVW5pdCAqIDN9cHg7XG4gICAgbWFyZ2luLWxlZnQ6ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4O1xuICBgfVxuYDtcblxuY29uc3QgY2hlY2tib3hHZW5lcmF0b3IgPSAoZCwgb25DaGFuZ2UpID0+IChcbiAgPENoZWNrYm94Q29udHJvbCB2YWx1ZT17ZH0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuKTtcbmNvbnN0IERBVEFfVFlQRVMgPSBbXG4gIHsgdmFsdWU6ICdTVFJJTkcnLCBsYWJlbDogdCgnU1RSSU5HJykgfSxcbiAgeyB2YWx1ZTogJ05VTUVSSUMnLCBsYWJlbDogdCgnTlVNRVJJQycpIH0sXG4gIHsgdmFsdWU6ICdEQVRFVElNRScsIGxhYmVsOiB0KCdEQVRFVElNRScpIH0sXG4gIHsgdmFsdWU6ICdCT09MRUFOJywgbGFiZWw6IHQoJ0JPT0xFQU4nKSB9LFxuXTtcblxuY29uc3QgREFUQVNPVVJDRV9UWVBFU19BUlIgPSBbXG4gIHsga2V5OiAncGh5c2ljYWwnLCBsYWJlbDogdCgnUGh5c2ljYWwgKHRhYmxlIG9yIHZpZXcpJykgfSxcbiAgeyBrZXk6ICd2aXJ0dWFsJywgbGFiZWw6IHQoJ1ZpcnR1YWwgKFNRTCknKSB9LFxuXTtcbmNvbnN0IERBVEFTT1VSQ0VfVFlQRVMgPSB7fTtcbkRBVEFTT1VSQ0VfVFlQRVNfQVJSLmZvckVhY2gobyA9PiB7XG4gIERBVEFTT1VSQ0VfVFlQRVNbby5rZXldID0gbztcbn0pO1xuXG5mdW5jdGlvbiBDb2xsZWN0aW9uVGFiVGl0bGUoeyB0aXRsZSwgY29sbGVjdGlvbiB9KSB7XG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY3NzPXt7IGRpc3BsYXk6ICdmbGV4JywgYWxpZ25JdGVtczogJ2NlbnRlcicgfX1cbiAgICAgIGRhdGEtdGVzdD17YGNvbGxlY3Rpb24tdGFiLSR7dGl0bGV9YH1cbiAgICA+XG4gICAgICB7dGl0bGV9eycgJ31cbiAgICAgIDxTdHlsZWRCYWRnZSBjb3VudD17Y29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMH0gc2hvd1plcm8gLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuQ29sbGVjdGlvblRhYlRpdGxlLnByb3BUeXBlcyA9IHtcbiAgdGl0bGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGNvbGxlY3Rpb246IFByb3BUeXBlcy5hcnJheSxcbn07XG5cbmZ1bmN0aW9uIENvbHVtbkNvbGxlY3Rpb25UYWJsZSh7XG4gIGNvbHVtbnMsXG4gIGRhdGFzb3VyY2UsXG4gIG9uQ29sdW1uc0NoYW5nZSxcbiAgb25EYXRhc291cmNlQ2hhbmdlLFxuICBlZGl0YWJsZUNvbHVtbk5hbWUsXG4gIHNob3dFeHByZXNzaW9uLFxuICBhbGxvd0FkZEl0ZW0sXG4gIGFsbG93RWRpdERhdGFUeXBlLFxuICBpdGVtR2VuZXJhdG9yLFxuICBjb2x1bW5MYWJlbFRvb2x0aXBzLFxufSkge1xuICByZXR1cm4gKFxuICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgIHRhYmxlQ29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBzb3J0Q29sdW1ucz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICdjb2x1bW5fbmFtZScsXG4gICAgICAgICAgICAgICdhZHZhbmNlZF9kYXRhX3R5cGUnLFxuICAgICAgICAgICAgICAndHlwZScsXG4gICAgICAgICAgICAgICdpc19kdHRtJyxcbiAgICAgICAgICAgICAgJ21haW5fZHR0bV9jb2wnLFxuICAgICAgICAgICAgICAnZmlsdGVyYWJsZScsXG4gICAgICAgICAgICAgICdncm91cGJ5JyxcbiAgICAgICAgICAgIF1cbiAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgJ2NvbHVtbl9uYW1lJyxcbiAgICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgICAnaXNfZHR0bScsXG4gICAgICAgICAgICAgICdtYWluX2R0dG1fY29sJyxcbiAgICAgICAgICAgICAgJ2ZpbHRlcmFibGUnLFxuICAgICAgICAgICAgICAnZ3JvdXBieScsXG4gICAgICAgICAgICBdXG4gICAgICB9XG4gICAgICBhbGxvd0RlbGV0ZXNcbiAgICAgIGFsbG93QWRkSXRlbT17YWxsb3dBZGRJdGVtfVxuICAgICAgaXRlbUdlbmVyYXRvcj17aXRlbUdlbmVyYXRvcn1cbiAgICAgIGNvbGxlY3Rpb249e2NvbHVtbnN9XG4gICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXtjb2x1bW5MYWJlbFRvb2x0aXBzfVxuICAgICAgc3RpY2t5SGVhZGVyXG4gICAgICBleHBhbmRGaWVsZHNldD17XG4gICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgIDxGaWVsZHNldCBjb21wYWN0PlxuICAgICAgICAgICAge3Nob3dFeHByZXNzaW9uICYmIChcbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJleHByZXNzaW9uXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMIGV4cHJlc3Npb24nKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJtYXJrZG93blwiXG4gICAgICAgICAgICAgICAgICAgIG9mZmVyRWRpdEluTW9kYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnTGFiZWwnKX1cbiAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ2ZXJib3NlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0xhYmVsJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHthbGxvd0VkaXREYXRhVHlwZSAmJiAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidHlwZVwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICBhcmlhTGFiZWw9e3QoJ0RhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zPXtEQVRBX1RZUEVTfVxuICAgICAgICAgICAgICAgICAgICBuYW1lPVwidHlwZVwiXG4gICAgICAgICAgICAgICAgICAgIGFsbG93TmV3T3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICBhbGxvd0NsZWFyXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICB7aXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5FbmFibGVBZHZhbmNlZERhdGFUeXBlcykgPyAoXG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnQWR2YW5jZWQgZGF0YSB0eXBlJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiYWR2YW5jZWRfZGF0YV90eXBlXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0FkdmFuY2VkIERhdGEgdHlwZScpfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8PjwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICBmaWVsZEtleT1cInB5dGhvbl9kYXRlX2Zvcm1hdFwiXG4gICAgICAgICAgICAgIGxhYmVsPXt0KCdEYXRldGltZSBmb3JtYXQnKX1cbiAgICAgICAgICAgICAgZGVzY3JpcHRpb249e1xuICAgICAgICAgICAgICAgIC8qIE5vdGUgdGhlIGZyYWdtZW50ZWQgdHJhbnNsYXRpb25zIG1heSBub3Qgd29yay4gKi9cbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAge3QoJ1RoZSBwYXR0ZXJuIG9mIHRpbWVzdGFtcCBmb3JtYXQuIEZvciBzdHJpbmdzIHVzZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2RvY3MucHl0aG9uLm9yZy8yL2xpYnJhcnkvZGF0ZXRpbWUuaHRtbCNzdHJmdGltZS1zdHJwdGltZS1iZWhhdmlvclwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnUHl0aG9uIGRhdGV0aW1lIHN0cmluZyBwYXR0ZXJuJyl9XG4gICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICB7dCgnIGV4cHJlc3Npb24gd2hpY2ggbmVlZHMgdG8gYWRoZXJlIHRvIHRoZSAnKX1cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9JU09fODYwMVwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnSVNPIDg2MDEnKX1cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgIHt0KGAgc3RhbmRhcmQgdG8gZW5zdXJlIHRoYXQgdGhlIGxleGljb2dyYXBoaWNhbCBvcmRlcmluZ1xuICAgICAgICAgICAgICAgICAgICAgIGNvaW5jaWRlcyB3aXRoIHRoZSBjaHJvbm9sb2dpY2FsIG9yZGVyaW5nLiBJZiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgZm9ybWF0IGRvZXMgbm90IGFkaGVyZSB0byB0aGUgSVNPIDg2MDEgc3RhbmRhcmRcbiAgICAgICAgICAgICAgICAgICAgICB5b3Ugd2lsbCBuZWVkIHRvIGRlZmluZSBhbiBleHByZXNzaW9uIGFuZCB0eXBlIGZvclxuICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWluZyB0aGUgc3RyaW5nIGludG8gYSBkYXRlIG9yIHRpbWVzdGFtcC4gTm90ZVxuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseSB0aW1lIHpvbmVzIGFyZSBub3Qgc3VwcG9ydGVkLiBJZiB0aW1lIGlzIHN0b3JlZFxuICAgICAgICAgICAgICAgICAgICAgIGluIGVwb2NoIGZvcm1hdCwgcHV0IFxcYGVwb2NoX3NcXGAgb3IgXFxgZXBvY2hfbXNcXGAuIElmIG5vIHBhdHRlcm5cbiAgICAgICAgICAgICAgICAgICAgICBpcyBzcGVjaWZpZWQgd2UgZmFsbCBiYWNrIHRvIHVzaW5nIHRoZSBvcHRpb25hbCBkZWZhdWx0cyBvbiBhIHBlclxuICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlL2NvbHVtbiBuYW1lIGxldmVsIHZpYSB0aGUgZXh0cmEgcGFyYW1ldGVyLmApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwicHl0aG9uX2RhdGVfZm9ybWF0XCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiJVktJW0tJWRcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgZmllbGRLZXk9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICBsYWJlbD17dCgnQ2VydGlmaWVkIEJ5Jyl9XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgY29udHJvbElkPVwiY2VydGlmaWVkXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25EZXRhaWxzXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICAgIDwvRm9ybUNvbnRhaW5lcj5cbiAgICAgIH1cbiAgICAgIGNvbHVtbkxhYmVscz17XG4gICAgICAgIGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRW5hYmxlQWR2YW5jZWREYXRhVHlwZXMpXG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCdDb2x1bW4nKSxcbiAgICAgICAgICAgICAgYWR2YW5jZWRfZGF0YV90eXBlOiB0KCdBZHZhbmNlZCBkYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgdHlwZTogdCgnRGF0YSB0eXBlJyksXG4gICAgICAgICAgICAgIGdyb3VwYnk6IHQoJ0lzIGRpbWVuc2lvbicpLFxuICAgICAgICAgICAgICBpc19kdHRtOiB0KCdJcyB0ZW1wb3JhbCcpLFxuICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiB0KCdEZWZhdWx0IGRhdGV0aW1lJyksXG4gICAgICAgICAgICAgIGZpbHRlcmFibGU6IHQoJ0lzIGZpbHRlcmFibGUnKSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgY29sdW1uX25hbWU6IHQoJ0NvbHVtbicpLFxuICAgICAgICAgICAgICB0eXBlOiB0KCdEYXRhIHR5cGUnKSxcbiAgICAgICAgICAgICAgZ3JvdXBieTogdCgnSXMgZGltZW5zaW9uJyksXG4gICAgICAgICAgICAgIGlzX2R0dG06IHQoJ0lzIHRlbXBvcmFsJyksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6IHQoJ0RlZmF1bHQgZGF0ZXRpbWUnKSxcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogdCgnSXMgZmlsdGVyYWJsZScpLFxuICAgICAgICAgICAgfVxuICAgICAgfVxuICAgICAgb25DaGFuZ2U9e29uQ29sdW1uc0NoYW5nZX1cbiAgICAgIGl0ZW1SZW5kZXJlcnM9e1xuICAgICAgICBpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkVuYWJsZUFkdmFuY2VkRGF0YVR5cGVzKVxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZVxuICAgICAgICAgICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17dn1cbiAgICAgICAgICAgICAgICAgICAgICBvblNhdmVUaXRsZT17b25JdGVtQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dn1cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkTGFiZWxXcmFwcGVyPlxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIG1haW5fZHR0bV9jb2w6ICh2YWx1ZSwgX29uSXRlbUNoYW5nZSwgX2xhYmVsLCByZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGVja2VkID0gZGF0YXNvdXJjZS5tYWluX2R0dG1fY29sID09PSByZWNvcmQuY29sdW1uX25hbWU7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlzYWJsZWQgPSAhY29sdW1ucy5maW5kKFxuICAgICAgICAgICAgICAgICAgY29sdW1uID0+IGNvbHVtbi5jb2x1bW5fbmFtZSA9PT0gcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICkuaXNfZHR0bTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdD17YHJhZGlvLWRlZmF1bHQtZHR0bS0ke3JlY29yZC5jb2x1bW5fbmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtjaGVja2VkfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogcmVjb3JkLmNvbHVtbl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdHlwZTogZCA9PiAoZCA/IDxMYWJlbD57ZH08L0xhYmVsPiA6IG51bGwpLFxuICAgICAgICAgICAgICBhZHZhbmNlZF9kYXRhX3R5cGU6IGQgPT4gKFxuICAgICAgICAgICAgICAgIDxMYWJlbCBvbkNoYW5nZT17b25Db2x1bW5zQ2hhbmdlfT57ZH08L0xhYmVsPlxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBpc19kdHRtOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZmlsdGVyYWJsZTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICAgIGdyb3VwYnk6IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDoge1xuICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogKHYsIG9uSXRlbUNoYW5nZSwgXywgcmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgIGVkaXRhYmxlQ29sdW1uTmFtZSA/IChcbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2wgdmFsdWU9e3Z9IG9uQ2hhbmdlPXtvbkl0ZW1DaGFuZ2V9IC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZExhYmVsV3JhcHBlcj5cbiAgICAgICAgICAgICAgICAgICAge3JlY29yZC5pc19jZXJ0aWZpZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxDZXJ0aWZpZWRCYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWVkQnk9e3JlY29yZC5jZXJ0aWZpZWRfYnl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzPXtyZWNvcmQuY2VydGlmaWNhdGlvbl9kZXRhaWxzfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIHt2fVxuICAgICAgICAgICAgICAgICAgPC9TdHlsZWRMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgbWFpbl9kdHRtX2NvbDogKHZhbHVlLCBfb25JdGVtQ2hhbmdlLCBfbGFiZWwsIHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSBkYXRhc291cmNlLm1haW5fZHR0bV9jb2wgPT09IHJlY29yZC5jb2x1bW5fbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICFjb2x1bW5zLmZpbmQoXG4gICAgICAgICAgICAgICAgICBjb2x1bW4gPT4gY29sdW1uLmNvbHVtbl9uYW1lID09PSByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgKS5pc19kdHRtO1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0PXtgcmFkaW8tZGVmYXVsdC1kdHRtLSR7cmVjb3JkLmNvbHVtbl9uYW1lfWB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NoZWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+XG4gICAgICAgICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRhdGFzb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluX2R0dG1fY29sOiByZWNvcmQuY29sdW1uX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0eXBlOiBkID0+IChkID8gPExhYmVsPntkfTwvTGFiZWw+IDogbnVsbCksXG4gICAgICAgICAgICAgIGlzX2R0dG06IGNoZWNrYm94R2VuZXJhdG9yLFxuICAgICAgICAgICAgICBmaWx0ZXJhYmxlOiBjaGVja2JveEdlbmVyYXRvcixcbiAgICAgICAgICAgICAgZ3JvdXBieTogY2hlY2tib3hHZW5lcmF0b3IsXG4gICAgICAgICAgICB9XG4gICAgICB9XG4gICAgLz5cbiAgKTtcbn1cbkNvbHVtbkNvbGxlY3Rpb25UYWJsZS5wcm9wVHlwZXMgPSB7XG4gIGNvbHVtbnM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ29sdW1uc0NoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25EYXRhc291cmNlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBlZGl0YWJsZUNvbHVtbk5hbWU6IFByb3BUeXBlcy5ib29sLFxuICBzaG93RXhwcmVzc2lvbjogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93QWRkSXRlbTogUHJvcFR5cGVzLmJvb2wsXG4gIGFsbG93RWRpdERhdGFUeXBlOiBQcm9wVHlwZXMuYm9vbCxcbiAgaXRlbUdlbmVyYXRvcjogUHJvcFR5cGVzLmZ1bmMsXG59O1xuQ29sdW1uQ29sbGVjdGlvblRhYmxlLmRlZmF1bHRQcm9wcyA9IHtcbiAgZWRpdGFibGVDb2x1bW5OYW1lOiBmYWxzZSxcbiAgc2hvd0V4cHJlc3Npb246IGZhbHNlLFxuICBhbGxvd0FkZEl0ZW06IGZhbHNlLFxuICBhbGxvd0VkaXREYXRhVHlwZTogZmFsc2UsXG4gIGl0ZW1HZW5lcmF0b3I6ICgpID0+ICh7XG4gICAgY29sdW1uX25hbWU6IHQoJzxuZXcgY29sdW1uPicpLFxuICAgIGZpbHRlcmFibGU6IHRydWUsXG4gICAgZ3JvdXBieTogdHJ1ZSxcbiAgfSksXG59O1xuXG5mdW5jdGlvbiBTdGFja2VkRmllbGQoeyBsYWJlbCwgZm9ybUVsZW1lbnQgfSkge1xuICByZXR1cm4gKFxuICAgIDxkaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICA8c3Ryb25nPntsYWJlbH08L3N0cm9uZz5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj57Zm9ybUVsZW1lbnR9PC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cblN0YWNrZWRGaWVsZC5wcm9wVHlwZXMgPSB7XG4gIGxhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBmb3JtRWxlbWVudDogUHJvcFR5cGVzLm5vZGUsXG59O1xuXG5mdW5jdGlvbiBGb3JtQ29udGFpbmVyKHsgY2hpbGRyZW4gfSkge1xuICByZXR1cm4gPENhcmQgcGFkZGVkPntjaGlsZHJlbn08L0NhcmQ+O1xufVxuXG5Gb3JtQ29udGFpbmVyLnByb3BUeXBlcyA9IHtcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5ub2RlLFxufTtcblxuY29uc3QgcHJvcFR5cGVzID0ge1xuICBkYXRhc291cmNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgYWRkU3VjY2Vzc1RvYXN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBhZGREYW5nZXJUb2FzdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgc2V0SXNFZGl0aW5nOiBQcm9wVHlwZXMuZnVuYyxcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgb25DaGFuZ2U6ICgpID0+IHt9LFxuICBzZXRJc0VkaXRpbmc6ICgpID0+IHt9LFxufTtcblxuZnVuY3Rpb24gT3duZXJzU2VsZWN0b3IoeyBkYXRhc291cmNlLCBvbkNoYW5nZSB9KSB7XG4gIGNvbnN0IGxvYWRPcHRpb25zID0gdXNlQ2FsbGJhY2soKHNlYXJjaCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gcmlzb24uZW5jb2RlKHsgZmlsdGVyOiBzZWFyY2gsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgcmV0dXJuIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGF0YXNldC9yZWxhdGVkL293bmVycz9xPSR7cXVlcnl9YCxcbiAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdFxuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5leHRyYS5hY3RpdmUpXG4gICAgICAgIC5tYXAoaXRlbSA9PiAoe1xuICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgIH0pKSxcbiAgICAgIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQsXG4gICAgfSkpO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8QXN5bmNTZWxlY3RcbiAgICAgIGFyaWFMYWJlbD17dCgnU2VsZWN0IG93bmVycycpfVxuICAgICAgbW9kZT1cIm11bHRpcGxlXCJcbiAgICAgIG5hbWU9XCJvd25lcnNcIlxuICAgICAgdmFsdWU9e2RhdGFzb3VyY2Uub3duZXJzfVxuICAgICAgb3B0aW9ucz17bG9hZE9wdGlvbnN9XG4gICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICBoZWFkZXI9ezxGb3JtTGFiZWw+e3QoJ093bmVycycpfTwvRm9ybUxhYmVsPn1cbiAgICAgIGFsbG93Q2xlYXJcbiAgICAvPlxuICApO1xufVxuXG5jbGFzcyBEYXRhc291cmNlRWRpdG9yIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBkYXRhc291cmNlOiB7XG4gICAgICAgIC4uLnByb3BzLmRhdGFzb3VyY2UsXG4gICAgICAgIG93bmVyczogcHJvcHMuZGF0YXNvdXJjZS5vd25lcnMubWFwKG93bmVyID0+ICh7XG4gICAgICAgICAgdmFsdWU6IG93bmVyLnZhbHVlIHx8IG93bmVyLmlkLFxuICAgICAgICAgIGxhYmVsOiBvd25lci5sYWJlbCB8fCBgJHtvd25lci5maXJzdF9uYW1lfSAke293bmVyLmxhc3RfbmFtZX1gLFxuICAgICAgICB9KSksXG4gICAgICAgIG1ldHJpY3M6IHByb3BzLmRhdGFzb3VyY2UubWV0cmljcz8ubWFwKG1ldHJpYyA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWNhdGlvbkRldGFpbHMsXG4gICAgICAgICAgfSA9IG1ldHJpYztcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0aW9uOiB7IGRldGFpbHMsIGNlcnRpZmllZF9ieTogY2VydGlmaWVkQnkgfSA9IHt9LFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duLFxuICAgICAgICAgIH0gPSBKU09OLnBhcnNlKG1ldHJpYy5leHRyYSB8fCAne30nKSB8fCB7fTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4ubWV0cmljLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbl9kZXRhaWxzOiBjZXJ0aWZpY2F0aW9uRGV0YWlscyB8fCBkZXRhaWxzLFxuICAgICAgICAgICAgd2FybmluZ19tYXJrZG93bjogd2FybmluZ01hcmtkb3duIHx8ICcnLFxuICAgICAgICAgICAgY2VydGlmaWVkX2J5OiBjZXJ0aWZpZWRCeSB8fCBjZXJ0aWZpZWRCeU1ldHJpYyxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgaXNTcWxhOlxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLmRhdGFzb3VyY2VfdHlwZSA9PT0gJ3RhYmxlJyB8fFxuICAgICAgICBwcm9wcy5kYXRhc291cmNlLnR5cGUgPT09ICd0YWJsZScsXG4gICAgICBpc0VkaXRNb2RlOiBmYWxzZSxcbiAgICAgIGRhdGFiYXNlQ29sdW1uczogcHJvcHMuZGF0YXNvdXJjZS5jb2x1bW5zLmZpbHRlcihjb2wgPT4gIWNvbC5leHByZXNzaW9uKSxcbiAgICAgIGNhbGN1bGF0ZWRDb2x1bW5zOiBwcm9wcy5kYXRhc291cmNlLmNvbHVtbnMuZmlsdGVyKFxuICAgICAgICBjb2wgPT4gISFjb2wuZXhwcmVzc2lvbixcbiAgICAgICksXG4gICAgICBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlLFxuICAgICAgYWN0aXZlVGFiS2V5OiAwLFxuICAgICAgZGF0YXNvdXJjZVR5cGU6IHByb3BzLmRhdGFzb3VyY2Uuc3FsXG4gICAgICAgID8gREFUQVNPVVJDRV9UWVBFUy52aXJ0dWFsLmtleVxuICAgICAgICA6IERBVEFTT1VSQ0VfVFlQRVMucGh5c2ljYWwua2V5LFxuICAgIH07XG5cbiAgICB0aGlzLm9uQ2hhbmdlID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25DaGFuZ2VFZGl0TW9kZSA9IHRoaXMub25DaGFuZ2VFZGl0TW9kZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSA9IHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25EYXRhc291cmNlQ2hhbmdlID0gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLnRhYmxlQ2hhbmdlQW5kU3luY01ldGFkYXRhID1cbiAgICAgIHRoaXMudGFibGVDaGFuZ2VBbmRTeW5jTWV0YWRhdGEuYmluZCh0aGlzKTtcbiAgICB0aGlzLnN5bmNNZXRhZGF0YSA9IHRoaXMuc3luY01ldGFkYXRhLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZXRDb2x1bW5zID0gdGhpcy5zZXRDb2x1bW5zLmJpbmQodGhpcyk7XG4gICAgdGhpcy52YWxpZGF0ZUFuZENoYW5nZSA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZVRhYlNlbGVjdCA9IHRoaXMuaGFuZGxlVGFiU2VsZWN0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5jdXJyZW5jaWVzID0gZW5zdXJlSXNBcnJheShwcm9wcy5jdXJyZW5jaWVzKS5tYXAoY3VycmVuY3lDb2RlID0+ICh7XG4gICAgICB2YWx1ZTogY3VycmVuY3lDb2RlLFxuICAgICAgbGFiZWw6IGAke2dldEN1cnJlbmN5U3ltYm9sKHtcbiAgICAgICAgc3ltYm9sOiBjdXJyZW5jeUNvZGUsXG4gICAgICB9KX0gKCR7Y3VycmVuY3lDb2RlfSlgLFxuICAgIH0pKTtcbiAgfVxuXG4gIG9uQ2hhbmdlKCkge1xuICAgIC8vIEVtcHR5aW5nIFNRTCBpZiBcIlBoeXNpY2FsXCIgcmFkaW8gYnV0dG9uIGlzIHNlbGVjdGVkXG4gICAgLy8gQ3VycmVudGx5IHRoZSBsb2dpYyB0byBrbm93IHdoZXRoZXIgdGhlIHNvdXJjZSBpc1xuICAgIC8vIHBoeXNpY2FsIG9yIHZpcnR1YWwgaXMgYmFzZWQgb24gd2hldGhlciBTUUwgaXMgZW1wdHkgb3Igbm90LlxuICAgIGNvbnN0IHsgZGF0YXNvdXJjZVR5cGUsIGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qgc3FsID1cbiAgICAgIGRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSA/ICcnIDogZGF0YXNvdXJjZS5zcWw7XG4gICAgY29uc3QgbmV3RGF0YXNvdXJjZSA9IHtcbiAgICAgIC4uLnRoaXMuc3RhdGUuZGF0YXNvdXJjZSxcbiAgICAgIHNxbCxcbiAgICAgIGNvbHVtbnM6IFsuLi50aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1ucywgLi4udGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc10sXG4gICAgfTtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKG5ld0RhdGFzb3VyY2UsIHRoaXMuc3RhdGUuZXJyb3JzKTtcbiAgfVxuXG4gIG9uQ2hhbmdlRWRpdE1vZGUoKSB7XG4gICAgdGhpcy5wcm9wcy5zZXRJc0VkaXRpbmcoIXRoaXMuc3RhdGUuaXNFZGl0TW9kZSk7XG4gICAgdGhpcy5zZXRTdGF0ZShwcmV2U3RhdGUgPT4gKHsgaXNFZGl0TW9kZTogIXByZXZTdGF0ZS5pc0VkaXRNb2RlIH0pKTtcbiAgfVxuXG4gIG9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCBjYWxsYmFjayA9IHRoaXMudmFsaWRhdGVBbmRDaGFuZ2UpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGF0YXNvdXJjZSB9LCBjYWxsYmFjayk7XG4gIH1cblxuICBvbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKGF0dHIsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjsgLy8gaWYgdmFsdWUgaXMgdW5kZWZpbmVkIGRvIG5vdCB1cGRhdGUgc3RhdGVcbiAgICBjb25zdCBkYXRhc291cmNlID0geyAuLi50aGlzLnN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfTtcbiAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgcHJldlN0YXRlID0+ICh7XG4gICAgICAgIGRhdGFzb3VyY2U6IHsgLi4ucHJldlN0YXRlLmRhdGFzb3VyY2UsIFthdHRyXTogdmFsdWUgfSxcbiAgICAgIH0pLFxuICAgICAgYXR0ciA9PT0gJ3RhYmxlX25hbWUnXG4gICAgICAgID8gdGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2UoZGF0YXNvdXJjZSwgdGhpcy50YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSlcbiAgICAgICAgOiB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZShkYXRhc291cmNlLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKSxcbiAgICApO1xuICB9XG5cbiAgb25EYXRhc291cmNlVHlwZUNoYW5nZShkYXRhc291cmNlVHlwZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhc291cmNlVHlwZSB9KTtcbiAgfVxuXG4gIHNldENvbHVtbnMob2JqKSB7XG4gICAgLy8gdXBkYXRlIGNhbGN1bGF0ZWRDb2x1bW5zIG9yIGRhdGFiYXNlQ29sdW1uc1xuICAgIHRoaXMuc2V0U3RhdGUob2JqLCB0aGlzLnZhbGlkYXRlQW5kQ2hhbmdlKTtcbiAgfVxuXG4gIHZhbGlkYXRlQW5kQ2hhbmdlKCkge1xuICAgIHRoaXMudmFsaWRhdGUodGhpcy5vbkNoYW5nZSk7XG4gIH1cblxuICB0YWJsZUNoYW5nZUFuZFN5bmNNZXRhZGF0YSgpIHtcbiAgICB0aGlzLnZhbGlkYXRlKCgpID0+IHtcbiAgICAgIHRoaXMuc3luY01ldGFkYXRhKCk7XG4gICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVDb2x1bW5zKGNvbHMpIHtcbiAgICAvLyBjb2xzOiBBcnJheTx7Y29sdW1uX25hbWU6IHN0cmluZzsgaXNfZHR0bTogYm9vbGVhbjsgdHlwZTogc3RyaW5nO30+XG4gICAgY29uc3QgeyBkYXRhYmFzZUNvbHVtbnMgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgZGF0YWJhc2VDb2x1bW5OYW1lcyA9IGNvbHMubWFwKGNvbCA9PiBjb2wuY29sdW1uX25hbWUpO1xuICAgIGNvbnN0IGN1cnJlbnRDb2xzID0gZGF0YWJhc2VDb2x1bW5zLnJlZHVjZShcbiAgICAgIChhZ2csIGNvbCkgPT4gKHtcbiAgICAgICAgLi4uYWdnLFxuICAgICAgICBbY29sLmNvbHVtbl9uYW1lXTogY29sLFxuICAgICAgfSksXG4gICAgICB7fSxcbiAgICApO1xuICAgIGNvbnN0IGZpbmFsQ29sdW1ucyA9IFtdO1xuICAgIGNvbnN0IHJlc3VsdHMgPSB7XG4gICAgICBhZGRlZDogW10sXG4gICAgICBtb2RpZmllZDogW10sXG4gICAgICByZW1vdmVkOiBkYXRhYmFzZUNvbHVtbnNcbiAgICAgICAgLm1hcChjb2wgPT4gY29sLmNvbHVtbl9uYW1lKVxuICAgICAgICAuZmlsdGVyKGNvbCA9PiAhZGF0YWJhc2VDb2x1bW5OYW1lcy5pbmNsdWRlcyhjb2wpKSxcbiAgICB9O1xuICAgIGNvbHMuZm9yRWFjaChjb2wgPT4ge1xuICAgICAgY29uc3QgY3VycmVudENvbCA9IGN1cnJlbnRDb2xzW2NvbC5jb2x1bW5fbmFtZV07XG4gICAgICBpZiAoIWN1cnJlbnRDb2wpIHtcbiAgICAgICAgLy8gbmV3IGNvbHVtblxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaCh7XG4gICAgICAgICAgaWQ6IG5hbm9pZCgpLFxuICAgICAgICAgIGNvbHVtbl9uYW1lOiBjb2wuY29sdW1uX25hbWUsXG4gICAgICAgICAgdHlwZTogY29sLnR5cGUsXG4gICAgICAgICAgZ3JvdXBieTogdHJ1ZSxcbiAgICAgICAgICBmaWx0ZXJhYmxlOiB0cnVlLFxuICAgICAgICAgIGlzX2R0dG06IGNvbC5pc19kdHRtLFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0cy5hZGRlZC5wdXNoKGNvbC5jb2x1bW5fbmFtZSk7XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICBjdXJyZW50Q29sLnR5cGUgIT09IGNvbC50eXBlIHx8XG4gICAgICAgICghY3VycmVudENvbC5pc19kdHRtICYmIGNvbC5pc19kdHRtKVxuICAgICAgKSB7XG4gICAgICAgIC8vIG1vZGlmaWVkIGNvbHVtblxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaCh7XG4gICAgICAgICAgLi4uY3VycmVudENvbCxcbiAgICAgICAgICB0eXBlOiBjb2wudHlwZSxcbiAgICAgICAgICBpc19kdHRtOiBjdXJyZW50Q29sLmlzX2R0dG0gfHwgY29sLmlzX2R0dG0sXG4gICAgICAgIH0pO1xuICAgICAgICByZXN1bHRzLm1vZGlmaWVkLnB1c2goY29sLmNvbHVtbl9uYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHVuY2hhbmdlZFxuICAgICAgICBmaW5hbENvbHVtbnMucHVzaChjdXJyZW50Q29sKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoXG4gICAgICByZXN1bHRzLmFkZGVkLmxlbmd0aCB8fFxuICAgICAgcmVzdWx0cy5tb2RpZmllZC5sZW5ndGggfHxcbiAgICAgIHJlc3VsdHMucmVtb3ZlZC5sZW5ndGhcbiAgICApIHtcbiAgICAgIHRoaXMuc2V0Q29sdW1ucyh7IGRhdGFiYXNlQ29sdW1uczogZmluYWxDb2x1bW5zIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxuXG4gIHN5bmNNZXRhZGF0YSgpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgZGF0YXNvdXJjZV90eXBlOiBkYXRhc291cmNlLnR5cGUgfHwgZGF0YXNvdXJjZS5kYXRhc291cmNlX3R5cGUsXG4gICAgICBkYXRhYmFzZV9uYW1lOlxuICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlLmRhdGFiYXNlX25hbWUgfHwgZGF0YXNvdXJjZS5kYXRhYmFzZS5uYW1lLFxuICAgICAgY2F0YWxvZ19uYW1lOiBkYXRhc291cmNlLmNhdGFsb2csXG4gICAgICBzY2hlbWFfbmFtZTogZGF0YXNvdXJjZS5zY2hlbWEsXG4gICAgICB0YWJsZV9uYW1lOiBkYXRhc291cmNlLnRhYmxlX25hbWUsXG4gICAgICBub3JtYWxpemVfY29sdW1uczogZGF0YXNvdXJjZS5ub3JtYWxpemVfY29sdW1ucyxcbiAgICAgIGFsd2F5c19maWx0ZXJfbWFpbl9kdHRtOiBkYXRhc291cmNlLmFsd2F5c19maWx0ZXJfbWFpbl9kdHRtLFxuICAgIH07XG4gICAgT2JqZWN0LmVudHJpZXMocGFyYW1zKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIC8vIHJpc29uIGNhbid0IGVuY29kZSB0aGUgdW5kZWZpbmVkIHZhbHVlXG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwYXJhbXNba2V5XSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgZW5kcG9pbnQgPSBgL2RhdGFzb3VyY2UvZXh0ZXJuYWxfbWV0YWRhdGFfYnlfbmFtZS8/cT0ke3Jpc29uLmVuY29kZV91cmkoXG4gICAgICBwYXJhbXMsXG4gICAgKX1gO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IHRydWUgfSk7XG5cbiAgICBTdXBlcnNldENsaWVudC5nZXQoeyBlbmRwb2ludCB9KVxuICAgICAgLnRoZW4oKHsganNvbiB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLnVwZGF0ZUNvbHVtbnMoanNvbik7XG4gICAgICAgIGlmIChyZXN1bHRzLm1vZGlmaWVkLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMucHJvcHMuYWRkU3VjY2Vzc1RvYXN0KFxuICAgICAgICAgICAgdCgnTW9kaWZpZWQgY29sdW1uczogJXMnLCByZXN1bHRzLm1vZGlmaWVkLmpvaW4oJywgJykpLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdHMucmVtb3ZlZC5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdChcbiAgICAgICAgICAgIHQoJ1JlbW92ZWQgY29sdW1uczogJXMnLCByZXN1bHRzLnJlbW92ZWQuam9pbignLCAnKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0cy5hZGRlZC5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdChcbiAgICAgICAgICAgIHQoJ05ldyBjb2x1bW5zIGFkZGVkOiAlcycsIHJlc3VsdHMuYWRkZWQuam9pbignLCAnKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3BzLmFkZFN1Y2Nlc3NUb2FzdCh0KCdNZXRhZGF0YSBoYXMgYmVlbiBzeW5jZWQnKSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZXRhZGF0YUxvYWRpbmc6IGZhbHNlIH0pO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChyZXNwb25zZSA9PlxuICAgICAgICBnZXRDbGllbnRFcnJvck9iamVjdChyZXNwb25zZSkudGhlbigoeyBlcnJvciwgc3RhdHVzVGV4dCB9KSA9PiB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5hZGREYW5nZXJUb2FzdChcbiAgICAgICAgICAgIGVycm9yIHx8IHN0YXR1c1RleHQgfHwgdCgnQW4gZXJyb3IgaGFzIG9jY3VycmVkJyksXG4gICAgICAgICAgKTtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgbWV0YWRhdGFMb2FkaW5nOiBmYWxzZSB9KTtcbiAgICAgICAgfSksXG4gICAgICApO1xuICB9XG5cbiAgZmluZER1cGxpY2F0ZXMoYXJyLCBhY2Nlc3Nvcikge1xuICAgIGNvbnN0IHNlZW4gPSB7fTtcbiAgICBjb25zdCBkdXBzID0gW107XG4gICAgYXJyLmZvckVhY2gob2JqID0+IHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBhY2Nlc3NvcihvYmopO1xuICAgICAgaWYgKGl0ZW0gaW4gc2Vlbikge1xuICAgICAgICBkdXBzLnB1c2goaXRlbSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWVuW2l0ZW1dID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZHVwcztcbiAgfVxuXG4gIHZhbGlkYXRlKGNhbGxiYWNrKSB7XG4gICAgbGV0IGVycm9ycyA9IFtdO1xuICAgIGxldCBkdXBzO1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIC8vIExvb2tpbmcgZm9yIGR1cGxpY2F0ZSBjb2x1bW5fbmFtZVxuICAgIGR1cHMgPSB0aGlzLmZpbmREdXBsaWNhdGVzKGRhdGFzb3VyY2UuY29sdW1ucywgb2JqID0+IG9iai5jb2x1bW5fbmFtZSk7XG4gICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChcbiAgICAgIGR1cHMubWFwKG5hbWUgPT4gdCgnQ29sdW1uIG5hbWUgWyVzXSBpcyBkdXBsaWNhdGVkJywgbmFtZSkpLFxuICAgICk7XG5cbiAgICAvLyBMb29raW5nIGZvciBkdXBsaWNhdGUgbWV0cmljX25hbWVcbiAgICBkdXBzID0gdGhpcy5maW5kRHVwbGljYXRlcyhkYXRhc291cmNlLm1ldHJpY3MsIG9iaiA9PiBvYmoubWV0cmljX25hbWUpO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBkdXBzLm1hcChuYW1lID0+IHQoJ01ldHJpYyBuYW1lIFslc10gaXMgZHVwbGljYXRlZCcsIG5hbWUpKSxcbiAgICApO1xuXG4gICAgLy8gTWFraW5nIHN1cmUgY2FsY3VsYXRlZENvbHVtbnMgaGF2ZSBhbiBleHByZXNzaW9uIGRlZmluZWRcbiAgICBjb25zdCBub0ZpbHRlckNhbGNDb2xzID0gdGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1ucy5maWx0ZXIoXG4gICAgICBjb2wgPT4gIWNvbC5leHByZXNzaW9uICYmICFjb2wuanNvbixcbiAgICApO1xuICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoXG4gICAgICBub0ZpbHRlckNhbGNDb2xzLm1hcChjb2wgPT5cbiAgICAgICAgdCgnQ2FsY3VsYXRlZCBjb2x1bW4gWyVzXSByZXF1aXJlcyBhbiBleHByZXNzaW9uJywgY29sLmNvbHVtbl9uYW1lKSxcbiAgICAgICksXG4gICAgKTtcblxuICAgIC8vIHZhbGlkYXRlIGN1cnJlbmN5IGNvZGVcbiAgICB0cnkge1xuICAgICAgdGhpcy5zdGF0ZS5kYXRhc291cmNlLm1ldHJpY3M/LmZvckVhY2goXG4gICAgICAgIG1ldHJpYyA9PlxuICAgICAgICAgIG1ldHJpYy5jdXJyZW5jeT8uc3ltYm9sICYmXG4gICAgICAgICAgbmV3IEludGwuTnVtYmVyRm9ybWF0KCdlbi1VUycsIHtcbiAgICAgICAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgICAgICAgY3VycmVuY3k6IG1ldHJpYy5jdXJyZW5jeS5zeW1ib2wsXG4gICAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0gY2F0Y2gge1xuICAgICAgZXJyb3JzID0gZXJyb3JzLmNvbmNhdChbdCgnSW52YWxpZCBjdXJyZW5jeSBjb2RlIGluIHNhdmVkIG1ldHJpY3MnKV0pO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoeyBlcnJvcnMgfSwgY2FsbGJhY2spO1xuICB9XG5cbiAgaGFuZGxlVGFiU2VsZWN0KGFjdGl2ZVRhYktleSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBhY3RpdmVUYWJLZXkgfSk7XG4gIH1cblxuICBzb3J0TWV0cmljcyhtZXRyaWNzKSB7XG4gICAgcmV0dXJuIG1ldHJpY3Muc29ydCgoeyBpZDogYSB9LCB7IGlkOiBiIH0pID0+IGIgLSBhKTtcbiAgfVxuXG4gIHJlbmRlclNldHRpbmdzRmllbGRzZXQoKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8RmllbGRzZXRcbiAgICAgICAgdGl0bGU9e3QoJ0Jhc2ljJyl9XG4gICAgICAgIGl0ZW09e2RhdGFzb3VyY2V9XG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX1cbiAgICAgID5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgZmllbGRLZXk9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwibWFya2Rvd25cIlxuICAgICAgICAgICAgICBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX1cbiAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiZGVmYXVsdF9lbmRwb2ludFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0RlZmF1bHQgVVJMJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAnRGVmYXVsdCBVUkwgdG8gcmVkaXJlY3QgdG8gd2hlbiBhY2Nlc3NpbmcgZnJvbSB0aGUgZGF0YXNldCBsaXN0IHBhZ2UnLFxuICAgICAgICAgICl9XG4gICAgICAgICAgY29udHJvbD17PFRleHRDb250cm9sIGNvbnRyb2xJZD1cImRlZmF1bHRfZW5kcG9pbnRcIiAvPn1cbiAgICAgICAgLz5cbiAgICAgICAgPEZpZWxkXG4gICAgICAgICAgaW5saW5lXG4gICAgICAgICAgZmllbGRLZXk9XCJmaWx0ZXJfc2VsZWN0X2VuYWJsZWRcIlxuICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgZmlsdGVycycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KCdXaGV0aGVyIHRvIHBvcHVsYXRlIGF1dG9jb21wbGV0ZSBmaWx0ZXJzIG9wdGlvbnMnKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIC8+fVxuICAgICAgICAvPlxuICAgICAgICB7dGhpcy5zdGF0ZS5pc1NxbGEgJiYgKFxuICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgZmllbGRLZXk9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgIGxhYmVsPXt0KCdBdXRvY29tcGxldGUgcXVlcnkgcHJlZGljYXRlJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ1doZW4gdXNpbmcgXCJBdXRvY29tcGxldGUgZmlsdGVyc1wiLCB0aGlzIGNhbiBiZSB1c2VkIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UgJyArXG4gICAgICAgICAgICAgICAgJ29mIHRoZSBxdWVyeSBmZXRjaGluZyB0aGUgdmFsdWVzLiBVc2UgdGhpcyBvcHRpb24gdG8gYXBwbHkgYSAnICtcbiAgICAgICAgICAgICAgICAncHJlZGljYXRlIChXSEVSRSBjbGF1c2UpIHRvIHRoZSBxdWVyeSBzZWxlY3RpbmcgdGhlIGRpc3RpbmN0ICcgK1xuICAgICAgICAgICAgICAgICd2YWx1ZXMgZnJvbSB0aGUgdGFibGUuIFR5cGljYWxseSB0aGUgaW50ZW50IHdvdWxkIGJlIHRvIGxpbWl0IHRoZSBzY2FuICcgK1xuICAgICAgICAgICAgICAgICdieSBhcHBseWluZyBhIHJlbGF0aXZlIHRpbWUgZmlsdGVyIG9uIGEgcGFydGl0aW9uZWQgb3IgaW5kZXhlZCB0aW1lLXJlbGF0ZWQgZmllbGQuJyxcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJmZXRjaF92YWx1ZXNfcHJlZGljYXRlXCJcbiAgICAgICAgICAgICAgICBtaW5MaW5lcz17NX1cbiAgICAgICAgICAgICAgICByZXNpemU9XCJ2ZXJ0aWNhbFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIGZpZWxkS2V5PVwiZXh0cmFcIlxuICAgICAgICAgICAgbGFiZWw9e3QoJ0V4dHJhJyl9XG4gICAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICAgJ0V4dHJhIGRhdGEgdG8gc3BlY2lmeSB0YWJsZSBtZXRhZGF0YS4gQ3VycmVudGx5IHN1cHBvcnRzICcgK1xuICAgICAgICAgICAgICAgICdtZXRhZGF0YSBvZiB0aGUgZm9ybWF0OiBgeyBcImNlcnRpZmljYXRpb25cIjogeyBcImNlcnRpZmllZF9ieVwiOiAnICtcbiAgICAgICAgICAgICAgICAnXCJEYXRhIFBsYXRmb3JtIFRlYW1cIiwgXCJkZXRhaWxzXCI6IFwiVGhpcyB0YWJsZSBpcyB0aGUgc291cmNlIG9mIHRydXRoLlwiICcgK1xuICAgICAgICAgICAgICAgICd9LCBcIndhcm5pbmdfbWFya2Rvd25cIjogXCJUaGlzIGlzIGEgd2FybmluZy5cIiB9YC4nLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgY29udHJvbElkPVwiZXh0cmFcIlxuICAgICAgICAgICAgICAgIGxhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgcmVzaXplPVwidmVydGljYWxcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIDxPd25lcnNTZWxlY3RvclxuICAgICAgICAgIGRhdGFzb3VyY2U9e2RhdGFzb3VyY2V9XG4gICAgICAgICAgb25DaGFuZ2U9e25ld093bmVycyA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZSh7IC4uLmRhdGFzb3VyY2UsIG93bmVyczogbmV3T3duZXJzIH0pO1xuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPEZpZWxkc2V0XG4gICAgICAgIHRpdGxlPXt0KCdBZHZhbmNlZCcpfVxuICAgICAgICBpdGVtPXtkYXRhc291cmNlfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGZpZWxkS2V5PVwiY2FjaGVfdGltZW91dFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0NhY2hlIHRpbWVvdXQnKX1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgZHVyYXRpb24gb2YgdGltZSBpbiBzZWNvbmRzIGJlZm9yZSB0aGUgY2FjaGUgaXMgaW52YWxpZGF0ZWQuIFNldCB0byAtMSB0byBieXBhc3MgdGhlIGNhY2hlLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8VGV4dENvbnRyb2wgY29udHJvbElkPVwiY2FjaGVfdGltZW91dFwiIC8+fVxuICAgICAgICAvPlxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBmaWVsZEtleT1cIm9mZnNldFwiXG4gICAgICAgICAgbGFiZWw9e3QoJ0hvdXJzIG9mZnNldCcpfVxuICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJvZmZzZXRcIiAvPn1cbiAgICAgICAgICBkZXNjcmlwdGlvbj17dChcbiAgICAgICAgICAgICdUaGUgbnVtYmVyIG9mIGhvdXJzLCBuZWdhdGl2ZSBvciBwb3NpdGl2ZSwgdG8gc2hpZnQgdGhlIHRpbWUgY29sdW1uLiBUaGlzIGNhbiBiZSB1c2VkIHRvIG1vdmUgVVRDIHRpbWUgdG8gbG9jYWwgdGltZS4nLFxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICAgIHt0aGlzLnN0YXRlLmlzU3FsYSAmJiAoXG4gICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICBmaWVsZEtleT1cInRlbXBsYXRlX3BhcmFtc1wiXG4gICAgICAgICAgICBsYWJlbD17dCgnVGVtcGxhdGUgcGFyYW1ldGVycycpfVxuICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICdBIHNldCBvZiBwYXJhbWV0ZXJzIHRoYXQgYmVjb21lIGF2YWlsYWJsZSBpbiB0aGUgcXVlcnkgdXNpbmcgSmluamEgdGVtcGxhdGluZyBzeW50YXgnLFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGNvbnRyb2w9ezxUZXh0Q29udHJvbCBjb250cm9sSWQ9XCJ0ZW1wbGF0ZV9wYXJhbXNcIiAvPn1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgICA8RmllbGRcbiAgICAgICAgICBpbmxpbmVcbiAgICAgICAgICBmaWVsZEtleT1cIm5vcm1hbGl6ZV9jb2x1bW5zXCJcbiAgICAgICAgICBsYWJlbD17dCgnTm9ybWFsaXplIGNvbHVtbiBuYW1lcycpfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgJ0FsbG93IGNvbHVtbiBuYW1lcyB0byBiZSBjaGFuZ2VkIHRvIGNhc2UgaW5zZW5zaXRpdmUgZm9ybWF0LCBpZiBzdXBwb3J0ZWQgKGUuZy4gT3JhY2xlLCBTbm93Zmxha2UpLicsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cIm5vcm1hbGl6ZV9jb2x1bW5zXCIgLz59XG4gICAgICAgIC8+XG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgIGlubGluZVxuICAgICAgICAgIGZpZWxkS2V5PVwiYWx3YXlzX2ZpbHRlcl9tYWluX2R0dG1cIlxuICAgICAgICAgIGxhYmVsPXt0KCdBbHdheXMgZmlsdGVyIG1haW4gZGF0ZXRpbWUgY29sdW1uJyl9XG4gICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICBgV2hlbiB0aGUgc2Vjb25kYXJ5IHRlbXBvcmFsIGNvbHVtbnMgYXJlIGZpbHRlcmVkLCBhcHBseSB0aGUgc2FtZSBmaWx0ZXIgdG8gdGhlIG1haW4gZGF0ZXRpbWUgY29sdW1uLmAsXG4gICAgICAgICAgKX1cbiAgICAgICAgICBjb250cm9sPXs8Q2hlY2tib3hDb250cm9sIGNvbnRyb2xJZD1cImFsd2F5c19maWx0ZXJfbWFpbl9kdHRtXCIgLz59XG4gICAgICAgIC8+XG4gICAgICA8L0ZpZWxkc2V0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJTcGF0aWFsVGFiKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IHNwYXRpYWxzLCBhbGxfY29sczogYWxsQ29scyB9ID0gZGF0YXNvdXJjZTtcbiAgICByZXR1cm4gKFxuICAgICAgPFRhYnMuVGFiUGFuZVxuICAgICAgICB0YWI9ezxDb2xsZWN0aW9uVGFiVGl0bGUgY29sbGVjdGlvbj17c3BhdGlhbHN9IHRpdGxlPXt0KCdTcGF0aWFsJyl9IC8+fVxuICAgICAgICBrZXk9ezR9XG4gICAgICA+XG4gICAgICAgIDxDb2xsZWN0aW9uVGFibGVcbiAgICAgICAgICB0YWJsZUNvbHVtbnM9e1snbmFtZScsICdjb25maWcnXX1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlLmJpbmQodGhpcywgJ3NwYXRpYWxzJyl9XG4gICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHQoJzxuZXcgc3BhdGlhbD4nKSxcbiAgICAgICAgICAgIHR5cGU6IHQoJzxubyB0eXBlPicpLFxuICAgICAgICAgICAgY29uZmlnOiBudWxsLFxuICAgICAgICAgIH0pfVxuICAgICAgICAgIGNvbGxlY3Rpb249e3NwYXRpYWxzfVxuICAgICAgICAgIGFsbG93RGVsZXRlc1xuICAgICAgICAgIGl0ZW1SZW5kZXJlcnM9e3tcbiAgICAgICAgICAgIG5hbWU6IChkLCBvbkNoYW5nZSkgPT4gKFxuICAgICAgICAgICAgICA8RWRpdGFibGVUaXRsZSBjYW5FZGl0IHRpdGxlPXtkfSBvblNhdmVUaXRsZT17b25DaGFuZ2V9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgY29uZmlnOiAodiwgb25DaGFuZ2UpID0+IChcbiAgICAgICAgICAgICAgPFNwYXRpYWxDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IGNob2ljZXM9e2FsbENvbHN9IC8+XG4gICAgICAgICAgICApLFxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU291cmNlRmllbGRzZXQodGhlbWUpIHtcbiAgICBjb25zdCB7IGRhdGFzb3VyY2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxFZGl0TG9ja0NvbnRhaW5lcj5cbiAgICAgICAgICA8c3BhbiByb2xlPVwiYnV0dG9uXCIgdGFiSW5kZXg9ezB9IG9uQ2xpY2s9e3RoaXMub25DaGFuZ2VFZGl0TW9kZX0+XG4gICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0VkaXRNb2RlID8gKFxuICAgICAgICAgICAgICA8SWNvbnMuTG9ja1VubG9ja2VkIGljb25Db2xvcj17dGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfSAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPEljb25zLkxvY2tMb2NrZWQgaWNvbkNvbG9yPXt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9IC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICB7IXRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJiAoXG4gICAgICAgICAgICA8ZGl2Pnt0KCdDbGljayB0aGUgbG9jayB0byBtYWtlIGNoYW5nZXMuJyl9PC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7dGhpcy5zdGF0ZS5pc0VkaXRNb2RlICYmIChcbiAgICAgICAgICAgIDxkaXY+e3QoJ0NsaWNrIHRoZSBsb2NrIHRvIHByZXZlbnQgZnVydGhlciBjaGFuZ2VzLicpfTwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRWRpdExvY2tDb250YWluZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibS1sLTEwIG0tdC0yMCBtLWItMTBcIj5cbiAgICAgICAgICB7REFUQVNPVVJDRV9UWVBFU19BUlIubWFwKHR5cGUgPT4gKFxuICAgICAgICAgICAgPFJhZGlvXG4gICAgICAgICAgICAgIGtleT17dHlwZS5rZXl9XG4gICAgICAgICAgICAgIHZhbHVlPXt0eXBlLmtleX1cbiAgICAgICAgICAgICAgaW5saW5lXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVR5cGVDaGFuZ2UuYmluZCh0aGlzLCB0eXBlLmtleSl9XG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IHR5cGUua2V5fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3R5cGUubGFiZWx9XG4gICAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxGaWVsZHNldCBpdGVtPXtkYXRhc291cmNlfSBvbkNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9IGNvbXBhY3Q+XG4gICAgICAgICAge3RoaXMuc3RhdGUuZGF0YXNvdXJjZVR5cGUgPT09IERBVEFTT1VSQ0VfVFlQRVMudmlydHVhbC5rZXkgJiYgKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGF0YWJhc2VTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ3ZpcnR1YWwnKX1cbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY3NzPXt7IG1hcmdpblRvcDogOCB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERhdGFiYXNlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYj17ZGF0YXNvdXJjZT8uZGF0YWJhc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0YWxvZz17ZGF0YXNvdXJjZS5jYXRhbG9nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYT17ZGF0YXNvdXJjZS5zY2hlbWF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DYXRhbG9nQ2hhbmdlPXtjYXRhbG9nID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnY2F0YWxvZycsIGNhdGFsb2cpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2NoZW1hQ2hhbmdlPXtzY2hlbWEgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdzY2hlbWEnLCBzY2hlbWEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRGJDaGFuZ2U9e2RhdGFiYXNlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25EYXRhc291cmNlUHJvcENoYW5nZSgnZGF0YWJhc2UnLCBkYXRhYmFzZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybU1vZGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yPXt0aGlzLnByb3BzLmFkZERhbmdlclRvYXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyB3aWR0aDogJ2NhbGMoMTAwJSAtIDM0cHgpJywgbWFyZ2luVG9wOiAtMTYgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cInRhYmxlX25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e3QoJ05hbWUnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dENvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJ0YWJsZV9uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGFibGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0RhdGFzZXQgbmFtZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICBsYWJlbD17dCgnU1FMJyl9XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXt0KFxuICAgICAgICAgICAgICAgICAgICAgICdXaGVuIHNwZWNpZnlpbmcgU1FMLCB0aGUgZGF0YXNvdXJjZSBhY3RzIGFzIGEgdmlldy4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnU3VwZXJzZXQgd2lsbCB1c2UgdGhpcyBzdGF0ZW1lbnQgYXMgYSBzdWJxdWVyeSB3aGlsZSBncm91cGluZyBhbmQgZmlsdGVyaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ29uIHRoZSBnZW5lcmF0ZWQgcGFyZW50IHF1ZXJpZXMuJyxcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2U9XCJzcWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5MaW5lcz17MjB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhMaW5lcz17SW5maW5pdHl9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkT25seT17IXRoaXMuc3RhdGUuaXNFZGl0TW9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cImJvdGhcIlxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHt0aGlzLnN0YXRlLmRhdGFzb3VyY2VUeXBlID09PSBEQVRBU09VUkNFX1RZUEVTLnBoeXNpY2FsLmtleSAmJiAoXG4gICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUuaXNTcWxhICYmIChcbiAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwidGFibGVTZWxlY3RvclwiXG4gICAgICAgICAgICAgICAgICBsYWJlbD17dCgnUGh5c2ljYWwnKX1cbiAgICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNzcz17eyBtYXJnaW5Ub3A6IDggfX0+XG4gICAgICAgICAgICAgICAgICAgICAgPFRhYmxlU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyYWJsZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5kYXRhc291cmNlLmRhdGFiYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZV9uYW1lOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzb3VyY2UuZGF0YWJhc2U/LmRhdGFiYXNlX25hbWUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhc291cmNlLmRhdGFiYXNlPy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRiSWQ9e2RhdGFzb3VyY2UuZGF0YWJhc2U/LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXJyb3I9e3RoaXMucHJvcHMuYWRkRGFuZ2VyVG9hc3R9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRhbG9nPXtkYXRhc291cmNlLmNhdGFsb2d9XG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE9e2RhdGFzb3VyY2Uuc2NoZW1hfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsTGFiTW9kZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVZhbHVlPXtkYXRhc291cmNlLnRhYmxlX25hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNhdGFsb2dDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNhdGFsb2cgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCdjYXRhbG9nJywgY2F0YWxvZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25TY2hlbWFDaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmlzRWRpdE1vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHNjaGVtYSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UoJ3NjaGVtYScsIHNjaGVtYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25EYkNoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZGF0YWJhc2UgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhYmFzZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25UYWJsZVNlbGVjdENoYW5nZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuaXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGFibGUgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFzb3VyY2VQcm9wQ2hhbmdlKCd0YWJsZV9uYW1lJywgdGFibGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshdGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAgICdUaGUgcG9pbnRlciB0byBhIHBoeXNpY2FsIHRhYmxlIChvciB2aWV3KS4gS2VlcCBpbiBtaW5kIHRoYXQgdGhlIGNoYXJ0IGlzICcgK1xuICAgICAgICAgICAgICAgICAgICAgICdhc3NvY2lhdGVkIHRvIHRoaXMgU3VwZXJzZXQgbG9naWNhbCB0YWJsZSwgYW5kIHRoaXMgbG9naWNhbCB0YWJsZSBwb2ludHMgJyArXG4gICAgICAgICAgICAgICAgICAgICAgJ3RoZSBwaHlzaWNhbCB0YWJsZSByZWZlcmVuY2VkIGhlcmUuJyxcbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyRXJyb3JzKCkge1xuICAgIGlmICh0aGlzLnN0YXRlLmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8QWxlcnRcbiAgICAgICAgICBjc3M9e3RoZW1lID0+ICh7IG1hcmdpbkJvdHRvbTogdGhlbWUuZ3JpZFVuaXQgKiA0IH0pfVxuICAgICAgICAgIHR5cGU9XCJlcnJvclwiXG4gICAgICAgICAgbWVzc2FnZT17XG4gICAgICAgICAgICA8PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5lcnJvcnMubWFwKGVyciA9PiAoXG4gICAgICAgICAgICAgICAgPGRpdiBrZXk9e2Vycn0+e2Vycn08L2Rpdj5cbiAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICB9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKSB7XG4gICAgY29uc3QgeyBkYXRhc291cmNlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIHJldHVybiAoXG4gICAgICA8Q29sbGVjdGlvblRhYmxlXG4gICAgICAgIHRhYmxlQ29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBzb3J0Q29sdW1ucz17WydtZXRyaWNfbmFtZScsICd2ZXJib3NlX25hbWUnLCAnZXhwcmVzc2lvbiddfVxuICAgICAgICBjb2x1bW5MYWJlbHM9e3tcbiAgICAgICAgICBtZXRyaWNfbmFtZTogdCgnTWV0cmljIEtleScpLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogdCgnTGFiZWwnKSxcbiAgICAgICAgICBleHByZXNzaW9uOiB0KCdTUUwgZXhwcmVzc2lvbicpLFxuICAgICAgICB9fVxuICAgICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXt7XG4gICAgICAgICAgbWV0cmljX25hbWU6IHQoXG4gICAgICAgICAgICAnVGhpcyBmaWVsZCBpcyB1c2VkIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgdG8gYXR0YWNoICcgK1xuICAgICAgICAgICAgICAndGhlIG1ldHJpYyB0byBjaGFydHMuIEl0IGlzIGFsc28gdXNlZCBhcyB0aGUgYWxpYXMgaW4gdGhlICcgK1xuICAgICAgICAgICAgICAnU1FMIHF1ZXJ5LicsXG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgZXhwYW5kRmllbGRzZXQ9e1xuICAgICAgICAgIDxGb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgPEZpZWxkc2V0IGNvbXBhY3Q+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiZGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdEZXNjcmlwdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZmllbGRLZXk9XCJkM2Zvcm1hdFwiXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0QzIGZvcm1hdCcpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sIGNvbnRyb2xJZD1cImQzZm9ybWF0XCIgcGxhY2Vob2xkZXI9XCIleS8lbS8lZFwiIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImN1cnJlbmN5XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnTWV0cmljIGN1cnJlbmN5Jyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8Q3VycmVuY3lDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5U2VsZWN0T3ZlcnJpZGVQcm9wcz17e1xuICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0KCdTZWxlY3Qgb3IgdHlwZSBjdXJyZW5jeSBzeW1ib2wnKSxcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VsZWN0QWRkaXRpb25hbFN0eWxlcz17Y3NzYFxuICAgICAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogMzAlO1xuICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGxhYmVsPXt0KCdDZXJ0aWZpZWQgYnknKX1cbiAgICAgICAgICAgICAgICBmaWVsZEtleT1cImNlcnRpZmllZF9ieVwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoXG4gICAgICAgICAgICAgICAgICAnUGVyc29uIG9yIGdyb3VwIHRoYXQgaGFzIGNlcnRpZmllZCB0aGlzIG1ldHJpYycsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICAgICAgICAgIDxUZXh0Q29udHJvbFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sSWQ9XCJjZXJ0aWZpZWRfYnlcIlxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dCgnQ2VydGlmaWVkIGJ5Jyl9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ0NlcnRpZmljYXRpb24gZGV0YWlscycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiY2VydGlmaWNhdGlvbl9kZXRhaWxzXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17dCgnRGV0YWlscyBvZiB0aGUgY2VydGlmaWNhdGlvbicpfVxuICAgICAgICAgICAgICAgIGNvbnRyb2w9e1xuICAgICAgICAgICAgICAgICAgPFRleHRDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cImNlcnRpZmljYXRpb25fZGV0YWlsc1wiXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnV2FybmluZycpfVxuICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwid2FybmluZ19tYXJrZG93blwiXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e3QoJ09wdGlvbmFsIHdhcm5pbmcgYWJvdXQgdXNlIG9mIHRoaXMgbWV0cmljJyl9XG4gICAgICAgICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xJZD1cIndhcm5pbmdfbWFya2Rvd25cIlxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZT1cIm1hcmtkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZT1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9GaWVsZHNldD5cbiAgICAgICAgICA8L0Zvcm1Db250YWluZXI+XG4gICAgICAgIH1cbiAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgYWxsb3dBZGRJdGVtXG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZVByb3BDaGFuZ2UuYmluZCh0aGlzLCAnbWV0cmljcycpfVxuICAgICAgICBpdGVtR2VuZXJhdG9yPXsoKSA9PiAoe1xuICAgICAgICAgIG1ldHJpY19uYW1lOiB0KCc8bmV3IG1ldHJpYz4nKSxcbiAgICAgICAgICB2ZXJib3NlX25hbWU6ICcnLFxuICAgICAgICAgIGV4cHJlc3Npb246ICcnLFxuICAgICAgICB9KX1cbiAgICAgICAgaXRlbUNlbGxQcm9wcz17e1xuICAgICAgICAgIGV4cHJlc3Npb246ICgpID0+ICh7XG4gICAgICAgICAgICB3aWR0aDogJzI0MHB4JyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfX1cbiAgICAgICAgaXRlbVJlbmRlcmVycz17e1xuICAgICAgICAgIG1ldHJpY19uYW1lOiAodiwgb25DaGFuZ2UsIF8sIHJlY29yZCkgPT4gKFxuICAgICAgICAgICAgPEZsZXhSb3dDb250YWluZXI+XG4gICAgICAgICAgICAgIHtyZWNvcmQuaXNfY2VydGlmaWVkICYmIChcbiAgICAgICAgICAgICAgICA8Q2VydGlmaWVkQmFkZ2VcbiAgICAgICAgICAgICAgICAgIGNlcnRpZmllZEJ5PXtyZWNvcmQuY2VydGlmaWVkX2J5fVxuICAgICAgICAgICAgICAgICAgZGV0YWlscz17cmVjb3JkLmNlcnRpZmljYXRpb25fZGV0YWlsc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7cmVjb3JkLndhcm5pbmdfbWFya2Rvd24gJiYgKFxuICAgICAgICAgICAgICAgIDxXYXJuaW5nSWNvbldpdGhUb29sdGlwXG4gICAgICAgICAgICAgICAgICB3YXJuaW5nTWFya2Rvd249e3JlY29yZC53YXJuaW5nX21hcmtkb3dufVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxFZGl0YWJsZVRpdGxlIGNhbkVkaXQgdGl0bGU9e3Z9IG9uU2F2ZVRpdGxlPXtvbkNoYW5nZX0gLz5cbiAgICAgICAgICAgIDwvRmxleFJvd0NvbnRhaW5lcj5cbiAgICAgICAgICApLFxuICAgICAgICAgIHZlcmJvc2VfbmFtZTogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dENvbnRyb2wgY2FuRWRpdCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZXhwcmVzc2lvbjogKHYsIG9uQ2hhbmdlKSA9PiAoXG4gICAgICAgICAgICA8VGV4dEFyZWFDb250cm9sXG4gICAgICAgICAgICAgIGNhbkVkaXRcbiAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlPXt2fVxuICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgIGV4dHJhQ2xhc3Nlcz17WydkYXRhc291cmNlLXNxbC1leHByZXNzaW9uJ119XG4gICAgICAgICAgICAgIGxhbmd1YWdlPVwic3FsXCJcbiAgICAgICAgICAgICAgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9XG4gICAgICAgICAgICAgIG1pbkxpbmVzPXs1fVxuICAgICAgICAgICAgICB0ZXh0QXJlYVN0eWxlcz17eyBtaW5XaWR0aDogJzIwMHB4JywgbWF4V2lkdGg6ICc0NTBweCcgfX1cbiAgICAgICAgICAgICAgcmVzaXplPVwiYm90aFwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICksXG4gICAgICAgICAgZGVzY3JpcHRpb246ICh2LCBvbkNoYW5nZSwgbGFiZWwpID0+IChcbiAgICAgICAgICAgIDxTdGFja2VkRmllbGRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICBmb3JtRWxlbWVudD17PFRleHRDb250cm9sIHZhbHVlPXt2fSBvbkNoYW5nZT17b25DaGFuZ2V9IC8+fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApLFxuICAgICAgICAgIGQzZm9ybWF0OiAodiwgb25DaGFuZ2UsIGxhYmVsKSA9PiAoXG4gICAgICAgICAgICA8U3RhY2tlZEZpZWxkXG4gICAgICAgICAgICAgIGxhYmVsPXtsYWJlbH1cbiAgICAgICAgICAgICAgZm9ybUVsZW1lbnQ9ezxUZXh0Q29udHJvbCB2YWx1ZT17dn0gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPn1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSxcbiAgICAgICAgfX1cbiAgICAgICAgYWxsb3dEZWxldGVzXG4gICAgICAgIHN0aWNreUhlYWRlclxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgZGF0YXNvdXJjZSwgYWN0aXZlVGFiS2V5IH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgbWV0cmljcyB9ID0gZGF0YXNvdXJjZTtcbiAgICBjb25zdCBzb3J0ZWRNZXRyaWNzID0gbWV0cmljcz8ubGVuZ3RoID8gdGhpcy5zb3J0TWV0cmljcyhtZXRyaWNzKSA6IFtdO1xuICAgIGNvbnN0IHsgdGhlbWUgfSA9IHRoaXMucHJvcHM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPERhdGFzb3VyY2VDb250YWluZXIgZGF0YS10ZXN0PVwiZGF0YXNvdXJjZS1lZGl0b3JcIj5cbiAgICAgICAge3RoaXMucmVuZGVyRXJyb3JzKCl9XG4gICAgICAgIDxBbGVydFxuICAgICAgICAgIGNzcz17dGhlbWUgPT4gKHsgbWFyZ2luQm90dG9tOiB0aGVtZS5ncmlkVW5pdCAqIDQgfSl9XG4gICAgICAgICAgdHlwZT1cIndhcm5pbmdcIlxuICAgICAgICAgIG1lc3NhZ2U9e1xuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgeycgJ31cbiAgICAgICAgICAgICAgPHN0cm9uZz57dCgnQmUgY2FyZWZ1bC4nKX0gPC9zdHJvbmc+XG4gICAgICAgICAgICAgIHt0KFxuICAgICAgICAgICAgICAgICdDaGFuZ2luZyB0aGVzZSBzZXR0aW5ncyB3aWxsIGFmZmVjdCBhbGwgY2hhcnRzIHVzaW5nIHRoaXMgZGF0YXNldCwgaW5jbHVkaW5nIGNoYXJ0cyBvd25lZCBieSBvdGhlciBwZW9wbGUuJyxcbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvPlxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICAgPFN0eWxlZFRhYmxlVGFic1xuICAgICAgICAgIGZ1bGxXaWR0aD17ZmFsc2V9XG4gICAgICAgICAgaWQ9XCJ0YWJsZS10YWJzXCJcbiAgICAgICAgICBkYXRhLXRlc3Q9XCJlZGl0LWRhdGFzZXQtdGFic1wiXG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlVGFiU2VsZWN0fVxuICAgICAgICAgIGRlZmF1bHRBY3RpdmVLZXk9e2FjdGl2ZVRhYktleX1cbiAgICAgICAgPlxuICAgICAgICAgIDxUYWJzLlRhYlBhbmUga2V5PXswfSB0YWI9e3QoJ1NvdXJjZScpfT5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlclNvdXJjZUZpZWxkc2V0KHRoZW1lKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17c29ydGVkTWV0cmljc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnTWV0cmljcycpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5PXsxfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlck1ldHJpY0NvbGxlY3Rpb24oKX1cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17dGhpcy5zdGF0ZS5kYXRhYmFzZUNvbHVtbnN9XG4gICAgICAgICAgICAgICAgdGl0bGU9e3QoJ0NvbHVtbnMnKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleT17Mn1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8U3R5bGVkQ29sdW1uc1RhYldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5CdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRCdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBidXR0b25TaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICAgICAgICBidXR0b25TdHlsZT1cInRlcnRpYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5zeW5jTWV0YWRhdGF9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInN5bmMtZnJvbS1zb3VyY2VcIlxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5pc0VkaXRNb2RlfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1kYXRhYmFzZVwiIC8+eycgJ31cbiAgICAgICAgICAgICAgICAgICAge3QoJ1N5bmMgY29sdW1ucyBmcm9tIHNvdXJjZScpfVxuICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPC9TdHlsZWRCdXR0b25XcmFwcGVyPlxuICAgICAgICAgICAgICA8L0NvbHVtbkJ1dHRvbldyYXBwZXI+XG4gICAgICAgICAgICAgIDxDb2x1bW5Db2xsZWN0aW9uVGFibGVcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjb2x1bW5zLXRhYmxlXCJcbiAgICAgICAgICAgICAgICBjb2x1bW5zPXt0aGlzLnN0YXRlLmRhdGFiYXNlQ29sdW1uc31cbiAgICAgICAgICAgICAgICBkYXRhc291cmNlPXtkYXRhc291cmNlfVxuICAgICAgICAgICAgICAgIG9uQ29sdW1uc0NoYW5nZT17ZGF0YWJhc2VDb2x1bW5zID0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENvbHVtbnMoeyBkYXRhYmFzZUNvbHVtbnMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb25EYXRhc291cmNlQ2hhbmdlPXt0aGlzLm9uRGF0YXNvdXJjZUNoYW5nZX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAge3RoaXMuc3RhdGUubWV0YWRhdGFMb2FkaW5nICYmIDxMb2FkaW5nIC8+fVxuICAgICAgICAgICAgPC9TdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lXG4gICAgICAgICAgICB0YWI9e1xuICAgICAgICAgICAgICA8Q29sbGVjdGlvblRhYlRpdGxlXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbj17dGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dCgnQ2FsY3VsYXRlZCBjb2x1bW5zJyl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXk9ezN9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPFN0eWxlZENvbHVtbnNUYWJXcmFwcGVyPlxuICAgICAgICAgICAgICA8Q29sdW1uQ29sbGVjdGlvblRhYmxlXG4gICAgICAgICAgICAgICAgY29sdW1ucz17dGhpcy5zdGF0ZS5jYWxjdWxhdGVkQ29sdW1uc31cbiAgICAgICAgICAgICAgICBvbkNvbHVtbnNDaGFuZ2U9e2NhbGN1bGF0ZWRDb2x1bW5zID0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENvbHVtbnMoeyBjYWxjdWxhdGVkQ29sdW1ucyB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2x1bW5MYWJlbFRvb2x0aXBzPXt7XG4gICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZTogdChcbiAgICAgICAgICAgICAgICAgICAgJ1RoaXMgZmllbGQgaXMgdXNlZCBhcyBhIHVuaXF1ZSBpZGVudGlmaWVyIHRvIGF0dGFjaCAnICtcbiAgICAgICAgICAgICAgICAgICAgICAndGhlIGNhbGN1bGF0ZWQgZGltZW5zaW9uIHRvIGNoYXJ0cy4gSXQgaXMgYWxzbyB1c2VkICcgK1xuICAgICAgICAgICAgICAgICAgICAgICdhcyB0aGUgYWxpYXMgaW4gdGhlIFNRTCBxdWVyeS4nLFxuICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIG9uRGF0YXNvdXJjZUNoYW5nZT17dGhpcy5vbkRhdGFzb3VyY2VDaGFuZ2V9XG4gICAgICAgICAgICAgICAgZGF0YXNvdXJjZT17ZGF0YXNvdXJjZX1cbiAgICAgICAgICAgICAgICBlZGl0YWJsZUNvbHVtbk5hbWVcbiAgICAgICAgICAgICAgICBzaG93RXhwcmVzc2lvblxuICAgICAgICAgICAgICAgIGFsbG93QWRkSXRlbVxuICAgICAgICAgICAgICAgIGFsbG93RWRpdERhdGFUeXBlXG4gICAgICAgICAgICAgICAgaXRlbUdlbmVyYXRvcj17KCkgPT4gKHtcbiAgICAgICAgICAgICAgICAgIGNvbHVtbl9uYW1lOiB0KCc8bmV3IGNvbHVtbj4nKSxcbiAgICAgICAgICAgICAgICAgIGZpbHRlcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBncm91cGJ5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogdCgnPGVudGVyIFNRTCBleHByZXNzaW9uIGhlcmU+JyksXG4gICAgICAgICAgICAgICAgICBfX2V4cGFuZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9TdHlsZWRDb2x1bW5zVGFiV3JhcHBlcj5cbiAgICAgICAgICA8L1RhYnMuVGFiUGFuZT5cbiAgICAgICAgICA8VGFicy5UYWJQYW5lIGtleT17NH0gdGFiPXt0KCdTZXR0aW5ncycpfT5cbiAgICAgICAgICAgIDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICAgIDxGb3JtQ29udGFpbmVyPnt0aGlzLnJlbmRlclNldHRpbmdzRmllbGRzZXQoKX08L0Zvcm1Db250YWluZXI+XG4gICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgICA8Rm9ybUNvbnRhaW5lcj57dGhpcy5yZW5kZXJBZHZhbmNlZEZpZWxkc2V0KCl9PC9Gb3JtQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxuICAgICAgICA8L1N0eWxlZFRhYmxlVGFicz5cbiAgICAgIDwvRGF0YXNvdXJjZUNvbnRhaW5lcj5cbiAgICApO1xuICB9XG59XG5cbkRhdGFzb3VyY2VFZGl0b3IuZGVmYXVsdFByb3BzID0gZGVmYXVsdFByb3BzO1xuRGF0YXNvdXJjZUVkaXRvci5wcm9wVHlwZXMgPSBwcm9wVHlwZXM7XG5cbmNvbnN0IERhdGFTb3VyY2VDb21wb25lbnQgPSB3aXRoVGhlbWUoRGF0YXNvdXJjZUVkaXRvcik7XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhUb2FzdHMoRGF0YVNvdXJjZUNvbXBvbmVudCk7XG4iXX0= */\"), children:\n                  _jsx(Field, {\n                    fieldKey: \"table_name\",\n                    label: t('Name'),\n                    control:\n                    _jsx(TextControl, {\n                      controlId: \"table_name\",\n                      onChange: (table) => {\n                        this.onDatasourcePropChange('table_name', table);\n                      },\n                      placeholder: t('Dataset name'),\n                      disabled: !this.state.isEditMode }\n                    ) }\n\n                  ) }\n                )] }\n              ),\n              _jsx(Field, {\n                fieldKey: \"sql\",\n                label: t('SQL'),\n                description: t(\n                  'When specifying SQL, the datasource acts as a view. ' +\n                  'Superset will use this statement as a subquery while grouping and filtering ' +\n                  'on the generated parent queries.'\n                ),\n                control:\n                _jsx(TextAreaControl, {\n                  language: \"sql\",\n                  offerEditInModal: false,\n                  minLines: 20,\n                  maxLines: Infinity,\n                  readOnly: !this.state.isEditMode,\n                  resize: \"both\" }\n                ) }\n\n              )] }\n            ) }\n\n          ),\n\n          this.state.datasourceType === DATASOURCE_TYPES.physical.key &&\n          _jsx(Col, { xs: 24, md: 12, children:\n            this.state.isSqla &&\n            _jsx(Field, {\n              fieldKey: \"tableSelector\",\n              label: t('Physical'),\n              control:\n              _jsx(\"div\", { css: _ref3, children:\n                _jsx(TableSelector, {\n                  clearable: false,\n                  database: {\n                    ...datasource.database,\n                    database_name:\n                    ((_datasource$database = datasource.database) == null ? void 0 : _datasource$database.database_name) || ((_datasource$database2 =\n                    datasource.database) == null ? void 0 : _datasource$database2.name)\n                  },\n                  dbId: (_datasource$database3 = datasource.database) == null ? void 0 : _datasource$database3.id,\n                  handleError: this.props.addDangerToast,\n                  catalog: datasource.catalog,\n                  schema: datasource.schema,\n                  sqlLabMode: false,\n                  tableValue: datasource.table_name,\n                  onCatalogChange:\n                  this.state.isEditMode ?\n                  (catalog) =>\n                  this.onDatasourcePropChange('catalog', catalog) :\n                  undefined,\n\n                  onSchemaChange:\n                  this.state.isEditMode ?\n                  (schema) =>\n                  this.onDatasourcePropChange('schema', schema) :\n                  undefined,\n\n                  onDbChange:\n                  this.state.isEditMode ?\n                  (database) =>\n                  this.onDatasourcePropChange(\n                    'database',\n                    database\n                  ) :\n                  undefined,\n\n                  onTableSelectChange:\n                  this.state.isEditMode ?\n                  (table) =>\n                  this.onDatasourcePropChange('table_name', table) :\n                  undefined,\n\n                  readOnly: !this.state.isEditMode }\n                ) }\n              ),\n\n              description: t(\n                'The pointer to a physical table (or view). Keep in mind that the chart is ' +\n                'associated to this Superset logical table, and this logical table points ' +\n                'the physical table referenced here.'\n              ) }\n            ) }\n\n          )] }\n\n        )] }\n      ));\n\n  }\n\n  renderErrors() {\n    if (this.state.errors.length > 0) {\n      return (\n        _jsx(Alert, {\n          css: (theme) => ({ marginBottom: theme.gridUnit * 4 }),\n          type: \"error\",\n          message:\n          _jsx(_Fragment, { children:\n            this.state.errors.map((err) =>\n            _jsx(\"div\", { children: err }, err)\n            ) }\n          ) }\n\n        ));\n\n    }\n    return null;\n  }\n\n  renderMetricCollection() {\n    const { datasource } = this.state;\n    const { metrics } = datasource;\n    const sortedMetrics = metrics != null && metrics.length ? this.sortMetrics(metrics) : [];\n    return (\n      _jsx(CollectionTable, {\n        tableColumns: ['metric_name', 'verbose_name', 'expression'],\n        sortColumns: ['metric_name', 'verbose_name', 'expression'],\n        columnLabels: {\n          metric_name: t('Metric Key'),\n          verbose_name: t('Label'),\n          expression: t('SQL expression')\n        },\n        columnLabelTooltips: {\n          metric_name: t(\n            'This field is used as a unique identifier to attach ' +\n            'the metric to charts. It is also used as the alias in the ' +\n            'SQL query.'\n          )\n        },\n        expandFieldset:\n        _jsx(FormContainer, { children:\n          _jsxs(Fieldset, { compact: true, children: [\n            _jsx(Field, {\n              fieldKey: \"description\",\n              label: t('Description'),\n              control:\n              _jsx(TextControl, {\n                controlId: \"description\",\n                placeholder: t('Description') }\n              ) }\n\n            ),\n            _jsx(Field, {\n              fieldKey: \"d3format\",\n              label: t('D3 format'),\n              control:\n              _jsx(TextControl, { controlId: \"d3format\", placeholder: \"%y/%m/%d\" }) }\n\n            ),\n            _jsx(Field, {\n              fieldKey: \"currency\",\n              label: t('Metric currency'),\n              control:\n              _jsx(CurrencyControl, {\n                currencySelectOverrideProps: {\n                  placeholder: t('Select or type currency symbol')\n                },\n                symbolSelectAdditionalStyles: css`\n                      max-width: 30%;\n                    ` }\n              ) }\n\n            ),\n            _jsx(Field, {\n              label: t('Certified by'),\n              fieldKey: \"certified_by\",\n              description: t(\n                'Person or group that has certified this metric'\n              ),\n              control:\n              _jsx(TextControl, {\n                controlId: \"certified_by\",\n                placeholder: t('Certified by') }\n              ) }\n\n            ),\n            _jsx(Field, {\n              label: t('Certification details'),\n              fieldKey: \"certification_details\",\n              description: t('Details of the certification'),\n              control:\n              _jsx(TextControl, {\n                controlId: \"certification_details\",\n                placeholder: t('Certification details') }\n              ) }\n\n            ),\n            _jsx(Field, {\n              label: t('Warning'),\n              fieldKey: \"warning_markdown\",\n              description: t('Optional warning about use of this metric'),\n              control:\n              _jsx(TextAreaControl, {\n                controlId: \"warning_markdown\",\n                language: \"markdown\",\n                offerEditInModal: false,\n                resize: \"vertical\" }\n              ) }\n\n            )] }\n          ) }\n        ),\n\n        collection: sortedMetrics,\n        allowAddItem: true,\n        onChange: this.onDatasourcePropChange.bind(this, 'metrics'),\n        itemGenerator: () => ({\n          metric_name: t('<new metric>'),\n          verbose_name: '',\n          expression: ''\n        }),\n        itemCellProps: {\n          expression: () => ({\n            width: '240px'\n          })\n        },\n        itemRenderers: {\n          metric_name: (v, onChange, _, record) =>\n          _jsxs(FlexRowContainer, { children: [\n            record.is_certified &&\n            _jsx(CertifiedBadge, {\n              certifiedBy: record.certified_by,\n              details: record.certification_details }\n            ),\n\n            record.warning_markdown &&\n            _jsx(WarningIconWithTooltip, {\n              warningMarkdown: record.warning_markdown }\n            ),\n\n            _jsx(EditableTitle, { canEdit: true, title: v, onSaveTitle: onChange })] }\n          ),\n\n          verbose_name: (v, onChange) =>\n          _jsx(TextControl, { canEdit: true, value: v, onChange: onChange }),\n\n          expression: (v, onChange) =>\n          _jsx(TextAreaControl, {\n            canEdit: true,\n            initialValue: v,\n            onChange: onChange,\n            extraClasses: ['datasource-sql-expression'],\n            language: \"sql\",\n            offerEditInModal: false,\n            minLines: 5,\n            textAreaStyles: { minWidth: '200px', maxWidth: '450px' },\n            resize: \"both\" }\n          ),\n\n          description: (v, onChange, label) =>\n          _jsx(StackedField, {\n            label: label,\n            formElement: _jsx(TextControl, { value: v, onChange: onChange }) }\n          ),\n\n          d3format: (v, onChange, label) =>\n          _jsx(StackedField, {\n            label: label,\n            formElement: _jsx(TextControl, { value: v, onChange: onChange }) }\n          )\n\n        },\n        allowDeletes: true,\n        stickyHeader: true }\n      ));\n\n  }\n\n  render() {\n    const { datasource, activeTabKey } = this.state;\n    const { metrics } = datasource;\n    const sortedMetrics = metrics != null && metrics.length ? this.sortMetrics(metrics) : [];\n    const { theme } = this.props;\n\n    return (\n      _jsxs(DatasourceContainer, { \"data-test\": \"datasource-editor\", children: [\n        this.renderErrors(),\n        _jsx(Alert, {\n          css: (theme) => ({ marginBottom: theme.gridUnit * 4 }),\n          type: \"warning\",\n          message:\n          _jsxs(_Fragment, { children: [\n            ' ',\n            _jsxs(\"strong\", { children: [t('Be careful.'), \" \"] }),\n            t(\n              'Changing these settings will affect all charts using this dataset, including charts owned by other people.'\n            )] }\n          ) }\n\n        ),\n        _jsxs(StyledTableTabs, {\n          fullWidth: false,\n          id: \"table-tabs\",\n          \"data-test\": \"edit-dataset-tabs\",\n          onChange: this.handleTabSelect,\n          defaultActiveKey: activeTabKey, children: [\n\n          _jsx(Tabs.TabPane, { tab: t('Source'), children:\n            this.renderSourceFieldset(theme) }, 0\n          ),\n          _jsx(Tabs.TabPane, {\n            tab:\n            _jsx(CollectionTabTitle, {\n              collection: sortedMetrics,\n              title: t('Metrics') }\n            ), children:\n\n\n\n            this.renderMetricCollection() }, 1\n          ),\n          _jsx(Tabs.TabPane, {\n            tab:\n            _jsx(CollectionTabTitle, {\n              collection: this.state.databaseColumns,\n              title: t('Columns') }\n            ), children:\n\n\n\n            _jsxs(StyledColumnsTabWrapper, { children: [\n              _jsx(ColumnButtonWrapper, { children:\n                _jsx(StyledButtonWrapper, { children:\n                  _jsxs(Button, {\n                    buttonSize: \"small\",\n                    buttonStyle: \"tertiary\",\n                    onClick: this.syncMetadata,\n                    className: \"sync-from-source\",\n                    disabled: this.state.isEditMode, children: [\n\n                    _jsx(\"i\", { className: \"fa fa-database\" }), ' ',\n                    t('Sync columns from source')] }\n                  ) }\n                ) }\n              ),\n              _jsx(ColumnCollectionTable, {\n                className: \"columns-table\",\n                columns: this.state.databaseColumns,\n                datasource: datasource,\n                onColumnsChange: (databaseColumns) =>\n                this.setColumns({ databaseColumns }),\n\n                onDatasourceChange: this.onDatasourceChange }\n              ),\n              this.state.metadataLoading && _jsx(Loading, {})] }\n            ) }, 2\n          ),\n          _jsx(Tabs.TabPane, {\n            tab:\n            _jsx(CollectionTabTitle, {\n              collection: this.state.calculatedColumns,\n              title: t('Calculated columns') }\n            ), children:\n\n\n\n            _jsx(StyledColumnsTabWrapper, { children:\n              _jsx(ColumnCollectionTable, {\n                columns: this.state.calculatedColumns,\n                onColumnsChange: (calculatedColumns) =>\n                this.setColumns({ calculatedColumns }),\n\n                columnLabelTooltips: {\n                  column_name: t(\n                    'This field is used as a unique identifier to attach ' +\n                    'the calculated dimension to charts. It is also used ' +\n                    'as the alias in the SQL query.'\n                  )\n                },\n                onDatasourceChange: this.onDatasourceChange,\n                datasource: datasource,\n                editableColumnName: true,\n                showExpression: true,\n                allowAddItem: true,\n                allowEditDataType: true,\n                itemGenerator: () => ({\n                  column_name: t('<new column>'),\n                  filterable: true,\n                  groupby: true,\n                  expression: t('<enter SQL expression here>'),\n                  __expanded: true\n                }) }\n              ) }\n            ) }, 3\n          ),\n          _jsx(Tabs.TabPane, { tab: t('Settings'), children:\n            _jsxs(Row, { gutter: 16, children: [\n              _jsx(Col, { xs: 24, md: 12, children:\n                _jsx(FormContainer, { children: this.renderSettingsFieldset() }) }\n              ),\n              _jsx(Col, { xs: 24, md: 12, children:\n                _jsx(FormContainer, { children: this.renderAdvancedFieldset() }) }\n              )] }\n            ) }, 4\n          )] }\n        )] }\n      ));\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nDatasourceEditor.defaultProps = defaultProps;\nDatasourceEditor.propTypes = propTypes;\n\nconst DataSourceComponent = withTheme(DatasourceEditor);const _default =\n\nwithToasts(DataSourceComponent);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DatasourceContainer, \"DatasourceContainer\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(FlexRowContainer, \"FlexRowContainer\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(StyledTableTabs, \"StyledTableTabs\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(StyledBadge, \"StyledBadge\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(EditLockContainer, \"EditLockContainer\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(ColumnButtonWrapper, \"ColumnButtonWrapper\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(StyledLabelWrapper, \"StyledLabelWrapper\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(StyledColumnsTabWrapper, \"StyledColumnsTabWrapper\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(StyledButtonWrapper, \"StyledButtonWrapper\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(checkboxGenerator, \"checkboxGenerator\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(DATA_TYPES, \"DATA_TYPES\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(DATASOURCE_TYPES_ARR, \"DATASOURCE_TYPES_ARR\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(DATASOURCE_TYPES, \"DATASOURCE_TYPES\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(CollectionTabTitle, \"CollectionTabTitle\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(ColumnCollectionTable, \"ColumnCollectionTable\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(StackedField, \"StackedField\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(FormContainer, \"FormContainer\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(propTypes, \"propTypes\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(OwnersSelector, \"OwnersSelector\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(DatasourceEditor, \"DatasourceEditor\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(DataSourceComponent, \"DataSourceComponent\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["rison","PureComponent","useCallback","PropTypes","Radio","Card","Alert","Badge","nanoid","css","isFeatureEnabled","getCurrencySymbol","ensureIsArray","FeatureFlag","styled","SupersetClient","t","withTheme","getClientErrorObject","Select","AsyncSelect","Row","Col","FormLabel","Button","Tabs","CertifiedBadge","WarningIconWithTooltip","DatabaseSelector","Label","Loading","TableSelector","EditableTitle","CheckboxControl","TextControl","TextAreaControl","SpatialControl","withToasts","Icons","CurrencyControl","CollectionTable","Fieldset","Field","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DatasourceContainer","div","theme","colors","warning","base","typography","weights","bold","FlexRowContainer","gridUnit","StyledTableTabs","StyledBadge","EditLockContainer","sizes","s","ColumnButtonWrapper","StyledLabelWrapper","StyledColumnsTabWrapper","StyledButtonWrapper","span","checkboxGenerator","d","onChange","value","DATA_TYPES","label","DATASOURCE_TYPES_ARR","key","DATASOURCE_TYPES","forEach","o","_ref","process","env","NODE_ENV","name","styles","map","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","CollectionTabTitle","title","collection","children","count","length","showZero","propTypes","string","array","ColumnCollectionTable","columns","datasource","onColumnsChange","onDatasourceChange","editableColumnName","showExpression","allowAddItem","allowEditDataType","itemGenerator","columnLabelTooltips","tableColumns","EnableAdvancedDataTypes","sortColumns","allowDeletes","stickyHeader","expandFieldset","FormContainer","compact","fieldKey","control","language","offerEditInModal","resize","controlId","placeholder","ariaLabel","options","allowNewOptions","allowClear","description","href","columnLabels","column_name","advanced_data_type","type","groupby","is_dttm","main_dttm_col","filterable","itemRenderers","v","onItemChange","_","record","is_certified","certifiedBy","certified_by","details","certification_details","canEdit","onSaveTitle","_onItemChange","_label","checked","disabled","find","column","isRequired","object","func","bool","defaultProps","StackedField","formElement","node","padded","addSuccessToast","addDangerToast","setIsEditing","OwnersSelector","loadOptions","search","page","pageSize","query","encode","filter","page_size","get","endpoint","then","response","data","json","result","item","extra","active","text","totalCount","mode","owners","header","__signature__","_ref2","_ref3","DatasourceEditor","constructor","props","_props$datasource$met","state","owner","id","first_name","last_name","metrics","metric","certifiedByMetric","certificationDetails","certification","warning_markdown","warningMarkdown","JSON","parse","errors","isSqla","datasource_type","isEditMode","databaseColumns","col","expression","calculatedColumns","metadataLoading","activeTabKey","datasourceType","sql","virtual","physical","bind","onChangeEditMode","onDatasourcePropChange","tableChangeAndSyncMetadata","syncMetadata","setColumns","validateAndChange","handleTabSelect","currencies","currencyCode","symbol","newDatasource","setState","prevState","callback","attr","undefined","onDatasourceTypeChange","obj","validate","updateColumns","cols","databaseColumnNames","currentCols","reduce","agg","finalColumns","results","added","modified","removed","includes","currentCol","push","params","database_name","database","catalog_name","catalog","schema_name","schema","table_name","normalize_columns","always_filter_main_dttm","Object","entries","encode_uri","join","catch","error","statusText","findDuplicates","arr","accessor","seen","dups","concat","metric_name","noFilterCalcCols","_this$state$datasourc","_metric$currency","currency","Intl","NumberFormat","style","sortMetrics","sort","a","b","renderSettingsFieldset","inline","minLines","newOwners","renderAdvancedFieldset","renderSpatialTab","spatials","all_cols","allCols","TabPane","tab","config","choices","renderSourceFieldset","_datasource$database","_datasource$database2","_datasource$database3","role","tabIndex","onClick","LockUnlocked","iconColor","grayscale","LockLocked","className","xs","md","db","onCatalogChange","onSchemaChange","onDbChange","formMode","handleError","readOnly","_css","width","marginTop","table","maxLines","Infinity","clearable","dbId","sqlLabMode","tableValue","onTableSelectChange","renderErrors","marginBottom","message","err","renderMetricCollection","sortedMetrics","verbose_name","currencySelectOverrideProps","symbolSelectAdditionalStyles","itemCellProps","initialValue","extraClasses","textAreaStyles","minWidth","maxWidth","d3format","render","fullWidth","defaultActiveKey","buttonSize","buttonStyle","__expanded","gutter","__reactstandin__regenerateByEval","code","eval","DataSourceComponent","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/app/superset-frontend/src/components/Datasource/DatasourceEditor.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport rison from 'rison';\nimport { PureComponent, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { Radio } from 'src/components/Radio';\nimport Card from 'src/components/Card';\nimport Alert from 'src/components/Alert';\nimport Badge from 'src/components/Badge';\nimport { nanoid } from 'nanoid';\nimport {\n  css,\n  isFeatureEnabled,\n  getCurrencySymbol,\n  ensureIsArray,\n  FeatureFlag,\n  styled,\n  SupersetClient,\n  t,\n  withTheme,\n  getClientErrorObject,\n} from '@superset-ui/core';\nimport { Select, AsyncSelect, Row, Col } from 'src/components';\nimport { FormLabel } from 'src/components/Form';\nimport Button from 'src/components/Button';\nimport Tabs from 'src/components/Tabs';\nimport CertifiedBadge from 'src/components/CertifiedBadge';\nimport WarningIconWithTooltip from 'src/components/WarningIconWithTooltip';\nimport DatabaseSelector from 'src/components/DatabaseSelector';\nimport Label from 'src/components/Label';\nimport Loading from 'src/components/Loading';\nimport TableSelector from 'src/components/TableSelector';\nimport EditableTitle from 'src/components/EditableTitle';\nimport CheckboxControl from 'src/explore/components/controls/CheckboxControl';\nimport TextControl from 'src/explore/components/controls/TextControl';\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\nimport SpatialControl from 'src/explore/components/controls/SpatialControl';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport Icons from 'src/components/Icons';\nimport CurrencyControl from 'src/explore/components/controls/CurrencyControl';\nimport CollectionTable from './CollectionTable';\nimport Fieldset from './Fieldset';\nimport Field from './Field';\n\nconst DatasourceContainer = styled.div`\n  .change-warning {\n    margin: 16px 10px 0;\n    color: ${({ theme }) => theme.colors.warning.base};\n  }\n\n  .change-warning .bold {\n    font-weight: ${({ theme }) => theme.typography.weights.bold};\n  }\n\n  .form-group.has-feedback > .help-block {\n    margin-top: 8px;\n  }\n\n  .form-group.form-group-md {\n    margin-bottom: 8px;\n  }\n`;\n\nconst FlexRowContainer = styled.div`\n  align-items: center;\n  display: flex;\n\n  svg {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledTableTabs = styled(Tabs)`\n  overflow: visible;\n  .ant-tabs-content-holder {\n    overflow: visible;\n  }\n`;\n\nconst StyledBadge = styled(Badge)`\n  .antd5-badge-count {\n    line-height: ${({ theme }) => theme.gridUnit * 4}px;\n    height: ${({ theme }) => theme.gridUnit * 4}px;\n    margin-left: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EditLockContainer = styled.div`\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  display: flex;\n  align-items: center;\n  a {\n    padding: 0 10px;\n  }\n`;\n\nconst ColumnButtonWrapper = styled.div`\n  text-align: right;\n  ${({ theme }) => `margin-bottom: ${theme.gridUnit * 2}px`}\n`;\n\nconst StyledLabelWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  span {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledColumnsTabWrapper = styled.div`\n  .table > tbody > tr > td {\n    vertical-align: middle;\n  }\n\n  .ant-tag {\n    margin-top: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst StyledButtonWrapper = styled.span`\n  ${({ theme }) => `\n    margin-top: ${theme.gridUnit * 3}px;\n    margin-left: ${theme.gridUnit * 3}px;\n  `}\n`;\n\nconst checkboxGenerator = (d, onChange) => (\n  <CheckboxControl value={d} onChange={onChange} />\n);\nconst DATA_TYPES = [\n  { value: 'STRING', label: t('STRING') },\n  { value: 'NUMERIC', label: t('NUMERIC') },\n  { value: 'DATETIME', label: t('DATETIME') },\n  { value: 'BOOLEAN', label: t('BOOLEAN') },\n];\n\nconst DATASOURCE_TYPES_ARR = [\n  { key: 'physical', label: t('Physical (table or view)') },\n  { key: 'virtual', label: t('Virtual (SQL)') },\n];\nconst DATASOURCE_TYPES = {};\nDATASOURCE_TYPES_ARR.forEach(o => {\n  DATASOURCE_TYPES[o.key] = o;\n});\n\nfunction CollectionTabTitle({ title, collection }) {\n  return (\n    <div\n      css={{ display: 'flex', alignItems: 'center' }}\n      data-test={`collection-tab-${title}`}\n    >\n      {title}{' '}\n      <StyledBadge count={collection ? collection.length : 0} showZero />\n    </div>\n  );\n}\n\nCollectionTabTitle.propTypes = {\n  title: PropTypes.string,\n  collection: PropTypes.array,\n};\n\nfunction ColumnCollectionTable({\n  columns,\n  datasource,\n  onColumnsChange,\n  onDatasourceChange,\n  editableColumnName,\n  showExpression,\n  allowAddItem,\n  allowEditDataType,\n  itemGenerator,\n  columnLabelTooltips,\n}) {\n  return (\n    <CollectionTable\n      tableColumns={\n        isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes)\n          ? [\n              'column_name',\n              'advanced_data_type',\n              'type',\n              'is_dttm',\n              'main_dttm_col',\n              'filterable',\n              'groupby',\n            ]\n          : [\n              'column_name',\n              'type',\n              'is_dttm',\n              'main_dttm_col',\n              'filterable',\n              'groupby',\n            ]\n      }\n      sortColumns={\n        isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes)\n          ? [\n              'column_name',\n              'advanced_data_type',\n              'type',\n              'is_dttm',\n              'main_dttm_col',\n              'filterable',\n              'groupby',\n            ]\n          : [\n              'column_name',\n              'type',\n              'is_dttm',\n              'main_dttm_col',\n              'filterable',\n              'groupby',\n            ]\n      }\n      allowDeletes\n      allowAddItem={allowAddItem}\n      itemGenerator={itemGenerator}\n      collection={columns}\n      columnLabelTooltips={columnLabelTooltips}\n      stickyHeader\n      expandFieldset={\n        <FormContainer>\n          <Fieldset compact>\n            {showExpression && (\n              <Field\n                fieldKey=\"expression\"\n                label={t('SQL expression')}\n                control={\n                  <TextAreaControl\n                    language=\"markdown\"\n                    offerEditInModal={false}\n                    resize=\"vertical\"\n                  />\n                }\n              />\n            )}\n            <Field\n              fieldKey=\"verbose_name\"\n              label={t('Label')}\n              control={\n                <TextControl\n                  controlId=\"verbose_name\"\n                  placeholder={t('Label')}\n                />\n              }\n            />\n            <Field\n              fieldKey=\"description\"\n              label={t('Description')}\n              control={\n                <TextControl\n                  controlId=\"description\"\n                  placeholder={t('Description')}\n                />\n              }\n            />\n            {allowEditDataType && (\n              <Field\n                fieldKey=\"type\"\n                label={t('Data type')}\n                control={\n                  <Select\n                    ariaLabel={t('Data type')}\n                    options={DATA_TYPES}\n                    name=\"type\"\n                    allowNewOptions\n                    allowClear\n                  />\n                }\n              />\n            )}\n            {isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes) ? (\n              <Field\n                fieldKey=\"advanced_data_type\"\n                label={t('Advanced data type')}\n                control={\n                  <TextControl\n                    controlId=\"advanced_data_type\"\n                    placeholder={t('Advanced Data type')}\n                  />\n                }\n              />\n            ) : (\n              <></>\n            )}\n            <Field\n              fieldKey=\"python_date_format\"\n              label={t('Datetime format')}\n              description={\n                /* Note the fragmented translations may not work. */\n                <div>\n                  {t('The pattern of timestamp format. For strings use ')}\n                  <a href=\"https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior\">\n                    {t('Python datetime string pattern')}\n                  </a>\n                  {t(' expression which needs to adhere to the ')}\n                  <a href=\"https://en.wikipedia.org/wiki/ISO_8601\">\n                    {t('ISO 8601')}\n                  </a>\n                  {t(` standard to ensure that the lexicographical ordering\n                      coincides with the chronological ordering. If the\n                      timestamp format does not adhere to the ISO 8601 standard\n                      you will need to define an expression and type for\n                      transforming the string into a date or timestamp. Note\n                      currently time zones are not supported. If time is stored\n                      in epoch format, put \\`epoch_s\\` or \\`epoch_ms\\`. If no pattern\n                      is specified we fall back to using the optional defaults on a per\n                      database/column name level via the extra parameter.`)}\n                </div>\n              }\n              control={\n                <TextControl\n                  controlId=\"python_date_format\"\n                  placeholder=\"%Y-%m-%d\"\n                />\n              }\n            />\n            <Field\n              fieldKey=\"certified_by\"\n              label={t('Certified By')}\n              description={t('Person or group that has certified this metric')}\n              control={\n                <TextControl\n                  controlId=\"certified\"\n                  placeholder={t('Certified by')}\n                />\n              }\n            />\n            <Field\n              fieldKey=\"certification_details\"\n              label={t('Certification details')}\n              description={t('Details of the certification')}\n              control={\n                <TextControl\n                  controlId=\"certificationDetails\"\n                  placeholder={t('Certification details')}\n                />\n              }\n            />\n          </Fieldset>\n        </FormContainer>\n      }\n      columnLabels={\n        isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes)\n          ? {\n              column_name: t('Column'),\n              advanced_data_type: t('Advanced data type'),\n              type: t('Data type'),\n              groupby: t('Is dimension'),\n              is_dttm: t('Is temporal'),\n              main_dttm_col: t('Default datetime'),\n              filterable: t('Is filterable'),\n            }\n          : {\n              column_name: t('Column'),\n              type: t('Data type'),\n              groupby: t('Is dimension'),\n              is_dttm: t('Is temporal'),\n              main_dttm_col: t('Default datetime'),\n              filterable: t('Is filterable'),\n            }\n      }\n      onChange={onColumnsChange}\n      itemRenderers={\n        isFeatureEnabled(FeatureFlag.EnableAdvancedDataTypes)\n          ? {\n              column_name: (v, onItemChange, _, record) =>\n                editableColumnName ? (\n                  <StyledLabelWrapper>\n                    {record.is_certified && (\n                      <CertifiedBadge\n                        certifiedBy={record.certified_by}\n                        details={record.certification_details}\n                      />\n                    )}\n                    <EditableTitle\n                      canEdit\n                      title={v}\n                      onSaveTitle={onItemChange}\n                    />\n                  </StyledLabelWrapper>\n                ) : (\n                  <StyledLabelWrapper>\n                    {record.is_certified && (\n                      <CertifiedBadge\n                        certifiedBy={record.certified_by}\n                        details={record.certification_details}\n                      />\n                    )}\n                    {v}\n                  </StyledLabelWrapper>\n                ),\n              main_dttm_col: (value, _onItemChange, _label, record) => {\n                const checked = datasource.main_dttm_col === record.column_name;\n                const disabled = !columns.find(\n                  column => column.column_name === record.column_name,\n                ).is_dttm;\n                return (\n                  <Radio\n                    data-test={`radio-default-dttm-${record.column_name}`}\n                    checked={checked}\n                    disabled={disabled}\n                    onChange={() =>\n                      onDatasourceChange({\n                        ...datasource,\n                        main_dttm_col: record.column_name,\n                      })\n                    }\n                  />\n                );\n              },\n              type: d => (d ? <Label>{d}</Label> : null),\n              advanced_data_type: d => (\n                <Label onChange={onColumnsChange}>{d}</Label>\n              ),\n              is_dttm: checkboxGenerator,\n              filterable: checkboxGenerator,\n              groupby: checkboxGenerator,\n            }\n          : {\n              column_name: (v, onItemChange, _, record) =>\n                editableColumnName ? (\n                  <StyledLabelWrapper>\n                    {record.is_certified && (\n                      <CertifiedBadge\n                        certifiedBy={record.certified_by}\n                        details={record.certification_details}\n                      />\n                    )}\n                    <TextControl value={v} onChange={onItemChange} />\n                  </StyledLabelWrapper>\n                ) : (\n                  <StyledLabelWrapper>\n                    {record.is_certified && (\n                      <CertifiedBadge\n                        certifiedBy={record.certified_by}\n                        details={record.certification_details}\n                      />\n                    )}\n                    {v}\n                  </StyledLabelWrapper>\n                ),\n              main_dttm_col: (value, _onItemChange, _label, record) => {\n                const checked = datasource.main_dttm_col === record.column_name;\n                const disabled = !columns.find(\n                  column => column.column_name === record.column_name,\n                ).is_dttm;\n                return (\n                  <Radio\n                    data-test={`radio-default-dttm-${record.column_name}`}\n                    checked={checked}\n                    disabled={disabled}\n                    onChange={() =>\n                      onDatasourceChange({\n                        ...datasource,\n                        main_dttm_col: record.column_name,\n                      })\n                    }\n                  />\n                );\n              },\n              type: d => (d ? <Label>{d}</Label> : null),\n              is_dttm: checkboxGenerator,\n              filterable: checkboxGenerator,\n              groupby: checkboxGenerator,\n            }\n      }\n    />\n  );\n}\nColumnCollectionTable.propTypes = {\n  columns: PropTypes.array.isRequired,\n  datasource: PropTypes.object.isRequired,\n  onColumnsChange: PropTypes.func.isRequired,\n  onDatasourceChange: PropTypes.func.isRequired,\n  editableColumnName: PropTypes.bool,\n  showExpression: PropTypes.bool,\n  allowAddItem: PropTypes.bool,\n  allowEditDataType: PropTypes.bool,\n  itemGenerator: PropTypes.func,\n};\nColumnCollectionTable.defaultProps = {\n  editableColumnName: false,\n  showExpression: false,\n  allowAddItem: false,\n  allowEditDataType: false,\n  itemGenerator: () => ({\n    column_name: t('<new column>'),\n    filterable: true,\n    groupby: true,\n  }),\n};\n\nfunction StackedField({ label, formElement }) {\n  return (\n    <div>\n      <div>\n        <strong>{label}</strong>\n      </div>\n      <div>{formElement}</div>\n    </div>\n  );\n}\n\nStackedField.propTypes = {\n  label: PropTypes.string,\n  formElement: PropTypes.node,\n};\n\nfunction FormContainer({ children }) {\n  return <Card padded>{children}</Card>;\n}\n\nFormContainer.propTypes = {\n  children: PropTypes.node,\n};\n\nconst propTypes = {\n  datasource: PropTypes.object.isRequired,\n  onChange: PropTypes.func,\n  addSuccessToast: PropTypes.func.isRequired,\n  addDangerToast: PropTypes.func.isRequired,\n  setIsEditing: PropTypes.func,\n};\n\nconst defaultProps = {\n  onChange: () => {},\n  setIsEditing: () => {},\n};\n\nfunction OwnersSelector({ datasource, onChange }) {\n  const loadOptions = useCallback((search = '', page, pageSize) => {\n    const query = rison.encode({ filter: search, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dataset/related/owners?q=${query}`,\n    }).then(response => ({\n      data: response.json.result\n        .filter(item => item.extra.active)\n        .map(item => ({\n          value: item.value,\n          label: item.text,\n        })),\n      totalCount: response.json.count,\n    }));\n  }, []);\n\n  return (\n    <AsyncSelect\n      ariaLabel={t('Select owners')}\n      mode=\"multiple\"\n      name=\"owners\"\n      value={datasource.owners}\n      options={loadOptions}\n      onChange={onChange}\n      header={<FormLabel>{t('Owners')}</FormLabel>}\n      allowClear\n    />\n  );\n}\n\nclass DatasourceEditor extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      datasource: {\n        ...props.datasource,\n        owners: props.datasource.owners.map(owner => ({\n          value: owner.value || owner.id,\n          label: owner.label || `${owner.first_name} ${owner.last_name}`,\n        })),\n        metrics: props.datasource.metrics?.map(metric => {\n          const {\n            certified_by: certifiedByMetric,\n            certification_details: certificationDetails,\n          } = metric;\n          const {\n            certification: { details, certified_by: certifiedBy } = {},\n            warning_markdown: warningMarkdown,\n          } = JSON.parse(metric.extra || '{}') || {};\n          return {\n            ...metric,\n            certification_details: certificationDetails || details,\n            warning_markdown: warningMarkdown || '',\n            certified_by: certifiedBy || certifiedByMetric,\n          };\n        }),\n      },\n      errors: [],\n      isSqla:\n        props.datasource.datasource_type === 'table' ||\n        props.datasource.type === 'table',\n      isEditMode: false,\n      databaseColumns: props.datasource.columns.filter(col => !col.expression),\n      calculatedColumns: props.datasource.columns.filter(\n        col => !!col.expression,\n      ),\n      metadataLoading: false,\n      activeTabKey: 0,\n      datasourceType: props.datasource.sql\n        ? DATASOURCE_TYPES.virtual.key\n        : DATASOURCE_TYPES.physical.key,\n    };\n\n    this.onChange = this.onChange.bind(this);\n    this.onChangeEditMode = this.onChangeEditMode.bind(this);\n    this.onDatasourcePropChange = this.onDatasourcePropChange.bind(this);\n    this.onDatasourceChange = this.onDatasourceChange.bind(this);\n    this.tableChangeAndSyncMetadata =\n      this.tableChangeAndSyncMetadata.bind(this);\n    this.syncMetadata = this.syncMetadata.bind(this);\n    this.setColumns = this.setColumns.bind(this);\n    this.validateAndChange = this.validateAndChange.bind(this);\n    this.handleTabSelect = this.handleTabSelect.bind(this);\n    this.currencies = ensureIsArray(props.currencies).map(currencyCode => ({\n      value: currencyCode,\n      label: `${getCurrencySymbol({\n        symbol: currencyCode,\n      })} (${currencyCode})`,\n    }));\n  }\n\n  onChange() {\n    // Emptying SQL if \"Physical\" radio button is selected\n    // Currently the logic to know whether the source is\n    // physical or virtual is based on whether SQL is empty or not.\n    const { datasourceType, datasource } = this.state;\n    const sql =\n      datasourceType === DATASOURCE_TYPES.physical.key ? '' : datasource.sql;\n    const newDatasource = {\n      ...this.state.datasource,\n      sql,\n      columns: [...this.state.databaseColumns, ...this.state.calculatedColumns],\n    };\n    this.props.onChange(newDatasource, this.state.errors);\n  }\n\n  onChangeEditMode() {\n    this.props.setIsEditing(!this.state.isEditMode);\n    this.setState(prevState => ({ isEditMode: !prevState.isEditMode }));\n  }\n\n  onDatasourceChange(datasource, callback = this.validateAndChange) {\n    this.setState({ datasource }, callback);\n  }\n\n  onDatasourcePropChange(attr, value) {\n    if (value === undefined) return; // if value is undefined do not update state\n    const datasource = { ...this.state.datasource, [attr]: value };\n    this.setState(\n      prevState => ({\n        datasource: { ...prevState.datasource, [attr]: value },\n      }),\n      attr === 'table_name'\n        ? this.onDatasourceChange(datasource, this.tableChangeAndSyncMetadata)\n        : this.onDatasourceChange(datasource, this.validateAndChange),\n    );\n  }\n\n  onDatasourceTypeChange(datasourceType) {\n    this.setState({ datasourceType });\n  }\n\n  setColumns(obj) {\n    // update calculatedColumns or databaseColumns\n    this.setState(obj, this.validateAndChange);\n  }\n\n  validateAndChange() {\n    this.validate(this.onChange);\n  }\n\n  tableChangeAndSyncMetadata() {\n    this.validate(() => {\n      this.syncMetadata();\n      this.onChange();\n    });\n  }\n\n  updateColumns(cols) {\n    // cols: Array<{column_name: string; is_dttm: boolean; type: string;}>\n    const { databaseColumns } = this.state;\n    const databaseColumnNames = cols.map(col => col.column_name);\n    const currentCols = databaseColumns.reduce(\n      (agg, col) => ({\n        ...agg,\n        [col.column_name]: col,\n      }),\n      {},\n    );\n    const finalColumns = [];\n    const results = {\n      added: [],\n      modified: [],\n      removed: databaseColumns\n        .map(col => col.column_name)\n        .filter(col => !databaseColumnNames.includes(col)),\n    };\n    cols.forEach(col => {\n      const currentCol = currentCols[col.column_name];\n      if (!currentCol) {\n        // new column\n        finalColumns.push({\n          id: nanoid(),\n          column_name: col.column_name,\n          type: col.type,\n          groupby: true,\n          filterable: true,\n          is_dttm: col.is_dttm,\n        });\n        results.added.push(col.column_name);\n      } else if (\n        currentCol.type !== col.type ||\n        (!currentCol.is_dttm && col.is_dttm)\n      ) {\n        // modified column\n        finalColumns.push({\n          ...currentCol,\n          type: col.type,\n          is_dttm: currentCol.is_dttm || col.is_dttm,\n        });\n        results.modified.push(col.column_name);\n      } else {\n        // unchanged\n        finalColumns.push(currentCol);\n      }\n    });\n    if (\n      results.added.length ||\n      results.modified.length ||\n      results.removed.length\n    ) {\n      this.setColumns({ databaseColumns: finalColumns });\n    }\n    return results;\n  }\n\n  syncMetadata() {\n    const { datasource } = this.state;\n    const params = {\n      datasource_type: datasource.type || datasource.datasource_type,\n      database_name:\n        datasource.database.database_name || datasource.database.name,\n      catalog_name: datasource.catalog,\n      schema_name: datasource.schema,\n      table_name: datasource.table_name,\n      normalize_columns: datasource.normalize_columns,\n      always_filter_main_dttm: datasource.always_filter_main_dttm,\n    };\n    Object.entries(params).forEach(([key, value]) => {\n      // rison can't encode the undefined value\n      if (value === undefined) {\n        params[key] = null;\n      }\n    });\n    const endpoint = `/datasource/external_metadata_by_name/?q=${rison.encode_uri(\n      params,\n    )}`;\n    this.setState({ metadataLoading: true });\n\n    SupersetClient.get({ endpoint })\n      .then(({ json }) => {\n        const results = this.updateColumns(json);\n        if (results.modified.length) {\n          this.props.addSuccessToast(\n            t('Modified columns: %s', results.modified.join(', ')),\n          );\n        }\n        if (results.removed.length) {\n          this.props.addSuccessToast(\n            t('Removed columns: %s', results.removed.join(', ')),\n          );\n        }\n        if (results.added.length) {\n          this.props.addSuccessToast(\n            t('New columns added: %s', results.added.join(', ')),\n          );\n        }\n        this.props.addSuccessToast(t('Metadata has been synced'));\n        this.setState({ metadataLoading: false });\n      })\n      .catch(response =>\n        getClientErrorObject(response).then(({ error, statusText }) => {\n          this.props.addDangerToast(\n            error || statusText || t('An error has occurred'),\n          );\n          this.setState({ metadataLoading: false });\n        }),\n      );\n  }\n\n  findDuplicates(arr, accessor) {\n    const seen = {};\n    const dups = [];\n    arr.forEach(obj => {\n      const item = accessor(obj);\n      if (item in seen) {\n        dups.push(item);\n      } else {\n        seen[item] = null;\n      }\n    });\n    return dups;\n  }\n\n  validate(callback) {\n    let errors = [];\n    let dups;\n    const { datasource } = this.state;\n\n    // Looking for duplicate column_name\n    dups = this.findDuplicates(datasource.columns, obj => obj.column_name);\n    errors = errors.concat(\n      dups.map(name => t('Column name [%s] is duplicated', name)),\n    );\n\n    // Looking for duplicate metric_name\n    dups = this.findDuplicates(datasource.metrics, obj => obj.metric_name);\n    errors = errors.concat(\n      dups.map(name => t('Metric name [%s] is duplicated', name)),\n    );\n\n    // Making sure calculatedColumns have an expression defined\n    const noFilterCalcCols = this.state.calculatedColumns.filter(\n      col => !col.expression && !col.json,\n    );\n    errors = errors.concat(\n      noFilterCalcCols.map(col =>\n        t('Calculated column [%s] requires an expression', col.column_name),\n      ),\n    );\n\n    // validate currency code\n    try {\n      this.state.datasource.metrics?.forEach(\n        metric =>\n          metric.currency?.symbol &&\n          new Intl.NumberFormat('en-US', {\n            style: 'currency',\n            currency: metric.currency.symbol,\n          }),\n      );\n    } catch {\n      errors = errors.concat([t('Invalid currency code in saved metrics')]);\n    }\n\n    this.setState({ errors }, callback);\n  }\n\n  handleTabSelect(activeTabKey) {\n    this.setState({ activeTabKey });\n  }\n\n  sortMetrics(metrics) {\n    return metrics.sort(({ id: a }, { id: b }) => b - a);\n  }\n\n  renderSettingsFieldset() {\n    const { datasource } = this.state;\n    return (\n      <Fieldset\n        title={t('Basic')}\n        item={datasource}\n        onChange={this.onDatasourceChange}\n      >\n        <Field\n          fieldKey=\"description\"\n          label={t('Description')}\n          control={\n            <TextAreaControl\n              language=\"markdown\"\n              offerEditInModal={false}\n              resize=\"vertical\"\n            />\n          }\n        />\n        <Field\n          fieldKey=\"default_endpoint\"\n          label={t('Default URL')}\n          description={t(\n            'Default URL to redirect to when accessing from the dataset list page',\n          )}\n          control={<TextControl controlId=\"default_endpoint\" />}\n        />\n        <Field\n          inline\n          fieldKey=\"filter_select_enabled\"\n          label={t('Autocomplete filters')}\n          description={t('Whether to populate autocomplete filters options')}\n          control={<CheckboxControl />}\n        />\n        {this.state.isSqla && (\n          <Field\n            fieldKey=\"fetch_values_predicate\"\n            label={t('Autocomplete query predicate')}\n            description={t(\n              'When using \"Autocomplete filters\", this can be used to improve performance ' +\n                'of the query fetching the values. Use this option to apply a ' +\n                'predicate (WHERE clause) to the query selecting the distinct ' +\n                'values from the table. Typically the intent would be to limit the scan ' +\n                'by applying a relative time filter on a partitioned or indexed time-related field.',\n            )}\n            control={\n              <TextAreaControl\n                language=\"sql\"\n                controlId=\"fetch_values_predicate\"\n                minLines={5}\n                resize=\"vertical\"\n              />\n            }\n          />\n        )}\n        {this.state.isSqla && (\n          <Field\n            fieldKey=\"extra\"\n            label={t('Extra')}\n            description={t(\n              'Extra data to specify table metadata. Currently supports ' +\n                'metadata of the format: `{ \"certification\": { \"certified_by\": ' +\n                '\"Data Platform Team\", \"details\": \"This table is the source of truth.\" ' +\n                '}, \"warning_markdown\": \"This is a warning.\" }`.',\n            )}\n            control={\n              <TextAreaControl\n                controlId=\"extra\"\n                language=\"json\"\n                offerEditInModal={false}\n                resize=\"vertical\"\n              />\n            }\n          />\n        )}\n        <OwnersSelector\n          datasource={datasource}\n          onChange={newOwners => {\n            this.onDatasourceChange({ ...datasource, owners: newOwners });\n          }}\n        />\n      </Fieldset>\n    );\n  }\n\n  renderAdvancedFieldset() {\n    const { datasource } = this.state;\n    return (\n      <Fieldset\n        title={t('Advanced')}\n        item={datasource}\n        onChange={this.onDatasourceChange}\n      >\n        <Field\n          fieldKey=\"cache_timeout\"\n          label={t('Cache timeout')}\n          description={t(\n            'The duration of time in seconds before the cache is invalidated. Set to -1 to bypass the cache.',\n          )}\n          control={<TextControl controlId=\"cache_timeout\" />}\n        />\n        <Field\n          fieldKey=\"offset\"\n          label={t('Hours offset')}\n          control={<TextControl controlId=\"offset\" />}\n          description={t(\n            'The number of hours, negative or positive, to shift the time column. This can be used to move UTC time to local time.',\n          )}\n        />\n        {this.state.isSqla && (\n          <Field\n            fieldKey=\"template_params\"\n            label={t('Template parameters')}\n            description={t(\n              'A set of parameters that become available in the query using Jinja templating syntax',\n            )}\n            control={<TextControl controlId=\"template_params\" />}\n          />\n        )}\n        <Field\n          inline\n          fieldKey=\"normalize_columns\"\n          label={t('Normalize column names')}\n          description={t(\n            'Allow column names to be changed to case insensitive format, if supported (e.g. Oracle, Snowflake).',\n          )}\n          control={<CheckboxControl controlId=\"normalize_columns\" />}\n        />\n        <Field\n          inline\n          fieldKey=\"always_filter_main_dttm\"\n          label={t('Always filter main datetime column')}\n          description={t(\n            `When the secondary temporal columns are filtered, apply the same filter to the main datetime column.`,\n          )}\n          control={<CheckboxControl controlId=\"always_filter_main_dttm\" />}\n        />\n      </Fieldset>\n    );\n  }\n\n  renderSpatialTab() {\n    const { datasource } = this.state;\n    const { spatials, all_cols: allCols } = datasource;\n    return (\n      <Tabs.TabPane\n        tab={<CollectionTabTitle collection={spatials} title={t('Spatial')} />}\n        key={4}\n      >\n        <CollectionTable\n          tableColumns={['name', 'config']}\n          onChange={this.onDatasourcePropChange.bind(this, 'spatials')}\n          itemGenerator={() => ({\n            name: t('<new spatial>'),\n            type: t('<no type>'),\n            config: null,\n          })}\n          collection={spatials}\n          allowDeletes\n          itemRenderers={{\n            name: (d, onChange) => (\n              <EditableTitle canEdit title={d} onSaveTitle={onChange} />\n            ),\n            config: (v, onChange) => (\n              <SpatialControl value={v} onChange={onChange} choices={allCols} />\n            ),\n          }}\n        />\n      </Tabs.TabPane>\n    );\n  }\n\n  renderSourceFieldset(theme) {\n    const { datasource } = this.state;\n    return (\n      <div>\n        <EditLockContainer>\n          <span role=\"button\" tabIndex={0} onClick={this.onChangeEditMode}>\n            {this.state.isEditMode ? (\n              <Icons.LockUnlocked iconColor={theme.colors.grayscale.base} />\n            ) : (\n              <Icons.LockLocked iconColor={theme.colors.grayscale.base} />\n            )}\n          </span>\n          {!this.state.isEditMode && (\n            <div>{t('Click the lock to make changes.')}</div>\n          )}\n          {this.state.isEditMode && (\n            <div>{t('Click the lock to prevent further changes.')}</div>\n          )}\n        </EditLockContainer>\n        <div className=\"m-l-10 m-t-20 m-b-10\">\n          {DATASOURCE_TYPES_ARR.map(type => (\n            <Radio\n              key={type.key}\n              value={type.key}\n              inline\n              onChange={this.onDatasourceTypeChange.bind(this, type.key)}\n              checked={this.state.datasourceType === type.key}\n              disabled={!this.state.isEditMode}\n            >\n              {type.label}\n            </Radio>\n          ))}\n        </div>\n        <hr />\n        <Fieldset item={datasource} onChange={this.onDatasourceChange} compact>\n          {this.state.datasourceType === DATASOURCE_TYPES.virtual.key && (\n            <div>\n              {this.state.isSqla && (\n                <>\n                  <Col xs={24} md={12}>\n                    <Field\n                      fieldKey=\"databaseSelector\"\n                      label={t('virtual')}\n                      control={\n                        <div css={{ marginTop: 8 }}>\n                          <DatabaseSelector\n                            db={datasource?.database}\n                            catalog={datasource.catalog}\n                            schema={datasource.schema}\n                            onCatalogChange={catalog =>\n                              this.state.isEditMode &&\n                              this.onDatasourcePropChange('catalog', catalog)\n                            }\n                            onSchemaChange={schema =>\n                              this.state.isEditMode &&\n                              this.onDatasourcePropChange('schema', schema)\n                            }\n                            onDbChange={database =>\n                              this.state.isEditMode &&\n                              this.onDatasourcePropChange('database', database)\n                            }\n                            formMode={false}\n                            handleError={this.props.addDangerToast}\n                            readOnly={!this.state.isEditMode}\n                          />\n                        </div>\n                      }\n                    />\n                    <div css={{ width: 'calc(100% - 34px)', marginTop: -16 }}>\n                      <Field\n                        fieldKey=\"table_name\"\n                        label={t('Name')}\n                        control={\n                          <TextControl\n                            controlId=\"table_name\"\n                            onChange={table => {\n                              this.onDatasourcePropChange('table_name', table);\n                            }}\n                            placeholder={t('Dataset name')}\n                            disabled={!this.state.isEditMode}\n                          />\n                        }\n                      />\n                    </div>\n                  </Col>\n                  <Field\n                    fieldKey=\"sql\"\n                    label={t('SQL')}\n                    description={t(\n                      'When specifying SQL, the datasource acts as a view. ' +\n                        'Superset will use this statement as a subquery while grouping and filtering ' +\n                        'on the generated parent queries.',\n                    )}\n                    control={\n                      <TextAreaControl\n                        language=\"sql\"\n                        offerEditInModal={false}\n                        minLines={20}\n                        maxLines={Infinity}\n                        readOnly={!this.state.isEditMode}\n                        resize=\"both\"\n                      />\n                    }\n                  />\n                </>\n              )}\n            </div>\n          )}\n          {this.state.datasourceType === DATASOURCE_TYPES.physical.key && (\n            <Col xs={24} md={12}>\n              {this.state.isSqla && (\n                <Field\n                  fieldKey=\"tableSelector\"\n                  label={t('Physical')}\n                  control={\n                    <div css={{ marginTop: 8 }}>\n                      <TableSelector\n                        clearable={false}\n                        database={{\n                          ...datasource.database,\n                          database_name:\n                            datasource.database?.database_name ||\n                            datasource.database?.name,\n                        }}\n                        dbId={datasource.database?.id}\n                        handleError={this.props.addDangerToast}\n                        catalog={datasource.catalog}\n                        schema={datasource.schema}\n                        sqlLabMode={false}\n                        tableValue={datasource.table_name}\n                        onCatalogChange={\n                          this.state.isEditMode\n                            ? catalog =>\n                                this.onDatasourcePropChange('catalog', catalog)\n                            : undefined\n                        }\n                        onSchemaChange={\n                          this.state.isEditMode\n                            ? schema =>\n                                this.onDatasourcePropChange('schema', schema)\n                            : undefined\n                        }\n                        onDbChange={\n                          this.state.isEditMode\n                            ? database =>\n                                this.onDatasourcePropChange(\n                                  'database',\n                                  database,\n                                )\n                            : undefined\n                        }\n                        onTableSelectChange={\n                          this.state.isEditMode\n                            ? table =>\n                                this.onDatasourcePropChange('table_name', table)\n                            : undefined\n                        }\n                        readOnly={!this.state.isEditMode}\n                      />\n                    </div>\n                  }\n                  description={t(\n                    'The pointer to a physical table (or view). Keep in mind that the chart is ' +\n                      'associated to this Superset logical table, and this logical table points ' +\n                      'the physical table referenced here.',\n                  )}\n                />\n              )}\n            </Col>\n          )}\n        </Fieldset>\n      </div>\n    );\n  }\n\n  renderErrors() {\n    if (this.state.errors.length > 0) {\n      return (\n        <Alert\n          css={theme => ({ marginBottom: theme.gridUnit * 4 })}\n          type=\"error\"\n          message={\n            <>\n              {this.state.errors.map(err => (\n                <div key={err}>{err}</div>\n              ))}\n            </>\n          }\n        />\n      );\n    }\n    return null;\n  }\n\n  renderMetricCollection() {\n    const { datasource } = this.state;\n    const { metrics } = datasource;\n    const sortedMetrics = metrics?.length ? this.sortMetrics(metrics) : [];\n    return (\n      <CollectionTable\n        tableColumns={['metric_name', 'verbose_name', 'expression']}\n        sortColumns={['metric_name', 'verbose_name', 'expression']}\n        columnLabels={{\n          metric_name: t('Metric Key'),\n          verbose_name: t('Label'),\n          expression: t('SQL expression'),\n        }}\n        columnLabelTooltips={{\n          metric_name: t(\n            'This field is used as a unique identifier to attach ' +\n              'the metric to charts. It is also used as the alias in the ' +\n              'SQL query.',\n          ),\n        }}\n        expandFieldset={\n          <FormContainer>\n            <Fieldset compact>\n              <Field\n                fieldKey=\"description\"\n                label={t('Description')}\n                control={\n                  <TextControl\n                    controlId=\"description\"\n                    placeholder={t('Description')}\n                  />\n                }\n              />\n              <Field\n                fieldKey=\"d3format\"\n                label={t('D3 format')}\n                control={\n                  <TextControl controlId=\"d3format\" placeholder=\"%y/%m/%d\" />\n                }\n              />\n              <Field\n                fieldKey=\"currency\"\n                label={t('Metric currency')}\n                control={\n                  <CurrencyControl\n                    currencySelectOverrideProps={{\n                      placeholder: t('Select or type currency symbol'),\n                    }}\n                    symbolSelectAdditionalStyles={css`\n                      max-width: 30%;\n                    `}\n                  />\n                }\n              />\n              <Field\n                label={t('Certified by')}\n                fieldKey=\"certified_by\"\n                description={t(\n                  'Person or group that has certified this metric',\n                )}\n                control={\n                  <TextControl\n                    controlId=\"certified_by\"\n                    placeholder={t('Certified by')}\n                  />\n                }\n              />\n              <Field\n                label={t('Certification details')}\n                fieldKey=\"certification_details\"\n                description={t('Details of the certification')}\n                control={\n                  <TextControl\n                    controlId=\"certification_details\"\n                    placeholder={t('Certification details')}\n                  />\n                }\n              />\n              <Field\n                label={t('Warning')}\n                fieldKey=\"warning_markdown\"\n                description={t('Optional warning about use of this metric')}\n                control={\n                  <TextAreaControl\n                    controlId=\"warning_markdown\"\n                    language=\"markdown\"\n                    offerEditInModal={false}\n                    resize=\"vertical\"\n                  />\n                }\n              />\n            </Fieldset>\n          </FormContainer>\n        }\n        collection={sortedMetrics}\n        allowAddItem\n        onChange={this.onDatasourcePropChange.bind(this, 'metrics')}\n        itemGenerator={() => ({\n          metric_name: t('<new metric>'),\n          verbose_name: '',\n          expression: '',\n        })}\n        itemCellProps={{\n          expression: () => ({\n            width: '240px',\n          }),\n        }}\n        itemRenderers={{\n          metric_name: (v, onChange, _, record) => (\n            <FlexRowContainer>\n              {record.is_certified && (\n                <CertifiedBadge\n                  certifiedBy={record.certified_by}\n                  details={record.certification_details}\n                />\n              )}\n              {record.warning_markdown && (\n                <WarningIconWithTooltip\n                  warningMarkdown={record.warning_markdown}\n                />\n              )}\n              <EditableTitle canEdit title={v} onSaveTitle={onChange} />\n            </FlexRowContainer>\n          ),\n          verbose_name: (v, onChange) => (\n            <TextControl canEdit value={v} onChange={onChange} />\n          ),\n          expression: (v, onChange) => (\n            <TextAreaControl\n              canEdit\n              initialValue={v}\n              onChange={onChange}\n              extraClasses={['datasource-sql-expression']}\n              language=\"sql\"\n              offerEditInModal={false}\n              minLines={5}\n              textAreaStyles={{ minWidth: '200px', maxWidth: '450px' }}\n              resize=\"both\"\n            />\n          ),\n          description: (v, onChange, label) => (\n            <StackedField\n              label={label}\n              formElement={<TextControl value={v} onChange={onChange} />}\n            />\n          ),\n          d3format: (v, onChange, label) => (\n            <StackedField\n              label={label}\n              formElement={<TextControl value={v} onChange={onChange} />}\n            />\n          ),\n        }}\n        allowDeletes\n        stickyHeader\n      />\n    );\n  }\n\n  render() {\n    const { datasource, activeTabKey } = this.state;\n    const { metrics } = datasource;\n    const sortedMetrics = metrics?.length ? this.sortMetrics(metrics) : [];\n    const { theme } = this.props;\n\n    return (\n      <DatasourceContainer data-test=\"datasource-editor\">\n        {this.renderErrors()}\n        <Alert\n          css={theme => ({ marginBottom: theme.gridUnit * 4 })}\n          type=\"warning\"\n          message={\n            <>\n              {' '}\n              <strong>{t('Be careful.')} </strong>\n              {t(\n                'Changing these settings will affect all charts using this dataset, including charts owned by other people.',\n              )}\n            </>\n          }\n        />\n        <StyledTableTabs\n          fullWidth={false}\n          id=\"table-tabs\"\n          data-test=\"edit-dataset-tabs\"\n          onChange={this.handleTabSelect}\n          defaultActiveKey={activeTabKey}\n        >\n          <Tabs.TabPane key={0} tab={t('Source')}>\n            {this.renderSourceFieldset(theme)}\n          </Tabs.TabPane>\n          <Tabs.TabPane\n            tab={\n              <CollectionTabTitle\n                collection={sortedMetrics}\n                title={t('Metrics')}\n              />\n            }\n            key={1}\n          >\n            {this.renderMetricCollection()}\n          </Tabs.TabPane>\n          <Tabs.TabPane\n            tab={\n              <CollectionTabTitle\n                collection={this.state.databaseColumns}\n                title={t('Columns')}\n              />\n            }\n            key={2}\n          >\n            <StyledColumnsTabWrapper>\n              <ColumnButtonWrapper>\n                <StyledButtonWrapper>\n                  <Button\n                    buttonSize=\"small\"\n                    buttonStyle=\"tertiary\"\n                    onClick={this.syncMetadata}\n                    className=\"sync-from-source\"\n                    disabled={this.state.isEditMode}\n                  >\n                    <i className=\"fa fa-database\" />{' '}\n                    {t('Sync columns from source')}\n                  </Button>\n                </StyledButtonWrapper>\n              </ColumnButtonWrapper>\n              <ColumnCollectionTable\n                className=\"columns-table\"\n                columns={this.state.databaseColumns}\n                datasource={datasource}\n                onColumnsChange={databaseColumns =>\n                  this.setColumns({ databaseColumns })\n                }\n                onDatasourceChange={this.onDatasourceChange}\n              />\n              {this.state.metadataLoading && <Loading />}\n            </StyledColumnsTabWrapper>\n          </Tabs.TabPane>\n          <Tabs.TabPane\n            tab={\n              <CollectionTabTitle\n                collection={this.state.calculatedColumns}\n                title={t('Calculated columns')}\n              />\n            }\n            key={3}\n          >\n            <StyledColumnsTabWrapper>\n              <ColumnCollectionTable\n                columns={this.state.calculatedColumns}\n                onColumnsChange={calculatedColumns =>\n                  this.setColumns({ calculatedColumns })\n                }\n                columnLabelTooltips={{\n                  column_name: t(\n                    'This field is used as a unique identifier to attach ' +\n                      'the calculated dimension to charts. It is also used ' +\n                      'as the alias in the SQL query.',\n                  ),\n                }}\n                onDatasourceChange={this.onDatasourceChange}\n                datasource={datasource}\n                editableColumnName\n                showExpression\n                allowAddItem\n                allowEditDataType\n                itemGenerator={() => ({\n                  column_name: t('<new column>'),\n                  filterable: true,\n                  groupby: true,\n                  expression: t('<enter SQL expression here>'),\n                  __expanded: true,\n                })}\n              />\n            </StyledColumnsTabWrapper>\n          </Tabs.TabPane>\n          <Tabs.TabPane key={4} tab={t('Settings')}>\n            <Row gutter={16}>\n              <Col xs={24} md={12}>\n                <FormContainer>{this.renderSettingsFieldset()}</FormContainer>\n              </Col>\n              <Col xs={24} md={12}>\n                <FormContainer>{this.renderAdvancedFieldset()}</FormContainer>\n              </Col>\n            </Row>\n          </Tabs.TabPane>\n        </StyledTableTabs>\n      </DatasourceContainer>\n    );\n  }\n}\n\nDatasourceEditor.defaultProps = defaultProps;\nDatasourceEditor.propTypes = propTypes;\n\nconst DataSourceComponent = withTheme(DatasourceEditor);\n\nexport default withToasts(DataSourceComponent);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}