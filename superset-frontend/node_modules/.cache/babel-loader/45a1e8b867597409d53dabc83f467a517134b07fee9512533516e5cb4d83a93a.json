{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Input, TextArea } from 'src/components/Input';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { URL_PARAMS } from 'src/constants';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport { CopyButton } from './DataTableControl';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\n\nconst CopyButtonEmbedCode = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EmbedCodeContent = ({ formData, addDangerToast }) => {\n  const [height, setHeight] = useState('400');\n  const [width, setWidth] = useState('600');\n  const [url, setUrl] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleInputChange = useCallback((e) => {\n    const { value, name } = e.currentTarget;\n    if (name === 'width') {\n      setWidth(value);\n    }\n    if (name === 'height') {\n      setHeight(value);\n    }\n  }, []);\n\n  const updateUrl = useCallback(() => {\n    setUrl('');\n    getChartPermalink(formData).\n    then((url) => {\n      setUrl(url);\n      setErrorMessage('');\n    }).\n    catch(() => {\n      setErrorMessage(t('Error'));\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    });\n  }, [addDangerToast, formData]);\n\n  useEffect(() => {\n    updateUrl();\n  }, []);\n\n  const html = useMemo(() => {\n    if (!url) return '';\n    const srcLink = `${url}?${URL_PARAMS.standalone.name}=1&height=${height}`;\n    return (\n      '<iframe\\n' +\n      `  width=\"${width}\"\\n` +\n      `  height=\"${height}\"\\n` +\n      '  seamless\\n' +\n      '  frameBorder=\"0\"\\n' +\n      '  scrolling=\"no\"\\n' +\n      `  src=\"${srcLink}\"\\n` +\n      '>\\n' +\n      '</iframe>');\n\n  }, [height, url, width]);\n\n  const text = errorMessage || html || t('Generating link, please wait..');\n  return (\n    _jsxs(\"div\", { id: \"embed-code-popover\", \"data-test\": \"embed-code-popover\", children: [\n      _jsxs(\"div\", {\n        css: css`\n          display: flex;\n          flex-direction: column;\n        `, children: [\n\n        _jsx(CopyToClipboard, {\n          shouldShowText: false,\n          text: html,\n          copyNode:\n          _jsx(CopyButtonEmbedCode, { buttonSize: \"xsmall\", children:\n            _jsx(\"i\", { className: \"fa fa-clipboard\" }) }\n          ) }\n\n        ),\n        _jsx(TextArea, {\n          \"data-test\": \"embed-code-textarea\",\n          name: \"embedCode\",\n          disabled: !html,\n          value: text,\n          rows: \"4\",\n          readOnly: true,\n          css: (theme) => css`\n            resize: vertical;\n            padding: ${theme.gridUnit * 2}px;\n            font-size: ${theme.typography.sizes.s}px;\n            border-radius: 4px;\n            background-color: ${theme.colors.secondary.light5};\n          ` }\n        )] }\n      ),\n      _jsxs(\"div\", {\n        css: (theme) => css`\n          display: flex;\n          margin-top: ${theme.gridUnit * 4}px;\n          & > div {\n            margin-right: ${theme.gridUnit * 2}px;\n          }\n          & > div:last-of-type {\n            margin-right: 0;\n            margin-left: ${theme.gridUnit * 2}px;\n          }\n        `, children: [\n\n        _jsxs(\"div\", { children: [\n          _jsx(\"label\", { htmlFor: \"embed-height\", children: t('Chart height') }),\n          _jsx(Input, {\n            type: \"text\",\n            defaultValue: height,\n            name: \"height\",\n            onChange: handleInputChange }\n          )] }\n        ),\n        _jsxs(\"div\", { children: [\n          _jsx(\"label\", { htmlFor: \"embed-width\", children: t('Chart width') }),\n          _jsx(Input, {\n            type: \"text\",\n            defaultValue: width,\n            name: \"width\",\n            onChange: handleInputChange,\n            id: \"embed-width\" }\n          )] }\n        )] }\n      )] }\n    ));\n\n};__signature__(EmbedCodeContent, \"useState{[height, setHeight]('400')}\\nuseState{[width, setWidth]('600')}\\nuseState{[url, setUrl]('')}\\nuseState{[errorMessage, setErrorMessage]('')}\\nuseCallback{handleInputChange}\\nuseCallback{updateUrl}\\nuseEffect{}\\nuseMemo{html}\");const _default =\n\nEmbedCodeContent;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(CopyButtonEmbedCode, \"CopyButtonEmbedCode\", \"/app/superset-frontend/src/explore/components/EmbedCodeContent.jsx\");reactHotLoader.register(EmbedCodeContent, \"EmbedCodeContent\", \"/app/superset-frontend/src/explore/components/EmbedCodeContent.jsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/explore/components/EmbedCodeContent.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useEffect","useMemo","useState","css","styled","t","Input","TextArea","CopyToClipboard","URL_PARAMS","getChartPermalink","CopyButton","jsx","_jsx","jsxs","_jsxs","CopyButtonEmbedCode","theme","gridUnit","EmbedCodeContent","formData","addDangerToast","height","setHeight","width","setWidth","url","setUrl","errorMessage","setErrorMessage","handleInputChange","e","value","name","currentTarget","updateUrl","then","catch","html","srcLink","standalone","text","id","children","shouldShowText","copyNode","buttonSize","className","disabled","rows","readOnly","typography","sizes","s","colors","secondary","light5","htmlFor","type","defaultValue","onChange","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/explore/components/EmbedCodeContent.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Input, TextArea } from 'src/components/Input';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { URL_PARAMS } from 'src/constants';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport { CopyButton } from './DataTableControl';\n\nconst CopyButtonEmbedCode = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EmbedCodeContent = ({ formData, addDangerToast }) => {\n  const [height, setHeight] = useState('400');\n  const [width, setWidth] = useState('600');\n  const [url, setUrl] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleInputChange = useCallback(e => {\n    const { value, name } = e.currentTarget;\n    if (name === 'width') {\n      setWidth(value);\n    }\n    if (name === 'height') {\n      setHeight(value);\n    }\n  }, []);\n\n  const updateUrl = useCallback(() => {\n    setUrl('');\n    getChartPermalink(formData)\n      .then(url => {\n        setUrl(url);\n        setErrorMessage('');\n      })\n      .catch(() => {\n        setErrorMessage(t('Error'));\n        addDangerToast(t('Sorry, something went wrong. Try again later.'));\n      });\n  }, [addDangerToast, formData]);\n\n  useEffect(() => {\n    updateUrl();\n  }, []);\n\n  const html = useMemo(() => {\n    if (!url) return '';\n    const srcLink = `${url}?${URL_PARAMS.standalone.name}=1&height=${height}`;\n    return (\n      '<iframe\\n' +\n      `  width=\"${width}\"\\n` +\n      `  height=\"${height}\"\\n` +\n      '  seamless\\n' +\n      '  frameBorder=\"0\"\\n' +\n      '  scrolling=\"no\"\\n' +\n      `  src=\"${srcLink}\"\\n` +\n      '>\\n' +\n      '</iframe>'\n    );\n  }, [height, url, width]);\n\n  const text = errorMessage || html || t('Generating link, please wait..');\n  return (\n    <div id=\"embed-code-popover\" data-test=\"embed-code-popover\">\n      <div\n        css={css`\n          display: flex;\n          flex-direction: column;\n        `}\n      >\n        <CopyToClipboard\n          shouldShowText={false}\n          text={html}\n          copyNode={\n            <CopyButtonEmbedCode buttonSize=\"xsmall\">\n              <i className=\"fa fa-clipboard\" />\n            </CopyButtonEmbedCode>\n          }\n        />\n        <TextArea\n          data-test=\"embed-code-textarea\"\n          name=\"embedCode\"\n          disabled={!html}\n          value={text}\n          rows=\"4\"\n          readOnly\n          css={theme => css`\n            resize: vertical;\n            padding: ${theme.gridUnit * 2}px;\n            font-size: ${theme.typography.sizes.s}px;\n            border-radius: 4px;\n            background-color: ${theme.colors.secondary.light5};\n          `}\n        />\n      </div>\n      <div\n        css={theme => css`\n          display: flex;\n          margin-top: ${theme.gridUnit * 4}px;\n          & > div {\n            margin-right: ${theme.gridUnit * 2}px;\n          }\n          & > div:last-of-type {\n            margin-right: 0;\n            margin-left: ${theme.gridUnit * 2}px;\n          }\n        `}\n      >\n        <div>\n          <label htmlFor=\"embed-height\">{t('Chart height')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={height}\n            name=\"height\"\n            onChange={handleInputChange}\n          />\n        </div>\n        <div>\n          <label htmlFor=\"embed-width\">{t('Chart width')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={width}\n            name=\"width\"\n            onChange={handleInputChange}\n            id=\"embed-width\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmbedCodeContent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}