{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useHistory } from 'react-router-dom';\nimport Button from 'src/components/Button';\nimport { t } from '@superset-ui/core';\nimport { useSingleViewResource } from 'src/views/CRUD/hooks';\nimport { logEvent } from 'src/logger/actions';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { LOG_ACTIONS_DATASET_CREATION_EMPTY_CANCELLATION, LOG_ACTIONS_DATASET_CREATION_DATABASE_CANCELLATION, LOG_ACTIONS_DATASET_CREATION_SCHEMA_CANCELLATION, LOG_ACTIONS_DATASET_CREATION_TABLE_CANCELLATION, LOG_ACTIONS_DATASET_CREATION_SUCCESS } from 'src/logger/LogUtils';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst INPUT_FIELDS = ['db', 'schema', 'table_name'];\nconst LOG_ACTIONS = [\nLOG_ACTIONS_DATASET_CREATION_EMPTY_CANCELLATION,\nLOG_ACTIONS_DATASET_CREATION_DATABASE_CANCELLATION,\nLOG_ACTIONS_DATASET_CREATION_SCHEMA_CANCELLATION,\nLOG_ACTIONS_DATASET_CREATION_TABLE_CANCELLATION];\n\nfunction Footer({ datasetObject, addDangerToast, hasColumns = false, datasets }) {\n  const history = useHistory();\n  const { createResource } = useSingleViewResource('dataset', t('dataset'), addDangerToast);\n  const createLogAction = (dataset) => {\n    let totalCount = 0;\n    const value = Object.keys(dataset).reduce((total, key) => {\n      if (INPUT_FIELDS.includes(key) && dataset[key]) {\n        totalCount += 1;\n      }\n      return totalCount;\n    }, 0);\n    return LOG_ACTIONS[value];\n  };\n  const cancelButtonOnClick = () => {\n    if (!datasetObject) {\n      logEvent(LOG_ACTIONS_DATASET_CREATION_EMPTY_CANCELLATION, {});\n    } else\n    {\n      const logAction = createLogAction(datasetObject);\n      logEvent(logAction, datasetObject);\n    }\n    history.goBack();\n  };\n  const tooltipText = t('Select a database table.');\n  const onSave = () => {\n    if (datasetObject) {var _datasetObject$db;\n      const data = {\n        database: (_datasetObject$db = datasetObject.db) == null ? void 0 : _datasetObject$db.id,\n        catalog: datasetObject.catalog,\n        schema: datasetObject.schema,\n        table_name: datasetObject.table_name\n      };\n      createResource(data).then((response) => {\n        if (!response) {\n          return;\n        }\n        if (typeof response === 'number') {\n          logEvent(LOG_ACTIONS_DATASET_CREATION_SUCCESS, datasetObject);\n          // When a dataset is created the response we get is its ID number\n          history.push(`/chart/add/?dataset=${datasetObject.table_name}`);\n        }\n      });\n    }\n  };\n  const CREATE_DATASET_TEXT = t('Create dataset and create chart');\n  const disabledCheck = !(datasetObject != null && datasetObject.table_name) ||\n  !hasColumns || (\n  datasets == null ? void 0 : datasets.includes(datasetObject == null ? void 0 : datasetObject.table_name));\n  return _jsxs(_Fragment, { children: [\n    _jsx(Button, { onClick: cancelButtonOnClick, children: t('Cancel') }),\n    _jsx(Button, { buttonStyle: \"primary\", disabled: disabledCheck, tooltip: !(datasetObject != null && datasetObject.table_name) ? tooltipText : undefined, onClick: onSave, children:\n      CREATE_DATASET_TEXT }\n    )] }\n  );\n}__signature__(Footer, \"useHistory{history}\\nuseSingleViewResource{{ createResource }}\", () => [useHistory, useSingleViewResource]);const _default =\nwithToasts(Footer);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(INPUT_FIELDS, \"INPUT_FIELDS\", \"/app/superset-frontend/src/features/datasets/AddDataset/Footer/index.tsx\");reactHotLoader.register(LOG_ACTIONS, \"LOG_ACTIONS\", \"/app/superset-frontend/src/features/datasets/AddDataset/Footer/index.tsx\");reactHotLoader.register(Footer, \"Footer\", \"/app/superset-frontend/src/features/datasets/AddDataset/Footer/index.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/features/datasets/AddDataset/Footer/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useHistory","Button","t","useSingleViewResource","logEvent","withToasts","LOG_ACTIONS_DATASET_CREATION_EMPTY_CANCELLATION","LOG_ACTIONS_DATASET_CREATION_DATABASE_CANCELLATION","LOG_ACTIONS_DATASET_CREATION_SCHEMA_CANCELLATION","LOG_ACTIONS_DATASET_CREATION_TABLE_CANCELLATION","LOG_ACTIONS_DATASET_CREATION_SUCCESS","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","INPUT_FIELDS","LOG_ACTIONS","Footer","datasetObject","addDangerToast","hasColumns","datasets","history","createResource","createLogAction","dataset","totalCount","value","Object","keys","reduce","total","key","includes","cancelButtonOnClick","logAction","goBack","tooltipText","onSave","_datasetObject$db","data","database","db","id","catalog","schema","table_name","then","response","push","CREATE_DATASET_TEXT","disabledCheck","children","onClick","buttonStyle","disabled","tooltip","undefined","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/app/superset-frontend/src/features/datasets/AddDataset/Footer/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useHistory } from 'react-router-dom';\nimport Button from 'src/components/Button';\nimport { t } from '@superset-ui/core';\nimport { useSingleViewResource } from 'src/views/CRUD/hooks';\nimport { logEvent } from 'src/logger/actions';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport {\n  LOG_ACTIONS_DATASET_CREATION_EMPTY_CANCELLATION,\n  LOG_ACTIONS_DATASET_CREATION_DATABASE_CANCELLATION,\n  LOG_ACTIONS_DATASET_CREATION_SCHEMA_CANCELLATION,\n  LOG_ACTIONS_DATASET_CREATION_TABLE_CANCELLATION,\n  LOG_ACTIONS_DATASET_CREATION_SUCCESS,\n} from 'src/logger/LogUtils';\nimport { DatasetObject } from '../types';\n\ninterface FooterProps {\n  url: string;\n  addDangerToast: () => void;\n  datasetObject?: Partial<DatasetObject> | null;\n  onDatasetAdd?: (dataset: DatasetObject) => void;\n  hasColumns?: boolean;\n  datasets?: (string | null | undefined)[] | undefined;\n}\n\nconst INPUT_FIELDS = ['db', 'schema', 'table_name'];\nconst LOG_ACTIONS = [\n  LOG_ACTIONS_DATASET_CREATION_EMPTY_CANCELLATION,\n  LOG_ACTIONS_DATASET_CREATION_DATABASE_CANCELLATION,\n  LOG_ACTIONS_DATASET_CREATION_SCHEMA_CANCELLATION,\n  LOG_ACTIONS_DATASET_CREATION_TABLE_CANCELLATION,\n];\n\nfunction Footer({\n  datasetObject,\n  addDangerToast,\n  hasColumns = false,\n  datasets,\n}: FooterProps) {\n  const history = useHistory();\n  const { createResource } = useSingleViewResource<Partial<DatasetObject>>(\n    'dataset',\n    t('dataset'),\n    addDangerToast,\n  );\n\n  const createLogAction = (dataset: Partial<DatasetObject>) => {\n    let totalCount = 0;\n    const value = Object.keys(dataset).reduce((total, key) => {\n      if (INPUT_FIELDS.includes(key) && dataset[key]) {\n        totalCount += 1;\n      }\n      return totalCount;\n    }, 0);\n\n    return LOG_ACTIONS[value];\n  };\n\n  const cancelButtonOnClick = () => {\n    if (!datasetObject) {\n      logEvent(LOG_ACTIONS_DATASET_CREATION_EMPTY_CANCELLATION, {});\n    } else {\n      const logAction = createLogAction(datasetObject);\n      logEvent(logAction, datasetObject);\n    }\n    history.goBack();\n  };\n\n  const tooltipText = t('Select a database table.');\n\n  const onSave = () => {\n    if (datasetObject) {\n      const data = {\n        database: datasetObject.db?.id,\n        catalog: datasetObject.catalog,\n        schema: datasetObject.schema,\n        table_name: datasetObject.table_name,\n      };\n      createResource(data).then(response => {\n        if (!response) {\n          return;\n        }\n        if (typeof response === 'number') {\n          logEvent(LOG_ACTIONS_DATASET_CREATION_SUCCESS, datasetObject);\n          // When a dataset is created the response we get is its ID number\n          history.push(`/chart/add/?dataset=${datasetObject.table_name}`);\n        }\n      });\n    }\n  };\n\n  const CREATE_DATASET_TEXT = t('Create dataset and create chart');\n  const disabledCheck =\n    !datasetObject?.table_name ||\n    !hasColumns ||\n    datasets?.includes(datasetObject?.table_name);\n\n  return (\n    <>\n      <Button onClick={cancelButtonOnClick}>{t('Cancel')}</Button>\n      <Button\n        buttonStyle=\"primary\"\n        disabled={disabledCheck}\n        tooltip={!datasetObject?.table_name ? tooltipText : undefined}\n        onClick={onSave}\n      >\n        {CREATE_DATASET_TEXT}\n      </Button>\n    </>\n  );\n}\n\nexport default withToasts(Footer);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}