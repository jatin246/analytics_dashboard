{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Suspense } from 'react';\nimport { t } from '@superset-ui/core';\nimport backgroundStyleOptions from 'src/dashboard/util/backgroundStyleOptions';\nimport cx from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { Draggable } from '../dnd/DragDroppable';\nimport { COLUMN_TYPE, ROW_TYPE } from '../../util/componentTypes';\nimport WithPopoverMenu from '../menu/WithPopoverMenu';\nimport ResizableContainer from '../resizable/ResizableContainer';\nimport { BACKGROUND_TRANSPARENT, GRID_BASE_UNIT, GRID_MIN_COLUMN_COUNT } from '../../util/constants';\nimport HoverMenu from '../menu/HoverMenu';\nimport DeleteComponentButton from '../DeleteComponentButton';\nimport BackgroundStyleDropdown from '../menu/BackgroundStyleDropdown';\nimport dashboardComponents from '../../../visualizations/presets/dashboardComponents';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst DynamicComponent = ({ component, parentComponent, index, depth, handleComponentDrop, editMode, columnWidth, availableColumnCount, onResizeStart, onResizeStop, onResize, deleteComponent, parentId, updateComponents, id }) => {\n  // inherit the size of parent columns\n  const widthMultiple = parentComponent.type === COLUMN_TYPE ?\n  parentComponent.meta.width || GRID_MIN_COLUMN_COUNT :\n  component.meta.width || GRID_MIN_COLUMN_COUNT;\n  const handleDeleteComponent = () => {\n    deleteComponent(id, parentId);\n  };\n  const rowStyle = backgroundStyleOptions.find((opt) => opt.value === (component.meta.background || BACKGROUND_TRANSPARENT));\n  const updateMeta = (metaKey, nextValue) => {\n    updateComponents({\n      [component.id]: {\n        ...component,\n        meta: {\n          ...component.meta,\n          [metaKey]: nextValue\n        }\n      }\n    });\n  };\n  const { Component } = dashboardComponents.get(component.meta.componentKey);\n  const dashboardData = useSelector(({ nativeFilters, dataMask }) => ({\n    nativeFilters,\n    dataMask\n  }));\n  return _jsx(Draggable\n  // @ts-ignore\n  , { component: component\n    // @ts-ignore\n    , parentComponent: parentComponent, orientation: parentComponent.type === ROW_TYPE ? 'column' : 'row', index: index, depth: depth, onDrop: handleComponentDrop, editMode: editMode, children:\n    ({ dragSourceRef }) => _jsx(WithPopoverMenu, { menuItems: [\n      _jsx(BackgroundStyleDropdown, { id: `${component.id}-background`, value: component.meta.background, onChange: (value) => updateMeta('background', value) })],\n      editMode: editMode, children:\n      _jsx(\"div\", { \"data-test\": `dashboard-${component.componentKey}`, className: cx('dashboard-component', `dashboard-${component.componentKey}`, rowStyle == null ? void 0 : rowStyle.className), id: component.id, children:\n        _jsx(ResizableContainer, { id: component.id, adjustableWidth: parentComponent.type === ROW_TYPE, widthStep: columnWidth, widthMultiple: widthMultiple, heightStep: GRID_BASE_UNIT, adjustableHeight: false, heightMultiple: component.meta.height, minWidthMultiple: GRID_MIN_COLUMN_COUNT, minHeightMultiple: GRID_MIN_COLUMN_COUNT, maxWidthMultiple: availableColumnCount + widthMultiple, onResizeStart: onResizeStart, onResize: onResize, onResizeStop: onResizeStop, children:\n          _jsxs(\"div\", { ref: dragSourceRef, className: \"dashboard-component\", \"data-test\": \"dashboard-component-chart-holder\", children: [\n            editMode && _jsx(HoverMenu, { position: \"top\", children:\n              _jsx(DeleteComponentButton, { onDelete: handleDeleteComponent }) }\n            ),\n            _jsx(Suspense, { fallback: _jsx(\"div\", { children: t('Loading...') }), children:\n              _jsx(Component, { dashboardData: dashboardData }) }\n            )] }\n          ) }\n        ) }\n      ) }\n    ) }\n  );\n};__signature__(DynamicComponent, \"useSelector{dashboardData}\", () => [useSelector]);const _default =\nDynamicComponent;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DynamicComponent, \"DynamicComponent\", \"/app/superset-frontend/src/dashboard/components/gridComponents/DynamicComponent.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/dashboard/components/gridComponents/DynamicComponent.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["Suspense","t","backgroundStyleOptions","cx","useSelector","Draggable","COLUMN_TYPE","ROW_TYPE","WithPopoverMenu","ResizableContainer","BACKGROUND_TRANSPARENT","GRID_BASE_UNIT","GRID_MIN_COLUMN_COUNT","HoverMenu","DeleteComponentButton","BackgroundStyleDropdown","dashboardComponents","jsx","_jsx","jsxs","_jsxs","DynamicComponent","component","parentComponent","index","depth","handleComponentDrop","editMode","columnWidth","availableColumnCount","onResizeStart","onResizeStop","onResize","deleteComponent","parentId","updateComponents","id","widthMultiple","type","meta","width","handleDeleteComponent","rowStyle","find","opt","value","background","updateMeta","metaKey","nextValue","Component","get","componentKey","dashboardData","nativeFilters","dataMask","orientation","onDrop","children","dragSourceRef","menuItems","onChange","className","adjustableWidth","widthStep","heightStep","adjustableHeight","heightMultiple","height","minWidthMultiple","minHeightMultiple","maxWidthMultiple","ref","position","onDelete","fallback","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/dashboard/components/gridComponents/DynamicComponent.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { FC, Suspense } from 'react';\nimport { DashboardComponentMetadata, JsonObject, t } from '@superset-ui/core';\nimport backgroundStyleOptions from 'src/dashboard/util/backgroundStyleOptions';\nimport cx from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { Draggable } from '../dnd/DragDroppable';\nimport { COLUMN_TYPE, ROW_TYPE } from '../../util/componentTypes';\nimport WithPopoverMenu from '../menu/WithPopoverMenu';\nimport ResizableContainer from '../resizable/ResizableContainer';\nimport {\n  BACKGROUND_TRANSPARENT,\n  GRID_BASE_UNIT,\n  GRID_MIN_COLUMN_COUNT,\n} from '../../util/constants';\nimport HoverMenu from '../menu/HoverMenu';\nimport DeleteComponentButton from '../DeleteComponentButton';\nimport BackgroundStyleDropdown from '../menu/BackgroundStyleDropdown';\nimport dashboardComponents from '../../../visualizations/presets/dashboardComponents';\nimport { RootState } from '../../types';\n\ntype FilterSummaryType = {\n  component: JsonObject;\n  parentComponent: JsonObject;\n  index: number;\n  depth: number;\n  handleComponentDrop: (...args: any[]) => any;\n  editMode: boolean;\n  columnWidth: number;\n  availableColumnCount: number;\n  onResizeStart: Function;\n  onResizeStop: Function;\n  onResize: Function;\n  deleteComponent: Function;\n  updateComponents: Function;\n  parentId: number;\n  id: number;\n};\n\nconst DynamicComponent: FC<FilterSummaryType> = ({\n  component,\n  parentComponent,\n  index,\n  depth,\n  handleComponentDrop,\n  editMode,\n  columnWidth,\n  availableColumnCount,\n  onResizeStart,\n  onResizeStop,\n  onResize,\n  deleteComponent,\n  parentId,\n  updateComponents,\n  id,\n}) => {\n  // inherit the size of parent columns\n  const widthMultiple =\n    parentComponent.type === COLUMN_TYPE\n      ? parentComponent.meta.width || GRID_MIN_COLUMN_COUNT\n      : component.meta.width || GRID_MIN_COLUMN_COUNT;\n\n  const handleDeleteComponent = () => {\n    deleteComponent(id, parentId);\n  };\n\n  const rowStyle = backgroundStyleOptions.find(\n    opt => opt.value === (component.meta.background || BACKGROUND_TRANSPARENT),\n  );\n\n  const updateMeta = (metaKey: string, nextValue: string | number) => {\n    updateComponents({\n      [component.id]: {\n        ...component,\n        meta: {\n          ...component.meta,\n          [metaKey]: nextValue,\n        },\n      },\n    });\n  };\n\n  const { Component } = dashboardComponents.get(component.meta.componentKey);\n  const dashboardData = useSelector<RootState, DashboardComponentMetadata>(\n    ({ nativeFilters, dataMask }) => ({\n      nativeFilters,\n      dataMask,\n    }),\n  );\n\n  return (\n    <Draggable\n      // @ts-ignore\n      component={component}\n      // @ts-ignore\n      parentComponent={parentComponent}\n      orientation={parentComponent.type === ROW_TYPE ? 'column' : 'row'}\n      index={index}\n      depth={depth}\n      onDrop={handleComponentDrop}\n      editMode={editMode}\n    >\n      {({ dragSourceRef }) => (\n        <WithPopoverMenu\n          menuItems={[\n            <BackgroundStyleDropdown\n              id={`${component.id}-background`}\n              value={component.meta.background}\n              onChange={value => updateMeta('background', value)}\n            />,\n          ]}\n          editMode={editMode}\n        >\n          <div\n            data-test={`dashboard-${component.componentKey}`}\n            className={cx(\n              'dashboard-component',\n              `dashboard-${component.componentKey}`,\n              rowStyle?.className,\n            )}\n            id={component.id}\n          >\n            <ResizableContainer\n              id={component.id}\n              adjustableWidth={parentComponent.type === ROW_TYPE}\n              widthStep={columnWidth}\n              widthMultiple={widthMultiple}\n              heightStep={GRID_BASE_UNIT}\n              adjustableHeight={false}\n              heightMultiple={component.meta.height}\n              minWidthMultiple={GRID_MIN_COLUMN_COUNT}\n              minHeightMultiple={GRID_MIN_COLUMN_COUNT}\n              maxWidthMultiple={availableColumnCount + widthMultiple}\n              onResizeStart={onResizeStart}\n              onResize={onResize}\n              onResizeStop={onResizeStop}\n            >\n              <div\n                ref={dragSourceRef}\n                className=\"dashboard-component\"\n                data-test=\"dashboard-component-chart-holder\"\n              >\n                {editMode && (\n                  <HoverMenu position=\"top\">\n                    <DeleteComponentButton onDelete={handleDeleteComponent} />\n                  </HoverMenu>\n                )}\n                <Suspense fallback={<div>{t('Loading...')}</div>}>\n                  <Component dashboardData={dashboardData} />\n                </Suspense>\n              </div>\n            </ResizableContainer>\n          </div>\n        </WithPopoverMenu>\n      )}\n    </Draggable>\n  );\n};\nexport default DynamicComponent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}