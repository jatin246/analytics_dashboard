{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState } from 'react';\nimport { styled, logging } from '@superset-ui/core';import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nconst ImageContainer = styled.div`\n  background-image: url(${({ src }) => src});\n  background-size: cover;\n  background-position: center ${({ position }) => position};\n  display: inline-block;\n  height: calc(100% - 1px);\n  width: calc(100% - 2px);\n  margin: 1px 1px 0 1px;\n`;\nexport default function ImageLoader({ src, fallback, isLoading, position, ...rest }) {\n  const [imgSrc, setImgSrc] = useState(fallback);\n  useEffect(() => {\n    if (src) {\n      fetch(src).\n      then((response) => response.blob()).\n      then((blob) => {\n        if (/image/.test(blob.type)) {\n          const imgURL = URL.createObjectURL(blob);\n          setImgSrc(imgURL);\n        }\n      }).\n      catch((errMsg) => {\n        logging.error(errMsg);\n        setImgSrc(fallback);\n      });\n    }\n    return () => {\n      // theres a very brief period where isLoading is false and this component is about to unmount\n      // where the stale imgSrc is briefly rendered. Setting imgSrc to fallback smoothes the transition.\n      setImgSrc(fallback);\n    };\n  }, [src, fallback]);\n  return _jsx(ImageContainer, { src: isLoading ? fallback : imgSrc, ...rest, position: position });\n}__signature__(ImageLoader, \"useState{[imgSrc, setImgSrc](fallback)}\\nuseEffect{}\");;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(ImageContainer, \"ImageContainer\", \"/app/superset-frontend/src/components/ListViewCard/ImageLoader.tsx\");reactHotLoader.register(ImageLoader, \"ImageLoader\", \"/app/superset-frontend/src/components/ListViewCard/ImageLoader.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useEffect","useState","styled","logging","jsx","_jsx","ImageContainer","div","src","position","ImageLoader","fallback","isLoading","rest","imgSrc","setImgSrc","fetch","then","response","blob","test","type","imgURL","URL","createObjectURL","catch","errMsg","error","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/components/ListViewCard/ImageLoader.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState, DetailedHTMLProps, HTMLAttributes } from 'react';\n\nimport { styled, logging } from '@superset-ui/core';\n\nexport type BackgroundPosition = 'top' | 'bottom';\ninterface ImageContainerProps {\n  src: string;\n  position: BackgroundPosition;\n}\n\nconst ImageContainer = styled.div<ImageContainerProps>`\n  background-image: url(${({ src }) => src});\n  background-size: cover;\n  background-position: center ${({ position }) => position};\n  display: inline-block;\n  height: calc(100% - 1px);\n  width: calc(100% - 2px);\n  margin: 1px 1px 0 1px;\n`;\ninterface ImageLoaderProps\n  extends DetailedHTMLProps<HTMLAttributes<HTMLDivElement>, HTMLDivElement> {\n  fallback: string;\n  src: string;\n  isLoading?: boolean;\n  position: BackgroundPosition;\n}\n\nexport default function ImageLoader({\n  src,\n  fallback,\n  isLoading,\n  position,\n  ...rest\n}: ImageLoaderProps) {\n  const [imgSrc, setImgSrc] = useState<string>(fallback);\n\n  useEffect(() => {\n    if (src) {\n      fetch(src)\n        .then(response => response.blob())\n        .then(blob => {\n          if (/image/.test(blob.type)) {\n            const imgURL = URL.createObjectURL(blob);\n            setImgSrc(imgURL);\n          }\n        })\n        .catch(errMsg => {\n          logging.error(errMsg);\n          setImgSrc(fallback);\n        });\n    }\n\n    return () => {\n      // theres a very brief period where isLoading is false and this component is about to unmount\n      // where the stale imgSrc is briefly rendered. Setting imgSrc to fallback smoothes the transition.\n      setImgSrc(fallback);\n    };\n  }, [src, fallback]);\n\n  return (\n    <ImageContainer\n      src={isLoading ? fallback : imgSrc}\n      {...rest}\n      position={position}\n    />\n  );\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,SAASA,SAAS,EAAEC,QAAQ,QAA2C,OAAO;AAE9E,SAASC,MAAM,EAAEC,OAAO,QAAQ,mBAAmB,CAAC,SAAAC,GAAA,IAAAC,IAAA;AAQpD,MAAMC,cAAc,GAAGJ,MAAM,CAACK,GAAwB;0BAC5B,CAAC,EAAEC,GAAG,EAAE,KAAKA,GAAG;;gCAEV,CAAC,EAAEC,QAAQ,EAAE,KAAKA,QAAQ;;;;;CAKzD;AASD,eAAc,SAAUC,WAAWA,CAAC,EAClCF,GAAG,EACHG,QAAQ,EACRC,SAAS,EACTH,QAAQ,EACR,GAAGI,IAAI,EACU;EACjB,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGd,QAAQ,CAASU,QAAQ,CAAC;EAEtDX,SAAS,CAAC,MAAK;IACb,IAAIQ,GAAG,EAAE;MACPQ,KAAK,CAACR,GAAG,CAAC;MACPS,IAAI,CAAC,CAAAC,QAAQ,KAAIA,QAAQ,CAACC,IAAI,EAAE,CAAC;MACjCF,IAAI,CAAC,CAAAE,IAAI,KAAG;QACX,IAAI,OAAO,CAACC,IAAI,CAACD,IAAI,CAACE,IAAI,CAAC,EAAE;UAC3B,MAAMC,MAAM,GAAGC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC;UACxCJ,SAAS,CAACO,MAAM,CAAC;;MAErB,CAAC,CAAC;MACDG,KAAK,CAAC,CAAAC,MAAM,KAAG;QACdvB,OAAO,CAACwB,KAAK,CAACD,MAAM,CAAC;QACrBX,SAAS,CAACJ,QAAQ,CAAC;MACrB,CAAC,CAAC;;IAGN,OAAO,MAAK;MACV;MACA;MACAI,SAAS,CAACJ,QAAQ,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,CAACH,GAAG,EAAEG,QAAQ,CAAC,CAAC;EAEnB,OACEN,IAAA,CAACC,cAAc,IACbE,GAAG,EAAEI,SAAS,GAAGD,QAAQ,GAAGG,MAAO,KAC/BD,IAAI,EACRJ,QAAQ,EAAEA,QAAS,GACnB;AAEN,CAACmB,aAAA,CAvCuBlB,WAAW,6EAAAmB,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CAjB7B3B,cAAc,0FAAAuB,cAAA,CAAAI,QAAA,CAiBIvB,WAAW,+GAAAwB,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}