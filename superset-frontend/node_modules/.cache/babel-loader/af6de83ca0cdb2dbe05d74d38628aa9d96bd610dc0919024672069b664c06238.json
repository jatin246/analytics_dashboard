{"ast":null,"code":"import _mapKeys from \"lodash/mapKeys\";import _invert from \"lodash/invert\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { nanoid } from 'nanoid';\nimport rison from 'rison';\nimport {\n  FeatureFlag,\n  SupersetClient,\n  t,\n  isFeatureEnabled,\n  COMMON_ERR_MESSAGES,\n  getClientErrorObject } from\n'@superset-ui/core';\n\n\nimport { now } from 'src/utils/dates';\nimport {\n  addDangerToast as addDangerToastAction,\n  addInfoToast as addInfoToastAction,\n  addSuccessToast as addSuccessToastAction,\n  addWarningToast as addWarningToastAction } from\n'src/components/MessageToasts/actions';\nimport { LOG_ACTIONS_SQLLAB_FETCH_FAILED_QUERY } from 'src/logger/LogUtils';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport { logEvent } from 'src/logger/actions';\nimport { newQueryTabName } from '../utils/newQueryTabName';\nimport getInitialState from '../reducers/getInitialState';\nimport { rehydratePersistedState } from '../utils/reduxStateToLocalStorageHelper';\n\nexport const RESET_STATE = 'RESET_STATE';\nexport const ADD_QUERY_EDITOR = 'ADD_QUERY_EDITOR';\nexport const UPDATE_QUERY_EDITOR = 'UPDATE_QUERY_EDITOR';\nexport const QUERY_EDITOR_SAVED = 'QUERY_EDITOR_SAVED';\nexport const CLONE_QUERY_TO_NEW_TAB = 'CLONE_QUERY_TO_NEW_TAB';\nexport const REMOVE_QUERY_EDITOR = 'REMOVE_QUERY_EDITOR';\nexport const MERGE_TABLE = 'MERGE_TABLE';\nexport const REMOVE_TABLES = 'REMOVE_TABLES';\nexport const END_QUERY = 'END_QUERY';\nexport const REMOVE_QUERY = 'REMOVE_QUERY';\nexport const EXPAND_TABLE = 'EXPAND_TABLE';\nexport const COLLAPSE_TABLE = 'COLLAPSE_TABLE';\nexport const QUERY_EDITOR_SETDB = 'QUERY_EDITOR_SETDB';\nexport const QUERY_EDITOR_SET_CATALOG = 'QUERY_EDITOR_SET_CATALOG';\nexport const QUERY_EDITOR_SET_SCHEMA = 'QUERY_EDITOR_SET_SCHEMA';\nexport const QUERY_EDITOR_SET_TITLE = 'QUERY_EDITOR_SET_TITLE';\nexport const QUERY_EDITOR_SET_AUTORUN = 'QUERY_EDITOR_SET_AUTORUN';\nexport const QUERY_EDITOR_SET_SQL = 'QUERY_EDITOR_SET_SQL';\nexport const QUERY_EDITOR_SET_CURSOR_POSITION =\n'QUERY_EDITOR_SET_CURSOR_POSITION';\nexport const QUERY_EDITOR_SET_QUERY_LIMIT = 'QUERY_EDITOR_SET_QUERY_LIMIT';\nexport const QUERY_EDITOR_SET_TEMPLATE_PARAMS =\n'QUERY_EDITOR_SET_TEMPLATE_PARAMS';\nexport const QUERY_EDITOR_SET_SELECTED_TEXT = 'QUERY_EDITOR_SET_SELECTED_TEXT';\nexport const QUERY_EDITOR_SET_FUNCTION_NAMES =\n'QUERY_EDITOR_SET_FUNCTION_NAMES';\nexport const QUERY_EDITOR_PERSIST_HEIGHT = 'QUERY_EDITOR_PERSIST_HEIGHT';\nexport const QUERY_EDITOR_TOGGLE_LEFT_BAR = 'QUERY_EDITOR_TOGGLE_LEFT_BAR';\nexport const MIGRATE_QUERY_EDITOR = 'MIGRATE_QUERY_EDITOR';\nexport const MIGRATE_TAB_HISTORY = 'MIGRATE_TAB_HISTORY';\nexport const MIGRATE_TABLE = 'MIGRATE_TABLE';\nexport const MIGRATE_QUERY = 'MIGRATE_QUERY';\n\nexport const SET_DATABASES = 'SET_DATABASES';\nexport const SET_ACTIVE_QUERY_EDITOR = 'SET_ACTIVE_QUERY_EDITOR';\nexport const LOAD_QUERY_EDITOR = 'LOAD_QUERY_EDITOR';\nexport const SET_TABLES = 'SET_TABLES';\nexport const SET_ACTIVE_SOUTHPANE_TAB = 'SET_ACTIVE_SOUTHPANE_TAB';\nexport const REFRESH_QUERIES = 'REFRESH_QUERIES';\nexport const SET_USER_OFFLINE = 'SET_USER_OFFLINE';\nexport const RUN_QUERY = 'RUN_QUERY';\nexport const START_QUERY = 'START_QUERY';\nexport const STOP_QUERY = 'STOP_QUERY';\nexport const REQUEST_QUERY_RESULTS = 'REQUEST_QUERY_RESULTS';\nexport const QUERY_SUCCESS = 'QUERY_SUCCESS';\nexport const QUERY_FAILED = 'QUERY_FAILED';\nexport const CLEAR_INACTIVE_QUERIES = 'CLEAR_INACTIVE_QUERIES';\nexport const CLEAR_QUERY_RESULTS = 'CLEAR_QUERY_RESULTS';\nexport const REMOVE_DATA_PREVIEW = 'REMOVE_DATA_PREVIEW';\nexport const CHANGE_DATA_PREVIEW_ID = 'CHANGE_DATA_PREVIEW_ID';\n\nexport const COST_ESTIMATE_STARTED = 'COST_ESTIMATE_STARTED';\nexport const COST_ESTIMATE_RETURNED = 'COST_ESTIMATE_RETURNED';\nexport const COST_ESTIMATE_FAILED = 'COST_ESTIMATE_FAILED';\n\nexport const CREATE_DATASOURCE_STARTED = 'CREATE_DATASOURCE_STARTED';\nexport const CREATE_DATASOURCE_SUCCESS = 'CREATE_DATASOURCE_SUCCESS';\nexport const CREATE_DATASOURCE_FAILED = 'CREATE_DATASOURCE_FAILED';\n\nexport const SET_EDITOR_TAB_LAST_UPDATE = 'SET_EDITOR_TAB_LAST_UPDATE';\nexport const SET_LAST_UPDATED_ACTIVE_TAB = 'SET_LAST_UPDATED_ACTIVE_TAB';\nexport const CLEAR_DESTROYED_QUERY_EDITOR = 'CLEAR_DESTROYED_QUERY_EDITOR';\n\nexport const addInfoToast = addInfoToastAction;\nexport const addSuccessToast = addSuccessToastAction;\nexport const addDangerToast = addDangerToastAction;\nexport const addWarningToast = addWarningToastAction;\n\nexport const CtasEnum = {\n  Table: 'TABLE',\n  View: 'VIEW'\n};\nconst ERR_MSG_CANT_LOAD_QUERY = t(\"The query couldn't be loaded\");\n\n// a map of SavedQuery field names to the different names used client-side,\n// because for now making the names consistent is too complicated\n// so it might as well only happen in one place\nconst queryClientMapping = {\n  id: 'remoteId',\n  db_id: 'dbId',\n  label: 'name',\n  template_parameters: 'templateParams'\n};\nconst queryServerMapping = _invert(queryClientMapping);\n\n// uses a mapping like those above to convert object key names to another style\nconst fieldConverter = (mapping) => (obj) =>\n_mapKeys(obj, (value, key) => key in mapping ? mapping[key] : key);\n\nexport const convertQueryToServer = fieldConverter(queryServerMapping);\nexport const convertQueryToClient = fieldConverter(queryClientMapping);\n\nexport function getUpToDateQuery(rootState, queryEditor, key) {\n  const {\n    sqlLab: { unsavedQueryEditor, queryEditors }\n  } = rootState;\n  const id = key != null ? key : queryEditor.id;\n  return {\n    id,\n    ...queryEditors.find((qe) => qe.id === id),\n    ...(id === unsavedQueryEditor.id && unsavedQueryEditor)\n  };\n}\n\nexport function resetState(data) {\n  return (dispatch, getState) => {\n    const { common } = getState();\n    const initialState = getInitialState({\n      ...getBootstrapData(),\n      common,\n      ...data\n    });\n\n    dispatch({\n      type: RESET_STATE,\n      sqlLabInitialState: initialState.sqlLab\n    });\n    rehydratePersistedState(dispatch, initialState);\n  };\n}\n\nexport function updateQueryEditor(alterations) {\n  return { type: UPDATE_QUERY_EDITOR, alterations };\n}\n\nexport function setEditorTabLastUpdate(timestamp) {\n  return { type: SET_EDITOR_TAB_LAST_UPDATE, timestamp };\n}\n\nexport function scheduleQuery(query) {\n  return (dispatch) =>\n  SupersetClient.post({\n    endpoint: '/api/v1/saved_query/',\n    jsonPayload: query,\n    stringify: false\n  }).\n  then(() =>\n  dispatch(\n    addSuccessToast(\n      t(\n        'Your query has been scheduled. To see details of your query, navigate to Saved queries'\n      )\n    )\n  )\n  ).\n  catch(() =>\n  dispatch(addDangerToast(t('Your query could not be scheduled')))\n  );\n}\n\nexport function estimateQueryCost(queryEditor) {\n  return (dispatch, getState) => {\n    const { dbId, catalog, schema, sql, selectedText, templateParams } =\n    getUpToDateQuery(getState(), queryEditor);\n    const requestSql = selectedText || sql;\n\n    const postPayload = {\n      database_id: dbId,\n      catalog,\n      schema,\n      sql: requestSql,\n      template_params: JSON.parse(templateParams || '{}')\n    };\n\n    return Promise.all([\n    dispatch({ type: COST_ESTIMATE_STARTED, query: queryEditor }),\n    SupersetClient.post({\n      endpoint: '/api/v1/sqllab/estimate/',\n      body: JSON.stringify(postPayload),\n      headers: { 'Content-Type': 'application/json' }\n    }).\n    then(({ json }) =>\n    dispatch({ type: COST_ESTIMATE_RETURNED, query: queryEditor, json })\n    ).\n    catch((response) =>\n    getClientErrorObject(response).then((error) => {\n      const message =\n      error.error ||\n      error.statusText ||\n      t('Failed at retrieving results');\n      return dispatch({\n        type: COST_ESTIMATE_FAILED,\n        query: queryEditor,\n        error: message\n      });\n    })\n    )]\n    );\n  };\n}\n\nexport function clearInactiveQueries(interval) {\n  return { type: CLEAR_INACTIVE_QUERIES, interval };\n}\n\nexport function startQuery(query) {\n  Object.assign(query, {\n    id: query.id ? query.id : nanoid(11),\n    progress: 0,\n    startDttm: now(),\n    state: query.runAsync ? 'pending' : 'running',\n    cached: false\n  });\n  return { type: START_QUERY, query };\n}\n\nexport function querySuccess(query, results) {\n  return { type: QUERY_SUCCESS, query, results };\n}\n\nexport function queryFailed(query, msg, link, errors) {\n  return function (dispatch) {\n    const eventData = {\n      has_err: true,\n      start_offset: query.startDttm,\n      ts: new Date().getTime()\n    };\n    errors == null ? void 0 : errors.forEach(({ error_type: errorType, extra }) => {var _extra$issue_codes;\n      const messages = (extra == null ? void 0 : (_extra$issue_codes = extra.issue_codes) == null ? void 0 : _extra$issue_codes.map(({ message }) => message)) || [\n      errorType];\n\n      messages.forEach((message) => {\n        dispatch(\n          logEvent(LOG_ACTIONS_SQLLAB_FETCH_FAILED_QUERY, {\n            ...eventData,\n            error_type: errorType,\n            error_details: message\n          })\n        );\n      });\n    });\n\n    dispatch({ type: QUERY_FAILED, query, msg, link, errors });\n  };\n}\n\nexport function stopQuery(query) {\n  return { type: STOP_QUERY, query };\n}\n\nexport function clearQueryResults(query) {\n  return { type: CLEAR_QUERY_RESULTS, query };\n}\n\nexport function removeDataPreview(table) {\n  return { type: REMOVE_DATA_PREVIEW, table };\n}\n\nexport function requestQueryResults(query) {\n  return { type: REQUEST_QUERY_RESULTS, query };\n}\n\nexport function fetchQueryResults(query, displayLimit) {\n  return function (dispatch) {\n    dispatch(requestQueryResults(query));\n\n    const queryParams = rison.encode({\n      key: query.resultsKey,\n      rows: displayLimit || null\n    });\n\n    return SupersetClient.get({\n      endpoint: `/api/v1/sqllab/results/?q=${queryParams}`,\n      parseMethod: 'json-bigint'\n    }).\n    then(({ json }) => dispatch(querySuccess(query, json))).\n    catch((response) =>\n    getClientErrorObject(response).then((error) => {\n      const message =\n      error.error ||\n      error.statusText ||\n      t('Failed at retrieving results');\n\n      return dispatch(\n        queryFailed(query, message, error.link, error.errors)\n      );\n    })\n    );\n  };\n}\n\nexport function runQuery(query) {\n  return function (dispatch) {\n    dispatch(startQuery(query));\n    const postPayload = {\n      client_id: query.id,\n      database_id: query.dbId,\n      json: true,\n      runAsync: query.runAsync,\n      catalog: query.catalog,\n      schema: query.schema,\n      sql: query.sql,\n      sql_editor_id: query.sqlEditorId,\n      tab: query.tab,\n      tmp_table_name: query.tempTable,\n      select_as_cta: query.ctas,\n      ctas_method: query.ctas_method,\n      templateParams: query.templateParams,\n      queryLimit: query.queryLimit,\n      expand_data: true\n    };\n\n    const search = window.location.search || '';\n    return SupersetClient.post({\n      endpoint: `/api/v1/sqllab/execute/${search}`,\n      body: JSON.stringify(postPayload),\n      headers: { 'Content-Type': 'application/json' },\n      parseMethod: 'json-bigint'\n    }).\n    then(({ json }) => {\n      if (!query.runAsync) {\n        dispatch(querySuccess(query, json));\n      }\n    }).\n    catch((response) =>\n    getClientErrorObject(response).then((error) => {\n      let message =\n      error.error ||\n      error.message ||\n      error.statusText ||\n      t('Unknown error');\n      if (message.includes('CSRF token')) {\n        message = t(COMMON_ERR_MESSAGES.SESSION_TIMED_OUT);\n      }\n      dispatch(queryFailed(query, message, error.link, error.errors));\n    })\n    );\n  };\n}\n\nexport function runQueryFromSqlEditor(\ndatabase,\nqueryEditor,\ndefaultQueryLimit,\ntempTable,\nctas,\nctasMethod)\n{\n  return function (dispatch, getState) {\n    const qe = getUpToDateQuery(getState(), queryEditor, queryEditor.id);\n    const query = {\n      dbId: qe.dbId,\n      sql: qe.selectedText || qe.sql,\n      sqlEditorId: qe.id,\n      tab: qe.name,\n      catalog: qe.catalog,\n      schema: qe.schema,\n      tempTable,\n      templateParams: qe.templateParams,\n      queryLimit: qe.queryLimit || defaultQueryLimit,\n      runAsync: database ? database.allow_run_async : false,\n      ctas,\n      ctas_method: ctasMethod,\n      updateTabState: !qe.selectedText\n    };\n    dispatch(runQuery(query));\n  };\n}\n\nexport function reRunQuery(query) {\n  // run Query with a new id\n  return function (dispatch) {\n    dispatch(runQuery({ ...query, id: nanoid(11) }));\n  };\n}\n\nexport function postStopQuery(query) {\n  return function (dispatch) {\n    return SupersetClient.post({\n      endpoint: '/api/v1/query/stop',\n      body: JSON.stringify({ client_id: query.id }),\n      headers: { 'Content-Type': 'application/json' }\n    }).\n    then(() => dispatch(stopQuery(query))).\n    then(() => dispatch(addSuccessToast(t('Query was stopped.')))).\n    catch(() =>\n    dispatch(addDangerToast(t('Failed at stopping query. %s', query.id)))\n    );\n  };\n}\n\nexport function setDatabases(databases) {\n  return { type: SET_DATABASES, databases };\n}\n\nfunction migrateTable(table, queryEditorId, dispatch) {\n  return SupersetClient.post({\n    endpoint: encodeURI('/tableschemaview/'),\n    postPayload: { table: { ...table, queryEditorId } }\n  }).\n  then(({ json }) => {\n    const newTable = {\n      ...table,\n      id: json.id,\n      queryEditorId\n    };\n    return dispatch({ type: MIGRATE_TABLE, oldTable: table, newTable });\n  }).\n  catch(() =>\n  dispatch(\n    addWarningToast(\n      t(\n        'Unable to migrate table schema state to backend. Superset will retry ' +\n        'later. Please contact your administrator if this problem persists.'\n      )\n    )\n  )\n  );\n}\n\nfunction migrateQuery(queryId, queryEditorId, dispatch) {\n  return SupersetClient.post({\n    endpoint: encodeURI(`/tabstateview/${queryEditorId}/migrate_query`),\n    postPayload: { queryId }\n  }).\n  then(() => dispatch({ type: MIGRATE_QUERY, queryId, queryEditorId })).\n  catch(() =>\n  dispatch(\n    addWarningToast(\n      t(\n        'Unable to migrate query state to backend. Superset will retry later. ' +\n        'Please contact your administrator if this problem persists.'\n      )\n    )\n  )\n  );\n}\n\n/**\n * Persist QueryEditor from local storage to backend tab state.\n * This ensures that when new tabs are created, query editors are\n * asynchronously stored in local storage and periodically synchronized\n * with the backend.\n * When switching to persistence mode, the QueryEditors previously\n * stored in local storage will also be synchronized to the backend\n * through syncQueryEditor.\n */\nexport function syncQueryEditor(queryEditor) {\n  return function (dispatch, getState) {\n    const { tables, queries } = getState().sqlLab;\n    const localStorageTables = tables.filter(\n      (table) => table.inLocalStorage && table.queryEditorId === queryEditor.id\n    );\n    const localStorageQueries = Object.values(queries).filter(\n      (query) => query.inLocalStorage && query.sqlEditorId === queryEditor.id\n    );\n    return SupersetClient.post({\n      endpoint: '/tabstateview/',\n      postPayload: { queryEditor }\n    }).\n    then(({ json }) => {\n      const newQueryEditor = {\n        ...queryEditor,\n        id: json.id.toString(),\n        inLocalStorage: false,\n        loaded: true\n      };\n      dispatch({\n        type: MIGRATE_QUERY_EDITOR,\n        oldQueryEditor: queryEditor,\n        newQueryEditor\n      });\n      dispatch({\n        type: MIGRATE_TAB_HISTORY,\n        oldId: queryEditor.id,\n        newId: newQueryEditor.id\n      });\n      return Promise.all([\n      ...localStorageTables.map((table) =>\n      migrateTable(table, newQueryEditor.id, dispatch)\n      ),\n      ...localStorageQueries.map((query) =>\n      migrateQuery(query.id, newQueryEditor.id, dispatch)\n      )]\n      );\n    }).\n    catch(() =>\n    dispatch(\n      addWarningToast(\n        t(\n          'Unable to migrate query editor state to backend. Superset will retry ' +\n          'later. Please contact your administrator if this problem persists.'\n        )\n      )\n    )\n    );\n  };\n}\n\nexport function addQueryEditor(queryEditor) {\n  const newQueryEditor = {\n    ...queryEditor,\n    id: nanoid(11),\n    loaded: true,\n    inLocalStorage: true\n  };\n  return {\n    type: ADD_QUERY_EDITOR,\n    queryEditor: newQueryEditor\n  };\n}\n\nexport function addNewQueryEditor() {\n  return function (dispatch, getState) {\n    const {\n      sqlLab: { queryEditors, tabHistory, unsavedQueryEditor, databases },\n      common\n    } = getState();\n    const defaultDbId = common.conf.SQLLAB_DEFAULT_DBID;\n    const activeQueryEditor = queryEditors.find(\n      (qe) => qe.id === tabHistory[tabHistory.length - 1]\n    );\n    const dbIds = Object.values(databases).map((database) => database.id);\n    const firstDbId = dbIds.length > 0 ? Math.min(...dbIds) : undefined;\n    const { dbId, catalog, schema, queryLimit, autorun } = {\n      ...queryEditors[0],\n      ...activeQueryEditor,\n      ...(unsavedQueryEditor.id === (activeQueryEditor == null ? void 0 : activeQueryEditor.id) &&\n      unsavedQueryEditor)\n    };\n    const warning = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence) ?\n    '' :\n    t(\n      '-- Note: Unless you save your query, these tabs will NOT persist if you clear your cookies or change browsers.\\n\\n'\n    );\n\n    const name = newQueryTabName(\n      (queryEditors == null ? void 0 : queryEditors.map((qe) => ({\n        ...qe,\n        ...(qe.id === unsavedQueryEditor.id && unsavedQueryEditor)\n      }))) || []\n    );\n\n    return dispatch(\n      addQueryEditor({\n        dbId: dbId || defaultDbId || firstDbId,\n        catalog: catalog != null ? catalog : null,\n        schema: schema != null ? schema : null,\n        autorun: autorun != null ? autorun : false,\n        sql: `${warning}SELECT ...`,\n        queryLimit: queryLimit || common.conf.DEFAULT_SQLLAB_LIMIT,\n        name\n      })\n    );\n  };\n}\n\nexport function cloneQueryToNewTab(query, autorun) {\n  return function (dispatch, getState) {\n    const state = getState();\n    const { queryEditors, unsavedQueryEditor, tabHistory } = state.sqlLab;\n    const sourceQueryEditor = {\n      ...queryEditors.find((qe) => qe.id === tabHistory[tabHistory.length - 1]),\n      ...(tabHistory[tabHistory.length - 1] === unsavedQueryEditor.id &&\n      unsavedQueryEditor)\n    };\n    const queryEditor = {\n      name: t('Copy of %s', sourceQueryEditor.name),\n      dbId: query.dbId ? query.dbId : null,\n      catalog: query.catalog ? query.catalog : null,\n      schema: query.schema ? query.schema : null,\n      autorun,\n      sql: query.sql,\n      queryLimit: sourceQueryEditor.queryLimit,\n      maxRow: sourceQueryEditor.maxRow,\n      templateParams: sourceQueryEditor.templateParams\n    };\n    return dispatch(addQueryEditor(queryEditor));\n  };\n}\n\nexport function setLastUpdatedActiveTab(queryEditorId) {\n  return {\n    type: SET_LAST_UPDATED_ACTIVE_TAB,\n    queryEditorId\n  };\n}\n\nexport function setActiveQueryEditor(queryEditor) {\n  return {\n    type: SET_ACTIVE_QUERY_EDITOR,\n    queryEditor\n  };\n}\n\nexport function loadQueryEditor(queryEditor) {\n  return { type: LOAD_QUERY_EDITOR, queryEditor };\n}\n\nexport function setTables(tableSchemas) {\n  const tables = tableSchemas.\n  filter((tableSchema) => tableSchema.description !== null).\n  map((tableSchema) => {\n    const {\n      columns,\n      selectStar,\n      primaryKey,\n      foreignKeys,\n      indexes,\n      dataPreviewQueryId\n    } = tableSchema.description;\n    return {\n      dbId: tableSchema.database_id,\n      queryEditorId: tableSchema.tab_state_id.toString(),\n      catalog: tableSchema.catalog,\n      schema: tableSchema.schema,\n      name: tableSchema.table,\n      expanded: tableSchema.expanded,\n      id: tableSchema.id,\n      dataPreviewQueryId,\n      columns,\n      selectStar,\n      primaryKey,\n      foreignKeys,\n      indexes,\n      isMetadataLoading: false,\n      isExtraMetadataLoading: false\n    };\n  });\n  return { type: SET_TABLES, tables };\n}\n\nexport function fetchQueryEditor(queryEditor, displayLimit) {\n  return function (dispatch) {\n    SupersetClient.get({\n      endpoint: encodeURI(`/tabstateview/${queryEditor.id}`)\n    }).\n    then(({ json }) => {var _json$latest_query, _json$saved_query;\n      const loadedQueryEditor = {\n        id: json.id.toString(),\n        loaded: true,\n        name: json.label,\n        sql: json.sql,\n        selectedText: null,\n        latestQueryId: (_json$latest_query = json.latest_query) == null ? void 0 : _json$latest_query.id,\n        autorun: json.autorun,\n        dbId: json.database_id,\n        templateParams: json.template_params,\n        catalog: json.catalog,\n        schema: json.schema,\n        queryLimit: json.query_limit,\n        remoteId: (_json$saved_query = json.saved_query) == null ? void 0 : _json$saved_query.id,\n        hideLeftBar: json.hide_left_bar\n      };\n      dispatch(loadQueryEditor(loadedQueryEditor));\n      dispatch(setTables(json.table_schemas || []));\n      if (json.latest_query && json.latest_query.resultsKey) {\n        dispatch(fetchQueryResults(json.latest_query, displayLimit));\n      }\n    }).\n    catch((response) => {\n      if (response.status !== 404) {\n        return dispatch(\n          addDangerToast(t('An error occurred while fetching tab state'))\n        );\n      }\n      return dispatch({ type: REMOVE_QUERY_EDITOR, queryEditor });\n    });\n  };\n}\n\nexport function setActiveSouthPaneTab(tabId) {\n  return { type: SET_ACTIVE_SOUTHPANE_TAB, tabId };\n}\n\nexport function toggleLeftBar(queryEditor) {\n  const hideLeftBar = !queryEditor.hideLeftBar;\n  return {\n    type: QUERY_EDITOR_TOGGLE_LEFT_BAR,\n    queryEditor,\n    hideLeftBar\n  };\n}\n\nexport function clearDestoryedQueryEditor(queryEditorId) {\n  return { type: CLEAR_DESTROYED_QUERY_EDITOR, queryEditorId };\n}\n\nexport function removeQueryEditor(queryEditor) {\n  return { type: REMOVE_QUERY_EDITOR, queryEditor };\n}\n\nexport function removeAllOtherQueryEditors(queryEditor) {\n  return function (dispatch, getState) {var _sqlLab$queryEditors;\n    const { sqlLab } = getState();\n    (_sqlLab$queryEditors = sqlLab.queryEditors) == null ? void 0 : _sqlLab$queryEditors.forEach((otherQueryEditor) => {\n      if (otherQueryEditor.id !== queryEditor.id) {\n        dispatch(removeQueryEditor(otherQueryEditor));\n      }\n    });\n  };\n}\n\nexport function removeQuery(query) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence) ?\n    SupersetClient.delete({\n      endpoint: encodeURI(\n        `/tabstateview/${query.sqlEditorId}/query/${query.id}`\n      )\n    }) :\n    Promise.resolve();\n\n    return sync.\n    then(() => dispatch({ type: REMOVE_QUERY, query })).\n    catch(() =>\n    dispatch(\n      addDangerToast(\n        t(\n          'An error occurred while removing query. Please contact your administrator.'\n        )\n      )\n    )\n    );\n  };\n}\n\nexport function queryEditorSetDb(queryEditor, dbId) {\n  return { type: QUERY_EDITOR_SETDB, queryEditor, dbId };\n}\n\nexport function queryEditorSetCatalog(queryEditor, catalog) {\n  return {\n    type: QUERY_EDITOR_SET_CATALOG,\n    queryEditor: queryEditor || {},\n    catalog\n  };\n}\n\nexport function queryEditorSetSchema(queryEditor, schema) {\n  return {\n    type: QUERY_EDITOR_SET_SCHEMA,\n    queryEditor: queryEditor || {},\n    schema\n  };\n}\n\nexport function queryEditorSetAutorun(queryEditor, autorun) {\n  return { type: QUERY_EDITOR_SET_AUTORUN, queryEditor, autorun };\n}\n\nexport function queryEditorSetTitle(queryEditor, name, id) {\n  return {\n    type: QUERY_EDITOR_SET_TITLE,\n    queryEditor: { ...queryEditor, id },\n    name\n  };\n}\n\nexport function saveQuery(query, clientId) {\n  const { id, ...payload } = convertQueryToServer(query);\n\n  return (dispatch) =>\n  SupersetClient.post({\n    endpoint: '/api/v1/saved_query/',\n    jsonPayload: convertQueryToServer(payload)\n  }).\n  then((result) => {\n    const savedQuery = convertQueryToClient({\n      id: result.json.id,\n      ...result.json.result\n    });\n    dispatch({\n      type: QUERY_EDITOR_SAVED,\n      query,\n      clientId,\n      result: savedQuery\n    });\n    dispatch(queryEditorSetTitle(query, query.name, clientId));\n    return savedQuery;\n  }).\n  catch(() =>\n  dispatch(addDangerToast(t('Your query could not be saved')))\n  );\n}\n\nexport const addSavedQueryToTabState =\n(queryEditor, savedQuery) => (dispatch) => {\n  const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence) ?\n  SupersetClient.put({\n    endpoint: `/tabstateview/${queryEditor.id}`,\n    postPayload: { saved_query_id: savedQuery.remoteId }\n  }) :\n  Promise.resolve();\n\n  return sync.\n  catch(() => {\n    dispatch(addDangerToast(t('Your query was not properly saved')));\n  }).\n  then(() => {\n    dispatch(addSuccessToast(t('Your query was saved')));\n  });\n};\n\nexport function updateSavedQuery(query, clientId) {\n  const { id, ...payload } = convertQueryToServer(query);\n\n  return (dispatch) =>\n  SupersetClient.put({\n    endpoint: `/api/v1/saved_query/${query.remoteId}`,\n    jsonPayload: convertQueryToServer(payload)\n  }).\n  then(() => {\n    dispatch(addSuccessToast(t('Your query was updated')));\n    dispatch(queryEditorSetTitle(query, query.name, clientId));\n  }).\n  catch((e) => {\n    const message = t('Your query could not be updated');\n    // eslint-disable-next-line no-console\n    console.error(message, e);\n    dispatch(addDangerToast(message));\n  }).\n  then(() => dispatch(updateQueryEditor(query)));\n}\n\nexport function queryEditorSetSql(queryEditor, sql, queryId) {\n  return { type: QUERY_EDITOR_SET_SQL, queryEditor, sql, queryId };\n}\n\nexport function queryEditorSetCursorPosition(queryEditor, position) {\n  return { type: QUERY_EDITOR_SET_CURSOR_POSITION, queryEditor, position };\n}\n\nexport function queryEditorSetAndSaveSql(targetQueryEditor, sql, queryId) {\n  return function (dispatch, getState) {\n    const queryEditor = getUpToDateQuery(getState(), targetQueryEditor);\n    // saved query and set tab state use this action\n    dispatch(queryEditorSetSql(queryEditor, sql, queryId));\n    if (isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)) {\n      return SupersetClient.put({\n        endpoint: encodeURI(`/tabstateview/${queryEditor.id}`),\n        postPayload: { sql, latest_query_id: queryId }\n      }).catch(() =>\n      dispatch(\n        addDangerToast(\n          t(\n            'An error occurred while storing your query in the backend. To ' +\n            'avoid losing your changes, please save your query using the ' +\n            '\"Save Query\" button.'\n          )\n        )\n      )\n      );\n    }\n    return Promise.resolve();\n  };\n}\n\nexport function formatQuery(queryEditor) {\n  return function (dispatch, getState) {\n    const { sql } = getUpToDateQuery(getState(), queryEditor);\n    return SupersetClient.post({\n      endpoint: `/api/v1/sqllab/format_sql/`,\n      // TODO (betodealmeida): pass engine as a parameter for better formatting\n      body: JSON.stringify({ sql }),\n      headers: { 'Content-Type': 'application/json' }\n    }).then(({ json }) => {\n      dispatch(queryEditorSetSql(queryEditor, json.result));\n    });\n  };\n}\n\nexport function queryEditorSetQueryLimit(queryEditor, queryLimit) {\n  return {\n    type: QUERY_EDITOR_SET_QUERY_LIMIT,\n    queryEditor,\n    queryLimit\n  };\n}\n\nexport function queryEditorSetTemplateParams(queryEditor, templateParams) {\n  return {\n    type: QUERY_EDITOR_SET_TEMPLATE_PARAMS,\n    queryEditor,\n    templateParams\n  };\n}\n\nexport function queryEditorSetSelectedText(queryEditor, sql) {\n  return { type: QUERY_EDITOR_SET_SELECTED_TEXT, queryEditor, sql };\n}\n\nexport function mergeTable(table, query, prepend) {\n  return { type: MERGE_TABLE, table, query, prepend };\n}\n\nexport function addTable(queryEditor, tableName, catalogName, schemaName) {\n  return function (dispatch, getState) {\n    const query = getUpToDateQuery(getState(), queryEditor, queryEditor.id);\n    const table = {\n      dbId: query.dbId,\n      queryEditorId: query.id,\n      catalog: catalogName,\n      schema: schemaName,\n      name: tableName\n    };\n    dispatch(\n      mergeTable(\n        {\n          ...table,\n          id: nanoid(11),\n          expanded: true\n        },\n        null,\n        true\n      )\n    );\n  };\n}\n\nexport function runTablePreviewQuery(newTable) {\n  return function (dispatch, getState) {\n    const {\n      sqlLab: { databases }\n    } = getState();\n    const database = databases[newTable.dbId];\n    const { dbId, catalog, schema } = newTable;\n\n    if (database && !database.disable_data_preview) {\n      const dataPreviewQuery = {\n        id: nanoid(11),\n        dbId,\n        catalog,\n        schema,\n        sql: newTable.selectStar,\n        tableName: newTable.name,\n        sqlEditorId: null,\n        tab: '',\n        runAsync: database.allow_run_async,\n        ctas: false,\n        isDataPreview: true\n      };\n      return Promise.all([\n      dispatch(\n        mergeTable(\n          {\n            id: newTable.id,\n            dbId: newTable.dbId,\n            catalog: newTable.catalog,\n            schema: newTable.schema,\n            name: newTable.name,\n            queryEditorId: newTable.queryEditorId,\n            dataPreviewQueryId: dataPreviewQuery.id\n          },\n          dataPreviewQuery\n        )\n      ),\n      dispatch(runQuery(dataPreviewQuery))]\n      );\n    }\n    return Promise.resolve();\n  };\n}\n\nexport function syncTable(table, tableMetadata) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence) ?\n    SupersetClient.post({\n      endpoint: encodeURI('/tableschemaview/'),\n      postPayload: { table: { ...tableMetadata, ...table } }\n    }) :\n    Promise.resolve({ json: { id: table.id } });\n\n    return sync.\n    then(({ json: resultJson }) => {\n      const newTable = { ...table, id: resultJson.id };\n      dispatch(\n        mergeTable({\n          ...newTable,\n          expanded: true,\n          initialized: true\n        })\n      );\n      if (!table.dataPreviewQueryId) {\n        dispatch(runTablePreviewQuery({ ...tableMetadata, ...newTable }));\n      }\n    }).\n    catch(() =>\n    dispatch(\n      addDangerToast(\n        t(\n          'An error occurred while fetching table metadata. ' +\n          'Please contact your administrator.'\n        )\n      )\n    )\n    );\n  };\n}\n\nexport function changeDataPreviewId(oldQueryId, newQuery) {\n  return { type: CHANGE_DATA_PREVIEW_ID, oldQueryId, newQuery };\n}\n\nexport function reFetchQueryResults(query) {\n  return function (dispatch) {\n    const newQuery = {\n      id: nanoid(),\n      dbId: query.dbId,\n      sql: query.sql,\n      tableName: query.tableName,\n      sqlEditorId: null,\n      tab: '',\n      runAsync: false,\n      ctas: false,\n      queryLimit: query.queryLimit,\n      isDataPreview: query.isDataPreview\n    };\n    dispatch(runQuery(newQuery));\n    dispatch(changeDataPreviewId(query.id, newQuery));\n  };\n}\n\nexport function expandTable(table) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence) ?\n    SupersetClient.post({\n      endpoint: encodeURI(`/tableschemaview/${table.id}/expanded`),\n      postPayload: { expanded: true }\n    }) :\n    Promise.resolve();\n\n    return sync.\n    then(() => dispatch({ type: EXPAND_TABLE, table })).\n    catch(() =>\n    dispatch(\n      addDangerToast(\n        t(\n          'An error occurred while expanding the table schema. ' +\n          'Please contact your administrator.'\n        )\n      )\n    )\n    );\n  };\n}\n\nexport function collapseTable(table) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence) ?\n    SupersetClient.post({\n      endpoint: encodeURI(`/tableschemaview/${table.id}/expanded`),\n      postPayload: { expanded: false }\n    }) :\n    Promise.resolve();\n\n    return sync.\n    then(() => dispatch({ type: COLLAPSE_TABLE, table })).\n    catch(() =>\n    dispatch(\n      addDangerToast(\n        t(\n          'An error occurred while collapsing the table schema. ' +\n          'Please contact your administrator.'\n        )\n      )\n    )\n    );\n  };\n}\n\nexport function removeTables(tables) {\n  return function (dispatch) {var _tables$filter;\n    const tablesToRemove = (_tables$filter = tables == null ? void 0 : tables.filter(Boolean)) != null ? _tables$filter : [];\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence) ?\n    Promise.all(\n      tablesToRemove.map((table) =>\n      table.initialized ?\n      SupersetClient.delete({\n        endpoint: encodeURI(`/tableschemaview/${table.id}`)\n      }) :\n      Promise.resolve()\n      )\n    ) :\n    Promise.resolve();\n\n    return sync.\n    then(() => dispatch({ type: REMOVE_TABLES, tables: tablesToRemove })).\n    catch(() =>\n    dispatch(\n      addDangerToast(\n        t(\n          'An error occurred while removing the table schema. ' +\n          'Please contact your administrator.'\n        )\n      )\n    )\n    );\n  };\n}\n\nexport function refreshQueries(alteredQueries) {\n  return { type: REFRESH_QUERIES, alteredQueries };\n}\n\nexport function setUserOffline(offline) {\n  return { type: SET_USER_OFFLINE, offline };\n}\n\nexport function persistEditorHeight(queryEditor, northPercent, southPercent) {\n  return {\n    type: QUERY_EDITOR_PERSIST_HEIGHT,\n    queryEditor,\n    northPercent,\n    southPercent\n  };\n}\n\nexport function popStoredQuery(urlId) {\n  return function (dispatch) {\n    return SupersetClient.get({ endpoint: `/kv/${urlId}` }).\n    then(({ json }) =>\n    dispatch(\n      addQueryEditor({\n        name: json.name ? json.name : t('Shared query'),\n        dbId: json.dbId ? parseInt(json.dbId, 10) : null,\n        catalog: json.catalog ? json.catalog : null,\n        schema: json.schema ? json.schema : null,\n        autorun: json.autorun ? json.autorun : false,\n        sql: json.sql ? json.sql : 'SELECT ...',\n        templateParams: json.templateParams\n      })\n    )\n    ).\n    catch(() => dispatch(addDangerToast(ERR_MSG_CANT_LOAD_QUERY)));\n  };\n}\nexport function popSavedQuery(saveQueryId) {\n  return function (dispatch) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/saved_query/${saveQueryId}`\n    }).\n    then(({ json }) => {\n      const queryEditorProps = {\n        ...convertQueryToClient(json.result),\n        loaded: true,\n        autorun: false\n      };\n      const tmpAdaptedProps = {\n        name: queryEditorProps.name,\n        dbId: queryEditorProps.database.id,\n        catalog: queryEditorProps.catalog,\n        schema: queryEditorProps.schema,\n        sql: queryEditorProps.sql,\n        templateParams: queryEditorProps.templateParams\n      };\n      return dispatch(addQueryEditor(tmpAdaptedProps));\n    }).\n    catch(() => dispatch(addDangerToast(ERR_MSG_CANT_LOAD_QUERY)));\n  };\n}\nexport function popQuery(queryId) {\n  return function (dispatch) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/query/${queryId}`\n    }).\n    then(({ json }) => {\n      const queryData = json.result;\n      const queryEditorProps = {\n        dbId: queryData.database.id,\n        catalog: queryData.catalog,\n        schema: queryData.schema,\n        sql: queryData.sql,\n        name: t('Copy of %s', queryData.tab_name),\n        autorun: false\n      };\n      return dispatch(addQueryEditor(queryEditorProps));\n    }).\n    catch(() => dispatch(addDangerToast(ERR_MSG_CANT_LOAD_QUERY)));\n  };\n}\nexport function popDatasourceQuery(datasourceKey, sql) {\n  return function (dispatch) {\n    const QUERY_TEXT = t('Query');\n    const datasetId = datasourceKey.split('__')[0];\n\n    const queryParams = rison.encode({\n      keys: ['none'],\n      columns: ['name', 'schema', 'database.id', 'select_star']\n    });\n\n    return SupersetClient.get({\n      endpoint: `/api/v1/dataset/${datasetId}?q=${queryParams}`\n    }).\n    then(({ json }) =>\n    dispatch(\n      addQueryEditor({\n        name: `${QUERY_TEXT} ${json.result.name}`,\n        dbId: json.result.database.id,\n        schema: json.result.schema,\n        autorun: sql !== undefined,\n        sql: sql || json.result.select_star\n      })\n    )\n    ).\n    catch(() =>\n    dispatch(addDangerToast(t(\"The datasource couldn't be loaded\")))\n    );\n  };\n}\nexport function createDatasourceStarted() {\n  return { type: CREATE_DATASOURCE_STARTED };\n}\nexport function createDatasourceSuccess(data) {\n  const datasource = `${data.id}__table`;\n  return { type: CREATE_DATASOURCE_SUCCESS, datasource };\n}\nexport function createDatasourceFailed(err) {\n  return { type: CREATE_DATASOURCE_FAILED, err };\n}\n\nexport function createDatasource(vizOptions) {\n  return (dispatch) => {\n    dispatch(createDatasourceStarted());\n    const { dbId, catalog, schema, datasourceName, sql } = vizOptions;\n    return SupersetClient.post({\n      endpoint: '/api/v1/dataset/',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        database: dbId,\n        catalog,\n        schema,\n        sql,\n        table_name: datasourceName,\n        is_managed_externally: false,\n        external_url: null\n      })\n    }).\n    then(({ json }) => {\n      dispatch(createDatasourceSuccess(json));\n\n      return Promise.resolve(json);\n    }).\n    catch((error) => {\n      getClientErrorObject(error).then((e) => {\n        dispatch(addDangerToast(e.error));\n      });\n      dispatch(\n        createDatasourceFailed(\n          t('An error occurred while creating the data source')\n        )\n      );\n\n      return Promise.reject();\n    });\n  };\n}\n\nexport function createCtasDatasource(vizOptions) {\n  return (dispatch) => {\n    dispatch(createDatasourceStarted());\n    return SupersetClient.post({\n      endpoint: '/api/v1/dataset/get_or_create/',\n      jsonPayload: vizOptions\n    }).\n    then(({ json }) => {\n      dispatch(createDatasourceSuccess(json.result));\n\n      return json.result;\n    }).\n    catch(() => {\n      const errorMsg = t('An error occurred while creating the data source');\n      dispatch(createDatasourceFailed(errorMsg));\n      return Promise.reject(new Error(errorMsg));\n    });\n  };\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(RESET_STATE, \"RESET_STATE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(ADD_QUERY_EDITOR, \"ADD_QUERY_EDITOR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(UPDATE_QUERY_EDITOR, \"UPDATE_QUERY_EDITOR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SAVED, \"QUERY_EDITOR_SAVED\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CLONE_QUERY_TO_NEW_TAB, \"CLONE_QUERY_TO_NEW_TAB\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(REMOVE_QUERY_EDITOR, \"REMOVE_QUERY_EDITOR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(MERGE_TABLE, \"MERGE_TABLE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(REMOVE_TABLES, \"REMOVE_TABLES\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(END_QUERY, \"END_QUERY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(REMOVE_QUERY, \"REMOVE_QUERY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(EXPAND_TABLE, \"EXPAND_TABLE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(COLLAPSE_TABLE, \"COLLAPSE_TABLE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SETDB, \"QUERY_EDITOR_SETDB\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_CATALOG, \"QUERY_EDITOR_SET_CATALOG\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_SCHEMA, \"QUERY_EDITOR_SET_SCHEMA\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_TITLE, \"QUERY_EDITOR_SET_TITLE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_AUTORUN, \"QUERY_EDITOR_SET_AUTORUN\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_SQL, \"QUERY_EDITOR_SET_SQL\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_CURSOR_POSITION, \"QUERY_EDITOR_SET_CURSOR_POSITION\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_QUERY_LIMIT, \"QUERY_EDITOR_SET_QUERY_LIMIT\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_TEMPLATE_PARAMS, \"QUERY_EDITOR_SET_TEMPLATE_PARAMS\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_SELECTED_TEXT, \"QUERY_EDITOR_SET_SELECTED_TEXT\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_SET_FUNCTION_NAMES, \"QUERY_EDITOR_SET_FUNCTION_NAMES\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_PERSIST_HEIGHT, \"QUERY_EDITOR_PERSIST_HEIGHT\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_EDITOR_TOGGLE_LEFT_BAR, \"QUERY_EDITOR_TOGGLE_LEFT_BAR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(MIGRATE_QUERY_EDITOR, \"MIGRATE_QUERY_EDITOR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(MIGRATE_TAB_HISTORY, \"MIGRATE_TAB_HISTORY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(MIGRATE_TABLE, \"MIGRATE_TABLE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(MIGRATE_QUERY, \"MIGRATE_QUERY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(SET_DATABASES, \"SET_DATABASES\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(SET_ACTIVE_QUERY_EDITOR, \"SET_ACTIVE_QUERY_EDITOR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(LOAD_QUERY_EDITOR, \"LOAD_QUERY_EDITOR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(SET_TABLES, \"SET_TABLES\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(SET_ACTIVE_SOUTHPANE_TAB, \"SET_ACTIVE_SOUTHPANE_TAB\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(REFRESH_QUERIES, \"REFRESH_QUERIES\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(SET_USER_OFFLINE, \"SET_USER_OFFLINE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(RUN_QUERY, \"RUN_QUERY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(START_QUERY, \"START_QUERY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(STOP_QUERY, \"STOP_QUERY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(REQUEST_QUERY_RESULTS, \"REQUEST_QUERY_RESULTS\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_SUCCESS, \"QUERY_SUCCESS\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(QUERY_FAILED, \"QUERY_FAILED\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CLEAR_INACTIVE_QUERIES, \"CLEAR_INACTIVE_QUERIES\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CLEAR_QUERY_RESULTS, \"CLEAR_QUERY_RESULTS\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(REMOVE_DATA_PREVIEW, \"REMOVE_DATA_PREVIEW\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CHANGE_DATA_PREVIEW_ID, \"CHANGE_DATA_PREVIEW_ID\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(COST_ESTIMATE_STARTED, \"COST_ESTIMATE_STARTED\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(COST_ESTIMATE_RETURNED, \"COST_ESTIMATE_RETURNED\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(COST_ESTIMATE_FAILED, \"COST_ESTIMATE_FAILED\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CREATE_DATASOURCE_STARTED, \"CREATE_DATASOURCE_STARTED\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CREATE_DATASOURCE_SUCCESS, \"CREATE_DATASOURCE_SUCCESS\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CREATE_DATASOURCE_FAILED, \"CREATE_DATASOURCE_FAILED\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(SET_EDITOR_TAB_LAST_UPDATE, \"SET_EDITOR_TAB_LAST_UPDATE\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(SET_LAST_UPDATED_ACTIVE_TAB, \"SET_LAST_UPDATED_ACTIVE_TAB\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CLEAR_DESTROYED_QUERY_EDITOR, \"CLEAR_DESTROYED_QUERY_EDITOR\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addInfoToast, \"addInfoToast\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addSuccessToast, \"addSuccessToast\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addDangerToast, \"addDangerToast\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addWarningToast, \"addWarningToast\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(CtasEnum, \"CtasEnum\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(ERR_MSG_CANT_LOAD_QUERY, \"ERR_MSG_CANT_LOAD_QUERY\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryClientMapping, \"queryClientMapping\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryServerMapping, \"queryServerMapping\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(fieldConverter, \"fieldConverter\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(convertQueryToServer, \"convertQueryToServer\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(convertQueryToClient, \"convertQueryToClient\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(getUpToDateQuery, \"getUpToDateQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(resetState, \"resetState\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(updateQueryEditor, \"updateQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(setEditorTabLastUpdate, \"setEditorTabLastUpdate\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(scheduleQuery, \"scheduleQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(estimateQueryCost, \"estimateQueryCost\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(clearInactiveQueries, \"clearInactiveQueries\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(startQuery, \"startQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(querySuccess, \"querySuccess\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryFailed, \"queryFailed\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(stopQuery, \"stopQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(clearQueryResults, \"clearQueryResults\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(removeDataPreview, \"removeDataPreview\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(requestQueryResults, \"requestQueryResults\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(fetchQueryResults, \"fetchQueryResults\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(runQuery, \"runQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(runQueryFromSqlEditor, \"runQueryFromSqlEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(reRunQuery, \"reRunQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(postStopQuery, \"postStopQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(setDatabases, \"setDatabases\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(migrateTable, \"migrateTable\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(migrateQuery, \"migrateQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(syncQueryEditor, \"syncQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addQueryEditor, \"addQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addNewQueryEditor, \"addNewQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(cloneQueryToNewTab, \"cloneQueryToNewTab\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(setLastUpdatedActiveTab, \"setLastUpdatedActiveTab\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(setActiveQueryEditor, \"setActiveQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(loadQueryEditor, \"loadQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(setTables, \"setTables\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(fetchQueryEditor, \"fetchQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(setActiveSouthPaneTab, \"setActiveSouthPaneTab\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(toggleLeftBar, \"toggleLeftBar\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(clearDestoryedQueryEditor, \"clearDestoryedQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(removeQueryEditor, \"removeQueryEditor\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(removeAllOtherQueryEditors, \"removeAllOtherQueryEditors\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(removeQuery, \"removeQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetDb, \"queryEditorSetDb\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetCatalog, \"queryEditorSetCatalog\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetSchema, \"queryEditorSetSchema\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetAutorun, \"queryEditorSetAutorun\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetTitle, \"queryEditorSetTitle\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(saveQuery, \"saveQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addSavedQueryToTabState, \"addSavedQueryToTabState\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(updateSavedQuery, \"updateSavedQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetSql, \"queryEditorSetSql\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetCursorPosition, \"queryEditorSetCursorPosition\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetAndSaveSql, \"queryEditorSetAndSaveSql\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(formatQuery, \"formatQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetQueryLimit, \"queryEditorSetQueryLimit\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetTemplateParams, \"queryEditorSetTemplateParams\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(queryEditorSetSelectedText, \"queryEditorSetSelectedText\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(mergeTable, \"mergeTable\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(addTable, \"addTable\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(runTablePreviewQuery, \"runTablePreviewQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(syncTable, \"syncTable\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(changeDataPreviewId, \"changeDataPreviewId\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(reFetchQueryResults, \"reFetchQueryResults\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(expandTable, \"expandTable\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(collapseTable, \"collapseTable\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(removeTables, \"removeTables\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(refreshQueries, \"refreshQueries\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(setUserOffline, \"setUserOffline\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(persistEditorHeight, \"persistEditorHeight\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(popStoredQuery, \"popStoredQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(popSavedQuery, \"popSavedQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(popQuery, \"popQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(popDatasourceQuery, \"popDatasourceQuery\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(createDatasourceStarted, \"createDatasourceStarted\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(createDatasourceSuccess, \"createDatasourceSuccess\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(createDatasourceFailed, \"createDatasourceFailed\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(createDatasource, \"createDatasource\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");reactHotLoader.register(createCtasDatasource, \"createCtasDatasource\", \"/app/superset-frontend/src/SqlLab/actions/sqlLab.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["nanoid","rison","FeatureFlag","SupersetClient","t","isFeatureEnabled","COMMON_ERR_MESSAGES","getClientErrorObject","now","addDangerToast","addDangerToastAction","addInfoToast","addInfoToastAction","addSuccessToast","addSuccessToastAction","addWarningToast","addWarningToastAction","LOG_ACTIONS_SQLLAB_FETCH_FAILED_QUERY","getBootstrapData","logEvent","newQueryTabName","getInitialState","rehydratePersistedState","RESET_STATE","ADD_QUERY_EDITOR","UPDATE_QUERY_EDITOR","QUERY_EDITOR_SAVED","CLONE_QUERY_TO_NEW_TAB","REMOVE_QUERY_EDITOR","MERGE_TABLE","REMOVE_TABLES","END_QUERY","REMOVE_QUERY","EXPAND_TABLE","COLLAPSE_TABLE","QUERY_EDITOR_SETDB","QUERY_EDITOR_SET_CATALOG","QUERY_EDITOR_SET_SCHEMA","QUERY_EDITOR_SET_TITLE","QUERY_EDITOR_SET_AUTORUN","QUERY_EDITOR_SET_SQL","QUERY_EDITOR_SET_CURSOR_POSITION","QUERY_EDITOR_SET_QUERY_LIMIT","QUERY_EDITOR_SET_TEMPLATE_PARAMS","QUERY_EDITOR_SET_SELECTED_TEXT","QUERY_EDITOR_SET_FUNCTION_NAMES","QUERY_EDITOR_PERSIST_HEIGHT","QUERY_EDITOR_TOGGLE_LEFT_BAR","MIGRATE_QUERY_EDITOR","MIGRATE_TAB_HISTORY","MIGRATE_TABLE","MIGRATE_QUERY","SET_DATABASES","SET_ACTIVE_QUERY_EDITOR","LOAD_QUERY_EDITOR","SET_TABLES","SET_ACTIVE_SOUTHPANE_TAB","REFRESH_QUERIES","SET_USER_OFFLINE","RUN_QUERY","START_QUERY","STOP_QUERY","REQUEST_QUERY_RESULTS","QUERY_SUCCESS","QUERY_FAILED","CLEAR_INACTIVE_QUERIES","CLEAR_QUERY_RESULTS","REMOVE_DATA_PREVIEW","CHANGE_DATA_PREVIEW_ID","COST_ESTIMATE_STARTED","COST_ESTIMATE_RETURNED","COST_ESTIMATE_FAILED","CREATE_DATASOURCE_STARTED","CREATE_DATASOURCE_SUCCESS","CREATE_DATASOURCE_FAILED","SET_EDITOR_TAB_LAST_UPDATE","SET_LAST_UPDATED_ACTIVE_TAB","CLEAR_DESTROYED_QUERY_EDITOR","CtasEnum","Table","View","ERR_MSG_CANT_LOAD_QUERY","queryClientMapping","id","db_id","label","template_parameters","queryServerMapping","_invert","fieldConverter","mapping","obj","_mapKeys","value","key","convertQueryToServer","convertQueryToClient","getUpToDateQuery","rootState","queryEditor","sqlLab","unsavedQueryEditor","queryEditors","find","qe","resetState","data","dispatch","getState","common","initialState","type","sqlLabInitialState","updateQueryEditor","alterations","setEditorTabLastUpdate","timestamp","scheduleQuery","query","post","endpoint","jsonPayload","stringify","then","catch","estimateQueryCost","dbId","catalog","schema","sql","selectedText","templateParams","requestSql","postPayload","database_id","template_params","JSON","parse","Promise","all","body","headers","json","response","error","message","statusText","clearInactiveQueries","interval","startQuery","Object","assign","progress","startDttm","state","runAsync","cached","querySuccess","results","queryFailed","msg","link","errors","eventData","has_err","start_offset","ts","Date","getTime","forEach","error_type","errorType","extra","_extra$issue_codes","messages","issue_codes","map","error_details","stopQuery","clearQueryResults","removeDataPreview","table","requestQueryResults","fetchQueryResults","displayLimit","queryParams","encode","resultsKey","rows","get","parseMethod","runQuery","client_id","sql_editor_id","sqlEditorId","tab","tmp_table_name","tempTable","select_as_cta","ctas","ctas_method","queryLimit","expand_data","search","window","location","includes","SESSION_TIMED_OUT","runQueryFromSqlEditor","database","defaultQueryLimit","ctasMethod","name","allow_run_async","updateTabState","reRunQuery","postStopQuery","setDatabases","databases","migrateTable","queryEditorId","encodeURI","newTable","oldTable","migrateQuery","queryId","syncQueryEditor","tables","queries","localStorageTables","filter","inLocalStorage","localStorageQueries","values","newQueryEditor","toString","loaded","oldQueryEditor","oldId","newId","addQueryEditor","addNewQueryEditor","tabHistory","defaultDbId","conf","SQLLAB_DEFAULT_DBID","activeQueryEditor","length","dbIds","firstDbId","Math","min","undefined","autorun","warning","SqllabBackendPersistence","DEFAULT_SQLLAB_LIMIT","cloneQueryToNewTab","sourceQueryEditor","maxRow","setLastUpdatedActiveTab","setActiveQueryEditor","loadQueryEditor","setTables","tableSchemas","tableSchema","description","columns","selectStar","primaryKey","foreignKeys","indexes","dataPreviewQueryId","tab_state_id","expanded","isMetadataLoading","isExtraMetadataLoading","fetchQueryEditor","_json$latest_query","_json$saved_query","loadedQueryEditor","latestQueryId","latest_query","query_limit","remoteId","saved_query","hideLeftBar","hide_left_bar","table_schemas","status","setActiveSouthPaneTab","tabId","toggleLeftBar","clearDestoryedQueryEditor","removeQueryEditor","removeAllOtherQueryEditors","_sqlLab$queryEditors","otherQueryEditor","removeQuery","sync","delete","resolve","queryEditorSetDb","queryEditorSetCatalog","queryEditorSetSchema","queryEditorSetAutorun","queryEditorSetTitle","saveQuery","clientId","payload","result","savedQuery","addSavedQueryToTabState","put","saved_query_id","updateSavedQuery","e","console","queryEditorSetSql","queryEditorSetCursorPosition","position","queryEditorSetAndSaveSql","targetQueryEditor","latest_query_id","formatQuery","queryEditorSetQueryLimit","queryEditorSetTemplateParams","queryEditorSetSelectedText","mergeTable","prepend","addTable","tableName","catalogName","schemaName","runTablePreviewQuery","disable_data_preview","dataPreviewQuery","isDataPreview","syncTable","tableMetadata","resultJson","initialized","changeDataPreviewId","oldQueryId","newQuery","reFetchQueryResults","expandTable","collapseTable","removeTables","_tables$filter","tablesToRemove","Boolean","refreshQueries","alteredQueries","setUserOffline","offline","persistEditorHeight","northPercent","southPercent","popStoredQuery","urlId","parseInt","popSavedQuery","saveQueryId","queryEditorProps","tmpAdaptedProps","popQuery","queryData","tab_name","popDatasourceQuery","datasourceKey","QUERY_TEXT","datasetId","split","keys","select_star","createDatasourceStarted","createDatasourceSuccess","datasource","createDatasourceFailed","err","createDatasource","vizOptions","datasourceName","table_name","is_managed_externally","external_url","reject","createCtasDatasource","errorMsg","Error","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/app/superset-frontend/src/SqlLab/actions/sqlLab.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { nanoid } from 'nanoid';\nimport rison from 'rison';\nimport {\n  FeatureFlag,\n  SupersetClient,\n  t,\n  isFeatureEnabled,\n  COMMON_ERR_MESSAGES,\n  getClientErrorObject,\n} from '@superset-ui/core';\nimport { invert, mapKeys } from 'lodash';\n\nimport { now } from 'src/utils/dates';\nimport {\n  addDangerToast as addDangerToastAction,\n  addInfoToast as addInfoToastAction,\n  addSuccessToast as addSuccessToastAction,\n  addWarningToast as addWarningToastAction,\n} from 'src/components/MessageToasts/actions';\nimport { LOG_ACTIONS_SQLLAB_FETCH_FAILED_QUERY } from 'src/logger/LogUtils';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport { logEvent } from 'src/logger/actions';\nimport { newQueryTabName } from '../utils/newQueryTabName';\nimport getInitialState from '../reducers/getInitialState';\nimport { rehydratePersistedState } from '../utils/reduxStateToLocalStorageHelper';\n\nexport const RESET_STATE = 'RESET_STATE';\nexport const ADD_QUERY_EDITOR = 'ADD_QUERY_EDITOR';\nexport const UPDATE_QUERY_EDITOR = 'UPDATE_QUERY_EDITOR';\nexport const QUERY_EDITOR_SAVED = 'QUERY_EDITOR_SAVED';\nexport const CLONE_QUERY_TO_NEW_TAB = 'CLONE_QUERY_TO_NEW_TAB';\nexport const REMOVE_QUERY_EDITOR = 'REMOVE_QUERY_EDITOR';\nexport const MERGE_TABLE = 'MERGE_TABLE';\nexport const REMOVE_TABLES = 'REMOVE_TABLES';\nexport const END_QUERY = 'END_QUERY';\nexport const REMOVE_QUERY = 'REMOVE_QUERY';\nexport const EXPAND_TABLE = 'EXPAND_TABLE';\nexport const COLLAPSE_TABLE = 'COLLAPSE_TABLE';\nexport const QUERY_EDITOR_SETDB = 'QUERY_EDITOR_SETDB';\nexport const QUERY_EDITOR_SET_CATALOG = 'QUERY_EDITOR_SET_CATALOG';\nexport const QUERY_EDITOR_SET_SCHEMA = 'QUERY_EDITOR_SET_SCHEMA';\nexport const QUERY_EDITOR_SET_TITLE = 'QUERY_EDITOR_SET_TITLE';\nexport const QUERY_EDITOR_SET_AUTORUN = 'QUERY_EDITOR_SET_AUTORUN';\nexport const QUERY_EDITOR_SET_SQL = 'QUERY_EDITOR_SET_SQL';\nexport const QUERY_EDITOR_SET_CURSOR_POSITION =\n  'QUERY_EDITOR_SET_CURSOR_POSITION';\nexport const QUERY_EDITOR_SET_QUERY_LIMIT = 'QUERY_EDITOR_SET_QUERY_LIMIT';\nexport const QUERY_EDITOR_SET_TEMPLATE_PARAMS =\n  'QUERY_EDITOR_SET_TEMPLATE_PARAMS';\nexport const QUERY_EDITOR_SET_SELECTED_TEXT = 'QUERY_EDITOR_SET_SELECTED_TEXT';\nexport const QUERY_EDITOR_SET_FUNCTION_NAMES =\n  'QUERY_EDITOR_SET_FUNCTION_NAMES';\nexport const QUERY_EDITOR_PERSIST_HEIGHT = 'QUERY_EDITOR_PERSIST_HEIGHT';\nexport const QUERY_EDITOR_TOGGLE_LEFT_BAR = 'QUERY_EDITOR_TOGGLE_LEFT_BAR';\nexport const MIGRATE_QUERY_EDITOR = 'MIGRATE_QUERY_EDITOR';\nexport const MIGRATE_TAB_HISTORY = 'MIGRATE_TAB_HISTORY';\nexport const MIGRATE_TABLE = 'MIGRATE_TABLE';\nexport const MIGRATE_QUERY = 'MIGRATE_QUERY';\n\nexport const SET_DATABASES = 'SET_DATABASES';\nexport const SET_ACTIVE_QUERY_EDITOR = 'SET_ACTIVE_QUERY_EDITOR';\nexport const LOAD_QUERY_EDITOR = 'LOAD_QUERY_EDITOR';\nexport const SET_TABLES = 'SET_TABLES';\nexport const SET_ACTIVE_SOUTHPANE_TAB = 'SET_ACTIVE_SOUTHPANE_TAB';\nexport const REFRESH_QUERIES = 'REFRESH_QUERIES';\nexport const SET_USER_OFFLINE = 'SET_USER_OFFLINE';\nexport const RUN_QUERY = 'RUN_QUERY';\nexport const START_QUERY = 'START_QUERY';\nexport const STOP_QUERY = 'STOP_QUERY';\nexport const REQUEST_QUERY_RESULTS = 'REQUEST_QUERY_RESULTS';\nexport const QUERY_SUCCESS = 'QUERY_SUCCESS';\nexport const QUERY_FAILED = 'QUERY_FAILED';\nexport const CLEAR_INACTIVE_QUERIES = 'CLEAR_INACTIVE_QUERIES';\nexport const CLEAR_QUERY_RESULTS = 'CLEAR_QUERY_RESULTS';\nexport const REMOVE_DATA_PREVIEW = 'REMOVE_DATA_PREVIEW';\nexport const CHANGE_DATA_PREVIEW_ID = 'CHANGE_DATA_PREVIEW_ID';\n\nexport const COST_ESTIMATE_STARTED = 'COST_ESTIMATE_STARTED';\nexport const COST_ESTIMATE_RETURNED = 'COST_ESTIMATE_RETURNED';\nexport const COST_ESTIMATE_FAILED = 'COST_ESTIMATE_FAILED';\n\nexport const CREATE_DATASOURCE_STARTED = 'CREATE_DATASOURCE_STARTED';\nexport const CREATE_DATASOURCE_SUCCESS = 'CREATE_DATASOURCE_SUCCESS';\nexport const CREATE_DATASOURCE_FAILED = 'CREATE_DATASOURCE_FAILED';\n\nexport const SET_EDITOR_TAB_LAST_UPDATE = 'SET_EDITOR_TAB_LAST_UPDATE';\nexport const SET_LAST_UPDATED_ACTIVE_TAB = 'SET_LAST_UPDATED_ACTIVE_TAB';\nexport const CLEAR_DESTROYED_QUERY_EDITOR = 'CLEAR_DESTROYED_QUERY_EDITOR';\n\nexport const addInfoToast = addInfoToastAction;\nexport const addSuccessToast = addSuccessToastAction;\nexport const addDangerToast = addDangerToastAction;\nexport const addWarningToast = addWarningToastAction;\n\nexport const CtasEnum = {\n  Table: 'TABLE',\n  View: 'VIEW',\n};\nconst ERR_MSG_CANT_LOAD_QUERY = t(\"The query couldn't be loaded\");\n\n// a map of SavedQuery field names to the different names used client-side,\n// because for now making the names consistent is too complicated\n// so it might as well only happen in one place\nconst queryClientMapping = {\n  id: 'remoteId',\n  db_id: 'dbId',\n  label: 'name',\n  template_parameters: 'templateParams',\n};\nconst queryServerMapping = invert(queryClientMapping);\n\n// uses a mapping like those above to convert object key names to another style\nconst fieldConverter = mapping => obj =>\n  mapKeys(obj, (value, key) => (key in mapping ? mapping[key] : key));\n\nexport const convertQueryToServer = fieldConverter(queryServerMapping);\nexport const convertQueryToClient = fieldConverter(queryClientMapping);\n\nexport function getUpToDateQuery(rootState, queryEditor, key) {\n  const {\n    sqlLab: { unsavedQueryEditor, queryEditors },\n  } = rootState;\n  const id = key ?? queryEditor.id;\n  return {\n    id,\n    ...queryEditors.find(qe => qe.id === id),\n    ...(id === unsavedQueryEditor.id && unsavedQueryEditor),\n  };\n}\n\nexport function resetState(data) {\n  return (dispatch, getState) => {\n    const { common } = getState();\n    const initialState = getInitialState({\n      ...getBootstrapData(),\n      common,\n      ...data,\n    });\n\n    dispatch({\n      type: RESET_STATE,\n      sqlLabInitialState: initialState.sqlLab,\n    });\n    rehydratePersistedState(dispatch, initialState);\n  };\n}\n\nexport function updateQueryEditor(alterations) {\n  return { type: UPDATE_QUERY_EDITOR, alterations };\n}\n\nexport function setEditorTabLastUpdate(timestamp) {\n  return { type: SET_EDITOR_TAB_LAST_UPDATE, timestamp };\n}\n\nexport function scheduleQuery(query) {\n  return dispatch =>\n    SupersetClient.post({\n      endpoint: '/api/v1/saved_query/',\n      jsonPayload: query,\n      stringify: false,\n    })\n      .then(() =>\n        dispatch(\n          addSuccessToast(\n            t(\n              'Your query has been scheduled. To see details of your query, navigate to Saved queries',\n            ),\n          ),\n        ),\n      )\n      .catch(() =>\n        dispatch(addDangerToast(t('Your query could not be scheduled'))),\n      );\n}\n\nexport function estimateQueryCost(queryEditor) {\n  return (dispatch, getState) => {\n    const { dbId, catalog, schema, sql, selectedText, templateParams } =\n      getUpToDateQuery(getState(), queryEditor);\n    const requestSql = selectedText || sql;\n\n    const postPayload = {\n      database_id: dbId,\n      catalog,\n      schema,\n      sql: requestSql,\n      template_params: JSON.parse(templateParams || '{}'),\n    };\n\n    return Promise.all([\n      dispatch({ type: COST_ESTIMATE_STARTED, query: queryEditor }),\n      SupersetClient.post({\n        endpoint: '/api/v1/sqllab/estimate/',\n        body: JSON.stringify(postPayload),\n        headers: { 'Content-Type': 'application/json' },\n      })\n        .then(({ json }) =>\n          dispatch({ type: COST_ESTIMATE_RETURNED, query: queryEditor, json }),\n        )\n        .catch(response =>\n          getClientErrorObject(response).then(error => {\n            const message =\n              error.error ||\n              error.statusText ||\n              t('Failed at retrieving results');\n            return dispatch({\n              type: COST_ESTIMATE_FAILED,\n              query: queryEditor,\n              error: message,\n            });\n          }),\n        ),\n    ]);\n  };\n}\n\nexport function clearInactiveQueries(interval) {\n  return { type: CLEAR_INACTIVE_QUERIES, interval };\n}\n\nexport function startQuery(query) {\n  Object.assign(query, {\n    id: query.id ? query.id : nanoid(11),\n    progress: 0,\n    startDttm: now(),\n    state: query.runAsync ? 'pending' : 'running',\n    cached: false,\n  });\n  return { type: START_QUERY, query };\n}\n\nexport function querySuccess(query, results) {\n  return { type: QUERY_SUCCESS, query, results };\n}\n\nexport function queryFailed(query, msg, link, errors) {\n  return function (dispatch) {\n    const eventData = {\n      has_err: true,\n      start_offset: query.startDttm,\n      ts: new Date().getTime(),\n    };\n    errors?.forEach(({ error_type: errorType, extra }) => {\n      const messages = extra?.issue_codes?.map(({ message }) => message) || [\n        errorType,\n      ];\n      messages.forEach(message => {\n        dispatch(\n          logEvent(LOG_ACTIONS_SQLLAB_FETCH_FAILED_QUERY, {\n            ...eventData,\n            error_type: errorType,\n            error_details: message,\n          }),\n        );\n      });\n    });\n\n    dispatch({ type: QUERY_FAILED, query, msg, link, errors });\n  };\n}\n\nexport function stopQuery(query) {\n  return { type: STOP_QUERY, query };\n}\n\nexport function clearQueryResults(query) {\n  return { type: CLEAR_QUERY_RESULTS, query };\n}\n\nexport function removeDataPreview(table) {\n  return { type: REMOVE_DATA_PREVIEW, table };\n}\n\nexport function requestQueryResults(query) {\n  return { type: REQUEST_QUERY_RESULTS, query };\n}\n\nexport function fetchQueryResults(query, displayLimit) {\n  return function (dispatch) {\n    dispatch(requestQueryResults(query));\n\n    const queryParams = rison.encode({\n      key: query.resultsKey,\n      rows: displayLimit || null,\n    });\n\n    return SupersetClient.get({\n      endpoint: `/api/v1/sqllab/results/?q=${queryParams}`,\n      parseMethod: 'json-bigint',\n    })\n      .then(({ json }) => dispatch(querySuccess(query, json)))\n      .catch(response =>\n        getClientErrorObject(response).then(error => {\n          const message =\n            error.error ||\n            error.statusText ||\n            t('Failed at retrieving results');\n\n          return dispatch(\n            queryFailed(query, message, error.link, error.errors),\n          );\n        }),\n      );\n  };\n}\n\nexport function runQuery(query) {\n  return function (dispatch) {\n    dispatch(startQuery(query));\n    const postPayload = {\n      client_id: query.id,\n      database_id: query.dbId,\n      json: true,\n      runAsync: query.runAsync,\n      catalog: query.catalog,\n      schema: query.schema,\n      sql: query.sql,\n      sql_editor_id: query.sqlEditorId,\n      tab: query.tab,\n      tmp_table_name: query.tempTable,\n      select_as_cta: query.ctas,\n      ctas_method: query.ctas_method,\n      templateParams: query.templateParams,\n      queryLimit: query.queryLimit,\n      expand_data: true,\n    };\n\n    const search = window.location.search || '';\n    return SupersetClient.post({\n      endpoint: `/api/v1/sqllab/execute/${search}`,\n      body: JSON.stringify(postPayload),\n      headers: { 'Content-Type': 'application/json' },\n      parseMethod: 'json-bigint',\n    })\n      .then(({ json }) => {\n        if (!query.runAsync) {\n          dispatch(querySuccess(query, json));\n        }\n      })\n      .catch(response =>\n        getClientErrorObject(response).then(error => {\n          let message =\n            error.error ||\n            error.message ||\n            error.statusText ||\n            t('Unknown error');\n          if (message.includes('CSRF token')) {\n            message = t(COMMON_ERR_MESSAGES.SESSION_TIMED_OUT);\n          }\n          dispatch(queryFailed(query, message, error.link, error.errors));\n        }),\n      );\n  };\n}\n\nexport function runQueryFromSqlEditor(\n  database,\n  queryEditor,\n  defaultQueryLimit,\n  tempTable,\n  ctas,\n  ctasMethod,\n) {\n  return function (dispatch, getState) {\n    const qe = getUpToDateQuery(getState(), queryEditor, queryEditor.id);\n    const query = {\n      dbId: qe.dbId,\n      sql: qe.selectedText || qe.sql,\n      sqlEditorId: qe.id,\n      tab: qe.name,\n      catalog: qe.catalog,\n      schema: qe.schema,\n      tempTable,\n      templateParams: qe.templateParams,\n      queryLimit: qe.queryLimit || defaultQueryLimit,\n      runAsync: database ? database.allow_run_async : false,\n      ctas,\n      ctas_method: ctasMethod,\n      updateTabState: !qe.selectedText,\n    };\n    dispatch(runQuery(query));\n  };\n}\n\nexport function reRunQuery(query) {\n  // run Query with a new id\n  return function (dispatch) {\n    dispatch(runQuery({ ...query, id: nanoid(11) }));\n  };\n}\n\nexport function postStopQuery(query) {\n  return function (dispatch) {\n    return SupersetClient.post({\n      endpoint: '/api/v1/query/stop',\n      body: JSON.stringify({ client_id: query.id }),\n      headers: { 'Content-Type': 'application/json' },\n    })\n      .then(() => dispatch(stopQuery(query)))\n      .then(() => dispatch(addSuccessToast(t('Query was stopped.'))))\n      .catch(() =>\n        dispatch(addDangerToast(t('Failed at stopping query. %s', query.id))),\n      );\n  };\n}\n\nexport function setDatabases(databases) {\n  return { type: SET_DATABASES, databases };\n}\n\nfunction migrateTable(table, queryEditorId, dispatch) {\n  return SupersetClient.post({\n    endpoint: encodeURI('/tableschemaview/'),\n    postPayload: { table: { ...table, queryEditorId } },\n  })\n    .then(({ json }) => {\n      const newTable = {\n        ...table,\n        id: json.id,\n        queryEditorId,\n      };\n      return dispatch({ type: MIGRATE_TABLE, oldTable: table, newTable });\n    })\n    .catch(() =>\n      dispatch(\n        addWarningToast(\n          t(\n            'Unable to migrate table schema state to backend. Superset will retry ' +\n              'later. Please contact your administrator if this problem persists.',\n          ),\n        ),\n      ),\n    );\n}\n\nfunction migrateQuery(queryId, queryEditorId, dispatch) {\n  return SupersetClient.post({\n    endpoint: encodeURI(`/tabstateview/${queryEditorId}/migrate_query`),\n    postPayload: { queryId },\n  })\n    .then(() => dispatch({ type: MIGRATE_QUERY, queryId, queryEditorId }))\n    .catch(() =>\n      dispatch(\n        addWarningToast(\n          t(\n            'Unable to migrate query state to backend. Superset will retry later. ' +\n              'Please contact your administrator if this problem persists.',\n          ),\n        ),\n      ),\n    );\n}\n\n/**\n * Persist QueryEditor from local storage to backend tab state.\n * This ensures that when new tabs are created, query editors are\n * asynchronously stored in local storage and periodically synchronized\n * with the backend.\n * When switching to persistence mode, the QueryEditors previously\n * stored in local storage will also be synchronized to the backend\n * through syncQueryEditor.\n */\nexport function syncQueryEditor(queryEditor) {\n  return function (dispatch, getState) {\n    const { tables, queries } = getState().sqlLab;\n    const localStorageTables = tables.filter(\n      table => table.inLocalStorage && table.queryEditorId === queryEditor.id,\n    );\n    const localStorageQueries = Object.values(queries).filter(\n      query => query.inLocalStorage && query.sqlEditorId === queryEditor.id,\n    );\n    return SupersetClient.post({\n      endpoint: '/tabstateview/',\n      postPayload: { queryEditor },\n    })\n      .then(({ json }) => {\n        const newQueryEditor = {\n          ...queryEditor,\n          id: json.id.toString(),\n          inLocalStorage: false,\n          loaded: true,\n        };\n        dispatch({\n          type: MIGRATE_QUERY_EDITOR,\n          oldQueryEditor: queryEditor,\n          newQueryEditor,\n        });\n        dispatch({\n          type: MIGRATE_TAB_HISTORY,\n          oldId: queryEditor.id,\n          newId: newQueryEditor.id,\n        });\n        return Promise.all([\n          ...localStorageTables.map(table =>\n            migrateTable(table, newQueryEditor.id, dispatch),\n          ),\n          ...localStorageQueries.map(query =>\n            migrateQuery(query.id, newQueryEditor.id, dispatch),\n          ),\n        ]);\n      })\n      .catch(() =>\n        dispatch(\n          addWarningToast(\n            t(\n              'Unable to migrate query editor state to backend. Superset will retry ' +\n                'later. Please contact your administrator if this problem persists.',\n            ),\n          ),\n        ),\n      );\n  };\n}\n\nexport function addQueryEditor(queryEditor) {\n  const newQueryEditor = {\n    ...queryEditor,\n    id: nanoid(11),\n    loaded: true,\n    inLocalStorage: true,\n  };\n  return {\n    type: ADD_QUERY_EDITOR,\n    queryEditor: newQueryEditor,\n  };\n}\n\nexport function addNewQueryEditor() {\n  return function (dispatch, getState) {\n    const {\n      sqlLab: { queryEditors, tabHistory, unsavedQueryEditor, databases },\n      common,\n    } = getState();\n    const defaultDbId = common.conf.SQLLAB_DEFAULT_DBID;\n    const activeQueryEditor = queryEditors.find(\n      qe => qe.id === tabHistory[tabHistory.length - 1],\n    );\n    const dbIds = Object.values(databases).map(database => database.id);\n    const firstDbId = dbIds.length > 0 ? Math.min(...dbIds) : undefined;\n    const { dbId, catalog, schema, queryLimit, autorun } = {\n      ...queryEditors[0],\n      ...activeQueryEditor,\n      ...(unsavedQueryEditor.id === activeQueryEditor?.id &&\n        unsavedQueryEditor),\n    };\n    const warning = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)\n      ? ''\n      : t(\n          '-- Note: Unless you save your query, these tabs will NOT persist if you clear your cookies or change browsers.\\n\\n',\n        );\n\n    const name = newQueryTabName(\n      queryEditors?.map(qe => ({\n        ...qe,\n        ...(qe.id === unsavedQueryEditor.id && unsavedQueryEditor),\n      })) || [],\n    );\n\n    return dispatch(\n      addQueryEditor({\n        dbId: dbId || defaultDbId || firstDbId,\n        catalog: catalog ?? null,\n        schema: schema ?? null,\n        autorun: autorun ?? false,\n        sql: `${warning}SELECT ...`,\n        queryLimit: queryLimit || common.conf.DEFAULT_SQLLAB_LIMIT,\n        name,\n      }),\n    );\n  };\n}\n\nexport function cloneQueryToNewTab(query, autorun) {\n  return function (dispatch, getState) {\n    const state = getState();\n    const { queryEditors, unsavedQueryEditor, tabHistory } = state.sqlLab;\n    const sourceQueryEditor = {\n      ...queryEditors.find(qe => qe.id === tabHistory[tabHistory.length - 1]),\n      ...(tabHistory[tabHistory.length - 1] === unsavedQueryEditor.id &&\n        unsavedQueryEditor),\n    };\n    const queryEditor = {\n      name: t('Copy of %s', sourceQueryEditor.name),\n      dbId: query.dbId ? query.dbId : null,\n      catalog: query.catalog ? query.catalog : null,\n      schema: query.schema ? query.schema : null,\n      autorun,\n      sql: query.sql,\n      queryLimit: sourceQueryEditor.queryLimit,\n      maxRow: sourceQueryEditor.maxRow,\n      templateParams: sourceQueryEditor.templateParams,\n    };\n    return dispatch(addQueryEditor(queryEditor));\n  };\n}\n\nexport function setLastUpdatedActiveTab(queryEditorId) {\n  return {\n    type: SET_LAST_UPDATED_ACTIVE_TAB,\n    queryEditorId,\n  };\n}\n\nexport function setActiveQueryEditor(queryEditor) {\n  return {\n    type: SET_ACTIVE_QUERY_EDITOR,\n    queryEditor,\n  };\n}\n\nexport function loadQueryEditor(queryEditor) {\n  return { type: LOAD_QUERY_EDITOR, queryEditor };\n}\n\nexport function setTables(tableSchemas) {\n  const tables = tableSchemas\n    .filter(tableSchema => tableSchema.description !== null)\n    .map(tableSchema => {\n      const {\n        columns,\n        selectStar,\n        primaryKey,\n        foreignKeys,\n        indexes,\n        dataPreviewQueryId,\n      } = tableSchema.description;\n      return {\n        dbId: tableSchema.database_id,\n        queryEditorId: tableSchema.tab_state_id.toString(),\n        catalog: tableSchema.catalog,\n        schema: tableSchema.schema,\n        name: tableSchema.table,\n        expanded: tableSchema.expanded,\n        id: tableSchema.id,\n        dataPreviewQueryId,\n        columns,\n        selectStar,\n        primaryKey,\n        foreignKeys,\n        indexes,\n        isMetadataLoading: false,\n        isExtraMetadataLoading: false,\n      };\n    });\n  return { type: SET_TABLES, tables };\n}\n\nexport function fetchQueryEditor(queryEditor, displayLimit) {\n  return function (dispatch) {\n    SupersetClient.get({\n      endpoint: encodeURI(`/tabstateview/${queryEditor.id}`),\n    })\n      .then(({ json }) => {\n        const loadedQueryEditor = {\n          id: json.id.toString(),\n          loaded: true,\n          name: json.label,\n          sql: json.sql,\n          selectedText: null,\n          latestQueryId: json.latest_query?.id,\n          autorun: json.autorun,\n          dbId: json.database_id,\n          templateParams: json.template_params,\n          catalog: json.catalog,\n          schema: json.schema,\n          queryLimit: json.query_limit,\n          remoteId: json.saved_query?.id,\n          hideLeftBar: json.hide_left_bar,\n        };\n        dispatch(loadQueryEditor(loadedQueryEditor));\n        dispatch(setTables(json.table_schemas || []));\n        if (json.latest_query && json.latest_query.resultsKey) {\n          dispatch(fetchQueryResults(json.latest_query, displayLimit));\n        }\n      })\n      .catch(response => {\n        if (response.status !== 404) {\n          return dispatch(\n            addDangerToast(t('An error occurred while fetching tab state')),\n          );\n        }\n        return dispatch({ type: REMOVE_QUERY_EDITOR, queryEditor });\n      });\n  };\n}\n\nexport function setActiveSouthPaneTab(tabId) {\n  return { type: SET_ACTIVE_SOUTHPANE_TAB, tabId };\n}\n\nexport function toggleLeftBar(queryEditor) {\n  const hideLeftBar = !queryEditor.hideLeftBar;\n  return {\n    type: QUERY_EDITOR_TOGGLE_LEFT_BAR,\n    queryEditor,\n    hideLeftBar,\n  };\n}\n\nexport function clearDestoryedQueryEditor(queryEditorId) {\n  return { type: CLEAR_DESTROYED_QUERY_EDITOR, queryEditorId };\n}\n\nexport function removeQueryEditor(queryEditor) {\n  return { type: REMOVE_QUERY_EDITOR, queryEditor };\n}\n\nexport function removeAllOtherQueryEditors(queryEditor) {\n  return function (dispatch, getState) {\n    const { sqlLab } = getState();\n    sqlLab.queryEditors?.forEach(otherQueryEditor => {\n      if (otherQueryEditor.id !== queryEditor.id) {\n        dispatch(removeQueryEditor(otherQueryEditor));\n      }\n    });\n  };\n}\n\nexport function removeQuery(query) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)\n      ? SupersetClient.delete({\n          endpoint: encodeURI(\n            `/tabstateview/${query.sqlEditorId}/query/${query.id}`,\n          ),\n        })\n      : Promise.resolve();\n\n    return sync\n      .then(() => dispatch({ type: REMOVE_QUERY, query }))\n      .catch(() =>\n        dispatch(\n          addDangerToast(\n            t(\n              'An error occurred while removing query. Please contact your administrator.',\n            ),\n          ),\n        ),\n      );\n  };\n}\n\nexport function queryEditorSetDb(queryEditor, dbId) {\n  return { type: QUERY_EDITOR_SETDB, queryEditor, dbId };\n}\n\nexport function queryEditorSetCatalog(queryEditor, catalog) {\n  return {\n    type: QUERY_EDITOR_SET_CATALOG,\n    queryEditor: queryEditor || {},\n    catalog,\n  };\n}\n\nexport function queryEditorSetSchema(queryEditor, schema) {\n  return {\n    type: QUERY_EDITOR_SET_SCHEMA,\n    queryEditor: queryEditor || {},\n    schema,\n  };\n}\n\nexport function queryEditorSetAutorun(queryEditor, autorun) {\n  return { type: QUERY_EDITOR_SET_AUTORUN, queryEditor, autorun };\n}\n\nexport function queryEditorSetTitle(queryEditor, name, id) {\n  return {\n    type: QUERY_EDITOR_SET_TITLE,\n    queryEditor: { ...queryEditor, id },\n    name,\n  };\n}\n\nexport function saveQuery(query, clientId) {\n  const { id, ...payload } = convertQueryToServer(query);\n\n  return dispatch =>\n    SupersetClient.post({\n      endpoint: '/api/v1/saved_query/',\n      jsonPayload: convertQueryToServer(payload),\n    })\n      .then(result => {\n        const savedQuery = convertQueryToClient({\n          id: result.json.id,\n          ...result.json.result,\n        });\n        dispatch({\n          type: QUERY_EDITOR_SAVED,\n          query,\n          clientId,\n          result: savedQuery,\n        });\n        dispatch(queryEditorSetTitle(query, query.name, clientId));\n        return savedQuery;\n      })\n      .catch(() =>\n        dispatch(addDangerToast(t('Your query could not be saved'))),\n      );\n}\n\nexport const addSavedQueryToTabState =\n  (queryEditor, savedQuery) => dispatch => {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)\n      ? SupersetClient.put({\n          endpoint: `/tabstateview/${queryEditor.id}`,\n          postPayload: { saved_query_id: savedQuery.remoteId },\n        })\n      : Promise.resolve();\n\n    return sync\n      .catch(() => {\n        dispatch(addDangerToast(t('Your query was not properly saved')));\n      })\n      .then(() => {\n        dispatch(addSuccessToast(t('Your query was saved')));\n      });\n  };\n\nexport function updateSavedQuery(query, clientId) {\n  const { id, ...payload } = convertQueryToServer(query);\n\n  return dispatch =>\n    SupersetClient.put({\n      endpoint: `/api/v1/saved_query/${query.remoteId}`,\n      jsonPayload: convertQueryToServer(payload),\n    })\n      .then(() => {\n        dispatch(addSuccessToast(t('Your query was updated')));\n        dispatch(queryEditorSetTitle(query, query.name, clientId));\n      })\n      .catch(e => {\n        const message = t('Your query could not be updated');\n        // eslint-disable-next-line no-console\n        console.error(message, e);\n        dispatch(addDangerToast(message));\n      })\n      .then(() => dispatch(updateQueryEditor(query)));\n}\n\nexport function queryEditorSetSql(queryEditor, sql, queryId) {\n  return { type: QUERY_EDITOR_SET_SQL, queryEditor, sql, queryId };\n}\n\nexport function queryEditorSetCursorPosition(queryEditor, position) {\n  return { type: QUERY_EDITOR_SET_CURSOR_POSITION, queryEditor, position };\n}\n\nexport function queryEditorSetAndSaveSql(targetQueryEditor, sql, queryId) {\n  return function (dispatch, getState) {\n    const queryEditor = getUpToDateQuery(getState(), targetQueryEditor);\n    // saved query and set tab state use this action\n    dispatch(queryEditorSetSql(queryEditor, sql, queryId));\n    if (isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)) {\n      return SupersetClient.put({\n        endpoint: encodeURI(`/tabstateview/${queryEditor.id}`),\n        postPayload: { sql, latest_query_id: queryId },\n      }).catch(() =>\n        dispatch(\n          addDangerToast(\n            t(\n              'An error occurred while storing your query in the backend. To ' +\n                'avoid losing your changes, please save your query using the ' +\n                '\"Save Query\" button.',\n            ),\n          ),\n        ),\n      );\n    }\n    return Promise.resolve();\n  };\n}\n\nexport function formatQuery(queryEditor) {\n  return function (dispatch, getState) {\n    const { sql } = getUpToDateQuery(getState(), queryEditor);\n    return SupersetClient.post({\n      endpoint: `/api/v1/sqllab/format_sql/`,\n      // TODO (betodealmeida): pass engine as a parameter for better formatting\n      body: JSON.stringify({ sql }),\n      headers: { 'Content-Type': 'application/json' },\n    }).then(({ json }) => {\n      dispatch(queryEditorSetSql(queryEditor, json.result));\n    });\n  };\n}\n\nexport function queryEditorSetQueryLimit(queryEditor, queryLimit) {\n  return {\n    type: QUERY_EDITOR_SET_QUERY_LIMIT,\n    queryEditor,\n    queryLimit,\n  };\n}\n\nexport function queryEditorSetTemplateParams(queryEditor, templateParams) {\n  return {\n    type: QUERY_EDITOR_SET_TEMPLATE_PARAMS,\n    queryEditor,\n    templateParams,\n  };\n}\n\nexport function queryEditorSetSelectedText(queryEditor, sql) {\n  return { type: QUERY_EDITOR_SET_SELECTED_TEXT, queryEditor, sql };\n}\n\nexport function mergeTable(table, query, prepend) {\n  return { type: MERGE_TABLE, table, query, prepend };\n}\n\nexport function addTable(queryEditor, tableName, catalogName, schemaName) {\n  return function (dispatch, getState) {\n    const query = getUpToDateQuery(getState(), queryEditor, queryEditor.id);\n    const table = {\n      dbId: query.dbId,\n      queryEditorId: query.id,\n      catalog: catalogName,\n      schema: schemaName,\n      name: tableName,\n    };\n    dispatch(\n      mergeTable(\n        {\n          ...table,\n          id: nanoid(11),\n          expanded: true,\n        },\n        null,\n        true,\n      ),\n    );\n  };\n}\n\nexport function runTablePreviewQuery(newTable) {\n  return function (dispatch, getState) {\n    const {\n      sqlLab: { databases },\n    } = getState();\n    const database = databases[newTable.dbId];\n    const { dbId, catalog, schema } = newTable;\n\n    if (database && !database.disable_data_preview) {\n      const dataPreviewQuery = {\n        id: nanoid(11),\n        dbId,\n        catalog,\n        schema,\n        sql: newTable.selectStar,\n        tableName: newTable.name,\n        sqlEditorId: null,\n        tab: '',\n        runAsync: database.allow_run_async,\n        ctas: false,\n        isDataPreview: true,\n      };\n      return Promise.all([\n        dispatch(\n          mergeTable(\n            {\n              id: newTable.id,\n              dbId: newTable.dbId,\n              catalog: newTable.catalog,\n              schema: newTable.schema,\n              name: newTable.name,\n              queryEditorId: newTable.queryEditorId,\n              dataPreviewQueryId: dataPreviewQuery.id,\n            },\n            dataPreviewQuery,\n          ),\n        ),\n        dispatch(runQuery(dataPreviewQuery)),\n      ]);\n    }\n    return Promise.resolve();\n  };\n}\n\nexport function syncTable(table, tableMetadata) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)\n      ? SupersetClient.post({\n          endpoint: encodeURI('/tableschemaview/'),\n          postPayload: { table: { ...tableMetadata, ...table } },\n        })\n      : Promise.resolve({ json: { id: table.id } });\n\n    return sync\n      .then(({ json: resultJson }) => {\n        const newTable = { ...table, id: resultJson.id };\n        dispatch(\n          mergeTable({\n            ...newTable,\n            expanded: true,\n            initialized: true,\n          }),\n        );\n        if (!table.dataPreviewQueryId) {\n          dispatch(runTablePreviewQuery({ ...tableMetadata, ...newTable }));\n        }\n      })\n      .catch(() =>\n        dispatch(\n          addDangerToast(\n            t(\n              'An error occurred while fetching table metadata. ' +\n                'Please contact your administrator.',\n            ),\n          ),\n        ),\n      );\n  };\n}\n\nexport function changeDataPreviewId(oldQueryId, newQuery) {\n  return { type: CHANGE_DATA_PREVIEW_ID, oldQueryId, newQuery };\n}\n\nexport function reFetchQueryResults(query) {\n  return function (dispatch) {\n    const newQuery = {\n      id: nanoid(),\n      dbId: query.dbId,\n      sql: query.sql,\n      tableName: query.tableName,\n      sqlEditorId: null,\n      tab: '',\n      runAsync: false,\n      ctas: false,\n      queryLimit: query.queryLimit,\n      isDataPreview: query.isDataPreview,\n    };\n    dispatch(runQuery(newQuery));\n    dispatch(changeDataPreviewId(query.id, newQuery));\n  };\n}\n\nexport function expandTable(table) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)\n      ? SupersetClient.post({\n          endpoint: encodeURI(`/tableschemaview/${table.id}/expanded`),\n          postPayload: { expanded: true },\n        })\n      : Promise.resolve();\n\n    return sync\n      .then(() => dispatch({ type: EXPAND_TABLE, table }))\n      .catch(() =>\n        dispatch(\n          addDangerToast(\n            t(\n              'An error occurred while expanding the table schema. ' +\n                'Please contact your administrator.',\n            ),\n          ),\n        ),\n      );\n  };\n}\n\nexport function collapseTable(table) {\n  return function (dispatch) {\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)\n      ? SupersetClient.post({\n          endpoint: encodeURI(`/tableschemaview/${table.id}/expanded`),\n          postPayload: { expanded: false },\n        })\n      : Promise.resolve();\n\n    return sync\n      .then(() => dispatch({ type: COLLAPSE_TABLE, table }))\n      .catch(() =>\n        dispatch(\n          addDangerToast(\n            t(\n              'An error occurred while collapsing the table schema. ' +\n                'Please contact your administrator.',\n            ),\n          ),\n        ),\n      );\n  };\n}\n\nexport function removeTables(tables) {\n  return function (dispatch) {\n    const tablesToRemove = tables?.filter(Boolean) ?? [];\n    const sync = isFeatureEnabled(FeatureFlag.SqllabBackendPersistence)\n      ? Promise.all(\n          tablesToRemove.map(table =>\n            table.initialized\n              ? SupersetClient.delete({\n                  endpoint: encodeURI(`/tableschemaview/${table.id}`),\n                })\n              : Promise.resolve(),\n          ),\n        )\n      : Promise.resolve();\n\n    return sync\n      .then(() => dispatch({ type: REMOVE_TABLES, tables: tablesToRemove }))\n      .catch(() =>\n        dispatch(\n          addDangerToast(\n            t(\n              'An error occurred while removing the table schema. ' +\n                'Please contact your administrator.',\n            ),\n          ),\n        ),\n      );\n  };\n}\n\nexport function refreshQueries(alteredQueries) {\n  return { type: REFRESH_QUERIES, alteredQueries };\n}\n\nexport function setUserOffline(offline) {\n  return { type: SET_USER_OFFLINE, offline };\n}\n\nexport function persistEditorHeight(queryEditor, northPercent, southPercent) {\n  return {\n    type: QUERY_EDITOR_PERSIST_HEIGHT,\n    queryEditor,\n    northPercent,\n    southPercent,\n  };\n}\n\nexport function popStoredQuery(urlId) {\n  return function (dispatch) {\n    return SupersetClient.get({ endpoint: `/kv/${urlId}` })\n      .then(({ json }) =>\n        dispatch(\n          addQueryEditor({\n            name: json.name ? json.name : t('Shared query'),\n            dbId: json.dbId ? parseInt(json.dbId, 10) : null,\n            catalog: json.catalog ? json.catalog : null,\n            schema: json.schema ? json.schema : null,\n            autorun: json.autorun ? json.autorun : false,\n            sql: json.sql ? json.sql : 'SELECT ...',\n            templateParams: json.templateParams,\n          }),\n        ),\n      )\n      .catch(() => dispatch(addDangerToast(ERR_MSG_CANT_LOAD_QUERY)));\n  };\n}\nexport function popSavedQuery(saveQueryId) {\n  return function (dispatch) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/saved_query/${saveQueryId}`,\n    })\n      .then(({ json }) => {\n        const queryEditorProps = {\n          ...convertQueryToClient(json.result),\n          loaded: true,\n          autorun: false,\n        };\n        const tmpAdaptedProps = {\n          name: queryEditorProps.name,\n          dbId: queryEditorProps.database.id,\n          catalog: queryEditorProps.catalog,\n          schema: queryEditorProps.schema,\n          sql: queryEditorProps.sql,\n          templateParams: queryEditorProps.templateParams,\n        };\n        return dispatch(addQueryEditor(tmpAdaptedProps));\n      })\n      .catch(() => dispatch(addDangerToast(ERR_MSG_CANT_LOAD_QUERY)));\n  };\n}\nexport function popQuery(queryId) {\n  return function (dispatch) {\n    return SupersetClient.get({\n      endpoint: `/api/v1/query/${queryId}`,\n    })\n      .then(({ json }) => {\n        const queryData = json.result;\n        const queryEditorProps = {\n          dbId: queryData.database.id,\n          catalog: queryData.catalog,\n          schema: queryData.schema,\n          sql: queryData.sql,\n          name: t('Copy of %s', queryData.tab_name),\n          autorun: false,\n        };\n        return dispatch(addQueryEditor(queryEditorProps));\n      })\n      .catch(() => dispatch(addDangerToast(ERR_MSG_CANT_LOAD_QUERY)));\n  };\n}\nexport function popDatasourceQuery(datasourceKey, sql) {\n  return function (dispatch) {\n    const QUERY_TEXT = t('Query');\n    const datasetId = datasourceKey.split('__')[0];\n\n    const queryParams = rison.encode({\n      keys: ['none'],\n      columns: ['name', 'schema', 'database.id', 'select_star'],\n    });\n\n    return SupersetClient.get({\n      endpoint: `/api/v1/dataset/${datasetId}?q=${queryParams}`,\n    })\n      .then(({ json }) =>\n        dispatch(\n          addQueryEditor({\n            name: `${QUERY_TEXT} ${json.result.name}`,\n            dbId: json.result.database.id,\n            schema: json.result.schema,\n            autorun: sql !== undefined,\n            sql: sql || json.result.select_star,\n          }),\n        ),\n      )\n      .catch(() =>\n        dispatch(addDangerToast(t(\"The datasource couldn't be loaded\"))),\n      );\n  };\n}\nexport function createDatasourceStarted() {\n  return { type: CREATE_DATASOURCE_STARTED };\n}\nexport function createDatasourceSuccess(data) {\n  const datasource = `${data.id}__table`;\n  return { type: CREATE_DATASOURCE_SUCCESS, datasource };\n}\nexport function createDatasourceFailed(err) {\n  return { type: CREATE_DATASOURCE_FAILED, err };\n}\n\nexport function createDatasource(vizOptions) {\n  return dispatch => {\n    dispatch(createDatasourceStarted());\n    const { dbId, catalog, schema, datasourceName, sql } = vizOptions;\n    return SupersetClient.post({\n      endpoint: '/api/v1/dataset/',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        database: dbId,\n        catalog,\n        schema,\n        sql,\n        table_name: datasourceName,\n        is_managed_externally: false,\n        external_url: null,\n      }),\n    })\n      .then(({ json }) => {\n        dispatch(createDatasourceSuccess(json));\n\n        return Promise.resolve(json);\n      })\n      .catch(error => {\n        getClientErrorObject(error).then(e => {\n          dispatch(addDangerToast(e.error));\n        });\n        dispatch(\n          createDatasourceFailed(\n            t('An error occurred while creating the data source'),\n          ),\n        );\n\n        return Promise.reject();\n      });\n  };\n}\n\nexport function createCtasDatasource(vizOptions) {\n  return dispatch => {\n    dispatch(createDatasourceStarted());\n    return SupersetClient.post({\n      endpoint: '/api/v1/dataset/get_or_create/',\n      jsonPayload: vizOptions,\n    })\n      .then(({ json }) => {\n        dispatch(createDatasourceSuccess(json.result));\n\n        return json.result;\n      })\n      .catch(() => {\n        const errorMsg = t('An error occurred while creating the data source');\n        dispatch(createDatasourceFailed(errorMsg));\n        return Promise.reject(new Error(errorMsg));\n      });\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}