{"ast":null,"code":"import _isEmpty from \"lodash/isEmpty\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useMemo, useState } from 'react';\nimport { css, ensureIsArray, fetchTimeRange, getTimeOffset, styled, t, useTheme } from '@superset-ui/core';\nimport { Tooltip } from '@superset-ui/chart-controls';\n\nimport { ColorSchemeEnum } from './types';\nimport { useOverflowDetection } from './useOverflowDetection';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst NumbersContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  width: 100%;\n  overflow: auto;\n`;\nconst ComparisonValue = styled.div`\n  ${({ theme, subheaderFontSize }) => `\n    font-weight: ${theme.typography.weights.light};\n    display: flex;\n    justify-content: center;\n    font-size: ${subheaderFontSize || 20}px;\n    flex: 1 1 0px;\n  `}\n`;\nconst SymbolWrapper = styled.span`\n  ${({ theme, backgroundColor, textColor }) => `\n    background-color: ${backgroundColor};\n    color: ${textColor};\n    padding: ${theme.gridUnit}px ${theme.gridUnit * 2}px;\n    border-radius: ${theme.gridUnit * 2}px;\n    margin-right: ${theme.gridUnit}px;\n  `}\n`;\nexport default function PopKPI(props) {\n  const { height, width, bigNumber, prevNumber, valueDifference, percentDifferenceFormattedString, headerFontSize, subheaderFontSize, comparisonColorEnabled, comparisonColorScheme, percentDifferenceNumber, currentTimeRangeFilter, startDateOffset, shift, dashboardTimeRange } = props;\n  const [comparisonRange, setComparisonRange] = useState('');\n  useEffect(() => {\n    if (!currentTimeRangeFilter || !shift && !startDateOffset) {\n      setComparisonRange('');\n    } else\n    if (!_isEmpty(shift) || startDateOffset) {\n      const newShift = getTimeOffset({\n        timeRangeFilter: {\n          ...currentTimeRangeFilter,\n          comparator: dashboardTimeRange != null ? dashboardTimeRange : currentTimeRangeFilter.comparator\n        },\n        shifts: ensureIsArray(shift),\n        startDate: startDateOffset || ''\n      });\n      const promise = fetchTimeRange(dashboardTimeRange != null ? dashboardTimeRange : currentTimeRangeFilter.comparator, currentTimeRangeFilter.subject, newShift || []);\n      Promise.resolve(promise).then((res) => {\n        const response = ensureIsArray(res.value);\n        const firstRange = response.flat()[0];\n        const rangeText = firstRange.split('vs\\n');\n        setComparisonRange(rangeText.length > 1 ? rangeText[1].trim() : rangeText[0]);\n      });\n    }\n  }, [currentTimeRangeFilter, shift, startDateOffset, dashboardTimeRange]);\n  const theme = useTheme();\n  const flexGap = theme.gridUnit * 5;\n  const wrapperDivStyles = css`\n    font-family: ${theme.typography.families.sansSerif};\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: ${height}px;\n    width: ${width}px;\n    overflow: auto;\n  `;\n  const bigValueContainerStyles = css`\n    font-size: ${headerFontSize || 60}px;\n    font-weight: ${theme.typography.weights.normal};\n    text-align: center;\n    margin-bottom: ${theme.gridUnit * 4}px;\n  `;\n  const getArrowIndicatorColor = () => {\n    if (!comparisonColorEnabled || percentDifferenceNumber === 0) {\n      return theme.colors.grayscale.base;\n    }\n    if (percentDifferenceNumber > 0) {\n      // Positive difference\n      return comparisonColorScheme === ColorSchemeEnum.Green ?\n      theme.colors.success.base :\n      theme.colors.error.base;\n    }\n    // Negative difference\n    return comparisonColorScheme === ColorSchemeEnum.Red ?\n    theme.colors.success.base :\n    theme.colors.error.base;\n  };\n  const arrowIndicatorStyle = css`\n    color: ${getArrowIndicatorColor()};\n    margin-left: ${theme.gridUnit}px;\n  `;\n  const defaultBackgroundColor = theme.colors.grayscale.light4;\n  const defaultTextColor = theme.colors.grayscale.base;\n  const { backgroundColor, textColor } = useMemo(() => {\n    let bgColor = defaultBackgroundColor;\n    let txtColor = defaultTextColor;\n    if (comparisonColorEnabled && percentDifferenceNumber !== 0) {\n      const useSuccess = percentDifferenceNumber > 0 &&\n      comparisonColorScheme === ColorSchemeEnum.Green ||\n      percentDifferenceNumber < 0 &&\n      comparisonColorScheme === ColorSchemeEnum.Red;\n      // Set background and text colors based on the conditions\n      bgColor = useSuccess ?\n      theme.colors.success.light2 :\n      theme.colors.error.light2;\n      txtColor = useSuccess ?\n      theme.colors.success.base :\n      theme.colors.error.base;\n    }\n    return {\n      backgroundColor: bgColor,\n      textColor: txtColor\n    };\n  }, [\n  theme,\n  comparisonColorScheme,\n  comparisonColorEnabled,\n  percentDifferenceNumber]\n  );\n  const SYMBOLS_WITH_VALUES = useMemo(() => [\n  {\n    symbol: '#',\n    value: prevNumber,\n    tooltipText: t('Data for %s', comparisonRange || 'previous range')\n  },\n  {\n    symbol: '△',\n    value: valueDifference,\n    tooltipText: t('Value difference between the time periods')\n  },\n  {\n    symbol: '%',\n    value: percentDifferenceFormattedString,\n    tooltipText: t('Percentage difference between the time periods')\n  }],\n  [\n  comparisonRange,\n  prevNumber,\n  valueDifference,\n  percentDifferenceFormattedString]\n  );\n  const { isOverflowing, symbolContainerRef, wrapperRef } = useOverflowDetection(flexGap);\n  return _jsx(\"div\", { css: wrapperDivStyles, ref: wrapperRef, children:\n    _jsxs(NumbersContainer, { css: isOverflowing &&\n      css`\n            width: fit-content;\n            margin: auto;\n            align-items: flex-start;\n          `, children: [\n      _jsxs(\"div\", { css: bigValueContainerStyles, children: [\n        bigNumber,\n        percentDifferenceNumber !== 0 && _jsx(\"span\", { css: arrowIndicatorStyle, children:\n          percentDifferenceNumber > 0 ? '↑' : '↓' }\n        )] }\n      ),\n\n      _jsx(\"div\", { css: [\n        css`\n              display: flex;\n              justify-content: space-around;\n              gap: ${flexGap}px;\n              min-width: 0;\n              flex-shrink: 1;\n            `,\n        isOverflowing ?\n        css`\n                  flex-direction: column;\n                  align-items: flex-start;\n                  width: fit-content;\n                ` :\n        css`\n                  align-items: center;\n                  width: 100%;\n                `, process.env.NODE_ENV === \"production\" ? \"\" : \";label:PopKPI;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvcGx1Z2lucy9wbHVnaW4tY2hhcnQtZWNoYXJ0cy9zcmMvQmlnTnVtYmVyL0JpZ051bWJlclBlcmlvZE92ZXJQZXJpb2QvUG9wS1BJLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFnTGEiLCJmaWxlIjoiL2FwcC9zdXBlcnNldC1mcm9udGVuZC9wbHVnaW5zL3BsdWdpbi1jaGFydC1lY2hhcnRzL3NyYy9CaWdOdW1iZXIvQmlnTnVtYmVyUGVyaW9kT3ZlclBlcmlvZC9Qb3BLUEkudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGNzcywgZW5zdXJlSXNBcnJheSwgZmV0Y2hUaW1lUmFuZ2UsIGdldFRpbWVPZmZzZXQsIHN0eWxlZCwgdCwgdXNlVGhlbWUsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJ0BzdXBlcnNldC11aS9jaGFydC1jb250cm9scyc7XG5pbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IENvbG9yU2NoZW1lRW51bSwgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IHVzZU92ZXJmbG93RGV0ZWN0aW9uIH0gZnJvbSAnLi91c2VPdmVyZmxvd0RldGVjdGlvbic7XG5jb25zdCBOdW1iZXJzQ29udGFpbmVyID0gc3R5bGVkLmRpdiBgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICB3aWR0aDogMTAwJTtcbiAgb3ZlcmZsb3c6IGF1dG87XG5gO1xuY29uc3QgQ29tcGFyaXNvblZhbHVlID0gc3R5bGVkLmRpdiBgXG4gICR7KHsgdGhlbWUsIHN1YmhlYWRlckZvbnRTaXplIH0pID0+IGBcbiAgICBmb250LXdlaWdodDogJHt0aGVtZS50eXBvZ3JhcGh5LndlaWdodHMubGlnaHR9O1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgZm9udC1zaXplOiAke3N1YmhlYWRlckZvbnRTaXplIHx8IDIwfXB4O1xuICAgIGZsZXg6IDEgMSAwcHg7XG4gIGB9XG5gO1xuY29uc3QgU3ltYm9sV3JhcHBlciA9IHN0eWxlZC5zcGFuIGBcbiAgJHsoeyB0aGVtZSwgYmFja2dyb3VuZENvbG9yLCB0ZXh0Q29sb3IgfSkgPT4gYFxuICAgIGJhY2tncm91bmQtY29sb3I6ICR7YmFja2dyb3VuZENvbG9yfTtcbiAgICBjb2xvcjogJHt0ZXh0Q29sb3J9O1xuICAgIHBhZGRpbmc6ICR7dGhlbWUuZ3JpZFVuaXR9cHggJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gICAgYm9yZGVyLXJhZGl1czogJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gICAgbWFyZ2luLXJpZ2h0OiAke3RoZW1lLmdyaWRVbml0fXB4O1xuICBgfVxuYDtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFBvcEtQSShwcm9wcykge1xuICAgIGNvbnN0IHsgaGVpZ2h0LCB3aWR0aCwgYmlnTnVtYmVyLCBwcmV2TnVtYmVyLCB2YWx1ZURpZmZlcmVuY2UsIHBlcmNlbnREaWZmZXJlbmNlRm9ybWF0dGVkU3RyaW5nLCBoZWFkZXJGb250U2l6ZSwgc3ViaGVhZGVyRm9udFNpemUsIGNvbXBhcmlzb25Db2xvckVuYWJsZWQsIGNvbXBhcmlzb25Db2xvclNjaGVtZSwgcGVyY2VudERpZmZlcmVuY2VOdW1iZXIsIGN1cnJlbnRUaW1lUmFuZ2VGaWx0ZXIsIHN0YXJ0RGF0ZU9mZnNldCwgc2hpZnQsIGRhc2hib2FyZFRpbWVSYW5nZSwgfSA9IHByb3BzO1xuICAgIGNvbnN0IFtjb21wYXJpc29uUmFuZ2UsIHNldENvbXBhcmlzb25SYW5nZV0gPSB1c2VTdGF0ZSgnJyk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFjdXJyZW50VGltZVJhbmdlRmlsdGVyIHx8ICghc2hpZnQgJiYgIXN0YXJ0RGF0ZU9mZnNldCkpIHtcbiAgICAgICAgICAgIHNldENvbXBhcmlzb25SYW5nZSgnJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWlzRW1wdHkoc2hpZnQpIHx8IHN0YXJ0RGF0ZU9mZnNldCkge1xuICAgICAgICAgICAgY29uc3QgbmV3U2hpZnQgPSBnZXRUaW1lT2Zmc2V0KHtcbiAgICAgICAgICAgICAgICB0aW1lUmFuZ2VGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4uY3VycmVudFRpbWVSYW5nZUZpbHRlcixcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyYXRvcjogZGFzaGJvYXJkVGltZVJhbmdlID8/IGN1cnJlbnRUaW1lUmFuZ2VGaWx0ZXIuY29tcGFyYXRvcixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNoaWZ0czogZW5zdXJlSXNBcnJheShzaGlmdCksXG4gICAgICAgICAgICAgICAgc3RhcnREYXRlOiBzdGFydERhdGVPZmZzZXQgfHwgJycsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHByb21pc2UgPSBmZXRjaFRpbWVSYW5nZShkYXNoYm9hcmRUaW1lUmFuZ2UgPz8gY3VycmVudFRpbWVSYW5nZUZpbHRlci5jb21wYXJhdG9yLCBjdXJyZW50VGltZVJhbmdlRmlsdGVyLnN1YmplY3QsIG5ld1NoaWZ0IHx8IFtdKTtcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZShwcm9taXNlKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGVuc3VyZUlzQXJyYXkocmVzLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaXJzdFJhbmdlID0gcmVzcG9uc2UuZmxhdCgpWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlVGV4dCA9IGZpcnN0UmFuZ2Uuc3BsaXQoJ3ZzXFxuJyk7XG4gICAgICAgICAgICAgICAgc2V0Q29tcGFyaXNvblJhbmdlKHJhbmdlVGV4dC5sZW5ndGggPiAxID8gcmFuZ2VUZXh0WzFdLnRyaW0oKSA6IHJhbmdlVGV4dFswXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIFtjdXJyZW50VGltZVJhbmdlRmlsdGVyLCBzaGlmdCwgc3RhcnREYXRlT2Zmc2V0LCBkYXNoYm9hcmRUaW1lUmFuZ2VdKTtcbiAgICBjb25zdCB0aGVtZSA9IHVzZVRoZW1lKCk7XG4gICAgY29uc3QgZmxleEdhcCA9IHRoZW1lLmdyaWRVbml0ICogNTtcbiAgICBjb25zdCB3cmFwcGVyRGl2U3R5bGVzID0gY3NzIGBcbiAgICBmb250LWZhbWlseTogJHt0aGVtZS50eXBvZ3JhcGh5LmZhbWlsaWVzLnNhbnNTZXJpZn07XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGhlaWdodDogJHtoZWlnaHR9cHg7XG4gICAgd2lkdGg6ICR7d2lkdGh9cHg7XG4gICAgb3ZlcmZsb3c6IGF1dG87XG4gIGA7XG4gICAgY29uc3QgYmlnVmFsdWVDb250YWluZXJTdHlsZXMgPSBjc3MgYFxuICAgIGZvbnQtc2l6ZTogJHtoZWFkZXJGb250U2l6ZSB8fCA2MH1weDtcbiAgICBmb250LXdlaWdodDogJHt0aGVtZS50eXBvZ3JhcGh5LndlaWdodHMubm9ybWFsfTtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgbWFyZ2luLWJvdHRvbTogJHt0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gIGA7XG4gICAgY29uc3QgZ2V0QXJyb3dJbmRpY2F0b3JDb2xvciA9ICgpID0+IHtcbiAgICAgICAgaWYgKCFjb21wYXJpc29uQ29sb3JFbmFibGVkIHx8IHBlcmNlbnREaWZmZXJlbmNlTnVtYmVyID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwZXJjZW50RGlmZmVyZW5jZU51bWJlciA+IDApIHtcbiAgICAgICAgICAgIC8vIFBvc2l0aXZlIGRpZmZlcmVuY2VcbiAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uQ29sb3JTY2hlbWUgPT09IENvbG9yU2NoZW1lRW51bS5HcmVlblxuICAgICAgICAgICAgICAgID8gdGhlbWUuY29sb3JzLnN1Y2Nlc3MuYmFzZVxuICAgICAgICAgICAgICAgIDogdGhlbWUuY29sb3JzLmVycm9yLmJhc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTmVnYXRpdmUgZGlmZmVyZW5jZVxuICAgICAgICByZXR1cm4gY29tcGFyaXNvbkNvbG9yU2NoZW1lID09PSBDb2xvclNjaGVtZUVudW0uUmVkXG4gICAgICAgICAgICA/IHRoZW1lLmNvbG9ycy5zdWNjZXNzLmJhc2VcbiAgICAgICAgICAgIDogdGhlbWUuY29sb3JzLmVycm9yLmJhc2U7XG4gICAgfTtcbiAgICBjb25zdCBhcnJvd0luZGljYXRvclN0eWxlID0gY3NzIGBcbiAgICBjb2xvcjogJHtnZXRBcnJvd0luZGljYXRvckNvbG9yKCl9O1xuICAgIG1hcmdpbi1sZWZ0OiAke3RoZW1lLmdyaWRVbml0fXB4O1xuICBgO1xuICAgIGNvbnN0IGRlZmF1bHRCYWNrZ3JvdW5kQ29sb3IgPSB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0NDtcbiAgICBjb25zdCBkZWZhdWx0VGV4dENvbG9yID0gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlO1xuICAgIGNvbnN0IHsgYmFja2dyb3VuZENvbG9yLCB0ZXh0Q29sb3IgfSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBsZXQgYmdDb2xvciA9IGRlZmF1bHRCYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIGxldCB0eHRDb2xvciA9IGRlZmF1bHRUZXh0Q29sb3I7XG4gICAgICAgIGlmIChjb21wYXJpc29uQ29sb3JFbmFibGVkICYmIHBlcmNlbnREaWZmZXJlbmNlTnVtYmVyICE9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCB1c2VTdWNjZXNzID0gKHBlcmNlbnREaWZmZXJlbmNlTnVtYmVyID4gMCAmJlxuICAgICAgICAgICAgICAgIGNvbXBhcmlzb25Db2xvclNjaGVtZSA9PT0gQ29sb3JTY2hlbWVFbnVtLkdyZWVuKSB8fFxuICAgICAgICAgICAgICAgIChwZXJjZW50RGlmZmVyZW5jZU51bWJlciA8IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyaXNvbkNvbG9yU2NoZW1lID09PSBDb2xvclNjaGVtZUVudW0uUmVkKTtcbiAgICAgICAgICAgIC8vIFNldCBiYWNrZ3JvdW5kIGFuZCB0ZXh0IGNvbG9ycyBiYXNlZCBvbiB0aGUgY29uZGl0aW9uc1xuICAgICAgICAgICAgYmdDb2xvciA9IHVzZVN1Y2Nlc3NcbiAgICAgICAgICAgICAgICA/IHRoZW1lLmNvbG9ycy5zdWNjZXNzLmxpZ2h0MlxuICAgICAgICAgICAgICAgIDogdGhlbWUuY29sb3JzLmVycm9yLmxpZ2h0MjtcbiAgICAgICAgICAgIHR4dENvbG9yID0gdXNlU3VjY2Vzc1xuICAgICAgICAgICAgICAgID8gdGhlbWUuY29sb3JzLnN1Y2Nlc3MuYmFzZVxuICAgICAgICAgICAgICAgIDogdGhlbWUuY29sb3JzLmVycm9yLmJhc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogYmdDb2xvcixcbiAgICAgICAgICAgIHRleHRDb2xvcjogdHh0Q29sb3IsXG4gICAgICAgIH07XG4gICAgfSwgW1xuICAgICAgICB0aGVtZSxcbiAgICAgICAgY29tcGFyaXNvbkNvbG9yU2NoZW1lLFxuICAgICAgICBjb21wYXJpc29uQ29sb3JFbmFibGVkLFxuICAgICAgICBwZXJjZW50RGlmZmVyZW5jZU51bWJlcixcbiAgICBdKTtcbiAgICBjb25zdCBTWU1CT0xTX1dJVEhfVkFMVUVTID0gdXNlTWVtbygoKSA9PiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN5bWJvbDogJyMnLFxuICAgICAgICAgICAgdmFsdWU6IHByZXZOdW1iZXIsXG4gICAgICAgICAgICB0b29sdGlwVGV4dDogdCgnRGF0YSBmb3IgJXMnLCBjb21wYXJpc29uUmFuZ2UgfHwgJ3ByZXZpb3VzIHJhbmdlJyksXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN5bWJvbDogJ+KWsycsXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWVEaWZmZXJlbmNlLFxuICAgICAgICAgICAgdG9vbHRpcFRleHQ6IHQoJ1ZhbHVlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgdGltZSBwZXJpb2RzJyksXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN5bWJvbDogJyUnLFxuICAgICAgICAgICAgdmFsdWU6IHBlcmNlbnREaWZmZXJlbmNlRm9ybWF0dGVkU3RyaW5nLFxuICAgICAgICAgICAgdG9vbHRpcFRleHQ6IHQoJ1BlcmNlbnRhZ2UgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSB0aW1lIHBlcmlvZHMnKSxcbiAgICAgICAgfSxcbiAgICBdLCBbXG4gICAgICAgIGNvbXBhcmlzb25SYW5nZSxcbiAgICAgICAgcHJldk51bWJlcixcbiAgICAgICAgdmFsdWVEaWZmZXJlbmNlLFxuICAgICAgICBwZXJjZW50RGlmZmVyZW5jZUZvcm1hdHRlZFN0cmluZyxcbiAgICBdKTtcbiAgICBjb25zdCB7IGlzT3ZlcmZsb3dpbmcsIHN5bWJvbENvbnRhaW5lclJlZiwgd3JhcHBlclJlZiB9ID0gdXNlT3ZlcmZsb3dEZXRlY3Rpb24oZmxleEdhcCk7XG4gICAgcmV0dXJuICg8ZGl2IGNzcz17d3JhcHBlckRpdlN0eWxlc30gcmVmPXt3cmFwcGVyUmVmfT5cbiAgICAgIDxOdW1iZXJzQ29udGFpbmVyIGNzcz17aXNPdmVyZmxvd2luZyAmJlxuICAgICAgICAgICAgY3NzIGBcbiAgICAgICAgICAgIHdpZHRoOiBmaXQtY29udGVudDtcbiAgICAgICAgICAgIG1hcmdpbjogYXV0bztcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xuICAgICAgICAgIGB9PlxuICAgICAgICA8ZGl2IGNzcz17YmlnVmFsdWVDb250YWluZXJTdHlsZXN9PlxuICAgICAgICAgIHtiaWdOdW1iZXJ9XG4gICAgICAgICAge3BlcmNlbnREaWZmZXJlbmNlTnVtYmVyICE9PSAwICYmICg8c3BhbiBjc3M9e2Fycm93SW5kaWNhdG9yU3R5bGV9PlxuICAgICAgICAgICAgICB7cGVyY2VudERpZmZlcmVuY2VOdW1iZXIgPiAwID8gJ+KGkScgOiAn4oaTJ31cbiAgICAgICAgICAgIDwvc3Bhbj4pfVxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IGNzcz17W1xuICAgICAgICAgICAgY3NzIGBcbiAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4gICAgICAgICAgICAgIGdhcDogJHtmbGV4R2FwfXB4O1xuICAgICAgICAgICAgICBtaW4td2lkdGg6IDA7XG4gICAgICAgICAgICAgIGZsZXgtc2hyaW5rOiAxO1xuICAgICAgICAgICAgYCxcbiAgICAgICAgICAgIGlzT3ZlcmZsb3dpbmdcbiAgICAgICAgICAgICAgICA/IGNzcyBgXG4gICAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XG4gICAgICAgICAgICAgICAgICB3aWR0aDogZml0LWNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgYFxuICAgICAgICAgICAgICAgIDogY3NzIGBcbiAgICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBgLFxuICAgICAgICBdfSByZWY9e3N5bWJvbENvbnRhaW5lclJlZn0+XG4gICAgICAgICAge1NZTUJPTFNfV0lUSF9WQUxVRVMubWFwKChzeW1ib2xfd2l0aF92YWx1ZSwgaW5kZXgpID0+ICg8Q29tcGFyaXNvblZhbHVlIGtleT17YGNvbXBhcmlzb24tc3ltYm9sLSR7c3ltYm9sX3dpdGhfdmFsdWUuc3ltYm9sfWB9IHN1YmhlYWRlckZvbnRTaXplPXtzdWJoZWFkZXJGb250U2l6ZX0+XG4gICAgICAgICAgICAgIDxUb29sdGlwIGlkPVwidG9vbHRpcFwiIHBsYWNlbWVudD1cInRvcFwiIHRpdGxlPXtzeW1ib2xfd2l0aF92YWx1ZS50b29sdGlwVGV4dH0+XG4gICAgICAgICAgICAgICAgPFN5bWJvbFdyYXBwZXIgYmFja2dyb3VuZENvbG9yPXtpbmRleCA+IDAgPyBiYWNrZ3JvdW5kQ29sb3IgOiBkZWZhdWx0QmFja2dyb3VuZENvbG9yfSB0ZXh0Q29sb3I9e2luZGV4ID4gMCA/IHRleHRDb2xvciA6IGRlZmF1bHRUZXh0Q29sb3J9PlxuICAgICAgICAgICAgICAgICAge3N5bWJvbF93aXRoX3ZhbHVlLnN5bWJvbH1cbiAgICAgICAgICAgICAgICA8L1N5bWJvbFdyYXBwZXI+XG4gICAgICAgICAgICAgICAge3N5bWJvbF93aXRoX3ZhbHVlLnZhbHVlfVxuICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICA8L0NvbXBhcmlzb25WYWx1ZT4pKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L051bWJlcnNDb250YWluZXI+XG4gICAgPC9kaXY+KTtcbn1cbiJdfQ== */\"],\n        ref: symbolContainerRef, children:\n        SYMBOLS_WITH_VALUES.map((symbol_with_value, index) => _jsx(ComparisonValue, { subheaderFontSize: subheaderFontSize, children:\n          _jsxs(Tooltip, { id: \"tooltip\", placement: \"top\", title: symbol_with_value.tooltipText, children: [\n            _jsx(SymbolWrapper, { backgroundColor: index > 0 ? backgroundColor : defaultBackgroundColor, textColor: index > 0 ? textColor : defaultTextColor, children:\n              symbol_with_value.symbol }\n            ),\n            symbol_with_value.value] }\n          ) }, `comparison-symbol-${symbol_with_value.symbol}`\n        )) }\n      )] }\n    ) }\n  );\n}__signature__(PopKPI, \"useState{[comparisonRange, setComparisonRange]('')}\\nuseEffect{}\\nuseTheme{theme}\\nuseMemo{{ backgroundColor, textColor }}\\nuseMemo{SYMBOLS_WITH_VALUES}\\nuseOverflowDetection{{ isOverflowing, symbolContainerRef, wrapperRef }}\", () => [useTheme, useOverflowDetection]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(NumbersContainer, \"NumbersContainer\", \"/app/superset-frontend/plugins/plugin-chart-echarts/src/BigNumber/BigNumberPeriodOverPeriod/PopKPI.tsx\");reactHotLoader.register(ComparisonValue, \"ComparisonValue\", \"/app/superset-frontend/plugins/plugin-chart-echarts/src/BigNumber/BigNumberPeriodOverPeriod/PopKPI.tsx\");reactHotLoader.register(SymbolWrapper, \"SymbolWrapper\", \"/app/superset-frontend/plugins/plugin-chart-echarts/src/BigNumber/BigNumberPeriodOverPeriod/PopKPI.tsx\");reactHotLoader.register(PopKPI, \"PopKPI\", \"/app/superset-frontend/plugins/plugin-chart-echarts/src/BigNumber/BigNumberPeriodOverPeriod/PopKPI.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useEffect","useMemo","useState","css","ensureIsArray","fetchTimeRange","getTimeOffset","styled","t","useTheme","Tooltip","ColorSchemeEnum","useOverflowDetection","jsx","_jsx","jsxs","_jsxs","NumbersContainer","div","ComparisonValue","theme","subheaderFontSize","typography","weights","light","SymbolWrapper","span","backgroundColor","textColor","gridUnit","PopKPI","props","height","width","bigNumber","prevNumber","valueDifference","percentDifferenceFormattedString","headerFontSize","comparisonColorEnabled","comparisonColorScheme","percentDifferenceNumber","currentTimeRangeFilter","startDateOffset","shift","dashboardTimeRange","comparisonRange","setComparisonRange","_isEmpty","newShift","timeRangeFilter","comparator","shifts","startDate","promise","subject","Promise","resolve","then","res","response","value","firstRange","flat","rangeText","split","length","trim","flexGap","wrapperDivStyles","families","sansSerif","bigValueContainerStyles","normal","getArrowIndicatorColor","colors","grayscale","base","Green","success","error","Red","arrowIndicatorStyle","defaultBackgroundColor","light4","defaultTextColor","bgColor","txtColor","useSuccess","light2","SYMBOLS_WITH_VALUES","symbol","tooltipText","isOverflowing","symbolContainerRef","wrapperRef","ref","children","process","env","NODE_ENV","map","symbol_with_value","index","id","placement","title","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/plugins/plugin-chart-echarts/src/BigNumber/BigNumberPeriodOverPeriod/PopKPI.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useMemo, useState } from 'react';\nimport {\n  css,\n  ensureIsArray,\n  fetchTimeRange,\n  getTimeOffset,\n  styled,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { Tooltip } from '@superset-ui/chart-controls';\nimport { isEmpty } from 'lodash';\nimport {\n  ColorSchemeEnum,\n  PopKPIComparisonSymbolStyleProps,\n  PopKPIComparisonValueStyleProps,\n  PopKPIProps,\n} from './types';\nimport { useOverflowDetection } from './useOverflowDetection';\n\nconst NumbersContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  width: 100%;\n  overflow: auto;\n`;\n\nconst ComparisonValue = styled.div<PopKPIComparisonValueStyleProps>`\n  ${({ theme, subheaderFontSize }) => `\n    font-weight: ${theme.typography.weights.light};\n    display: flex;\n    justify-content: center;\n    font-size: ${subheaderFontSize || 20}px;\n    flex: 1 1 0px;\n  `}\n`;\n\nconst SymbolWrapper = styled.span<PopKPIComparisonSymbolStyleProps>`\n  ${({ theme, backgroundColor, textColor }) => `\n    background-color: ${backgroundColor};\n    color: ${textColor};\n    padding: ${theme.gridUnit}px ${theme.gridUnit * 2}px;\n    border-radius: ${theme.gridUnit * 2}px;\n    margin-right: ${theme.gridUnit}px;\n  `}\n`;\n\nexport default function PopKPI(props: PopKPIProps) {\n  const {\n    height,\n    width,\n    bigNumber,\n    prevNumber,\n    valueDifference,\n    percentDifferenceFormattedString,\n    headerFontSize,\n    subheaderFontSize,\n    comparisonColorEnabled,\n    comparisonColorScheme,\n    percentDifferenceNumber,\n    currentTimeRangeFilter,\n    startDateOffset,\n    shift,\n    dashboardTimeRange,\n  } = props;\n\n  const [comparisonRange, setComparisonRange] = useState<string>('');\n\n  useEffect(() => {\n    if (!currentTimeRangeFilter || (!shift && !startDateOffset)) {\n      setComparisonRange('');\n    } else if (!isEmpty(shift) || startDateOffset) {\n      const newShift = getTimeOffset({\n        timeRangeFilter: {\n          ...currentTimeRangeFilter,\n          comparator:\n            dashboardTimeRange ?? (currentTimeRangeFilter as any).comparator,\n        },\n        shifts: ensureIsArray(shift),\n        startDate: startDateOffset || '',\n      });\n      const promise: any = fetchTimeRange(\n        dashboardTimeRange ?? (currentTimeRangeFilter as any).comparator,\n        currentTimeRangeFilter.subject,\n        newShift || [],\n      );\n      Promise.resolve(promise).then((res: any) => {\n        const response: string[] = ensureIsArray(res.value);\n        const firstRange: string = response.flat()[0];\n        const rangeText = firstRange.split('vs\\n');\n        setComparisonRange(\n          rangeText.length > 1 ? rangeText[1].trim() : rangeText[0],\n        );\n      });\n    }\n  }, [currentTimeRangeFilter, shift, startDateOffset, dashboardTimeRange]);\n\n  const theme = useTheme();\n  const flexGap = theme.gridUnit * 5;\n  const wrapperDivStyles = css`\n    font-family: ${theme.typography.families.sansSerif};\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: ${height}px;\n    width: ${width}px;\n    overflow: auto;\n  `;\n\n  const bigValueContainerStyles = css`\n    font-size: ${headerFontSize || 60}px;\n    font-weight: ${theme.typography.weights.normal};\n    text-align: center;\n    margin-bottom: ${theme.gridUnit * 4}px;\n  `;\n\n  const getArrowIndicatorColor = () => {\n    if (!comparisonColorEnabled || percentDifferenceNumber === 0) {\n      return theme.colors.grayscale.base;\n    }\n\n    if (percentDifferenceNumber > 0) {\n      // Positive difference\n      return comparisonColorScheme === ColorSchemeEnum.Green\n        ? theme.colors.success.base\n        : theme.colors.error.base;\n    }\n    // Negative difference\n    return comparisonColorScheme === ColorSchemeEnum.Red\n      ? theme.colors.success.base\n      : theme.colors.error.base;\n  };\n\n  const arrowIndicatorStyle = css`\n    color: ${getArrowIndicatorColor()};\n    margin-left: ${theme.gridUnit}px;\n  `;\n\n  const defaultBackgroundColor = theme.colors.grayscale.light4;\n  const defaultTextColor = theme.colors.grayscale.base;\n  const { backgroundColor, textColor } = useMemo(() => {\n    let bgColor = defaultBackgroundColor;\n    let txtColor = defaultTextColor;\n    if (comparisonColorEnabled && percentDifferenceNumber !== 0) {\n      const useSuccess =\n        (percentDifferenceNumber > 0 &&\n          comparisonColorScheme === ColorSchemeEnum.Green) ||\n        (percentDifferenceNumber < 0 &&\n          comparisonColorScheme === ColorSchemeEnum.Red);\n\n      // Set background and text colors based on the conditions\n      bgColor = useSuccess\n        ? theme.colors.success.light2\n        : theme.colors.error.light2;\n      txtColor = useSuccess\n        ? theme.colors.success.base\n        : theme.colors.error.base;\n    }\n\n    return {\n      backgroundColor: bgColor,\n      textColor: txtColor,\n    };\n  }, [\n    theme,\n    comparisonColorScheme,\n    comparisonColorEnabled,\n    percentDifferenceNumber,\n  ]);\n\n  const SYMBOLS_WITH_VALUES = useMemo(\n    () => [\n      {\n        symbol: '#',\n        value: prevNumber,\n        tooltipText: t('Data for %s', comparisonRange || 'previous range'),\n      },\n      {\n        symbol: '△',\n        value: valueDifference,\n        tooltipText: t('Value difference between the time periods'),\n      },\n      {\n        symbol: '%',\n        value: percentDifferenceFormattedString,\n        tooltipText: t('Percentage difference between the time periods'),\n      },\n    ],\n    [\n      comparisonRange,\n      prevNumber,\n      valueDifference,\n      percentDifferenceFormattedString,\n    ],\n  );\n\n  const { isOverflowing, symbolContainerRef, wrapperRef } =\n    useOverflowDetection(flexGap);\n\n  return (\n    <div css={wrapperDivStyles} ref={wrapperRef}>\n      <NumbersContainer\n        css={\n          isOverflowing &&\n          css`\n            width: fit-content;\n            margin: auto;\n            align-items: flex-start;\n          `\n        }\n      >\n        <div css={bigValueContainerStyles}>\n          {bigNumber}\n          {percentDifferenceNumber !== 0 && (\n            <span css={arrowIndicatorStyle}>\n              {percentDifferenceNumber > 0 ? '↑' : '↓'}\n            </span>\n          )}\n        </div>\n\n        <div\n          css={[\n            css`\n              display: flex;\n              justify-content: space-around;\n              gap: ${flexGap}px;\n              min-width: 0;\n              flex-shrink: 1;\n            `,\n            isOverflowing\n              ? css`\n                  flex-direction: column;\n                  align-items: flex-start;\n                  width: fit-content;\n                `\n              : css`\n                  align-items: center;\n                  width: 100%;\n                `,\n          ]}\n          ref={symbolContainerRef}\n        >\n          {SYMBOLS_WITH_VALUES.map((symbol_with_value, index) => (\n            <ComparisonValue\n              key={`comparison-symbol-${symbol_with_value.symbol}`}\n              subheaderFontSize={subheaderFontSize}\n            >\n              <Tooltip\n                id=\"tooltip\"\n                placement=\"top\"\n                title={symbol_with_value.tooltipText}\n              >\n                <SymbolWrapper\n                  backgroundColor={\n                    index > 0 ? backgroundColor : defaultBackgroundColor\n                  }\n                  textColor={index > 0 ? textColor : defaultTextColor}\n                >\n                  {symbol_with_value.symbol}\n                </SymbolWrapper>\n                {symbol_with_value.value}\n              </Tooltip>\n            </ComparisonValue>\n          ))}\n        </div>\n      </NumbersContainer>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}