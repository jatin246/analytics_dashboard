{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { List } from 'src/components';\nimport { nanoid } from 'nanoid';\nimport { t, withTheme } from '@superset-ui/core';\nimport {\n  SortableContainer,\n  SortableHandle,\n  SortableElement,\n  arrayMove } from\n'react-sortable-hoc';\nimport Icons from 'src/components/Icons';\nimport {\n  HeaderContainer,\n  AddIconButton } from\n'src/explore/components/controls/OptionControls';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport ControlHeader from 'src/explore/components/ControlHeader';\nimport CustomListItem from 'src/explore/components/controls/CustomListItem';\nimport controlMap from '..';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\n\nconst propTypes = {\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  description: PropTypes.string,\n  placeholder: PropTypes.string,\n  addTooltip: PropTypes.string,\n  itemGenerator: PropTypes.func,\n  keyAccessor: PropTypes.func,\n  onChange: PropTypes.func,\n  value: PropTypes.oneOfType([PropTypes.array]),\n  isFloat: PropTypes.bool,\n  isInt: PropTypes.bool,\n  controlName: PropTypes.string.isRequired\n};\n\nconst defaultProps = {\n  label: null,\n  description: null,\n  onChange: () => {},\n  placeholder: t('Empty collection'),\n  itemGenerator: () => ({ key: nanoid(11) }),\n  keyAccessor: (o) => o.key,\n  value: [],\n  addTooltip: t('Add an item')\n};\nconst SortableListItem = SortableElement(CustomListItem);\nconst SortableList = SortableContainer(List);\nconst SortableDragger = SortableHandle(() =>\n_jsx(\"i\", {\n  role: \"img\",\n  \"aria-label\": \"drag\",\n  className: \"fa fa-bars text-primary\",\n  style: { cursor: 'ns-resize' } }\n)\n);var _ref = process.env.NODE_ENV === \"production\" ? { name: \"11g6mpt\", styles: \"justify-content:flex-start\" } : { name: \"13cksz1-CollectionControl\", styles: \"justify-content:flex-start;label:CollectionControl;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9Db2xsZWN0aW9uQ29udHJvbC9pbmRleC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd0hjIiwiZmlsZSI6Ii9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9Db2xsZWN0aW9uQ29udHJvbC9pbmRleC5qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgTGlzdCB9IGZyb20gJ3NyYy9jb21wb25lbnRzJztcbmltcG9ydCB7IG5hbm9pZCB9IGZyb20gJ25hbm9pZCc7XG5pbXBvcnQgeyB0LCB3aXRoVGhlbWUgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQge1xuICBTb3J0YWJsZUNvbnRhaW5lcixcbiAgU29ydGFibGVIYW5kbGUsXG4gIFNvcnRhYmxlRWxlbWVudCxcbiAgYXJyYXlNb3ZlLFxufSBmcm9tICdyZWFjdC1zb3J0YWJsZS1ob2MnO1xuaW1wb3J0IEljb25zIGZyb20gJ3NyYy9jb21wb25lbnRzL0ljb25zJztcbmltcG9ydCB7XG4gIEhlYWRlckNvbnRhaW5lcixcbiAgQWRkSWNvbkJ1dHRvbixcbn0gZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9PcHRpb25Db250cm9scyc7XG5pbXBvcnQgeyBJbmZvVG9vbHRpcFdpdGhUcmlnZ2VyIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NoYXJ0LWNvbnRyb2xzJztcbmltcG9ydCBDb250cm9sSGVhZGVyIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvQ29udHJvbEhlYWRlcic7XG5pbXBvcnQgQ3VzdG9tTGlzdEl0ZW0gZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9DdXN0b21MaXN0SXRlbSc7XG5pbXBvcnQgY29udHJvbE1hcCBmcm9tICcuLic7XG5cbmNvbnN0IHByb3BUeXBlcyA9IHtcbiAgbmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICBsYWJlbDogUHJvcFR5cGVzLnN0cmluZyxcbiAgZGVzY3JpcHRpb246IFByb3BUeXBlcy5zdHJpbmcsXG4gIHBsYWNlaG9sZGVyOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBhZGRUb29sdGlwOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBpdGVtR2VuZXJhdG9yOiBQcm9wVHlwZXMuZnVuYyxcbiAga2V5QWNjZXNzb3I6IFByb3BUeXBlcy5mdW5jLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gIHZhbHVlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYXJyYXldKSxcbiAgaXNGbG9hdDogUHJvcFR5cGVzLmJvb2wsXG4gIGlzSW50OiBQcm9wVHlwZXMuYm9vbCxcbiAgY29udHJvbE5hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgbGFiZWw6IG51bGwsXG4gIGRlc2NyaXB0aW9uOiBudWxsLFxuICBvbkNoYW5nZTogKCkgPT4ge30sXG4gIHBsYWNlaG9sZGVyOiB0KCdFbXB0eSBjb2xsZWN0aW9uJyksXG4gIGl0ZW1HZW5lcmF0b3I6ICgpID0+ICh7IGtleTogbmFub2lkKDExKSB9KSxcbiAga2V5QWNjZXNzb3I6IG8gPT4gby5rZXksXG4gIHZhbHVlOiBbXSxcbiAgYWRkVG9vbHRpcDogdCgnQWRkIGFuIGl0ZW0nKSxcbn07XG5jb25zdCBTb3J0YWJsZUxpc3RJdGVtID0gU29ydGFibGVFbGVtZW50KEN1c3RvbUxpc3RJdGVtKTtcbmNvbnN0IFNvcnRhYmxlTGlzdCA9IFNvcnRhYmxlQ29udGFpbmVyKExpc3QpO1xuY29uc3QgU29ydGFibGVEcmFnZ2VyID0gU29ydGFibGVIYW5kbGUoKCkgPT4gKFxuICA8aVxuICAgIHJvbGU9XCJpbWdcIlxuICAgIGFyaWEtbGFiZWw9XCJkcmFnXCJcbiAgICBjbGFzc05hbWU9XCJmYSBmYS1iYXJzIHRleHQtcHJpbWFyeVwiXG4gICAgc3R5bGU9e3sgY3Vyc29yOiAnbnMtcmVzaXplJyB9fVxuICAvPlxuKSk7XG5cbmNsYXNzIENvbGxlY3Rpb25Db250cm9sIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5vbkFkZCA9IHRoaXMub25BZGQuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9uQ2hhbmdlKGksIHZhbHVlKSB7XG4gICAgY29uc3QgbmV3VmFsdWUgPSBbLi4udGhpcy5wcm9wcy52YWx1ZV07XG4gICAgbmV3VmFsdWVbaV0gPSB7IC4uLnRoaXMucHJvcHMudmFsdWVbaV0sIC4uLnZhbHVlIH07XG4gICAgdGhpcy5wcm9wcy5vbkNoYW5nZShuZXdWYWx1ZSk7XG4gIH1cblxuICBvbkFkZCgpIHtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHRoaXMucHJvcHMudmFsdWUuY29uY2F0KFt0aGlzLnByb3BzLml0ZW1HZW5lcmF0b3IoKV0pKTtcbiAgfVxuXG4gIG9uU29ydEVuZCh7IG9sZEluZGV4LCBuZXdJbmRleCB9KSB7XG4gICAgdGhpcy5wcm9wcy5vbkNoYW5nZShhcnJheU1vdmUodGhpcy5wcm9wcy52YWx1ZSwgb2xkSW5kZXgsIG5ld0luZGV4KSk7XG4gIH1cblxuICByZW1vdmVJdGVtKGkpIHtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHRoaXMucHJvcHMudmFsdWUuZmlsdGVyKChvLCBpeCkgPT4gaSAhPT0gaXgpKTtcbiAgfVxuXG4gIHJlbmRlckxpc3QoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMudmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LW11dGVkXCI+e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9PC9kaXY+O1xuICAgIH1cbiAgICBjb25zdCBDb250cm9sID0gY29udHJvbE1hcFt0aGlzLnByb3BzLmNvbnRyb2xOYW1lXTtcbiAgICByZXR1cm4gKFxuICAgICAgPFNvcnRhYmxlTGlzdFxuICAgICAgICB1c2VEcmFnSGFuZGxlXG4gICAgICAgIGxvY2tBeGlzPVwieVwiXG4gICAgICAgIG9uU29ydEVuZD17dGhpcy5vblNvcnRFbmQuYmluZCh0aGlzKX1cbiAgICAgICAgYm9yZGVyZWRcbiAgICAgICAgY3NzPXt0aGVtZSA9PiAoe1xuICAgICAgICAgIGJvcmRlclJhZGl1czogdGhlbWUuZ3JpZFVuaXQsXG4gICAgICAgIH0pfVxuICAgICAgPlxuICAgICAgICB7dGhpcy5wcm9wcy52YWx1ZS5tYXAoKG8sIGkpID0+IHtcbiAgICAgICAgICAvLyBsYWJlbCByZWxldmFudCBvbmx5IGZvciBoZWFkZXIsIG5vdCBoZXJlXG4gICAgICAgICAgY29uc3QgeyBsYWJlbCwgLi4uY29tbW9uUHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxTb3J0YWJsZUxpc3RJdGVtXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNsZWFyZml4XCJcbiAgICAgICAgICAgICAgY3NzPXt7IGp1c3RpZnlDb250ZW50OiAnZmxleC1zdGFydCcgfX1cbiAgICAgICAgICAgICAga2V5PXt0aGlzLnByb3BzLmtleUFjY2Vzc29yKG8pfVxuICAgICAgICAgICAgICBpbmRleD17aX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFNvcnRhYmxlRHJhZ2dlciAvPlxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgY3NzPXt0aGVtZSA9PiAoe1xuICAgICAgICAgICAgICAgICAgZmxleDogMSxcbiAgICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ6IHRoZW1lLmdyaWRVbml0ICogMixcbiAgICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiB0aGVtZS5ncmlkVW5pdCAqIDIsXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8Q29udHJvbFxuICAgICAgICAgICAgICAgICAgey4uLmNvbW1vblByb3BzfVxuICAgICAgICAgICAgICAgICAgey4uLm99XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMsIGkpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8SW5mb1Rvb2x0aXBXaXRoVHJpZ2dlclxuICAgICAgICAgICAgICAgIGljb249XCJ0aW1lc1wiXG4gICAgICAgICAgICAgICAgbGFiZWw9XCJyZW1vdmUtaXRlbVwiXG4gICAgICAgICAgICAgICAgdG9vbHRpcD17dCgnUmVtb3ZlIGl0ZW0nKX1cbiAgICAgICAgICAgICAgICBic1N0eWxlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5yZW1vdmVJdGVtLmJpbmQodGhpcywgaSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L1NvcnRhYmxlTGlzdEl0ZW0+XG4gICAgICAgICAgKTtcbiAgICAgICAgfSl9XG4gICAgICA8L1NvcnRhYmxlTGlzdD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdGhlbWUgfSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgZGF0YS10ZXN0PVwiQ29sbGVjdGlvbkNvbnRyb2xcIiBjbGFzc05hbWU9XCJDb2xsZWN0aW9uQ29udHJvbFwiPlxuICAgICAgICA8SGVhZGVyQ29udGFpbmVyPlxuICAgICAgICAgIDxDb250cm9sSGVhZGVyIHsuLi50aGlzLnByb3BzfSAvPlxuICAgICAgICAgIDxBZGRJY29uQnV0dG9uIG9uQ2xpY2s9e3RoaXMub25BZGR9PlxuICAgICAgICAgICAgPEljb25zLlBsdXNMYXJnZVxuICAgICAgICAgICAgICBpY29uU2l6ZT1cInNcIlxuICAgICAgICAgICAgICBpY29uQ29sb3I9e3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQ1fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L0FkZEljb25CdXR0b24+XG4gICAgICAgIDwvSGVhZGVyQ29udGFpbmVyPlxuICAgICAgICB7dGhpcy5yZW5kZXJMaXN0KCl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbkNvbGxlY3Rpb25Db250cm9sLnByb3BUeXBlcyA9IHByb3BUeXBlcztcbkNvbGxlY3Rpb25Db250cm9sLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcblxuZXhwb3J0IGRlZmF1bHQgd2l0aFRoZW1lKENvbGxlY3Rpb25Db250cm9sKTtcbiJdfQ== */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\n\nclass CollectionControl extends Component {\n  constructor(props) {\n    super(props);\n    this.onAdd = this.onAdd.bind(this);\n  }\n\n  onChange(i, value) {\n    const newValue = [...this.props.value];\n    newValue[i] = { ...this.props.value[i], ...value };\n    this.props.onChange(newValue);\n  }\n\n  onAdd() {\n    this.props.onChange(this.props.value.concat([this.props.itemGenerator()]));\n  }\n\n  onSortEnd({ oldIndex, newIndex }) {\n    this.props.onChange(arrayMove(this.props.value, oldIndex, newIndex));\n  }\n\n  removeItem(i) {\n    this.props.onChange(this.props.value.filter((o, ix) => i !== ix));\n  }\n\n  renderList() {\n    if (this.props.value.length === 0) {\n      return _jsx(\"div\", { className: \"text-muted\", children: this.props.placeholder });\n    }\n    const Control = controlMap[this.props.controlName];\n    return (\n      _jsx(SortableList, {\n        useDragHandle: true,\n        lockAxis: \"y\",\n        onSortEnd: this.onSortEnd.bind(this),\n        bordered: true,\n        css: (theme) => ({\n          borderRadius: theme.gridUnit\n        }), children:\n\n        this.props.value.map((o, i) => {\n          // label relevant only for header, not here\n          const { label, ...commonProps } = this.props;\n          return (\n            _jsxs(SortableListItem, {\n              className: \"clearfix\",\n              css: _ref,\n\n              index: i, children: [\n\n              _jsx(SortableDragger, {}),\n              _jsx(\"div\", {\n                css: (theme) => ({\n                  flex: 1,\n                  marginLeft: theme.gridUnit * 2,\n                  marginRight: theme.gridUnit * 2\n                }), children:\n\n                _jsx(Control, { ...\n                  commonProps, ...\n                  o,\n                  onChange: this.onChange.bind(this, i) }\n                ) }\n              ),\n              _jsx(InfoTooltipWithTrigger, {\n                icon: \"times\",\n                label: \"remove-item\",\n                tooltip: t('Remove item'),\n                bsStyle: \"primary\",\n                onClick: this.removeItem.bind(this, i) }\n              )] }, this.props.keyAccessor(o)\n            ));\n\n        }) }\n      ));\n\n  }\n\n  render() {\n    const { theme } = this.props;\n    return (\n      _jsxs(\"div\", { \"data-test\": \"CollectionControl\", className: \"CollectionControl\", children: [\n        _jsxs(HeaderContainer, { children: [\n          _jsx(ControlHeader, { ...this.props }),\n          _jsx(AddIconButton, { onClick: this.onAdd, children:\n            _jsx(Icons.PlusLarge, {\n              iconSize: \"s\",\n              iconColor: theme.colors.grayscale.light5 }\n            ) }\n          )] }\n        ),\n        this.renderList()] }\n      ));\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nCollectionControl.propTypes = propTypes;\nCollectionControl.defaultProps = defaultProps;const _default =\n\nwithTheme(CollectionControl);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx\");reactHotLoader.register(SortableListItem, \"SortableListItem\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx\");reactHotLoader.register(SortableList, \"SortableList\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx\");reactHotLoader.register(SortableDragger, \"SortableDragger\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx\");reactHotLoader.register(CollectionControl, \"CollectionControl\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["Component","PropTypes","List","nanoid","t","withTheme","SortableContainer","SortableHandle","SortableElement","arrayMove","Icons","HeaderContainer","AddIconButton","InfoTooltipWithTrigger","ControlHeader","CustomListItem","controlMap","jsx","_jsx","jsxs","_jsxs","propTypes","name","string","isRequired","label","description","placeholder","addTooltip","itemGenerator","func","keyAccessor","onChange","value","oneOfType","array","isFloat","bool","isInt","controlName","defaultProps","key","o","SortableListItem","SortableList","SortableDragger","role","className","style","cursor","_ref","process","env","NODE_ENV","styles","map","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","CollectionControl","constructor","props","onAdd","bind","i","newValue","concat","onSortEnd","oldIndex","newIndex","removeItem","filter","ix","renderList","length","children","Control","useDragHandle","lockAxis","bordered","css","theme","borderRadius","gridUnit","commonProps","index","flex","marginLeft","marginRight","icon","tooltip","bsStyle","onClick","render","PlusLarge","iconSize","iconColor","colors","grayscale","light5","__reactstandin__regenerateByEval","code","eval","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/explore/components/controls/CollectionControl/index.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { List } from 'src/components';\nimport { nanoid } from 'nanoid';\nimport { t, withTheme } from '@superset-ui/core';\nimport {\n  SortableContainer,\n  SortableHandle,\n  SortableElement,\n  arrayMove,\n} from 'react-sortable-hoc';\nimport Icons from 'src/components/Icons';\nimport {\n  HeaderContainer,\n  AddIconButton,\n} from 'src/explore/components/controls/OptionControls';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport ControlHeader from 'src/explore/components/ControlHeader';\nimport CustomListItem from 'src/explore/components/controls/CustomListItem';\nimport controlMap from '..';\n\nconst propTypes = {\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  description: PropTypes.string,\n  placeholder: PropTypes.string,\n  addTooltip: PropTypes.string,\n  itemGenerator: PropTypes.func,\n  keyAccessor: PropTypes.func,\n  onChange: PropTypes.func,\n  value: PropTypes.oneOfType([PropTypes.array]),\n  isFloat: PropTypes.bool,\n  isInt: PropTypes.bool,\n  controlName: PropTypes.string.isRequired,\n};\n\nconst defaultProps = {\n  label: null,\n  description: null,\n  onChange: () => {},\n  placeholder: t('Empty collection'),\n  itemGenerator: () => ({ key: nanoid(11) }),\n  keyAccessor: o => o.key,\n  value: [],\n  addTooltip: t('Add an item'),\n};\nconst SortableListItem = SortableElement(CustomListItem);\nconst SortableList = SortableContainer(List);\nconst SortableDragger = SortableHandle(() => (\n  <i\n    role=\"img\"\n    aria-label=\"drag\"\n    className=\"fa fa-bars text-primary\"\n    style={{ cursor: 'ns-resize' }}\n  />\n));\n\nclass CollectionControl extends Component {\n  constructor(props) {\n    super(props);\n    this.onAdd = this.onAdd.bind(this);\n  }\n\n  onChange(i, value) {\n    const newValue = [...this.props.value];\n    newValue[i] = { ...this.props.value[i], ...value };\n    this.props.onChange(newValue);\n  }\n\n  onAdd() {\n    this.props.onChange(this.props.value.concat([this.props.itemGenerator()]));\n  }\n\n  onSortEnd({ oldIndex, newIndex }) {\n    this.props.onChange(arrayMove(this.props.value, oldIndex, newIndex));\n  }\n\n  removeItem(i) {\n    this.props.onChange(this.props.value.filter((o, ix) => i !== ix));\n  }\n\n  renderList() {\n    if (this.props.value.length === 0) {\n      return <div className=\"text-muted\">{this.props.placeholder}</div>;\n    }\n    const Control = controlMap[this.props.controlName];\n    return (\n      <SortableList\n        useDragHandle\n        lockAxis=\"y\"\n        onSortEnd={this.onSortEnd.bind(this)}\n        bordered\n        css={theme => ({\n          borderRadius: theme.gridUnit,\n        })}\n      >\n        {this.props.value.map((o, i) => {\n          // label relevant only for header, not here\n          const { label, ...commonProps } = this.props;\n          return (\n            <SortableListItem\n              className=\"clearfix\"\n              css={{ justifyContent: 'flex-start' }}\n              key={this.props.keyAccessor(o)}\n              index={i}\n            >\n              <SortableDragger />\n              <div\n                css={theme => ({\n                  flex: 1,\n                  marginLeft: theme.gridUnit * 2,\n                  marginRight: theme.gridUnit * 2,\n                })}\n              >\n                <Control\n                  {...commonProps}\n                  {...o}\n                  onChange={this.onChange.bind(this, i)}\n                />\n              </div>\n              <InfoTooltipWithTrigger\n                icon=\"times\"\n                label=\"remove-item\"\n                tooltip={t('Remove item')}\n                bsStyle=\"primary\"\n                onClick={this.removeItem.bind(this, i)}\n              />\n            </SortableListItem>\n          );\n        })}\n      </SortableList>\n    );\n  }\n\n  render() {\n    const { theme } = this.props;\n    return (\n      <div data-test=\"CollectionControl\" className=\"CollectionControl\">\n        <HeaderContainer>\n          <ControlHeader {...this.props} />\n          <AddIconButton onClick={this.onAdd}>\n            <Icons.PlusLarge\n              iconSize=\"s\"\n              iconColor={theme.colors.grayscale.light5}\n            />\n          </AddIconButton>\n        </HeaderContainer>\n        {this.renderList()}\n      </div>\n    );\n  }\n}\n\nCollectionControl.propTypes = propTypes;\nCollectionControl.defaultProps = defaultProps;\n\nexport default withTheme(CollectionControl);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}