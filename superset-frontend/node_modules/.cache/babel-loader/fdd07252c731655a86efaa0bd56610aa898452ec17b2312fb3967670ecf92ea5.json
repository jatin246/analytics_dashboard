{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  css,\n  isFeatureEnabled,\n  FeatureFlag,\n  styled,\n  t,\n  useTheme } from\n'@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport Button from 'src/components/Button';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { exportChart, getChartKey } from 'src/explore/exploreUtils';\nimport downloadAsImage from 'src/utils/downloadAsImage';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport copyTextToClipboard from 'src/utils/copy';\nimport HeaderReportDropDown from 'src/features/reports/ReportModal/HeaderReportDropdown';\nimport { logEvent } from 'src/logger/actions';\nimport {\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS } from\n'src/logger/LogUtils';\nimport ViewQueryModal from '../controls/ViewQueryModal';\nimport EmbedCodeContent from '../EmbedCodeContent';\nimport DashboardsSubMenu from './DashboardsSubMenu';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\n\nconst MENU_KEYS = {\n  EDIT_PROPERTIES: 'edit_properties',\n  DASHBOARDS_ADDED_TO: 'dashboards_added_to',\n  DOWNLOAD_SUBMENU: 'download_submenu',\n  EXPORT_TO_CSV: 'export_to_csv',\n  EXPORT_TO_CSV_PIVOTED: 'export_to_csv_pivoted',\n  EXPORT_TO_JSON: 'export_to_json',\n  EXPORT_TO_XLSX: 'export_to_xlsx',\n  DOWNLOAD_AS_IMAGE: 'download_as_image',\n  SHARE_SUBMENU: 'share_submenu',\n  COPY_PERMALINK: 'copy_permalink',\n  EMBED_CODE: 'embed_code',\n  SHARE_BY_EMAIL: 'share_by_email',\n  REPORT_SUBMENU: 'report_submenu',\n  SET_UP_REPORT: 'set_up_report',\n  SET_REPORT_ACTIVE: 'set_report_active',\n  EDIT_REPORT: 'edit_report',\n  DELETE_REPORT: 'delete_report',\n  VIEW_QUERY: 'view_query',\n  RUN_IN_SQL_LAB: 'run_in_sql_lab'\n};\n\nconst VIZ_TYPES_PIVOTABLE = ['pivot_table_v2'];\n\nexport const MenuItemWithCheckboxContainer = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    align-items: center;\n\n    & svg {\n      width: ${theme.gridUnit * 3}px;\n      height: ${theme.gridUnit * 3}px;\n    }\n\n    & span[role='checkbox'] {\n      display: inline-flex;\n      margin-right: ${theme.gridUnit}px;\n    }\n  `}\n`;\n\nexport const MenuTrigger = styled(Button)`\n  ${({ theme }) => css`\n    width: ${theme.gridUnit * 8}px;\n    height: ${theme.gridUnit * 8}px;\n    padding: 0;\n    border: 1px solid ${theme.colors.primary.dark2};\n\n    &.ant-btn > span.anticon {\n      line-height: 0;\n      transition: inherit;\n    }\n\n    &:hover:not(:focus) > span.anticon {\n      color: ${theme.colors.primary.light1};\n    }\n  `}\n`;\n\nconst iconReset = css`\n  .ant-dropdown-menu-item > & > .anticon:first-child {\n    margin-right: 0;\n    vertical-align: 0;\n  }\n`;\n\nexport const useExploreAdditionalActionsMenu = (\nlatestQueryFormData,\ncanDownloadCSV,\nslice,\nonOpenInEditor,\nonOpenPropertiesModal,\nownState,\ndashboards,\n...rest) =>\n{\n  const theme = useTheme();\n  const { addDangerToast, addSuccessToast } = useToasts();\n  const dispatch = useDispatch();\n  const [showReportSubMenu, setShowReportSubMenu] = useState(null);\n  const [isDropdownVisible, setIsDropdownVisible] = useState(false);\n  const chart = useSelector(\n    (state) => {var _state$charts;return (_state$charts = state.charts) == null ? void 0 : _state$charts[getChartKey(state.explore)];}\n  );\n\n  const { datasource } = latestQueryFormData;\n\n  const shareByEmail = useCallback(async () => {\n    try {\n      const subject = t('Superset Chart');\n      const url = await getChartPermalink(latestQueryFormData);\n      const body = encodeURIComponent(t('%s%s', 'Check out this chart: ', url));\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, latestQueryFormData]);\n\n  const exportCSV = useCallback(\n    () =>\n    canDownloadCSV ?\n    exportChart({\n      formData: latestQueryFormData,\n      ownState,\n      resultType: 'full',\n      resultFormat: 'csv'\n    }) :\n    null,\n    [canDownloadCSV, latestQueryFormData]\n  );\n\n  const exportCSVPivoted = useCallback(\n    () =>\n    canDownloadCSV ?\n    exportChart({\n      formData: latestQueryFormData,\n      resultType: 'post_processed',\n      resultFormat: 'csv'\n    }) :\n    null,\n    [canDownloadCSV, latestQueryFormData]\n  );\n\n  const exportJson = useCallback(\n    () =>\n    canDownloadCSV ?\n    exportChart({\n      formData: latestQueryFormData,\n      resultType: 'results',\n      resultFormat: 'json'\n    }) :\n    null,\n    [canDownloadCSV, latestQueryFormData]\n  );\n\n  const exportExcel = useCallback(\n    () =>\n    canDownloadCSV ?\n    exportChart({\n      formData: latestQueryFormData,\n      resultType: 'results',\n      resultFormat: 'xlsx'\n    }) :\n    null,\n    [canDownloadCSV, latestQueryFormData]\n  );\n\n  const copyLink = useCallback(async () => {\n    try {\n      if (!latestQueryFormData) {\n        throw new Error();\n      }\n      await copyTextToClipboard(() => getChartPermalink(latestQueryFormData));\n      addSuccessToast(t('Copied to clipboard!'));\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, addSuccessToast, latestQueryFormData]);\n\n  const handleMenuClick = useCallback(\n    ({ key, domEvent }) => {var _slice$slice_name;\n      switch (key) {\n        case MENU_KEYS.EDIT_PROPERTIES:\n          onOpenPropertiesModal();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV:\n          exportCSV();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV, {\n              chartId: slice == null ? void 0 : slice.slice_id,\n              chartName: slice == null ? void 0 : slice.slice_name\n            })\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV_PIVOTED:\n          exportCSVPivoted();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED, {\n              chartId: slice == null ? void 0 : slice.slice_id,\n              chartName: slice == null ? void 0 : slice.slice_name\n            })\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_JSON:\n          exportJson();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON, {\n              chartId: slice == null ? void 0 : slice.slice_id,\n              chartName: slice == null ? void 0 : slice.slice_name\n            })\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_XLSX:\n          exportExcel();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS, {\n              chartId: slice == null ? void 0 : slice.slice_id,\n              chartName: slice == null ? void 0 : slice.slice_name\n            })\n          );\n          break;\n        case MENU_KEYS.DOWNLOAD_AS_IMAGE:\n          downloadAsImage(\n            '.panel-body .chart-container',\n            // eslint-disable-next-line camelcase\n            (_slice$slice_name = slice == null ? void 0 : slice.slice_name) != null ? _slice$slice_name : t('New chart'),\n            true\n          )(domEvent);\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE, {\n              chartId: slice == null ? void 0 : slice.slice_id,\n              chartName: slice == null ? void 0 : slice.slice_name\n            })\n          );\n          break;\n        case MENU_KEYS.COPY_PERMALINK:\n          copyLink();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EMBED_CODE:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.SHARE_BY_EMAIL:\n          shareByEmail();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.VIEW_QUERY:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.RUN_IN_SQL_LAB:\n          onOpenInEditor(latestQueryFormData, domEvent.metaKey);\n          setIsDropdownVisible(false);\n          break;\n        default:\n          break;\n      }\n    },\n    [\n    copyLink,\n    exportCSV,\n    exportCSVPivoted,\n    exportJson,\n    latestQueryFormData,\n    onOpenInEditor,\n    onOpenPropertiesModal,\n    shareByEmail,\n    slice == null ? void 0 : slice.slice_name]\n\n  );\n\n  const menu = useMemo(\n    () =>\n    _jsxs(Menu, { onClick: handleMenuClick, selectable: false, ...rest, children: [\n      _jsxs(_Fragment, { children: [\n        slice &&\n        _jsx(Menu.Item, { children:\n          t('Edit chart properties') }, MENU_KEYS.EDIT_PROPERTIES\n        ),\n\n        _jsx(Menu.SubMenu, {\n          title: t('On dashboards'), children:\n\n\n          _jsx(DashboardsSubMenu, {\n            chartId: slice == null ? void 0 : slice.slice_id,\n            dashboards: dashboards }\n          ) }, MENU_KEYS.DASHBOARDS_ADDED_TO\n        ),\n        _jsx(Menu.Divider, {})] }\n      ),\n      _jsxs(Menu.SubMenu, { title: t('Download'), children: [\n        VIZ_TYPES_PIVOTABLE.includes(latestQueryFormData.viz_type) ?\n        _jsxs(_Fragment, { children: [\n          _jsx(Menu.Item, {\n\n            icon: _jsx(Icons.FileOutlined, { css: iconReset }),\n            disabled: !canDownloadCSV, children:\n\n            t('Export to original .CSV') }, MENU_KEYS.EXPORT_TO_CSV\n          ),\n          _jsx(Menu.Item, {\n\n            icon: _jsx(Icons.FileOutlined, { css: iconReset }),\n            disabled: !canDownloadCSV, children:\n\n            t('Export to pivoted .CSV') }, MENU_KEYS.EXPORT_TO_CSV_PIVOTED\n          )] }\n        ) :\n\n        _jsx(Menu.Item, {\n\n          icon: _jsx(Icons.FileOutlined, { css: iconReset }),\n          disabled: !canDownloadCSV, children:\n\n          t('Export to .CSV') }, MENU_KEYS.EXPORT_TO_CSV\n        ),\n\n        _jsx(Menu.Item, {\n\n          icon: _jsx(Icons.FileOutlined, { css: iconReset }),\n          disabled: !canDownloadCSV, children:\n\n          t('Export to .JSON') }, MENU_KEYS.EXPORT_TO_JSON\n        ),\n        _jsx(Menu.Item, {\n\n          icon: _jsx(Icons.FileImageOutlined, { css: iconReset }), children:\n\n          t('Download as image') }, MENU_KEYS.DOWNLOAD_AS_IMAGE\n        ),\n        _jsx(Menu.Item, {\n\n          icon: _jsx(Icons.FileOutlined, { css: iconReset }),\n          disabled: !canDownloadCSV, children:\n\n          t('Export to Excel') }, MENU_KEYS.EXPORT_TO_XLSX\n        )] }, MENU_KEYS.DOWNLOAD_SUBMENU\n      ),\n      _jsxs(Menu.SubMenu, { title: t('Share'), children: [\n        _jsx(Menu.Item, { children:\n          t('Copy permalink to clipboard') }, MENU_KEYS.COPY_PERMALINK\n        ),\n        _jsx(Menu.Item, { children:\n          t('Share chart by email') }, MENU_KEYS.SHARE_BY_EMAIL\n        ),\n        isFeatureEnabled(FeatureFlag.EmbeddableCharts) ?\n        _jsx(Menu.Item, { children:\n          _jsx(ModalTrigger, {\n            triggerNode:\n            _jsx(\"span\", { \"data-test\": \"embed-code-button\", children: t('Embed code') }),\n\n            modalTitle: t('Embed code'),\n            modalBody:\n            _jsx(EmbedCodeContent, {\n              formData: latestQueryFormData,\n              addDangerToast: addDangerToast }\n            ),\n\n            maxWidth: `${theme.gridUnit * 100}px`,\n            destroyOnClose: true,\n            responsive: true }\n          ) }, MENU_KEYS.EMBED_CODE\n        ) :\n        null] }, MENU_KEYS.SHARE_SUBMENU\n      ),\n      _jsx(Menu.Divider, {}),\n      showReportSubMenu ?\n      _jsxs(_Fragment, { children: [\n        _jsx(Menu.SubMenu, { title: t('Manage email report'), children:\n          _jsx(HeaderReportDropDown, {\n            chart: chart,\n            setShowReportSubMenu: setShowReportSubMenu,\n            showReportSubMenu: showReportSubMenu,\n            setIsDropdownVisible: setIsDropdownVisible,\n            isDropdownVisible: isDropdownVisible,\n            useTextMenu: true }\n          ) }\n        ),\n        _jsx(Menu.Divider, {})] }\n      ) :\n\n      _jsx(Menu, { children:\n        _jsx(HeaderReportDropDown, {\n          chart: chart,\n          setShowReportSubMenu: setShowReportSubMenu,\n          setIsDropdownVisible: setIsDropdownVisible,\n          isDropdownVisible: isDropdownVisible,\n          useTextMenu: true }\n        ) }\n      ),\n\n      _jsx(Menu.Item, { children:\n        _jsx(ModalTrigger, {\n          triggerNode:\n          _jsx(\"span\", { \"data-test\": \"view-query-menu-item\", children: t('View query') }),\n\n          modalTitle: t('View query'),\n          modalBody:\n          _jsx(ViewQueryModal, { latestQueryFormData: latestQueryFormData }),\n\n          draggable: true,\n          resizable: true,\n          responsive: true }\n        ) }, MENU_KEYS.VIEW_QUERY\n      ),\n      datasource &&\n      _jsx(Menu.Item, { children:\n        t('Run in SQL Lab') }, MENU_KEYS.RUN_IN_SQL_LAB\n      )] }\n\n    ),\n\n    [\n    addDangerToast,\n    canDownloadCSV,\n    chart,\n    dashboards,\n    handleMenuClick,\n    isDropdownVisible,\n    latestQueryFormData,\n    showReportSubMenu,\n    slice,\n    theme.gridUnit]\n\n  );\n  return [menu, isDropdownVisible, setIsDropdownVisible];\n};__signature__(useExploreAdditionalActionsMenu, \"useTheme{theme}\\nuseToasts{{ addDangerToast, addSuccessToast }}\\nuseDispatch{dispatch}\\nuseState{[showReportSubMenu, setShowReportSubMenu](null)}\\nuseState{[isDropdownVisible, setIsDropdownVisible](false)}\\nuseSelector{chart}\\nuseCallback{shareByEmail}\\nuseCallback{exportCSV}\\nuseCallback{exportCSVPivoted}\\nuseCallback{exportJson}\\nuseCallback{exportExcel}\\nuseCallback{copyLink}\\nuseCallback{handleMenuClick}\\nuseMemo{menu}\", () => [useTheme, useToasts, useDispatch, useSelector]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(MENU_KEYS, \"MENU_KEYS\", \"/app/superset-frontend/src/explore/components/useExploreAdditionalActionsMenu/index.jsx\");reactHotLoader.register(VIZ_TYPES_PIVOTABLE, \"VIZ_TYPES_PIVOTABLE\", \"/app/superset-frontend/src/explore/components/useExploreAdditionalActionsMenu/index.jsx\");reactHotLoader.register(MenuItemWithCheckboxContainer, \"MenuItemWithCheckboxContainer\", \"/app/superset-frontend/src/explore/components/useExploreAdditionalActionsMenu/index.jsx\");reactHotLoader.register(MenuTrigger, \"MenuTrigger\", \"/app/superset-frontend/src/explore/components/useExploreAdditionalActionsMenu/index.jsx\");reactHotLoader.register(iconReset, \"iconReset\", \"/app/superset-frontend/src/explore/components/useExploreAdditionalActionsMenu/index.jsx\");reactHotLoader.register(useExploreAdditionalActionsMenu, \"useExploreAdditionalActionsMenu\", \"/app/superset-frontend/src/explore/components/useExploreAdditionalActionsMenu/index.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useMemo","useState","useDispatch","useSelector","css","isFeatureEnabled","FeatureFlag","styled","t","useTheme","Icons","Menu","ModalTrigger","Button","useToasts","exportChart","getChartKey","downloadAsImage","getChartPermalink","copyTextToClipboard","HeaderReportDropDown","logEvent","LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE","LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON","LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV","LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED","LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS","ViewQueryModal","EmbedCodeContent","DashboardsSubMenu","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","MENU_KEYS","EDIT_PROPERTIES","DASHBOARDS_ADDED_TO","DOWNLOAD_SUBMENU","EXPORT_TO_CSV","EXPORT_TO_CSV_PIVOTED","EXPORT_TO_JSON","EXPORT_TO_XLSX","DOWNLOAD_AS_IMAGE","SHARE_SUBMENU","COPY_PERMALINK","EMBED_CODE","SHARE_BY_EMAIL","REPORT_SUBMENU","SET_UP_REPORT","SET_REPORT_ACTIVE","EDIT_REPORT","DELETE_REPORT","VIEW_QUERY","RUN_IN_SQL_LAB","VIZ_TYPES_PIVOTABLE","MenuItemWithCheckboxContainer","div","theme","gridUnit","MenuTrigger","colors","primary","dark2","light1","iconReset","useExploreAdditionalActionsMenu","latestQueryFormData","canDownloadCSV","slice","onOpenInEditor","onOpenPropertiesModal","ownState","dashboards","rest","addDangerToast","addSuccessToast","dispatch","showReportSubMenu","setShowReportSubMenu","isDropdownVisible","setIsDropdownVisible","chart","state","_state$charts","charts","explore","datasource","shareByEmail","subject","url","body","encodeURIComponent","window","location","href","error","exportCSV","formData","resultType","resultFormat","exportCSVPivoted","exportJson","exportExcel","copyLink","Error","handleMenuClick","key","domEvent","_slice$slice_name","chartId","slice_id","chartName","slice_name","metaKey","menu","onClick","selectable","children","Item","SubMenu","title","Divider","includes","viz_type","icon","FileOutlined","disabled","FileImageOutlined","EmbeddableCharts","triggerNode","modalTitle","modalBody","maxWidth","destroyOnClose","responsive","useTextMenu","draggable","resizable","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/explore/components/useExploreAdditionalActionsMenu/index.jsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  css,\n  isFeatureEnabled,\n  FeatureFlag,\n  styled,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport Button from 'src/components/Button';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { exportChart, getChartKey } from 'src/explore/exploreUtils';\nimport downloadAsImage from 'src/utils/downloadAsImage';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport copyTextToClipboard from 'src/utils/copy';\nimport HeaderReportDropDown from 'src/features/reports/ReportModal/HeaderReportDropdown';\nimport { logEvent } from 'src/logger/actions';\nimport {\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS,\n} from 'src/logger/LogUtils';\nimport ViewQueryModal from '../controls/ViewQueryModal';\nimport EmbedCodeContent from '../EmbedCodeContent';\nimport DashboardsSubMenu from './DashboardsSubMenu';\n\nconst MENU_KEYS = {\n  EDIT_PROPERTIES: 'edit_properties',\n  DASHBOARDS_ADDED_TO: 'dashboards_added_to',\n  DOWNLOAD_SUBMENU: 'download_submenu',\n  EXPORT_TO_CSV: 'export_to_csv',\n  EXPORT_TO_CSV_PIVOTED: 'export_to_csv_pivoted',\n  EXPORT_TO_JSON: 'export_to_json',\n  EXPORT_TO_XLSX: 'export_to_xlsx',\n  DOWNLOAD_AS_IMAGE: 'download_as_image',\n  SHARE_SUBMENU: 'share_submenu',\n  COPY_PERMALINK: 'copy_permalink',\n  EMBED_CODE: 'embed_code',\n  SHARE_BY_EMAIL: 'share_by_email',\n  REPORT_SUBMENU: 'report_submenu',\n  SET_UP_REPORT: 'set_up_report',\n  SET_REPORT_ACTIVE: 'set_report_active',\n  EDIT_REPORT: 'edit_report',\n  DELETE_REPORT: 'delete_report',\n  VIEW_QUERY: 'view_query',\n  RUN_IN_SQL_LAB: 'run_in_sql_lab',\n};\n\nconst VIZ_TYPES_PIVOTABLE = ['pivot_table_v2'];\n\nexport const MenuItemWithCheckboxContainer = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    align-items: center;\n\n    & svg {\n      width: ${theme.gridUnit * 3}px;\n      height: ${theme.gridUnit * 3}px;\n    }\n\n    & span[role='checkbox'] {\n      display: inline-flex;\n      margin-right: ${theme.gridUnit}px;\n    }\n  `}\n`;\n\nexport const MenuTrigger = styled(Button)`\n  ${({ theme }) => css`\n    width: ${theme.gridUnit * 8}px;\n    height: ${theme.gridUnit * 8}px;\n    padding: 0;\n    border: 1px solid ${theme.colors.primary.dark2};\n\n    &.ant-btn > span.anticon {\n      line-height: 0;\n      transition: inherit;\n    }\n\n    &:hover:not(:focus) > span.anticon {\n      color: ${theme.colors.primary.light1};\n    }\n  `}\n`;\n\nconst iconReset = css`\n  .ant-dropdown-menu-item > & > .anticon:first-child {\n    margin-right: 0;\n    vertical-align: 0;\n  }\n`;\n\nexport const useExploreAdditionalActionsMenu = (\n  latestQueryFormData,\n  canDownloadCSV,\n  slice,\n  onOpenInEditor,\n  onOpenPropertiesModal,\n  ownState,\n  dashboards,\n  ...rest\n) => {\n  const theme = useTheme();\n  const { addDangerToast, addSuccessToast } = useToasts();\n  const dispatch = useDispatch();\n  const [showReportSubMenu, setShowReportSubMenu] = useState(null);\n  const [isDropdownVisible, setIsDropdownVisible] = useState(false);\n  const chart = useSelector(\n    state => state.charts?.[getChartKey(state.explore)],\n  );\n\n  const { datasource } = latestQueryFormData;\n\n  const shareByEmail = useCallback(async () => {\n    try {\n      const subject = t('Superset Chart');\n      const url = await getChartPermalink(latestQueryFormData);\n      const body = encodeURIComponent(t('%s%s', 'Check out this chart: ', url));\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, latestQueryFormData]);\n\n  const exportCSV = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            ownState,\n            resultType: 'full',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportCSVPivoted = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            resultType: 'post_processed',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportJson = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            resultType: 'results',\n            resultFormat: 'json',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportExcel = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            resultType: 'results',\n            resultFormat: 'xlsx',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const copyLink = useCallback(async () => {\n    try {\n      if (!latestQueryFormData) {\n        throw new Error();\n      }\n      await copyTextToClipboard(() => getChartPermalink(latestQueryFormData));\n      addSuccessToast(t('Copied to clipboard!'));\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, addSuccessToast, latestQueryFormData]);\n\n  const handleMenuClick = useCallback(\n    ({ key, domEvent }) => {\n      switch (key) {\n        case MENU_KEYS.EDIT_PROPERTIES:\n          onOpenPropertiesModal();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV:\n          exportCSV();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV_PIVOTED:\n          exportCSVPivoted();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_JSON:\n          exportJson();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_XLSX:\n          exportExcel();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.DOWNLOAD_AS_IMAGE:\n          downloadAsImage(\n            '.panel-body .chart-container',\n            // eslint-disable-next-line camelcase\n            slice?.slice_name ?? t('New chart'),\n            true,\n          )(domEvent);\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.COPY_PERMALINK:\n          copyLink();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EMBED_CODE:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.SHARE_BY_EMAIL:\n          shareByEmail();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.VIEW_QUERY:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.RUN_IN_SQL_LAB:\n          onOpenInEditor(latestQueryFormData, domEvent.metaKey);\n          setIsDropdownVisible(false);\n          break;\n        default:\n          break;\n      }\n    },\n    [\n      copyLink,\n      exportCSV,\n      exportCSVPivoted,\n      exportJson,\n      latestQueryFormData,\n      onOpenInEditor,\n      onOpenPropertiesModal,\n      shareByEmail,\n      slice?.slice_name,\n    ],\n  );\n\n  const menu = useMemo(\n    () => (\n      <Menu onClick={handleMenuClick} selectable={false} {...rest}>\n        <>\n          {slice && (\n            <Menu.Item key={MENU_KEYS.EDIT_PROPERTIES}>\n              {t('Edit chart properties')}\n            </Menu.Item>\n          )}\n          <Menu.SubMenu\n            title={t('On dashboards')}\n            key={MENU_KEYS.DASHBOARDS_ADDED_TO}\n          >\n            <DashboardsSubMenu\n              chartId={slice?.slice_id}\n              dashboards={dashboards}\n            />\n          </Menu.SubMenu>\n          <Menu.Divider />\n        </>\n        <Menu.SubMenu title={t('Download')} key={MENU_KEYS.DOWNLOAD_SUBMENU}>\n          {VIZ_TYPES_PIVOTABLE.includes(latestQueryFormData.viz_type) ? (\n            <>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to original .CSV')}\n              </Menu.Item>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV_PIVOTED}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to pivoted .CSV')}\n              </Menu.Item>\n            </>\n          ) : (\n            <Menu.Item\n              key={MENU_KEYS.EXPORT_TO_CSV}\n              icon={<Icons.FileOutlined css={iconReset} />}\n              disabled={!canDownloadCSV}\n            >\n              {t('Export to .CSV')}\n            </Menu.Item>\n          )}\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_JSON}\n            icon={<Icons.FileOutlined css={iconReset} />}\n            disabled={!canDownloadCSV}\n          >\n            {t('Export to .JSON')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.DOWNLOAD_AS_IMAGE}\n            icon={<Icons.FileImageOutlined css={iconReset} />}\n          >\n            {t('Download as image')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_XLSX}\n            icon={<Icons.FileOutlined css={iconReset} />}\n            disabled={!canDownloadCSV}\n          >\n            {t('Export to Excel')}\n          </Menu.Item>\n        </Menu.SubMenu>\n        <Menu.SubMenu title={t('Share')} key={MENU_KEYS.SHARE_SUBMENU}>\n          <Menu.Item key={MENU_KEYS.COPY_PERMALINK}>\n            {t('Copy permalink to clipboard')}\n          </Menu.Item>\n          <Menu.Item key={MENU_KEYS.SHARE_BY_EMAIL}>\n            {t('Share chart by email')}\n          </Menu.Item>\n          {isFeatureEnabled(FeatureFlag.EmbeddableCharts) ? (\n            <Menu.Item key={MENU_KEYS.EMBED_CODE}>\n              <ModalTrigger\n                triggerNode={\n                  <span data-test=\"embed-code-button\">{t('Embed code')}</span>\n                }\n                modalTitle={t('Embed code')}\n                modalBody={\n                  <EmbedCodeContent\n                    formData={latestQueryFormData}\n                    addDangerToast={addDangerToast}\n                  />\n                }\n                maxWidth={`${theme.gridUnit * 100}px`}\n                destroyOnClose\n                responsive\n              />\n            </Menu.Item>\n          ) : null}\n        </Menu.SubMenu>\n        <Menu.Divider />\n        {showReportSubMenu ? (\n          <>\n            <Menu.SubMenu title={t('Manage email report')}>\n              <HeaderReportDropDown\n                chart={chart}\n                setShowReportSubMenu={setShowReportSubMenu}\n                showReportSubMenu={showReportSubMenu}\n                setIsDropdownVisible={setIsDropdownVisible}\n                isDropdownVisible={isDropdownVisible}\n                useTextMenu\n              />\n            </Menu.SubMenu>\n            <Menu.Divider />\n          </>\n        ) : (\n          <Menu>\n            <HeaderReportDropDown\n              chart={chart}\n              setShowReportSubMenu={setShowReportSubMenu}\n              setIsDropdownVisible={setIsDropdownVisible}\n              isDropdownVisible={isDropdownVisible}\n              useTextMenu\n            />\n          </Menu>\n        )}\n        <Menu.Item key={MENU_KEYS.VIEW_QUERY}>\n          <ModalTrigger\n            triggerNode={\n              <span data-test=\"view-query-menu-item\">{t('View query')}</span>\n            }\n            modalTitle={t('View query')}\n            modalBody={\n              <ViewQueryModal latestQueryFormData={latestQueryFormData} />\n            }\n            draggable\n            resizable\n            responsive\n          />\n        </Menu.Item>\n        {datasource && (\n          <Menu.Item key={MENU_KEYS.RUN_IN_SQL_LAB}>\n            {t('Run in SQL Lab')}\n          </Menu.Item>\n        )}\n      </Menu>\n    ),\n    [\n      addDangerToast,\n      canDownloadCSV,\n      chart,\n      dashboards,\n      handleMenuClick,\n      isDropdownVisible,\n      latestQueryFormData,\n      showReportSubMenu,\n      slice,\n      theme.gridUnit,\n    ],\n  );\n  return [menu, isDropdownVisible, setIsDropdownVisible];\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}