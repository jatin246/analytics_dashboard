{"ast":null,"code":"import _debounce from \"lodash/debounce\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState } from 'react';\nimport { FAST_DEBOUNCE, css, styled } from '@superset-ui/core';\nimport { useSelector } from 'react-redux';\nimport { useDragDropManager } from 'react-dnd';\nimport classNames from 'classnames';import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\n\nconst StyledDiv = styled.div`\n  ${({ theme }) => css`\n    position: relative;\n    display: grid;\n    grid-template-columns: auto 1fr;\n    grid-template-rows: auto 1fr;\n    flex: 1;\n    /* Special cases */\n\n    &.dragdroppable--dragging {\n      &\n        .dashboard-component-tabs-content\n        > .empty-droptarget.empty-droptarget--full {\n        height: 100%;\n      }\n      & .empty-droptarget:before {\n        display: block;\n        border-color: ${theme.colors.primary.light1};\n        background-color: ${theme.colors.primary.light3};\n      }\n      & .grid-row:after {\n        border-style: hidden;\n      }\n      & .droptarget-side:last-child {\n        inset-inline-end: 0;\n      }\n      & .droptarget-edge:last-child {\n        inset-block-end: 0;\n      }\n    }\n\n    /* A row within a column has inset hover menu */\n    .dragdroppable-column .dragdroppable-row .hover-menu--left {\n      left: ${theme.gridUnit * -3}px;\n      background: ${theme.colors.grayscale.light5};\n      border: 1px solid ${theme.colors.grayscale.light2};\n    }\n\n    .dashboard-component-tabs {\n      position: relative;\n    }\n\n    /* A column within a column or tabs has inset hover menu */\n    .dragdroppable-column .dragdroppable-column .hover-menu--top,\n    .dashboard-component-tabs .dragdroppable-column .hover-menu--top {\n      top: ${theme.gridUnit * -3}px;\n      background: ${theme.colors.grayscale.light5};\n      border: 1px solid ${theme.colors.grayscale.light2};\n    }\n\n    /* move Tabs hover menu to top near actual Tabs */\n    .dashboard-component-tabs > .hover-menu-container > .hover-menu--left {\n      top: 0;\n      transform: unset;\n      background: transparent;\n    }\n\n    /* push Chart actions to upper right */\n    .dragdroppable-column .dashboard-component-chart-holder .hover-menu--top,\n    .dragdroppable .dashboard-component-header .hover-menu--top {\n      right: ${theme.gridUnit * 2}px;\n      top: ${theme.gridUnit * 2}px;\n      background: transparent;\n      border: none;\n      transform: unset;\n      left: unset;\n    }\n    div:hover > .hover-menu-container .hover-menu,\n    .hover-menu-container .hover-menu:hover {\n      opacity: 1;\n    }\n\n    p {\n      margin: 0 0 ${theme.gridUnit * 2}px 0;\n    }\n\n    i.danger {\n      color: ${theme.colors.error.base};\n    }\n\n    i.warning {\n      color: ${theme.colors.alert.base};\n    }\n  `}\n`;\nconst DashboardWrapper = ({ children }) => {\n  const editMode = useSelector((state) => state.dashboardState.editMode);\n  const dragDropManager = useDragDropManager();\n  const [isDragged, setIsDragged] = useState(dragDropManager.getMonitor().isDragging());\n  useEffect(() => {\n    const monitor = dragDropManager.getMonitor();\n    const debouncedSetIsDragged = _debounce(setIsDragged, FAST_DEBOUNCE);\n    const unsub = monitor.subscribeToStateChange(() => {\n      const isDragging = monitor.isDragging();\n      if (isDragging) {\n        // set a debounced function to prevent HTML5 drag source\n        // from interfering with the drop zone highlighting\n        debouncedSetIsDragged(true);\n      } else\n      {\n        debouncedSetIsDragged.cancel();\n        setIsDragged(false);\n      }\n    });\n    return () => {\n      unsub();\n      debouncedSetIsDragged.cancel();\n    };\n  }, [dragDropManager]);\n  return _jsx(StyledDiv, { className: classNames({\n      'dragdroppable--dragging': editMode && isDragged\n    }), children:\n    children }\n  );\n};__signature__(DashboardWrapper, \"useSelector{editMode}\\nuseDragDropManager{dragDropManager}\\nuseState{[isDragged, setIsDragged](dragDropManager.getMonitor().isDragging())}\\nuseEffect{}\", () => [useSelector, useDragDropManager]);const _default =\nDashboardWrapper;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledDiv, \"StyledDiv\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardWrapper.tsx\");reactHotLoader.register(DashboardWrapper, \"DashboardWrapper\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardWrapper.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardWrapper.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useEffect","useState","FAST_DEBOUNCE","css","styled","useSelector","useDragDropManager","classNames","jsx","_jsx","StyledDiv","div","theme","colors","primary","light1","light3","gridUnit","grayscale","light5","light2","error","base","alert","DashboardWrapper","children","editMode","state","dashboardState","dragDropManager","isDragged","setIsDragged","getMonitor","isDragging","monitor","debouncedSetIsDragged","_debounce","unsub","subscribeToStateChange","cancel","className","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardWrapper.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { FC, useEffect, useState } from 'react';\n\nimport { FAST_DEBOUNCE, css, styled } from '@superset-ui/core';\nimport { RootState } from 'src/dashboard/types';\nimport { useSelector } from 'react-redux';\nimport { useDragDropManager } from 'react-dnd';\nimport classNames from 'classnames';\nimport { debounce } from 'lodash';\n\nconst StyledDiv = styled.div`\n  ${({ theme }) => css`\n    position: relative;\n    display: grid;\n    grid-template-columns: auto 1fr;\n    grid-template-rows: auto 1fr;\n    flex: 1;\n    /* Special cases */\n\n    &.dragdroppable--dragging {\n      &\n        .dashboard-component-tabs-content\n        > .empty-droptarget.empty-droptarget--full {\n        height: 100%;\n      }\n      & .empty-droptarget:before {\n        display: block;\n        border-color: ${theme.colors.primary.light1};\n        background-color: ${theme.colors.primary.light3};\n      }\n      & .grid-row:after {\n        border-style: hidden;\n      }\n      & .droptarget-side:last-child {\n        inset-inline-end: 0;\n      }\n      & .droptarget-edge:last-child {\n        inset-block-end: 0;\n      }\n    }\n\n    /* A row within a column has inset hover menu */\n    .dragdroppable-column .dragdroppable-row .hover-menu--left {\n      left: ${theme.gridUnit * -3}px;\n      background: ${theme.colors.grayscale.light5};\n      border: 1px solid ${theme.colors.grayscale.light2};\n    }\n\n    .dashboard-component-tabs {\n      position: relative;\n    }\n\n    /* A column within a column or tabs has inset hover menu */\n    .dragdroppable-column .dragdroppable-column .hover-menu--top,\n    .dashboard-component-tabs .dragdroppable-column .hover-menu--top {\n      top: ${theme.gridUnit * -3}px;\n      background: ${theme.colors.grayscale.light5};\n      border: 1px solid ${theme.colors.grayscale.light2};\n    }\n\n    /* move Tabs hover menu to top near actual Tabs */\n    .dashboard-component-tabs > .hover-menu-container > .hover-menu--left {\n      top: 0;\n      transform: unset;\n      background: transparent;\n    }\n\n    /* push Chart actions to upper right */\n    .dragdroppable-column .dashboard-component-chart-holder .hover-menu--top,\n    .dragdroppable .dashboard-component-header .hover-menu--top {\n      right: ${theme.gridUnit * 2}px;\n      top: ${theme.gridUnit * 2}px;\n      background: transparent;\n      border: none;\n      transform: unset;\n      left: unset;\n    }\n    div:hover > .hover-menu-container .hover-menu,\n    .hover-menu-container .hover-menu:hover {\n      opacity: 1;\n    }\n\n    p {\n      margin: 0 0 ${theme.gridUnit * 2}px 0;\n    }\n\n    i.danger {\n      color: ${theme.colors.error.base};\n    }\n\n    i.warning {\n      color: ${theme.colors.alert.base};\n    }\n  `}\n`;\n\ntype Props = {};\n\nconst DashboardWrapper: FC<Props> = ({ children }) => {\n  const editMode = useSelector<RootState, boolean>(\n    state => state.dashboardState.editMode,\n  );\n  const dragDropManager = useDragDropManager();\n  const [isDragged, setIsDragged] = useState(\n    dragDropManager.getMonitor().isDragging(),\n  );\n\n  useEffect(() => {\n    const monitor = dragDropManager.getMonitor();\n    const debouncedSetIsDragged = debounce(setIsDragged, FAST_DEBOUNCE);\n    const unsub = monitor.subscribeToStateChange(() => {\n      const isDragging = monitor.isDragging();\n      if (isDragging) {\n        // set a debounced function to prevent HTML5 drag source\n        // from interfering with the drop zone highlighting\n        debouncedSetIsDragged(true);\n      } else {\n        debouncedSetIsDragged.cancel();\n        setIsDragged(false);\n      }\n    });\n\n    return () => {\n      unsub();\n      debouncedSetIsDragged.cancel();\n    };\n  }, [dragDropManager]);\n\n  return (\n    <StyledDiv\n      className={classNames({\n        'dragdroppable--dragging': editMode && isDragged,\n      })}\n    >\n      {children}\n    </StyledDiv>\n  );\n};\n\nexport default DashboardWrapper;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}